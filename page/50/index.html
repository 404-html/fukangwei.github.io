<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="泥腿子出身">
<meta property="og:url" content="http://fukangwei.gitee.io/page/50/index.html">
<meta property="og:site_name" content="泥腿子出身">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="泥腿子出身">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '561O3H1PZB',
      apiKey: '7631d3cf19ac49bd39ada7163ec937a7',
      indexName: 'fuxinzi',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="http://fukangwei.gitee.io/page/50/">





  <title>泥腿子出身</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">泥腿子出身</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/24/Qt语法详解/Qt之QHostAddress/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Qt语法详解/Qt之QHostAddress/" itemprop="url">Qt之QHostAddress</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T14:57:19+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h3><p>&emsp;&emsp;<code>QHostAddress</code>类提供一个<code>IP</code>地址。这个类提供一种独立于平台和协议的方式来保存<code>IPv4</code>和<code>IPv6</code>地址。<code>QHostAddress</code>通常与<code>QTcpSocket</code>、QTcpServer、QUdpSocket一起使用，来连接到主机或建立一个服务器。<br>&emsp;&emsp;可以通过<code>setAddress</code>来设置一个主机地址，使用<code>toIPv4Address</code>、<code>toIPv6Address</code>或<code>toString</code>来检索主机地址，你可以通过<code>protocol</code>来检查协议类型。注意，<code>QHostAddress</code>不做<code>DNS</code>查询，而<code>QHostInfo</code>是有必要的。这个类还支持通用的预定义地址：<code>Null</code>、<code>LocalHost</code>、<code>LocalHostIPv6</code>、<code>Broadcast</code>和<code>Any</code>。</p>
<h3 id="常用接口"><a href="#常用接口" class="headerlink" title="常用接口"></a>常用接口</h3><p>&emsp;&emsp;枚举变量为<code>QHostAddress::SpecialAddress</code>，取值范围如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>常量</th>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QHostAddress::Null</code></td>
<td><code>0</code></td>
<td>空地址对象，相当于<code>QHostAddress</code></td>
</tr>
<tr>
<td><code>QHostAddress::LocalHost</code></td>
<td><code>2</code></td>
<td><code>IPv4</code>本地主机地址，相当于<code>QHostAddress(&quot;127.0.0.1&quot;)</code></td>
</tr>
<tr>
<td><code>QHostAddress::LocalHostIPv6</code></td>
<td><code>3</code></td>
<td><code>IPv6</code>本地主机地址，相当于<code>QHostAddress(&quot;::1&quot;)</code></td>
</tr>
<tr>
<td><code>QHostAddress::Broadcast</code></td>
<td><code>1</code></td>
<td><code>Pv4</code>广播地址，相当于<code>QHostAddress(&quot;255.255.255.255&quot;)</code></td>
</tr>
<tr>
<td><code>QHostAddress::AnyIPv4</code></td>
<td><code>6</code></td>
<td>意思是<code>IPv4 any-address</code>，相当于<code>QHostAddress(&quot;0.0.0.0&quot;)</code>，与该地址绑定的<code>socket</code>将只监听<code>IPv4</code>接口</td>
</tr>
<tr>
<td><code>QHostAddress::AnyIPv6</code></td>
<td><code>5</code></td>
<td>意思是<code>IPv6 any-address</code>，相当于<code>QHostAddress(&quot;::&quot;)</code>，与该地址绑定的<code>socket</code>将只监听<code>IPv6</code>接口</td>
</tr>
<tr>
<td><code>QHostAddress::Any</code></td>
<td><code>4</code></td>
<td>双<code>any-address</code>栈，与该地址绑定的<code>socket</code>将侦听<code>IPv4</code>和<code>IPv6</code>接口</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><code>bool isLoopback() const</code>：如果地址是<code>IPv6</code>的环回地址，或者<code>IPv4</code>的环回地址，则返回<code>true</code>。</li>
<li><code>bool isNull() const</code>：如果主机地址为空(<code>INADDR_ANY</code>或<code>in6addr_any</code>)，返回<code>true</code>。默认的构造函数创建一个空的地址，这个地址对于任何主机或接口是无效的。</li>
<li><code>QAbstractSocket::NetworkLayerProtocol protocol() const</code>：返回主机地址的网络层协议。</li>
<li><code>QString scopeId() const</code>：返回<code>IPv6</code>地址的范围<code>ID</code>。对于<code>IPv4</code>地址，如果该地址不包含范围<code>ID</code>，则返回一个空字符串。</li>
</ul>
<p>&emsp;&emsp;<code>IPv6</code>的范围<code>ID</code>指定非全球<code>IPv6</code>地址范围的可达性，限制地址可以被使用的区域。所有<code>IPv6</code>地址与这种可达范围相关联。范围<code>ID</code>用于消除那些不能保证是全局唯一性的地址。<br>&emsp;&emsp;当使用<code>链路本地</code>或<code>本地站点</code>地址的<code>IPv6</code>连接，必须指定范围<code>ID</code>。对<code>链路本地</code>地址来说，范围<code>ID</code>通常与接口名称(例如<code>eth0</code>、<code>en1</code>)或者数目(例如<code>1</code>、<code>2</code>)相同。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">quint32 <span class="title">toIPv4Address</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">quint32 <span class="title">toIPv4Address</span> <span class="params">( <span class="keyword">bool</span> *ok )</span> <span class="keyword">const</span></span></span><br></pre></td></tr></table></figure>
<p>返回<code>IPv4</code>地址为一个数字。如果地址是<code>127.0.0.1</code>，返回值为<code>2130706433</code>(即<code>0x7f000001</code>)。如果<code>protocol</code>是<code>IPv4Protocol</code>，该值是有效的；如果是<code>IPv6Protocol</code>，并且<code>IPv6</code>地址是一个<code>IPv4</code>映射的地址，在这种情况下，<code>ok</code>将被设置为<code>true</code>，否则它将被设置为<code>false</code>。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Q_IPV6ADDR <span class="title">toIPv6Address</span><span class="params">()</span> <span class="keyword">const</span></span></span><br></pre></td></tr></table></figure>
<p>返回的<code>IPv6</code>地址为<code>Q_IPV6ADDR</code>结构，该结构由<code>16</code>位无符号字符组成。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Q_IPV6ADDR addr = hostAddr.toIPv6Address(); <span class="comment">/* 该地址包含16位无符号字符 */</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i ) &#123;</span><br><span class="line">    <span class="comment">/* 处理addr[i] */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果<code>protocol</code>是<code>IPv6Protocol</code>，该值是有效的；如果是<code>IPv4Protocol</code>，返回地址将是<code>IPv4</code>地址映射的<code>IPv6</code>地址。</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>&emsp;&emsp;简单应用：构造一个<code>QHostAddress</code>，通过<code>toString</code>来获取对应的<code>IP</code>地址：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QHostAddress address = QHostAddress ( QHostAddress::LocalHost );</span><br><span class="line">QString strIPAddress = address.toString();</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;获取所有主机地址：<code>QNetworkInterface</code>类中提供了一个静态函数<code>allAddresses</code>，用于返回一个<code>QHostAddress</code>主机地址列表：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;QHostAddress&gt; <span class="built_in">list</span> = QNetworkInterface::allAddresses();</span><br><span class="line">​</span><br><span class="line">foreach ( QHostAddress address, <span class="built_in">list</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( address.isNull() ) &#123; <span class="comment">/* 主机地址为空 */</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    QAbstractSocket::NetworkLayerProtocol nProtocol = address.protocol();</span><br><span class="line">    QString strScopeId = address.scopeId();</span><br><span class="line">    QString strAddress = address.toString();</span><br><span class="line">    <span class="keyword">bool</span> bLoopback = address.isLoopback();</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( nProtocol == QAbstractSocket::IPv4Protocol ) &#123; <span class="comment">/* 如果是IPv4 */</span></span><br><span class="line">        <span class="keyword">bool</span> bOk = <span class="literal">false</span>;</span><br><span class="line">        quint32 nIPV4 = address.toIPv4Address ( &amp;bOk );</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">if</span> ( bOk ) &#123;</span><br><span class="line">            qDebug() &lt;&lt; <span class="string">"IPV4 : "</span> &lt;&lt; nIPV4;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( nProtocol == QAbstractSocket::IPv6Protocol ) &#123; <span class="comment">/* 如果是IPv6 */</span></span><br><span class="line">        QStringList IPV6List ( <span class="string">""</span> );</span><br><span class="line">        Q_IPV6ADDR IPV6 = address.toIPv6Address();</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i ) &#123;</span><br><span class="line">            quint8 nC = IPV6[i];</span><br><span class="line">            IPV6List &lt;&lt; QString::number ( nC );</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"IPV6: "</span> &lt;&lt; IPV6List.join ( <span class="string">" "</span> );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">"Protocol: "</span> &lt;&lt; nProtocol;</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">"ScopeId: "</span> &lt;&lt; strScopeId;</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">"Address: "</span> &lt;&lt; strAddress;</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">"IsLoopback: "</span> &lt;&lt; bLoopback;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">IPV6: <span class="string">" 254 128 0 0 0 0 0 0 89 150 39 163 131 181 42 231"</span></span><br><span class="line">Protocol: QAbstractSocket::NetworkLayerProtocol(IPv6Protocol)</span><br><span class="line">ScopeId: <span class="string">"18"</span></span><br><span class="line">Address: <span class="string">"fe80::5996:27a3:83b5:2ae7%18"</span></span><br><span class="line">IsLoopback: <span class="literal">false</span></span><br><span class="line">​</span><br><span class="line">IPV4: <span class="number">3232249857</span></span><br><span class="line">Protocol: QAbstractSocket::NetworkLayerProtocol(IPv4Protocol)</span><br><span class="line">ScopeId: <span class="string">""</span></span><br><span class="line">Address: <span class="string">"192.168.56.1"</span></span><br><span class="line">IsLoopback: <span class="literal">false</span></span><br><span class="line">​</span><br><span class="line">IPV6: <span class="string">" 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1"</span></span><br><span class="line">Protocol: QAbstractSocket::NetworkLayerProtocol(IPv6Protocol)</span><br><span class="line">ScopeId: <span class="string">""</span></span><br><span class="line">Address: <span class="string">"::1"</span></span><br><span class="line">IsLoopback: <span class="literal">true</span></span><br><span class="line">​</span><br><span class="line">IPV4: <span class="number">2130706433</span></span><br><span class="line">Protocol: QAbstractSocket::NetworkLayerProtocol(IPv4Protocol)</span><br><span class="line">ScopeId: <span class="string">""</span></span><br><span class="line">Address: <span class="string">"127.0.0.1"</span></span><br><span class="line">IsLoopback: <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h3><p>&emsp;&emsp;例如限制本地链路地址范围为<code>169.254.1.0</code>至<code>169.254.254.255</code>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isLinkLocalAddress</span> <span class="params">( QHostAddress addr )</span> </span>&#123;</span><br><span class="line">    quint32 nIPv4 = addr.toIPv4Address();</span><br><span class="line">    quint32 nMinRange = QHostAddress ( <span class="string">"169.254.1.0"</span> ).toIPv4Address();</span><br><span class="line">    quint32 nMaxRange = QHostAddress ( <span class="string">"169.254.254.255"</span> ).toIPv4Address();</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( ( nIPv4 &gt;= nMinRange ) &amp;&amp; ( nIPv4 &lt;= nMaxRange ) ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/24/Qt语法详解/Qt之QFileDialog/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Qt语法详解/Qt之QFileDialog/" itemprop="url">Qt之QFileDialog</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T14:05:36+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>QFileDialog</code>是<code>Qt</code>中的文件对话框，以下资料来源于<code>Qt</code>官方文档。使用QFileDialog可以调用当前系统的文件对话框，需要包含头文件<code>QFileDialog</code>。最简单的方法是调用静态函数来对话框获取文件：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QString file = QFileDialog::getOpenFileName ( <span class="string">"/home/foxman"</span>, <span class="string">"Images (*.png *.xpm *.jpg)"</span>, <span class="keyword">this</span> );</span><br></pre></td></tr></table></figure>
<p>这段代码可以建立一个取文件对话框，选择<code>OK</code>后将文件路径返回给<code>file</code>。可以一次性打开多个文件，使用<code>QStringList</code>来保存打开的文件的路径，例如打开一些音乐文件：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QStringList files = QFileDialog::getOpenFileNames (</span><br><span class="line">    <span class="keyword">this</span>, tr ( <span class="string">"Select Music Files"</span> ),</span><br><span class="line">    QDesktopServices::storageLocation ( QDesktopServices::MusicLocation ) );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;常见的用法如下所示：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 指定父窗口、设置对话框标题、指定默认打开的目录路径、设置文件类型过滤器 */</span></span><br><span class="line">QStringList fileNames = QFileDialog::getOpenFileNames ( <span class="keyword">this</span>, tr ( <span class="string">"文件对话框"</span> ), \</span><br><span class="line">                                                        <span class="string">"F:"</span>, tr ( <span class="string">"图片文件(*png *jpg)"</span> ) );</span><br><span class="line">qDebug() &lt;&lt; <span class="string">"fileNames:"</span> &lt;&lt; fileNames;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;一般的文件对话框的使用：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QFileDialog *fd = <span class="keyword">new</span> QFileDialog ( <span class="keyword">this</span>, <span class="string">"file dlg"</span>, TRUE );</span><br><span class="line">​</span><br><span class="line"><span class="keyword">if</span> ( fd-&gt;exec() == QFileDialog::Accepted ) &#123; <span class="comment">/* ok */</span></span><br><span class="line">    QString file = fd-&gt;selectedFile();</span><br><span class="line">    qWarning ( s );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;设定选项如下：<br>&emsp;&emsp;1. 设定显示模式：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Detail显示文件详细的日期大小，List为一般情况 */</span></span><br><span class="line">fd-&gt;setViewMode ( QFileDialog::Detail );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;2. 设定过滤器：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fd-&gt;setFilter ( <span class="string">"Images (*.png *.xpm *.jpg)"</span> );</span><br></pre></td></tr></table></figure>
<p>下面是设定多个过滤器，一定要以<code>;;</code>隔开：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QString filters = <span class="string">"C file(*.c *.cpp *.h);;pic(*.png *.xpm)"</span>;</span><br><span class="line">fd-&gt;setFilters ( filters );</span><br></pre></td></tr></table></figure>
<p>设定对话框返回值类型：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fd-&gt;setMode ( QFileDialog::ExistingFile );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>AnyFile</code>：一般用于<code>save as</code>对话框。</li>
<li><code>ExistingFile</code>：存在的一个文件。</li>
<li><code>ExistingFiles</code>：存在的<code>0</code>个或多个文件(可用于选择多个文件)。</li>
<li><code>Directory</code>：返回目录。</li>
<li><code>DirectoryOnly</code>：返回目录(选取文件的时候只选中目录)。</li>
</ul>
<p>&emsp;&emsp;读取<code>QFileDialog</code>返回值：</p>
<ul>
<li>返回选择中的一个文件(夹)名字：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QString s = fd-&gt;selectedFile();</span><br></pre></td></tr></table></figure>
<ul>
<li>选取多个文件(一定要设定<code>ExistingFiles</code>模式)：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QStringList slist = fd-&gt;selectedFiles();</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> ( QStringList::Iterator it = slist.begin(); it != slist.end(); it++ ) &#123;</span><br><span class="line">    qWarning ( *it );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="文件打开对话框"><a href="#文件打开对话框" class="headerlink" title="文件打开对话框"></a>文件打开对话框</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QString <span class="title">getOpenFileName</span> <span class="params">( QWidget *parent = <span class="number">0</span>, <span class="keyword">const</span> QString &amp;caption = QString(), \</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">const</span> QString &amp;dir = QString(), <span class="keyword">const</span> QString &amp;filter = QString(), \</span></span></span><br><span class="line"><span class="function"><span class="params">                          QString *selectedFilter = <span class="number">0</span>, Options options = <span class="number">0</span> )</span></span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>parent</code>：用于指定父组件。注意，很多<code>Qt</code>组件的构造函数都会有这么一个parent参数，并提供一个默认值0。</li>
<li><code>caption</code>：对话框的标题。</li>
<li><code>dir</code>：对话框显示时默认打开的目录，<code>.</code>代表程序运行目录，<code>/</code>代表当前盘符的根目录。也可以是平台相关的目录，例如<code>C:\\</code>。</li>
<li><code>filter</code>：对话框的后缀名过滤器。多个文件使用空格分隔，例如使用<code>Image Files(*.jpg *.png)</code>就让它只能显示后缀名是<code>jpg</code>或者<code>png</code>的文件；多个过滤使用两个分号分隔，如果需要使用多个过滤器，使用<code>;;</code>分割，例如<code>JPEG Files(*.jpg);;PNG Files(*.png)</code>。</li>
<li><code>selectedFilter</code>：默认选择的过滤器。</li>
<li><code>options</code>：对话框的一些参数设定，例如只显示文件夹等，它的取值是<code>enum QFileDialog::Option</code>，每个选项可以使用<code>|</code>运算组合起来。</li>
</ul>
<h3 id="文件保存对话框"><a href="#文件保存对话框" class="headerlink" title="文件保存对话框"></a>文件保存对话框</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QString <span class="title">getSaveFileName</span> <span class="params">( QWidget *parent = <span class="number">0</span>, <span class="keyword">const</span> QString &amp;caption = QString(), \</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">const</span> QString &amp;dir = QString(), <span class="keyword">const</span> QString &amp;filter = QString(), \</span></span></span><br><span class="line"><span class="function"><span class="params">                          QString *selectedFilter = <span class="number">0</span>, Options options = <span class="number">0</span> )</span></span>;</span><br></pre></td></tr></table></figure>
<p>代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">QString fileName = QFileDialog::getSaveFileName ( <span class="keyword">this</span>, tr ( <span class="string">"Open Config"</span> ), \</span><br><span class="line">                                                  <span class="string">""</span>, tr ( <span class="string">"Config Files (*.ifg)"</span> ) );</span><br><span class="line">​</span><br><span class="line"><span class="keyword">if</span> ( !fileName.isNull() ) &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="comment">/* 点击取消按钮 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/24/Qt语法详解/Qt之QFileSystemWatcher/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Qt语法详解/Qt之QFileSystemWatcher/" itemprop="url">Qt之QFileSystemWatcher</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T13:40:43+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h3><p>&emsp;&emsp;<code>QFileSystemWatcher</code>类用于提供监视文件和目录修改的接口。它通过监控指定路径的列表，监视文件系统中文件和目录的变更。调用<code>addPath</code>函数可以监控一个特定的文件或目录。如果需要监控多个路径，可以使用<code>addPaths</code>。通过使用<code>removePath</code>和<code>removePaths</code>函数来移除现有路径。<br>&emsp;&emsp;<code>QFileSystemWatcher</code>检查添加到它的每个路径，已添加到<code>QFileSystemWatcher</code>的文件可以使用的<code>files</code>函数进行访问，目录则使用<code>directories</code>函数进行访问。当一个文件被修改、重命名或从磁盘上删除时，会发出<code>fileChanged</code>信号。同样，当一个目录或它的内容被修改或删除时，会发射<code>directoryChanged</code>信号。需要注意，文件一旦被重命名或从硬盘删除，目录从磁盘上删除时，<code>QFileSystemWatcher</code>将停止监控。监控文件和目录进行修改的行为会消耗系统资源，这意味着进程同时监控的文件数量是有限制的。一些系统限制打开的文件描述符的数量默认为<code>256</code>，也就是说如果进程使用<code>addPath</code>和<code>addPaths</code>函数添加超过<code>256</code>个文件或目录到文件系统将会失败。</p>
<h3 id="公共函数"><a href="#公共函数" class="headerlink" title="公共函数"></a>公共函数</h3><ul>
<li><code>bool addPath(const QString &amp; path)</code>：如果路径存在，则添加至文件系统监控；如果路径不存在或者已经被监控了，那么不添加。如果路径是一个目录，内容被修改或删除时，会发射<code>directoryChanged</code>信号；否则当文件被修改、重命名或从磁盘上删除时，会发出<code>fileChanged</code>信号。如果监控成功，返回<code>true</code>，否则返回<code>false</code>。监控失败的原因通常依赖于系统，但也包括资源不存在、接入失败、或总的监控数量限制等原因。</li>
<li><code>QStringList addPaths(const QStringList &amp; paths)</code>：添加每一个路径至文件系统监控，如果路径不存在或者已经被监控了，那么不添加。返回值是不能被监控的路径列表。</li>
<li><code>QStringList directories() const</code>：返回一个被监控的目录路径列表。</li>
<li><code>QStringList files() const</code>：返回一个被监控的文件路径列表。</li>
<li><code>bool removePath(const QString &amp; path)</code>：从文件系统监控中删除指定的路径。如果监控被成功移除，返回<code>true</code>。删除失败的原因通常是与系统相关，但可能是由于路径已经被删除。</li>
<li><code>QStringList removePaths(const QStringList &amp; paths)</code>：从文件系统监控中删除指定的路径。返回值是一个无法删除成功的路径列表。</li>
</ul>
<h3 id="信号"><a href="#信号" class="headerlink" title="信号"></a>信号</h3><ul>
<li><code>void directoryChanged(const QString &amp; path)</code>：当目录被修改(例如在指定的路径中添加或删除一个文件)或从磁盘删除时，这个信号将被发射。注意，如果在短时间内有几种变化，可能有些变化不会发出这个信号。然而，在变化的序列中，最后的变化总会发射这个信号。这是一个私有信号，可以用于信号连接但不能由用户发出。</li>
<li><code>void fileChanged(const QString &amp; path)</code>：当在指定路径中的文件被修改、重命名或从磁盘上删除时，这个信号将被发射。这是一个私有信号，可以用于信号连接但不能由用户发出。</li>
</ul>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>&emsp;&emsp;下面来实现一个<code>文件/目录</code>监控的类。<code>FileSystemWatcher.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> FILE_SYSTEM_WATCHER_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FILE_SYSTEM_WATCHER_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QObject&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMap&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFileSystemWatcher&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileSystemWatcher</span> :</span> <span class="keyword">public</span> QObject &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addWatchPath</span> <span class="params">( QString path )</span></span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="comment">/* 目录更新时调用，path是监控的路径 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">directoryUpdated</span> <span class="params">( <span class="keyword">const</span> QString &amp;path )</span></span>;</span><br><span class="line">    <span class="comment">/* 文件被修改时调用，path是监控的路径 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fileUpdated</span> <span class="params">( <span class="keyword">const</span> QString &amp;path )</span></span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">FileSystemWatcher</span> <span class="params">( QObject *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">static</span> FileSystemWatcher *m_pInstance;</span><br><span class="line">    QFileSystemWatcher *m_pSystemWatcher;</span><br><span class="line">    <span class="comment">/* 当前每个监控的内容目录列表 */</span></span><br><span class="line">    QMap&lt;QString, QStringList&gt; m_currentContentsMap;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>FileSystemWatcher.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDir&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFileInfo&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;qDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"FileSystemWatcher.h"</span></span></span><br><span class="line">​</span><br><span class="line">FileSystemWatcher *FileSystemWatcher::m_pInstance = <span class="literal">NULL</span>;</span><br><span class="line">​</span><br><span class="line">FileSystemWatcher::FileSystemWatcher ( QObject *parent ) : QObject ( parent ) &#123;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> FileSystemWatcher::addWatchPath ( QString path ) &#123; <span class="comment">/* 监控文件或目录 */</span></span><br><span class="line">    qDebug() &lt;&lt; QString ( <span class="string">"Add to watch: %1"</span> ).arg ( path );</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( m_pInstance == <span class="literal">NULL</span> ) &#123;</span><br><span class="line">        m_pInstance = <span class="keyword">new</span> FileSystemWatcher();</span><br><span class="line">        m_pInstance-&gt;m_pSystemWatcher = <span class="keyword">new</span> QFileSystemWatcher();</span><br><span class="line">        <span class="comment">/* 连接QFileSystemWatcher的directoryChanged和fileChanged信号到相应的槽 */</span></span><br><span class="line">        connect ( m_pInstance-&gt;m_pSystemWatcher, SIGNAL ( directoryChanged ( QString ) ), \</span><br><span class="line">                  m_pInstance, SLOT ( directoryUpdated ( QString ) ) );</span><br><span class="line">        connect ( m_pInstance-&gt;m_pSystemWatcher, SIGNAL ( fileChanged ( QString ) ), \</span><br><span class="line">                  m_pInstance, SLOT ( fileUpdated ( QString ) ) );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    m_pInstance-&gt;m_pSystemWatcher-&gt;addPath ( path ); <span class="comment">/* 添加监控路径 */</span></span><br><span class="line">    <span class="function">QFileInfo <span class="title">file</span> <span class="params">( path )</span></span>; <span class="comment">/* 如果添加路径是一个目录，保存当前内容列表 */</span></span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( file.isDir() ) &#123;</span><br><span class="line">        <span class="function"><span class="keyword">const</span> QDir <span class="title">dirw</span> <span class="params">( path )</span></span>;</span><br><span class="line">        m_pInstance-&gt;m_currentContentsMap[path] = \</span><br><span class="line">            dirw.entryList ( QDir::NoDotAndDotDot | QDir::AllDirs | QDir::Files, QDir::DirsFirst );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="comment">/* 只要任何监控的目录更新(添加、删除、重命名)，就会调用 */</span></span><br><span class="line"><span class="keyword">void</span> FileSystemWatcher::directoryUpdated ( <span class="keyword">const</span> QString &amp;path ) &#123;</span><br><span class="line">    qDebug() &lt;&lt; QString ( <span class="string">"Directory updated: %1"</span> ).arg ( path );</span><br><span class="line">    <span class="comment">/* 比较最新的内容和保存的内容找出区别(变化) */</span></span><br><span class="line">    QStringList currEntryList = m_currentContentsMap[path];</span><br><span class="line">    <span class="function"><span class="keyword">const</span> QDir <span class="title">dir</span> <span class="params">( path )</span></span>;</span><br><span class="line">    QStringList newEntryList = \</span><br><span class="line">        dir.entryList ( QDir::NoDotAndDotDot  | QDir::AllDirs | QDir::Files, QDir::DirsFirst );</span><br><span class="line">    QSet&lt;QString&gt; newDirSet = QSet&lt;QString&gt;::fromList ( newEntryList );</span><br><span class="line">    QSet&lt;QString&gt; currentDirSet = QSet&lt;QString&gt;::fromList ( currEntryList );</span><br><span class="line">    <span class="comment">/* 添加了文件 */</span></span><br><span class="line">    QSet&lt;QString&gt; newFiles = newDirSet - currentDirSet;</span><br><span class="line">    QStringList newFile = newFiles.toList();</span><br><span class="line">    <span class="comment">/* 文件已被移除 */</span></span><br><span class="line">    QSet&lt;QString&gt; deletedFiles = currentDirSet - newDirSet;</span><br><span class="line">    QStringList deleteFile = deletedFiles.toList();</span><br><span class="line">    <span class="comment">/* 更新当前设置 */</span></span><br><span class="line">    m_currentContentsMap[path] = newEntryList;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( !newFile.isEmpty() &amp;&amp; !deleteFile.isEmpty() ) &#123;</span><br><span class="line">        <span class="comment">/* 文件/目录重命名 */</span></span><br><span class="line">        <span class="keyword">if</span> ( ( newFile.count() == <span class="number">1</span> ) &amp;&amp; ( deleteFile.count() == <span class="number">1</span> ) ) &#123;</span><br><span class="line">            qDebug() &lt;&lt; QString ( <span class="string">"File Renamed from %1 to %2"</span> ).arg (</span><br><span class="line">                deleteFile.first() ).arg ( newFile.first() );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/* 添加新文件/目录至Dir */</span></span><br><span class="line">        <span class="keyword">if</span> ( !newFile.isEmpty() ) &#123;</span><br><span class="line">            qDebug() &lt;&lt; <span class="string">"New Files/Dirs added: "</span> &lt;&lt; newFile;</span><br><span class="line">​</span><br><span class="line">            foreach ( QString file, newFile ) &#123;</span><br><span class="line">                <span class="comment">/* 处理操作每个新文件 */</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        <span class="comment">/* 从Dir中删除文件/目录 */</span></span><br><span class="line">        <span class="keyword">if</span> ( !deleteFile.isEmpty() ) &#123;</span><br><span class="line">            qDebug() &lt;&lt; <span class="string">"Files/Dirs deleted: "</span> &lt;&lt; deleteFile;</span><br><span class="line">​</span><br><span class="line">            foreach ( QString file, deleteFile ) &#123;</span><br><span class="line">                <span class="comment">/* 处理操作每个被删除的文件 */</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> FileSystemWatcher::fileUpdated ( <span class="keyword">const</span> QString &amp;path ) &#123; <span class="comment">/* 文件修改时调用 */</span></span><br><span class="line">    <span class="function">QFileInfo <span class="title">file</span> <span class="params">( path )</span></span>;</span><br><span class="line">    QString strPath = file.absolutePath();</span><br><span class="line">    QString strName = file.fileName();</span><br><span class="line">    qDebug() &lt;&lt; QString ( <span class="string">"The file %1 at path %2 is updated"</span> ).arg ( strName ).arg ( strPath );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"FileSystemWatcher.h"</span></span></span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[] )</span> </span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span> <span class="params">( argc, argv )</span></span>;</span><br><span class="line">    FileSystemWatcher::addWatchPath ( <span class="string">"E:/Test"</span> );</span><br><span class="line">    <span class="keyword">return</span> a.exec();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/24/Qt语法详解/QStringList用法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Qt语法详解/QStringList用法/" itemprop="url">QStringList用法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T13:25:08+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>QStringList</code>类提供了一个字符串列表，从<code>QList &lt;QString&gt;</code>继承而来，它提供快速索引为基础的接入以及快速插入和清除。其成员函数用于操作这个字符串列表，例如<code>append</code>、<code>insert</code>、<code>replace</code>、<code>removeAll</code>、<code>removeAt</code>、<code>removeFirst</code>、<code>removeLast</code>和<code>removeOne</code>(这些函数只能用来清除<code>QStringList</code>中的某一个元素)等。<br>&emsp;&emsp;增加字符串可以使用<code>append</code>或者<code>&lt;&lt;</code>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QStringList fonts;</span><br><span class="line"><span class="comment">/* fonts is ["Arial", "Helvetica", "Times", "Courier"] */</span></span><br><span class="line">fonts &lt;&lt; <span class="string">"Arial"</span> &lt;&lt; <span class="string">"Helvetica"</span> &lt;&lt; <span class="string">"Times"</span> &lt;&lt; <span class="string">"Courier"</span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;合并字符串使用<code>join</code>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* str is "Arial,Helvetica,Times,Courier" */</span></span><br><span class="line">QString str = fonts.join ( <span class="string">","</span> );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;拆分字符串：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QString str = <span class="string">"Arial,Helvetica,Times,Courier"</span>;</span><br><span class="line"><span class="comment">/* list is ["Arial", "Helvetica", "Times", "Courier"] */</span></span><br><span class="line">QStringList <span class="built_in">list</span> = str.split ( <span class="string">","</span> );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>IndexOf</code>函数返回给定字符串的第一个出现的索引，而<code>lastIndexOf</code>函数返回字符串的最后一次出现的索引。<br>&emsp;&emsp;替换字符串：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QStringList files;</span><br><span class="line">files &lt;&lt; <span class="string">"$QTDIR/src/moc/moc.y"</span></span><br><span class="line">      &lt;&lt; <span class="string">"$QTDIR/src/moc/moc.l"</span></span><br><span class="line">      &lt;&lt; <span class="string">"$QTDIR/include/qconfig.h"</span>;</span><br><span class="line"><span class="comment">/* files is ["/usr/lib/qt/src/moc/moc.y", ...] */</span></span><br><span class="line">files.replaceInStrings ( <span class="string">"$QTDIR"</span>, <span class="string">"/usr/lib/qt"</span> );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;过滤字符串：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QStringList <span class="built_in">list</span>;</span><br><span class="line"><span class="built_in">list</span> &lt;&lt; "Bill Murray" &lt;&lt; "John Doe" &lt;&lt; "Bill Clinton";</span><br><span class="line">QStringList result;</span><br><span class="line">/* result is ["Bill Murray", "Bill Clinton"] */</span><br><span class="line">result = <span class="built_in">list</span>.filter ( "Bill" );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;打印<code>QStringList</code>每一个元素的方法：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">QString str = <span class="string">"1,2,3,4,5,6,7,8,9"</span>;</span><br><span class="line">QStringList strList;</span><br><span class="line">​</span><br><span class="line">strList = str.split ( <span class="string">","</span> );</span><br><span class="line">​</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"String list item count: "</span> &lt;&lt; strList.size() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; strList.size(); i++ ) &#123;</span><br><span class="line">    <span class="comment">/* 或者“cout &lt;&lt; strList[i] &lt;&lt; endl;” */</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; strList.at ( i ).toLocal8Bit().constData() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;清空<code>QStringList</code>变量中所有元素的方法：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QStringList <span class="built_in">list</span>;</span><br><span class="line"><span class="built_in">list</span> &lt;&lt; "a" &lt;&lt; "b";</span><br><span class="line"><span class="built_in">list</span>.clear(); /* 清空 */</span><br><span class="line"><span class="built_in">list</span> = QStringList(); /* 清空 */</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/23/Qt语法详解/Qt之QTableWidgetItem/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/23/Qt语法详解/Qt之QTableWidgetItem/" itemprop="url">Qt之QTableWidgetItem</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-23T20:59:30+08:00">
                2019-01-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;The <code>QTableWidgetItem</code> class provides an item for use with the <code>QTableWidget</code> class. The header file is <code>QTableWidgetItem</code>.</p>
<h3 id="Public-Functions"><a href="#Public-Functions" class="headerlink" title="Public Functions"></a>Public Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><code>QTableWidgetItem(int type = Type)</code></td>
</tr>
<tr>
<td></td>
<td><code>QTableWidgetItem(const QString &amp; text, int type = Type)</code></td>
</tr>
<tr>
<td></td>
<td><code>QTableWidgetItem(const QIcon &amp; icon, const QString &amp; text, int type = Type)</code></td>
</tr>
<tr>
<td></td>
<td><code>QTableWidgetItem(const QTableWidgetItem &amp; other)</code></td>
</tr>
<tr>
<td><code>virtual</code></td>
<td><code>~QTableWidgetItem()</code></td>
</tr>
<tr>
<td><code>QBrush</code></td>
<td><code>background() const</code></td>
</tr>
<tr>
<td><code>Qt::CheckState</code></td>
<td><code>checkState() const</code></td>
</tr>
<tr>
<td><code>virtual QTableWidgetItem *</code></td>
<td><code>clone() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>column() const</code></td>
</tr>
<tr>
<td><code>virtual QVariant</code></td>
<td><code>data(int role) const</code></td>
</tr>
<tr>
<td><code>Qt::ItemFlags</code></td>
<td><code>flags() const</code></td>
</tr>
<tr>
<td><code>QFont</code></td>
<td><code>font() const</code></td>
</tr>
<tr>
<td><code>QBrush</code></td>
<td><code>foreground() const</code></td>
</tr>
<tr>
<td><code>QIcon</code></td>
<td><code>icon() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isSelected() const</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>read(QDataStream &amp; in)</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>row() const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setBackground(const QBrush &amp; brush)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setCheckState(Qt::CheckState state)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setData(int role, const QVariant &amp; value)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setFlags(Qt::ItemFlags flags)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setFont(const QFont &amp; font)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setForeground(const QBrush &amp; brush)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setIcon(const QIcon &amp; icon)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setSelected(bool select)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setSizeHint(const QSize &amp; size)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setStatusTip(const QString &amp; statusTip)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setText(const QString &amp; text)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setTextAlignment(int alignment)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setToolTip(const QString &amp; toolTip)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setWhatsThis(const QString &amp; whatsThis)</code></td>
</tr>
<tr>
<td><code>QSize</code></td>
<td><code>sizeHint() const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>statusTip() const</code></td>
</tr>
<tr>
<td><code>QTableWidget *</code></td>
<td><code>tableWidget() const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>text() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>textAlignment() const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>toolTip() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>type() const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>whatsThis() const</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>write(QDataStream &amp; out) const</code></td>
</tr>
<tr>
<td><code>virtual bool</code></td>
<td><code>operator&lt;(const QTableWidgetItem &amp; other) const</code></td>
</tr>
<tr>
<td><code>QTableWidgetItem &amp;</code></td>
<td><code>operator=(const QTableWidgetItem &amp; other)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Related-Non-Members"><a href="#Related-Non-Members" class="headerlink" title="Related Non-Members"></a>Related Non-Members</h3><ul>
<li><code>QDataStream &amp; operator&lt;&lt;(QDataStream &amp; out, const QTableWidgetItem &amp; item)</code></li>
<li><code>QDataStream &amp; operator&gt;&gt;(QDataStream &amp; in, QTableWidgetItem &amp; item)</code></li>
</ul>
<h3 id="Detailed-Description"><a href="#Detailed-Description" class="headerlink" title="Detailed Description"></a>Detailed Description</h3><p>&emsp;&emsp;The <code>QTableWidgetItem</code> class provides an item for use with the <code>QTableWidget</code> class.<br>&emsp;&emsp;Table items are used to hold pieces of information for table widgets. Items usually contain <code>text</code>, <code>icons</code>, or <code>checkboxes</code>.<br>&emsp;&emsp;The <code>QTableWidgetItem</code> class is a convenience class that replaces the <code>QTableItem</code> class in <code>Qt 3</code>. It provides an item for use with the <code>QTableWidget</code> class.<br>&emsp;&emsp;<code>Top-level</code> items are constructed without a parent then inserted at the position specified by a pair of row and column numbers:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QTableWidgetItem *newItem = <span class="keyword">new</span> QTableWidgetItem (</span><br><span class="line">    tr ( <span class="string">"%1"</span> ).arg ( <span class="built_in">pow</span> ( row, column + <span class="number">1</span> ) ) );</span><br><span class="line">tableWidget-&gt;setItem ( row, column, newItem );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;Each item can have its own background brush which is set with the <code>setBackground()</code> function. The current background brush can be found with <code>background()</code>. The text label for each item can be rendered with its own font and brush. These are specified with the <code>setFont()</code> and <code>setForeground()</code> functions, and read with <code>font()</code> and <code>foreground()</code>.<br>&emsp;&emsp;By default, items are enabled, editable, selectable, checkable, and can be used both as the source of a drag and drop operation and as a drop target. Each item’s flags can be changed by calling <code>setFlags()</code> with the appropriate value. Checkable items can be checked and unchecked with the <code>setCheckState()</code> function. The corresponding <code>checkState()</code> function indicates whether the item is currently checked.</p>
<h3 id="Subclassing"><a href="#Subclassing" class="headerlink" title="Subclassing"></a>Subclassing</h3><p>&emsp;&emsp;When subclassing <code>QTableWidgetItem</code> to provide custom items, it is possible to define new types for them so that they can be distinguished from standard items. The constructors for subclasses that require this feature need to call the base class constructor with a new type value equal to or greater than <code>UserType</code>.</p>
<h3 id="Member-Type-Documentation"><a href="#Member-Type-Documentation" class="headerlink" title="Member Type Documentation"></a>Member Type Documentation</h3><ul>
<li>enum <code>QTableWidgetItem::ItemType</code>: This enum describes the types that are used to describe table widget items.</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>Constant</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QTableWidgetItem::Type</code></td>
<td><code>0</code></td>
<td>The default type for table widget items.</td>
</tr>
<tr>
<td><code>QTableWidgetItem::UserType</code></td>
<td><code>1000</code></td>
<td>The minimum value for custom types. Values below <code>UserType</code> are reserved by <code>Qt</code>.</td>
</tr>
</tbody>
</table>
</div>
<p>You can define new user types in <code>QTableWidgetItem</code> subclasses to ensure that custom items are treated specially.</p>
<h3 id="Member-Function-Documentation"><a href="#Member-Function-Documentation" class="headerlink" title="Member Function Documentation"></a>Member Function Documentation</h3><ul>
<li><code>QTableWidgetItem::QTableWidgetItem(int type = Type)</code>: Constructs a table item of the specified <code>type</code> that does not belong to any table.</li>
<li><code>QTableWidgetItem::QTableWidgetItem(const QString &amp; text, int type = Type)</code>: Constructs a table item with the given <code>text</code>.</li>
<li><code>QTableWidgetItem::QTableWidgetItem(const QIcon &amp; icon, const QString &amp; text, int type = Type)</code>: Constructs a table item with the given <code>icon</code> and <code>text</code>.</li>
<li><code>QTableWidgetItem::QTableWidgetItem(const QTableWidgetItem &amp; other)</code>: Constructs a copy of <code>other</code>. Note that <code>type()</code> and <code>tableWidget()</code> are not copied. This function is useful when reimplementing <code>clone()</code>.</li>
<li><code>QTableWidgetItem::~QTableWidgetItem() [virtual]</code>: Destroys the table item.</li>
<li><code>QBrush QTableWidgetItem::background() const</code>: Returns the brush used to render the item’s background.</li>
<li><code>Qt::CheckState QTableWidgetItem::checkState() const</code>: Returns the checked state of the table item.</li>
<li><code>QTableWidgetItem * QTableWidgetItem::clone() const [virtual]</code>: Creates a copy of the item.</li>
<li><code>int QTableWidgetItem::column() const</code>: Returns the column of the item in the table. If the item is not in a table, this function will return <code>-1</code>.</li>
<li><code>QVariant QTableWidgetItem::data(int role) const [virtual]</code> — Returns the item’s data for the given <code>role</code>.</li>
<li><code>Qt::ItemFlags QTableWidgetItem::flags() const</code>: Returns the flags used to describe the item. These determine whether the item can be checked, edited, and selected.</li>
<li><code>QFont QTableWidgetItem::font() const</code>: Returns the font used to render the item’s text.</li>
<li><code>QBrush QTableWidgetItem::foreground() const</code>: Returns the brush used to render the item’s foreground (e.g. text).</li>
<li><code>QIcon QTableWidgetItem::icon() const</code>: Returns the item’s icon.</li>
<li><code>bool QTableWidgetItem::isSelected() const</code>: Returns <code>true</code> if the item is selected, otherwise returns <code>false</code>.</li>
<li><code>void QTableWidgetItem::read(QDataStream &amp; in) [virtual]</code>: Reads the item from stream <code>in</code>.</li>
<li><code>int QTableWidgetItem::row() const</code>: Returns the row of the item in the table. If the item is not in a table, this function will return <code>-1</code>.</li>
<li><code>void QTableWidgetItem::setBackground(const QBrush &amp; brush)</code>: Sets the item’s background <code>brush</code> to the specified <code>brush</code>.</li>
<li><code>void QTableWidgetItem::setCheckState(Qt::CheckState state)</code>: Sets the check <code>state</code> of the table item to be <code>state</code>.</li>
<li><code>void QTableWidgetItem::setData(int role, const QVariant &amp; value) [virtual]</code>: Sets the item’s data for the given role to the specified <code>value</code>.</li>
<li><code>void QTableWidgetItem::setFlags(Qt::ItemFlags flags)</code>: Sets the <code>flags</code> for the item to the given <code>flags</code>. These determine whether the item can be selected or modified.</li>
<li><code>void QTableWidgetItem::setFont(const QFont &amp; font)</code>: Sets the <code>font</code> used to display the item’s text to the given <code>font</code>.</li>
<li><code>void QTableWidgetItem::setForeground(const QBrush &amp; brush)</code>: Sets the item’s foreground <code>brush</code> to the specified <code>brush</code>.</li>
<li><code>void QTableWidgetItem::setIcon(const QIcon &amp; icon)</code>: Sets the item’s <code>icon</code> to the <code>icon</code> specified.</li>
<li><code>void QTableWidgetItem::setSelected(bool select)</code>: Sets the selected state of the item to <code>select</code>.</li>
<li><code>void QTableWidgetItem::setSizeHint(const QSize &amp; size)</code> — Sets the <code>size</code> hint for the table item to be size. If no <code>size</code> hint is set, the item delegate will compute the <code>size</code> hint based on the item data.</li>
<li><code>void QTableWidgetItem::setStatusTip(const QString &amp; statusTip)</code>: Sets the status tip for the table item to the text specified by <code>statusTip</code>. <code>QTableWidget</code> mouse tracking needs to be enabled for this feature to work.</li>
<li><code>void QTableWidgetItem::setText(const QString &amp; text)</code>: Sets the item’s <code>text</code> to the <code>text</code> specified.</li>
<li><code>void QTableWidgetItem::setTextAlignment(int alignment)</code>: Sets the text <code>alignment</code> for the item’s text to the alignment specified.</li>
<li><code>void QTableWidgetItem::setToolTip(const QString &amp; toolTip)</code>: Sets the item’s tooltip to the string specified by <code>toolTip</code>.</li>
<li><code>void QTableWidgetItem::setWhatsThis(const QString &amp; whatsThis)</code>: Sets the item’s <code>What&#39;s This?</code> help to the string specified by <code>whatsThis</code>.</li>
<li><code>QSize QTableWidgetItem::sizeHint() const</code>: Returns the size hint set for the table item.</li>
<li><code>QString QTableWidgetItem::statusTip() const</code>: Returns the item’s status tip.</li>
<li><code>QTableWidget * QTableWidgetItem::tableWidget() const</code>: Returns the table widget that contains the item.</li>
<li><code>QString QTableWidgetItem::text() const</code>: Returns the item’s text.</li>
<li><code>int QTableWidgetItem::textAlignment() const</code>: Returns the text alignment for the item’s text.</li>
<li><code>QString QTableWidgetItem::toolTip() const</code>: Returns the item’s tooltip.</li>
<li><code>int QTableWidgetItem::type() const</code>: Returns the type passed to the <code>QTableWidgetItem</code> constructor.</li>
<li><code>QString QTableWidgetItem::whatsThis() const</code>: Returns the item’s <code>What&#39;s This?</code> help.</li>
<li><code>void QTableWidgetItem::write(QDataStream &amp; out) const [virtual]</code>: Writes the item to stream <code>out</code>.</li>
<li><code>bool QTableWidgetItem::operator&lt;(const QTableWidgetItem &amp; other) const [virtual]</code>: Returns <code>true</code> if the item is less than the <code>other</code> item; otherwise returns <code>false</code>.</li>
<li><code>QTableWidgetItem &amp; QTableWidgetItem::operator=(const QTableWidgetItem &amp; other)</code>: Assigns <code>other&#39;s</code> data and flags to this item. Note that <code>type()</code> and <code>tableWidget()</code> are not copied. This function is useful when reimplementing <code>clone()</code>.</li>
</ul>
<h3 id="Related-Non-Members-1"><a href="#Related-Non-Members-1" class="headerlink" title="Related Non-Members"></a>Related Non-Members</h3><ul>
<li><code>QDataStream &amp; operator&lt;&lt;(QDataStream &amp; out, const QTableWidgetItem &amp; item)</code>: Writes the table widget item item to stream out. This operator uses <code>QTableWidgetItem::write()</code>.</li>
<li><code>QDataStream &amp; operator&gt;&gt;(QDataStream &amp; in, QTableWidgetItem &amp; item)</code>: Reads a table widget item from stream in into item. This operator uses <code>QTableWidgetItem::read()</code>.</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/23/Qt语法详解/Qt之定时器/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/23/Qt语法详解/Qt之定时器/" itemprop="url">Qt之定时器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-23T20:44:20+08:00">
                2019-01-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>Qt</code>使用定时器有两种方法，一种是使用<code>QObiect</code>类的定时器，一种是使用<code>QTimer</code>类。定时器的精确性依赖于操作系统和硬件，大多数平台支持<code>20ms</code>的精确度。</p>
<h3 id="QObject类的定时器"><a href="#QObject类的定时器" class="headerlink" title="QObject类的定时器"></a>QObject类的定时器</h3><p>&emsp;&emsp;<code>QObject</code>是所有<code>Qt</code>对象的基类，它提供了一个基本的定时器。通过<code>QObject::startTimer</code>，可以把一个一毫秒为单位的时间间隔作为参数来开始定时器，这个函数返回一个唯一的整数定时器的标识符。这个定时器开始就会在每一个时间间隔<code>触发</code>，直到明确地使用这个定时器的标识符来调用<code>QObject::killTimer</code>结束。当定时器触发时，应用程序会发送一个<code>QTimerEvent</code>。在事件循环中，处理器按照事件队列的顺序来处理定时器事件。当处理器正忙于其它事件处理时，定时器就不能立即处理。<br>&emsp;&emsp;<code>QObject</code>类还提供定时期的功能。与定时器相关的成员函数有<code>startTimer</code>、<code>timeEvent</code>、<code>killTimer</code>。<code>startTimer</code>原型如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">intQObject::startTimer ( <span class="keyword">int</span> interval );</span><br></pre></td></tr></table></figure>
<p>开始一个定时器并返回定时器<code>ID</code>，如果不能开始一个定时器，将返回<code>0</code>。定时器开始后，每隔<code>interval</code>毫秒间隔将触发一次超时事件，直到<code>killTimer</code>被调用来删除定时器。如果<code>interval</code>为<code>0</code>，那么定时器事件每次发生时没有窗口系统事件处理。<br>&emsp;&emsp;虚函数<code>timerEvent</code>被重载来实现用户的超时事件处理函数。如果有多个定时器在运行，<code>QTimerEvent::timerId</code>被用来查找指定定时器，对其进行操作。当定时器事件发生时，虚函数<code>timerEvent</code>随着<code>QTimerEvent</code>事件参数类一起被调用，重载这个函数可以获得定时器事件。定时器的用法如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 头文件 */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QNewObject</span> :</span> publicQObject &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    QNewObject ( QObject *parent = <span class="number">0</span> );</span><br><span class="line">    <span class="keyword">virtual</span> ~QNewObject();</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">timerEvent</span> <span class="params">( QTimerEvent *event )</span></span>;</span><br><span class="line">    <span class="keyword">int</span> m_nTimerId;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="comment">/* 源文件 */</span></span><br><span class="line">QNewObject::QNewObject ( QObject *parent ) : QNewObject ( parent ) &#123;</span><br><span class="line">    m_nTimerId = startTimer ( <span class="number">1000</span> );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">QNewObject::~QNewObject() &#123;</span><br><span class="line">    <span class="keyword">if</span> ( m_nTimerId != <span class="number">0</span> ) &#123;</span><br><span class="line">        killTimer ( m_nTimerId );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">voidQNewObject::timerEvent ( QTimerEvent *event ) &#123;</span><br><span class="line">    qDebug ( <span class="string">"timer event, id %d"</span>, event-&gt;timerId() );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="定时器类QTimer"><a href="#定时器类QTimer" class="headerlink" title="定时器类QTimer"></a>定时器类QTimer</h3><p>&emsp;&emsp;定时器类<code>QTimer</code>提供当定时器触发的时候发射一个信号的定时器，它提供只触发一次的超时事件，通常的使用方法如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">QTimer *testTimer = newQTimer ( <span class="keyword">this</span> ); <span class="comment">/* 创建定时器 */</span></span><br><span class="line"><span class="comment">/* 将定时器超时信号与槽(功能函数)联系起来 */</span></span><br><span class="line">connect ( testTimer, SIGNAL ( timeout() ), <span class="keyword">this</span>, SLOT ( testFunction() ) );</span><br><span class="line">testTimer-&gt;start ( <span class="number">1000</span> ); <span class="comment">/* 开始运行定时器，定时时间间隔为1000ms */</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">if</span> ( testTimer-&gt;isActive() ) &#123; <span class="comment">/* 停止运行定时器 */</span></span><br><span class="line">    testTimer-&gt;stop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>QTimer</code>还提供了一个简单的只有一次定时的函数<code>singleShot</code>。 一个定时器在<code>100ms</code>后触发处理函数<code>animateTimeout</code>并且只触发一次。代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QTimer::singleShot ( <span class="number">100</span>, <span class="keyword">this</span>, SLOT ( animateTimeout() ) );</span><br></pre></td></tr></table></figure>
<pre><code>widget.h如下所示：
</code></pre><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> WIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WIDGET_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QWidget&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Widget</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> :</span> <span class="keyword">public</span> QWidget &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Widget</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~Widget();</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">timerEvent</span> <span class="params">( QTimerEvent *event )</span></span>;</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">timerUpdate</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::Widget *ui;</span><br><span class="line">    <span class="keyword">int</span> id1, id2, id3;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// WIDGET_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>widget.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"widget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_widget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QTimer&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QTime&gt;</span></span></span><br><span class="line">​</span><br><span class="line">Widget::Widget ( QWidget *parent ) : QWidget ( parent ), ui ( <span class="keyword">new</span> Ui::Widget ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">    <span class="comment">/* 开启一个1秒定时器，返回其ID */</span></span><br><span class="line">    id1 = startTimer ( <span class="number">1000</span> );</span><br><span class="line">    id2 = startTimer ( <span class="number">2000</span> );</span><br><span class="line">    id3 = startTimer ( <span class="number">3000</span> );</span><br><span class="line">    QTimer *timer = <span class="keyword">new</span> QTimer ( <span class="keyword">this</span> ); <span class="comment">/* 创建一个新的定时器 */</span></span><br><span class="line">    <span class="comment">/* 关联定时器的溢出信号到我们的槽函数上 */</span></span><br><span class="line">    connect ( timer, SIGNAL ( timeout() ), <span class="keyword">this</span>, SLOT ( timerUpdate() ) );</span><br><span class="line">    timer-&gt;start ( <span class="number">1000</span> ); <span class="comment">/* 设置溢出时间为1秒，并启动定时器 */</span></span><br><span class="line">    <span class="comment">/* 为随机数设置初值 */</span></span><br><span class="line">    qsrand ( QTime ( <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span> ).secsTo ( QTime::currentTime() ) );</span><br><span class="line">    <span class="comment">/* singleShot函数用来开启一个只运行一次的定时器。该代码的作用是让程序运行10秒后自动关闭。*/</span></span><br><span class="line">    QTimer::singleShot ( <span class="number">10000</span>, <span class="keyword">this</span>, SLOT ( close() ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">Widget::~Widget() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> Widget::timerEvent ( QTimerEvent *event ) &#123;</span><br><span class="line">    <span class="comment">/* 判断是哪个定时器 */</span></span><br><span class="line">    <span class="keyword">if</span> ( event-&gt;timerId() == id1 ) &#123;</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"timer1"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( event-&gt;timerId() == id2 ) &#123;</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"timer2"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"timer3"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="comment">/* 定时器溢出处理 */</span></span><br><span class="line"><span class="keyword">void</span> Widget::timerUpdate() &#123;</span><br><span class="line">    QTime time = QTime::currentTime(); <span class="comment">/* 获取当前时间 */</span></span><br><span class="line">    QString text = time.toString ( <span class="string">"hh:mm"</span> ); <span class="comment">/* 转换为字符串 */</span></span><br><span class="line">​</span><br><span class="line">    <span class="comment">/* 注意单引号间要输入一个空格。每隔一秒就将“:”显示为空格 */</span></span><br><span class="line">    <span class="keyword">if</span> ( ( time.second() % <span class="number">2</span> ) == <span class="number">0</span> ) &#123;</span><br><span class="line">        text[<span class="number">2</span>] = <span class="string">' '</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    ui-&gt;lcdNumber-&gt;display ( text );</span><br><span class="line">    <span class="keyword">int</span> rand = qrand() % <span class="number">300</span>; <span class="comment">/* 产生300以内的正整数 */</span></span><br><span class="line">    ui-&gt;lcdNumber-&gt;move ( rand, rand );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/23/Qt语法详解/Qt之QPoint/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/23/Qt语法详解/Qt之QPoint/" itemprop="url">Qt之QPoint</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-23T19:45:45+08:00">
                2019-01-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;The <code>QPoint</code> class defines a point in the plane using integer precision. The header file is <code>QPoint</code>.</p>
<h3 id="Public-Functions"><a href="#Public-Functions" class="headerlink" title="Public Functions"></a>Public Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><code>QPoint()</code></td>
</tr>
<tr>
<td></td>
<td><code>QPoint(int x, int y)</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isNull() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>manhattanLength() const</code></td>
</tr>
<tr>
<td><code>int &amp;</code></td>
<td><code>rx()</code></td>
</tr>
<tr>
<td><code>int &amp;</code></td>
<td><code>ry()</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setX(int x)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setY(int y)</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>x() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>y() const</code></td>
</tr>
<tr>
<td><code>QPoint &amp;</code></td>
<td><code>operator*=(float factor)</code></td>
</tr>
<tr>
<td><code>QPoint &amp;</code></td>
<td><code>operator*=(double factor)</code></td>
</tr>
<tr>
<td><code>QPoint &amp;</code></td>
<td><code>operator*=(int factor)</code></td>
</tr>
<tr>
<td><code>QPoint &amp;</code></td>
<td><code>operator+=(const QPoint &amp; point)</code></td>
</tr>
<tr>
<td><code>QPoint &amp;</code></td>
<td><code>operator-=(const QPoint &amp; point)</code></td>
</tr>
<tr>
<td><code>QPoint &amp;</code></td>
<td><code>operator/=(qreal divisor)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Related-Non-Members"><a href="#Related-Non-Members" class="headerlink" title="Related Non-Members"></a>Related Non-Members</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bool</code></td>
<td><code>operator!=(const QPoint &amp; p1, const QPoint &amp; p2)</code></td>
</tr>
<tr>
<td><code>const QPoint</code></td>
<td><code>operator*(const QPoint &amp; point, float factor)</code></td>
</tr>
<tr>
<td><code>const QPoint</code></td>
<td><code>operator*(float factor, const QPoint &amp; point)</code></td>
</tr>
<tr>
<td><code>const QPoint</code></td>
<td><code>operator*(double factor, const QPoint &amp; point)</code></td>
</tr>
<tr>
<td><code>const QPoint</code></td>
<td><code>operator*(int factor, const QPoint &amp; point)</code></td>
</tr>
<tr>
<td><code>const QPoint</code></td>
<td><code>operator*(const QPoint &amp; point, double factor)</code></td>
</tr>
<tr>
<td><code>const QPoint</code></td>
<td><code>operator*(const QPoint &amp; point, int factor)</code></td>
</tr>
<tr>
<td><code>const QPoint</code></td>
<td><code>operator+(const QPoint &amp; p1, const QPoint &amp; p2)</code></td>
</tr>
<tr>
<td><code>const QPoint</code></td>
<td><code>operator-(const QPoint &amp; p1, const QPoint &amp; p2)</code></td>
</tr>
<tr>
<td><code>const QPoint</code></td>
<td><code>operator-(const QPoint &amp; point)</code></td>
</tr>
<tr>
<td><code>const QPoint</code></td>
<td><code>operator/(const QPoint &amp; point, qreal divisor)</code></td>
</tr>
<tr>
<td><code>QDataStream &amp;</code></td>
<td><code>operator&lt;&lt;(QDataStream &amp; stream, const QPoint &amp; point)</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator==(const QPoint &amp; p1, const QPoint &amp; p2)</code></td>
</tr>
<tr>
<td><code>QDataStream &amp;</code></td>
<td><code>operator&gt;&gt;(QDataStream &amp; stream, QPoint &amp; point)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Detailed-Description"><a href="#Detailed-Description" class="headerlink" title="Detailed Description"></a>Detailed Description</h3><p>&emsp;&emsp;The <code>QPoint</code> class defines a point in the plane using integer precision.<br>&emsp;&emsp;A point is specified by a <code>x</code> coordinate and an <code>y</code> coordinate which can be accessed using the <code>x()</code> and <code>y()</code> functions. The <code>isNull()</code> function returns <code>true</code> if both <code>x</code> and <code>y</code> are set to <code>0</code>. The coordinates can be set (or altered) using the <code>setX()</code> and <code>setY()</code> functions, or alternatively the <code>rx()</code> and <code>ry()</code> functions which return references to the coordinates (allowing direct manipulation).<br>&emsp;&emsp;Given a point <code>p</code>, the following statements are all equivalent:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QPoint p;</span><br><span class="line"></span><br><span class="line">p.setX(p.x() + <span class="number">1</span>);</span><br><span class="line">p += QPoint(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">p.rx()++;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;A <code>QPoint</code> object can also be used as a vector: Addition and subtraction are defined as for vectors (each component is added separately). A <code>QPoint</code> object can also be divided or multiplied by an int or a qreal.<br>&emsp;&emsp;In addition, the <code>QPoint</code> class provides the <code>manhattanLength()</code> function which gives an inexpensive approximation of the length of the <code>QPoint</code> object interpreted as a vector. Finally, <code>QPoint</code> objects can be streamed as well as compared.</p>
<h3 id="Member-Function-Documentation"><a href="#Member-Function-Documentation" class="headerlink" title="Member Function Documentation"></a>Member Function Documentation</h3><ul>
<li><code>QPoint::QPoint()</code>: Constructs a null point, i.e. with coordinates <code>(0, 0)</code>.</li>
<li><code>QPoint::QPoint(int x, int y)</code>: Constructs a point with the given coordinates <code>(x, y)</code>.</li>
<li><code>bool QPoint::isNull() const</code>: Returns <code>true</code> if both the <code>x</code> and <code>y</code> coordinates are set to <code>0</code>, otherwise returns <code>false</code>.</li>
<li><code>int QPoint::manhattanLength() const</code>: Returns the sum of the absolute values of <code>x()</code> and <code>y()</code>, traditionally known as the <code>Manhattan length</code> of the vector from the origin to the point. For example:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">QPoint oldPosition;</span><br><span class="line">​</span><br><span class="line">MyWidget::mouseMoveEvent ( QMouseEvent *event ) &#123;</span><br><span class="line">    QPoint point = event-&gt;pos() - oldPosition;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( point.manhattanLength() &gt; <span class="number">3</span> )</span><br><span class="line">        <span class="comment">// the mouse has moved more than 3 pixels since the oldPosition</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This is a useful, and quick to calculate, approximation to the true length:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> trueLength = <span class="built_in">sqrt</span> ( <span class="built_in">pow</span> ( x(), <span class="number">2</span> ) + <span class="built_in">pow</span> ( y(), <span class="number">2</span> ) );</span><br></pre></td></tr></table></figure>
<p>The tradition of <code>Manhattan length</code> arises because such distances apply to travelers who can only travel on a rectangular grid, like the streets of <code>Manhattan</code>.</p>
<ul>
<li><code>int &amp; QPoint::rx()</code>: Returns a reference to the <code>x</code> coordinate of this point. Using a reference makes it possible to directly manipulate <code>x</code>. For example:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QPoint <span class="title">p</span> <span class="params">( <span class="number">1</span>, <span class="number">2</span> )</span></span>;</span><br><span class="line">p.rx()--; <span class="comment">/* p becomes (0, 2) */</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>int &amp; QPoint::ry()</code>: Returns a reference to the <code>y</code> coordinate of this point. Using a reference makes it possible to directly manipulate <code>y</code>. For example:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QPoint <span class="title">p</span> <span class="params">( <span class="number">1</span>, <span class="number">2</span> )</span></span>;</span><br><span class="line">p.ry()++; <span class="comment">/* p becomes (1, 3) */</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>void QPoint::setX(int x)</code>: Sets the <code>x</code> coordinate of this point to the given <code>x</code> coordinate.</li>
<li><code>void QPoint::setY(int y)</code>: Sets the <code>y</code> coordinate of this point to the given <code>y</code> coordinate.</li>
<li><code>int QPoint::x() const</code>: Returns the <code>x</code> coordinate of this point.</li>
<li><code>int QPoint::y() const</code>: Returns the <code>y</code> coordinate of this point.</li>
<li><code>QPoint &amp; QPoint::operator*=(float factor)</code>: Multiplies this point’s coordinates by the given <code>factor</code>, and returns a reference to this point. Note that the result is rounded to the nearest integer as points are held as integers. Use <code>QPointF</code> for floating point accuracy.</li>
<li><code>QPoint &amp; QPoint::operator*=(double factor)</code>: Multiplies this point’s coordinates by the given <code>factor</code>, and returns a reference to this point. For example:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QPoint <span class="title">p</span> <span class="params">( <span class="number">-1</span>, <span class="number">4</span> )</span></span>;</span><br><span class="line">p *= <span class="number">2.5</span>; <span class="comment">/* p becomes (-3, 10) */</span></span><br></pre></td></tr></table></figure>
<p>Note that the result is rounded to the nearest integer as points are held as integers. Use <code>QPointF</code> for floating point accuracy.</p>
<ul>
<li><code>QPoint &amp; QPoint::operator*=(int factor)</code>: Multiplies this point’s coordinates by the given <code>factor</code>, and returns a reference to this point.</li>
<li><code>QPoint &amp; QPoint::operator+=(const QPoint &amp; point)</code>: Adds the given <code>point</code> to this <code>point</code> and returns a reference to this <code>point</code>. For example:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QPoint <span class="title">p</span> <span class="params">( <span class="number">3</span>, <span class="number">7</span> )</span></span>;</span><br><span class="line"><span class="function">QPoint <span class="title">q</span> <span class="params">( <span class="number">-1</span>, <span class="number">4</span> )</span></span>;</span><br><span class="line">p += q; <span class="comment">/* p becomes (2, 11) */</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>QPoint &amp; QPoint::operator-=(const QPoint &amp; point)</code>: Subtracts the given <code>point</code> from this <code>point</code> and returns a reference to this <code>point</code>. For example:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QPoint <span class="title">p</span> <span class="params">( <span class="number">3</span>, <span class="number">7</span> )</span></span>;</span><br><span class="line"><span class="function">QPoint <span class="title">q</span> <span class="params">( <span class="number">-1</span>, <span class="number">4</span> )</span></span>;</span><br><span class="line">p -= q; <span class="comment">/* p becomes (4, 3) */</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>QPoint &amp; QPoint::operator/=(qreal divisor)</code>: This is an overloaded function. Divides both <code>x</code> and <code>y</code> by the given <code>divisor</code>, and returns a reference to this point. For example:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QPoint <span class="title">p</span> <span class="params">( <span class="number">-3</span>, <span class="number">10</span> )</span></span>;</span><br><span class="line">p /= <span class="number">2.5</span>; <span class="comment">/* p becomes (-1, 4) */</span></span><br></pre></td></tr></table></figure>
<p>Note that the result is rounded to the nearest integer as points are held as integers. Use <code>QPointF</code> for floating point accuracy.</p>
<h3 id="Related-Non-Members-1"><a href="#Related-Non-Members-1" class="headerlink" title="Related Non-Members"></a>Related Non-Members</h3><ul>
<li><code>bool operator!=(const QPoint &amp; p1, const QPoint &amp; p2)</code>: Returns <code>true</code> if <code>p1</code> and <code>p2</code> are not equal; otherwise returns <code>false</code>.</li>
<li><code>const QPoint operator*(const QPoint &amp; point, float factor)</code>: Returns a copy of the given <code>point</code> multiplied by the given <code>factor</code>. Note that the result is rounded to the nearest integer as points are held as integers. Use <code>QPointF</code> for floating <code>point</code> accuracy.</li>
<li><code>const QPoint operator*(float factor, const QPoint &amp; point)</code>: This is an overloaded function. Returns a copy of the given <code>point</code> multiplied by the given <code>factor</code>.</li>
<li><code>const QPoint operator*(double factor, const QPoint &amp; point)</code>: This is an overloaded function. Returns a copy of the given <code>point</code> multiplied by the given <code>factor</code>.</li>
<li><code>const QPoint operator*(int factor, const QPoint &amp; point)</code>: This is an overloaded function. Returns a copy of the given <code>point</code> multiplied by the given <code>factor</code>.</li>
<li><code>const QPoint operator*(const QPoint &amp; point, double factor)</code>: Returns a copy of the given <code>point</code> multiplied by the given <code>factor</code>. Note that the result is rounded to the nearest integer as points are held as integers. Use <code>QPointF</code> for floating point accuracy.</li>
<li><code>const QPoint operator*(const QPoint &amp; point, int factor)</code>: Returns a copy of the given <code>point</code> multiplied by the given <code>factor</code>.</li>
<li><code>const QPoint operator+(const QPoint &amp; p1, const QPoint &amp; p2)</code>: Returns a <code>QPoint</code> object that is the sum of the given points, <code>p1</code> and <code>p2</code>; each component is added separately.</li>
<li><code>const QPoint operator-(const QPoint &amp; p1, const QPoint &amp; p2)</code>: Returns a <code>QPoint</code> object that is formed by subtracting <code>p2</code> from <code>p1</code>; each component is subtracted separately.</li>
<li><code>const QPoint operator-(const QPoint &amp; point)</code>: This is an overloaded function. Returns a <code>QPoint</code> object that is formed by changing the sign of both components of the given <code>point</code>. Equivalent to <code>QPoint(0,0) - point</code>.</li>
<li><code>const QPoint operator/(const QPoint &amp; point, qreal divisor)</code>: Returns the <code>QPoint</code> formed by dividing both components of the given <code>point</code> by the given <code>divisor</code>. Note that the result is rounded to the nearest integer as points are held as integers. Use <code>QPointF</code> for floating point accuracy.</li>
<li><code>QDataStream &amp; operator&lt;&lt;(QDataStream &amp; stream, const QPoint &amp; point)</code>: Writes the given <code>point</code> to the given <code>stream</code> and returns a reference to the <code>stream</code>.</li>
<li><code>bool operator==(const QPoint &amp; p1, const QPoint &amp; p2)</code>: Returns <code>true</code> if <code>p1</code> and <code>p2</code> are equal; otherwise returns <code>false</code>.</li>
<li><code>QDataStream &amp; operator&gt;&gt;(QDataStream &amp; stream, QPoint &amp; point)</code>: Reads a <code>point</code> from the given <code>stream</code> into the given <code>point</code> and returns a reference to the <code>stream</code>.</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/23/Qt语法详解/Qt之QThread/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/23/Qt语法详解/Qt之QThread/" itemprop="url">Qt之QThread</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-23T17:16:21+08:00">
                2019-01-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h3><p>&emsp;&emsp;<code>QThread</code>类提供了与系统无关的线程，其代表在程序中一个单独的线程控制。线程在<code>run</code>中开始执行，默认情况下，<code>run</code>通过调用<code>exec</code>启动事件循环并在线程里运行一个<code>Qt</code>的事件循环。<br>&emsp;&emsp;当线程<code>started</code>和<code>finished</code>时，<code>QThread</code>会通过一个信号通知你，可以使用<code>isFinished</code>和<code>isRunning</code>来查询线程的状态。你可以通过调用<code>exit</code>或<code>quit</code>来停止线程。在极端情况下，可能要强行<code>terminate</code>一个执行线程，但是这样做很危险。从<code>Qt 4.8</code>起，可以释放运行刚刚结束的线程对象，通过连接<code>finished</code>信号到<code>QObject::deleteLater</code>槽。使用<code>wait</code>来阻塞调用的线程，直到其它线程执行完毕(或者直到指定的时间过去)。<br>&emsp;&emsp;<code>QThread</code>还提供了静态的、平台独立的休眠函数：<code>sleep</code>、<code>msleep</code>、<code>usleep</code>，允许秒、毫秒和微秒来区分，这些函数在<code>Qt 5.0</code>中被设为<code>public</code>。一般情况下不需要<code>wait</code>和<code>sleep</code>函数，因为<code>Qt</code>是一个事件驱动型框架。考虑监听<code>finished</code>信号来取代<code>wait</code>，使用<code>QTimer</code>来取代<code>sleep</code>。<br>&emsp;&emsp;静态函数<code>currentThreadId</code>和<code>currentThread</code>返回标识当前正在执行的线程。前者返回该线程平台特定的<code>ID</code>，后者返回一个线程指针。<br>&emsp;&emsp;要设置线程的名称，可以在启动线程之前调用<code>setObjectName</code>。如果不调用<code>setObjectName</code>，线程的名称将是线程对象的运行时类型(<code>QThread</code>子类的类名)。</p>
<h3 id="线程启动"><a href="#线程启动" class="headerlink" title="线程启动"></a>线程启动</h3><p>&emsp;&emsp;<code>start</code>函数原型如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void start ( Priority priority = InheritPriority ) [slot]</span><br></pre></td></tr></table></figure>
<p>调用后会执行<code>run</code>函数，但在<code>run</code>函数执行前会发射信号<code>started</code>，操作系统将根据优先级参数调度线程。如果线程已经在运行，那么这个函数什么也不做。优先级参数的效果取决于操作系统的调度策略，那些不支持线程优先级的系统优先级将会被忽略。</p>
<h3 id="线程执行"><a href="#线程执行" class="headerlink" title="线程执行"></a>线程执行</h3><p>&emsp;&emsp;<code>exec</code>函数原型如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int exec() [protected]</span><br></pre></td></tr></table></figure>
<p>进入事件循环并等待直到调用<code>exit</code>，返回值是通过调用<code>exit</code>来获得，如果调用成功则返回<code>0</code>。<br>&emsp;&emsp;<code>run</code>函数原型如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void run() [virtual protected]</span><br></pre></td></tr></table></figure>
<p>这是线程的起点，在调用<code>start</code>之后，新创建的线程就会调用这个函数。大多数情况下需要重新实现这个函数，便于管理自己的线程。该方法返回时，该线程的执行将结束。</p>
<h3 id="线程退出"><a href="#线程退出" class="headerlink" title="线程退出"></a>线程退出</h3><p>&emsp;&emsp;<code>quit</code>函数原型如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void quit() [slot]</span><br></pre></td></tr></table></figure>
<p>告诉线程事件循环退出，返回<code>0</code>表示成功，相当于调用了<code>QThread::exit(0)</code>。<br>&emsp;&emsp;<code>exit</code>函数原型如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exit</span> <span class="params">( <span class="keyword">int</span> returnCode = <span class="number">0</span> )</span></span></span><br></pre></td></tr></table></figure>
<p>告诉线程事件循环退出。调用这个函数后，线程离开事件循环后返回，<code>QEventLoop::exec</code>返回<code>returnCode</code>。按照惯例，<code>0</code>表示成功，任何非<code>0</code>值表示失败。<br>&emsp;&emsp;<code>terminate</code>函数原型如下：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void terminate() [slot]</span><br></pre></td></tr></table></figure>
<p>终止线程，线程可能会立即被终止也可能不会，这取决于操作系统的调度策略。使用<code>terminate</code>之后再使用<code>QThread::wait</code>，以确保万无一失。当线程被终止后，所有等待中的线程将会被唤醒。此函数比较危险，不鼓励使用。线程可以在代码执行的任何点被终止，尤其可能在更新数据时被终止，从而没有机会来清理资源或者解锁等。总之，只有在绝对必要时才使用此函数。<br>&emsp;&emsp;<code>requestInterruption</code>函数原型如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">requestInterruption</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>
<p>请求线程的中断。此函数不停止线程上运行的任何事件循环，并且在任何情况下都不会终止它。</p>
<h3 id="线程等待"><a href="#线程等待" class="headerlink" title="线程等待"></a>线程等待</h3><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 强制当前线程睡眠msecs毫秒 */</span></span><br><span class="line">void msleep ( unsigned long msecs ) [static]</span><br><span class="line"><span class="comment">/* 强制当前线程睡眠secs秒 */</span></span><br><span class="line">void sleep ( unsigned long secs ) [static]</span><br><span class="line"><span class="comment">/* 强制当前线程睡眠usecs微秒 */</span></span><br><span class="line">void usleep ( unsigned long usecs ) [static]</span><br><span class="line"><span class="comment">/* 线程将会被阻塞，等待time毫秒。和sleep不同的是，如果线程退出，wait会返回 */</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">wait</span> <span class="params">( <span class="keyword">unsigned</span> <span class="keyword">long</span> time = ULONG_MAX )</span></span></span><br></pre></td></tr></table></figure>
<h3 id="线程状态"><a href="#线程状态" class="headerlink" title="线程状态"></a>线程状态</h3><p>&emsp;&emsp;<code>isFinished</code>和<code>isRunning</code>函数原型如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isFinished</span><span class="params">()</span> <span class="keyword">const</span> <span class="comment">/* 线程是否结束 */</span></span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isRunning</span><span class="params">()</span> <span class="keyword">const</span> <span class="comment">/* 线程是否正在运行 */</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>isInterruptionRequested</code>函数原型如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isInterruptionRequested</span><span class="params">()</span> <span class="keyword">const</span></span></span><br></pre></td></tr></table></figure>
<p>如果线程上的任务运行应该停止，则返回<code>true</code>。可以使用<code>requestInterruption</code>请求中断。此函数可用于使长时间运行的任务干净地中断。注意，不要过于频繁调用，以保持较低的开销。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">long_task</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    forever &#123;</span><br><span class="line">        <span class="keyword">if</span> ( QThread::currentThread()-&gt;isInterruptionRequested() ) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="线程优先级"><a href="#线程优先级" class="headerlink" title="线程优先级"></a>线程优先级</h3><p>&emsp;&emsp;<code>setPriority</code>函数原型如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setPriority</span><span class="params">(Priority priority)</span></span></span><br></pre></td></tr></table></figure>
<p>设置正在运行线程的优先级。如果线程没有运行，此函数不执行任何操作并立即返回。使用的<code>start</code>来启动一个线程具有特定的优先级。优先级参数可以是<code>QThread::Priority</code>枚举除了<code>InheritPriortyd</code>的任何值。枚举量<code>QThread::Priority</code>如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>常量</th>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QThread::IdlePriority</code></td>
<td><code>0</code></td>
<td>没有其它线程运行时才调度</td>
</tr>
<tr>
<td><code>QThread::LowestPriority</code></td>
<td><code>1</code></td>
<td>比<code>LowPriority</code>调度频率低</td>
</tr>
<tr>
<td><code>QThread::LowPriority</code></td>
<td><code>2</code></td>
<td>比<code>NormalPriority</code>调度频率低</td>
</tr>
<tr>
<td><code>QThread::NormalPriority</code></td>
<td><code>3</code></td>
<td>操作系统的默认优先级</td>
</tr>
<tr>
<td><code>QThread::HighPriority</code></td>
<td><code>4</code></td>
<td>比<code>NormalPriority</code>调度频繁</td>
</tr>
<tr>
<td><code>QThread::HighestPriority</code></td>
<td><code>5</code></td>
<td>比<code>HighPriority</code>调度频繁</td>
</tr>
<tr>
<td><code>QThread::TimeCriticalPriority</code></td>
<td><code>6</code></td>
<td>尽可能频繁的调度</td>
</tr>
<tr>
<td><code>QThread::InheritPriority</code></td>
<td><code>7</code></td>
<td>使用和创建线程同样的优先级，这是默认值</td>
</tr>
</tbody>
</table>
</div>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/23/Qt语法详解/Qt之QNetworkInterface/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/23/Qt语法详解/Qt之QNetworkInterface/" itemprop="url">Qt之QNetworkInterface</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-23T16:56:20+08:00">
                2019-01-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h3><p>&emsp;&emsp;<code>QNetworkInterface</code>类负责提供主机的<code>IP</code>地址和网络接口的列表，它表示了当前程序正在运行时与主机绑定的一个网络接口。每个网络接口可能包含<code>0</code>个或多个<code>IP</code>地址，每个<code>IP</code>地址都可选择性地与一个子网掩码<code>和/或</code>一个广播地址相关联。这样的列表可以通过<code>addressEntries</code>方法获得。当子网掩码或者广播地址不必要时，可以使用<code>allAddresses</code>函数来仅仅获得<code>IP</code>地址。<code>QNetworkInterface</code>使用<code>hardwareAddress</code>方法获取接口的硬件地址。</p>
<h3 id="常用接口"><a href="#常用接口" class="headerlink" title="常用接口"></a>常用接口</h3><p>&emsp;&emsp;枚举值为<code>QNetworkInterface::InterfaceFlag</code>，标识为<code>QNetworkInterface::InterfaceFlags</code>。它用于指定网络接口相关的标识，可能的值为：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>常量</th>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QNetworkInterface::IsUp</code></td>
<td><code>0x1</code></td>
<td>网络接口处于活动状态</td>
</tr>
<tr>
<td><code>QNetworkInterface::IsRunning</code></td>
<td><code>0x2</code></td>
<td>网络接口已分配资源</td>
</tr>
<tr>
<td><code>QNetworkInterface::CanBroadcast</code></td>
<td><code>0x4</code></td>
<td>网络接口工作在广播模式</td>
</tr>
<tr>
<td><code>QNetworkInterface::IsLoopBack</code></td>
<td><code>0x8</code></td>
<td>网络接口是环回接口</td>
</tr>
<tr>
<td><code>QNetworkInterface::IsPointToPoint</code></td>
<td><code>0x10</code></td>
<td>网络接口是一个点对点接口</td>
</tr>
<tr>
<td><code>QNetworkInterface::CanMulticast</code></td>
<td><code>0x20</code></td>
<td>网络接口支持多播</td>
</tr>
</tbody>
</table>
</div>
<p>注意，一个网络接口不能既是<code>broadcast-based</code>又是<code>point-to-point</code>。<code>InterfaceFlags</code>类型是一个<code>QFlags</code>类型定义，它存储一个或<code>InterfaceFlag</code>的组合值。</p>
<ul>
<li><code>QList&lt;QHostAddress&gt; allAddresses() [static]</code>: 函数返回主机上面发现的所有<code>IP</code>地址，相当于<code>allInterfaces</code>。返回的所有对象调用<code>addressEntries</code>来获取<code>QHostAddress</code>对象列表，然后对每一个对象调用<code>QHostAddress::ip</code>方法。</li>
<li><code>QList&lt;QNetworkInterface&gt; allInterfaces() [static]</code>: 返回主机上找到的所有的网络接口的列表。在失败情况下，它会返回一个空列表。</li>
<li><code>QList&lt;QNetworkAddressEntry&gt; addressEntries() const</code>: 返回<code>IP</code>地址列表，这个列表具备与其<code>IP</code>地址相关的网络掩码和广播地址。如果不需要子网掩码或广播地址的信息，可以调用<code>allAddresses</code>函数来只获取<code>IP</code>地址。</li>
<li><code>InterfaceFlags flags() const</code>: 返回与此网络接口关联的标志。</li>
<li><code>QString hardwareAddress() const</code>: 返回此接口的底层硬件地址。在以太网接口上，这是表示<code>MAC</code>地址的字符串，用冒号分隔。</li>
<li><code>QString humanReadableName() const</code>: 如果名称可确定，在<code>Windows</code>上返回网络接口的人类可读的名称，例如<code>本地连接</code>；如果不能，这个函数返回值与<code>name</code>相同。用户可以在<code>Windows</code>控制面板中修改人类可读的名称，因此它可以在程序的执行过程中变化。在<code>Unix</code>上，此函数目前返回值总是和<code>name</code>相同，因为<code>Unix</code>系统不存储人类可读的名称的配置。</li>
<li><code>bool isValid() const</code>: 如果此<code>QNetworkInterface</code>对象包含一个的有效的网络接口，则返回<code>true</code>。</li>
<li><code>QString QNetworkInterface::name() const</code>: 返回网络接口的名称。在<code>Unix</code>系统中，这是一个包含接口的类型和任选的序列号的字符串，例如<code>eth0</code>、<code>lo</code>或者<code>pcn0</code>；在<code>Windows</code>中，这是一个内部<code>ID</code>，用户不能更改。</li>
</ul>
<h3 id="获取所有IP地址"><a href="#获取所有IP地址" class="headerlink" title="获取所有IP地址"></a>获取所有IP地址</h3><p>&emsp;&emsp;静态函数<code>allAddresses</code>可以返回一个<code>QHostAddress</code>地址列表(只能获取<code>IP</code>地址，没有子网掩码和广播地址的信息)：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;QHostAddress&gt; <span class="built_in">list</span> = QNetworkInterface::allAddresses();</span><br><span class="line">​</span><br><span class="line">foreach ( QHostAddress address, <span class="built_in">list</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !address.isNull() ) &#123;</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"Address: "</span> &lt;&lt; address.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Address: <span class="string">"fe80::550c:ab19:fb48:1c9%15"</span></span><br><span class="line">Address: <span class="string">"169.254.1.201"</span></span><br><span class="line">Address: <span class="string">"fe80::d086:8566:6065:8954%11"</span></span><br><span class="line">Address: <span class="string">"172.18.4.165"</span></span><br><span class="line">Address: <span class="string">"fe80::f864:a962:7219:f98e%16"</span></span><br><span class="line">Address: <span class="string">"192.168.17.1"</span></span><br><span class="line">Address: <span class="string">"fe80::8169:691f:148e:d3cb%17"</span></span><br><span class="line">Address: <span class="string">"192.168.178.1"</span></span><br><span class="line">Address: <span class="string">"fe80::5996:27a3:83b5:2ae7%18"</span></span><br><span class="line">Address: <span class="string">"192.168.56.1"</span></span><br><span class="line">Address: <span class="string">"::1"</span></span><br><span class="line">Address: <span class="string">"127.0.0.1"</span></span><br></pre></td></tr></table></figure>
<h3 id="获取网络接口列表"><a href="#获取网络接口列表" class="headerlink" title="获取网络接口列表"></a>获取网络接口列表</h3><p>&emsp;&emsp;静态函数<code>allInterfaces</code>可以返回一个<code>QNetworkInterface</code>网络接口列表(通过<code>QNetworkAddressEntry</code>，可以获取<code>IP</code>地址、子网掩码和广播地址等信息)。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;QNetworkInterface&gt; <span class="built_in">list</span> = QNetworkInterface::allInterfaces();</span><br><span class="line">​</span><br><span class="line">foreach ( QNetworkInterface netInterface, <span class="built_in">list</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !netInterface.isValid() ) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    QNetworkInterface::InterfaceFlags flags = netInterface.flags();</span><br><span class="line">​</span><br><span class="line">    <span class="comment">/* 网络接口处于活动状态 */</span></span><br><span class="line">    <span class="keyword">if</span> ( flags.testFlag ( QNetworkInterface::IsRunning ) &amp;&amp; !flags.testFlag ( QNetworkInterface::IsLoopBack ) ) &#123;</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"Device: "</span> &lt;&lt; netInterface.name(); <span class="comment">/* 设备名 */</span></span><br><span class="line">        <span class="comment">/* 硬件地址 */</span></span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"HardwareAddress: "</span> &lt;&lt; netInterface.hardwareAddress();</span><br><span class="line">        <span class="comment">/* 人类可读的名字 */</span></span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"Human Readable Name: "</span> &lt;&lt; netInterface.humanReadableName();</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> 0</span></span><br><span class="line">    QList&lt;QNetworkAddressEntry&gt; entryList = netInterface.addressEntries();</span><br><span class="line">​</span><br><span class="line">    foreach ( QNetworkAddressEntry entry, entryList ) &#123; <span class="comment">/* 遍历每一个IP地址 */</span></span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"IP Address: "</span> &lt;&lt; entry.ip().toString(); <span class="comment">/* IP地址 */</span></span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"Netmask: "</span> &lt;&lt; entry.netmask().toString(); <span class="comment">/* 子网掩码 */</span></span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"Broadcast: "</span> &lt;&lt; entry.broadcast().toString(); <span class="comment">/* 广播地址 */</span></span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Device: <span class="string">"&#123;BE9972CD-860E-4E15-8CE2-3F25EF0A7A24&#125;"</span></span><br><span class="line">HardwareAddress: <span class="string">"94:DE:80:21:92:17"</span></span><br><span class="line">Human Readable Name: <span class="string">"本地连接"</span></span><br><span class="line"></span><br><span class="line">Device: <span class="string">"&#123;29F85058-E757-4F60-BF7B-47F6227C8CBC&#125;"</span></span><br><span class="line">HardwareAddress: <span class="string">"00:50:56:C0:00:01"</span></span><br><span class="line">Human Readable Name: <span class="string">"VMware Network Adapter VMnet1"</span></span><br><span class="line">​</span><br><span class="line">Device: <span class="string">"&#123;A297491C-D43C-4F85-A674-88368F8D4FC1&#125;"</span></span><br><span class="line">HardwareAddress: <span class="string">"00:50:56:C0:00:08"</span></span><br><span class="line">Human Readable Name: <span class="string">"VMware Network Adapter VMnet8"</span></span><br><span class="line">​</span><br><span class="line">Device: <span class="string">"&#123;1AE5F6FC-478A-4EAB-B4D2-86201A6B2090&#125;"</span></span><br><span class="line">HardwareAddress: <span class="string">"0A:00:27:00:00:12"</span></span><br><span class="line">Human Readable Name: <span class="string">"VirtualBox Host-Only Network"</span></span><br></pre></td></tr></table></figure>
<p>通过<code>flags</code>函数，可以获取到当前网络接口的标识；利用<code>testFlag</code>进行过滤，就可以获取我们想要的内容(设备名、硬件地址、名字)。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/23/Qt语法详解/Qt之QUrlInfo/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/23/Qt语法详解/Qt之QUrlInfo/" itemprop="url">Qt之QUrlInfo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-23T13:52:53+08:00">
                2019-01-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;The <code>QUrlInfo</code> class stores information about <code>URLs</code>. The header file is <code>QUrlInfo</code>.</p>
<h3 id="Public-Functions"><a href="#Public-Functions" class="headerlink" title="Public Functions"></a>Public Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><code>QUrlInfo()</code></td>
</tr>
<tr>
<td></td>
<td><code>QUrlInfo(const QUrlInfo &amp; ui)</code></td>
</tr>
<tr>
<td></td>
<td><code>QUrlInfo(const QString &amp; name, int permissions, const QString &amp; owner, const QString &amp; group, qint64 size, const QDateTime &amp; lastModified, const QDateTime &amp; lastRead, bool isDir, bool isFile, bool isSymLink, bool isWritable, bool isReadable, bool isExecutable)</code></td>
</tr>
<tr>
<td></td>
<td><code>QUrlInfo(const QUrl &amp; url, int permissions, const QString &amp; owner, const QString &amp; group, qint64 size, const QDateTime &amp; lastModified, const QDateTime &amp; lastRead, bool isDir, bool isFile, bool isSymLink, bool isWritable, bool isReadable, bool isExecutable)</code></td>
</tr>
<tr>
<td><code>virtual</code></td>
<td><code>~QUrlInfo()</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>group() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isDir() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isExecutable() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isFile() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isReadable() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isSymLink() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isValid() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isWritable() const</code></td>
</tr>
<tr>
<td><code>QDateTime</code></td>
<td><code>lastModified() const</code></td>
</tr>
<tr>
<td><code>QDateTime</code></td>
<td><code>lastRead() const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>name() const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>owner() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>permissions() const</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setDir(bool b)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setFile(bool b)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setGroup(const QString &amp; s)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setLastModified(const QDateTime &amp; dt)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setLastRead(const QDateTime &amp; dt)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setName(const QString &amp; name)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setOwner(const QString &amp; s)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setPermissions(int p)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setReadable(bool b)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setSize(qint64 size)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setSymLink(bool b)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setWritable(bool b)</code></td>
</tr>
<tr>
<td><code>qint64</code></td>
<td><code>size() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator!=(const QUrlInfo &amp; other) const</code></td>
</tr>
<tr>
<td><code>QUrlInfo &amp;</code></td>
<td><code>operator=(const QUrlInfo &amp; ui)</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator==(const QUrlInfo &amp; other) const</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Static-Public-Members"><a href="#Static-Public-Members" class="headerlink" title="Static Public Members"></a>Static Public Members</h3><ul>
<li><code>bool equal(const QUrlInfo &amp; i1, const QUrlInfo &amp; i2, int sortBy)</code></li>
<li><code>bool greaterThan(const QUrlInfo &amp; i1, const QUrlInfo &amp; i2, int sortBy)</code></li>
<li><code>bool lessThan(const QUrlInfo &amp; i1, const QUrlInfo &amp; i2, int sortBy)</code></li>
</ul>
<h3 id="Detailed-Description"><a href="#Detailed-Description" class="headerlink" title="Detailed Description"></a>Detailed Description</h3><p>&emsp;&emsp;The <code>QUrlInfo</code> class stores information about <code>URLs</code>.<br>&emsp;&emsp;The information about a URL that can be retrieved includes <code>name()</code>, <code>permissions()</code>, <code>owner()</code>, <code>group()</code>, <code>size()</code>, <code>lastModified()</code>, <code>lastRead()</code>, <code>isDir()</code>, <code>isFile()</code>, <code>isSymLink()</code>, <code>isWritable()</code>, <code>isReadable()</code> and <code>isExecutable()</code>.<br>&emsp;&emsp;You can create your own <code>QUrlInfo</code> objects passing in all the relevant information in the constructor, and you can modify a <code>QUrlInfo</code>; for each getter mentioned above there is an equivalent setter. Note that setting values does not affect the underlying resource that the <code>QUrlInfo</code> provides information about; for example if you call <code>setWritable(true)</code> on a <code>read-only</code> resource the only thing changed is the <code>QUrlInfo</code> object, not the resource.</p>
<h3 id="Member-Type-Documentation"><a href="#Member-Type-Documentation" class="headerlink" title="Member Type Documentation"></a>Member Type Documentation</h3><ul>
<li>enum <code>QUrlInfo::PermissionSpec</code>: This enum is used by the <code>permissions()</code> function to report the permissions of a file.</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>Constant</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QUrlInfo::ReadOwner</code></td>
<td><code>00400</code></td>
<td>The file is readable by the owner of the file.</td>
</tr>
<tr>
<td><code>QUrlInfo::WriteOwner</code></td>
<td><code>00200</code></td>
<td>The file is writable by the owner of the file.</td>
</tr>
<tr>
<td><code>QUrlInfo::ExeOwner</code></td>
<td><code>00100</code></td>
<td>The file is executable by the owner of the file.</td>
</tr>
<tr>
<td><code>QUrlInfo::ReadGroup</code></td>
<td><code>00040</code></td>
<td>The file is readable by the group.</td>
</tr>
<tr>
<td><code>QUrlInfo::WriteGroup</code></td>
<td><code>00020</code></td>
<td>The file is writable by the group.</td>
</tr>
<tr>
<td><code>QUrlInfo::ExeGroup</code></td>
<td><code>00010</code></td>
<td>The file is executable by the group.</td>
</tr>
<tr>
<td><code>QUrlInfo::ReadOther</code></td>
<td><code>00004</code></td>
<td>The file is readable by anyone.</td>
</tr>
<tr>
<td><code>QUrlInfo::WriteOther</code></td>
<td><code>00002</code></td>
<td>The file is writable by anyone.</td>
</tr>
<tr>
<td><code>QUrlInfo::ExeOther</code></td>
<td><code>00001</code></td>
<td>The file is executable by anyone.</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Member-Function-Documentation"><a href="#Member-Function-Documentation" class="headerlink" title="Member Function Documentation"></a>Member Function Documentation</h3><ul>
<li><code>QUrlInfo::QUrlInfo()</code>: Constructs an invalid <code>QUrlInfo</code> object with default values.</li>
<li><code>QUrlInfo::QUrlInfo(const QUrlInfo &amp; ui)</code>: Copy constructor, copies ui to this <code>URL</code> info object.</li>
<li><code>QUrlInfo::QUrlInfo(const QString &amp; name, int permissions, const QString &amp; owner, const QString &amp; group, qint64 size, const QDateTime &amp; lastModified, const QDateTime &amp; lastRead, bool isDir, bool isFile, bool isSymLink, bool isWritable, bool isReadable, bool isExecutable)</code>: Constructs a <code>QUrlInfo</code> object by specifying all the <code>URL&#39;s</code> information. The information that is passed is the name, file permissions, owner and group and the file’s size. Also passed is the <code>lastModified date/time</code> and the <code>lastRead date/time</code>. Flags are also passed, specifically, <code>isDir</code>, <code>isFile</code>, <code>isSymLink</code>, <code>isWritable</code>, <code>isReadable</code> and <code>isExecutable</code>.</li>
<li><code>QUrlInfo::QUrlInfo(const QUrl &amp; url, int permissions, const QString &amp; owner, const QString &amp; group, qint64 size, const QDateTime &amp; lastModified, const QDateTime &amp; lastRead, bool isDir, bool isFile, bool isSymLink, bool isWritable, bool isReadable, bool isExecutable)</code>: Constructs a <code>QUrlInfo</code> object by specifying all the <code>URL&#39;s</code> information. The information that is passed is the url, file permissions, owner and group and the file’s size. Also passed is the <code>lastModified date/time</code> and the <code>lastRead date/time</code>. Flags are also passed, specifically, <code>isDir</code>, <code>isFile</code>, <code>isSymLink</code>, <code>isWritable</code>, <code>isReadable</code> and <code>isExecutable</code>.</li>
<li><code>QUrlInfo::~QUrlInfo() [virtual]</code>: Destroys the <code>URL</code> info object.</li>
<li><code>bool QUrlInfo::equal(const QUrlInfo &amp; i1, const QUrlInfo &amp; i2, int sortBy) [static]</code>: Returns <code>true</code> if <code>i1</code> equals to <code>i2</code>; otherwise returns <code>false</code>. The objects are compared by the value, which is specified by <code>sortBy</code>. This must be one of <code>QDir::Name</code>, <code>QDir::Time</code> or <code>QDir::Size</code>.</li>
<li><code>bool QUrlInfo::greaterThan(const QUrlInfo &amp; i1, const QUrlInfo &amp; i2, int sortBy) [static]</code>: Returns <code>true</code> if <code>i1</code> is greater than <code>i2</code>; otherwise returns <code>false</code>. The objects are compared by the value, which is specified by <code>sortBy</code>. This must be one of <code>QDir::Name</code>, <code>QDir::Time</code> or <code>QDir::Size</code>.</li>
<li><code>QString QUrlInfo::group() const</code>: Returns the group of the <code>URL</code>.</li>
<li><code>bool QUrlInfo::isDir() const</code>: Returns <code>true</code> if the <code>URL</code> is a directory; otherwise returns <code>false</code>.</li>
<li><code>bool QUrlInfo::isExecutable() const</code>: Returns <code>true</code> if the <code>URL</code> is executable; otherwise returns false.</li>
<li><code>bool QUrlInfo::isFile() const</code>: Returns <code>true</code> if the <code>URL</code> is a file; otherwise returns <code>false</code>.</li>
<li><code>bool QUrlInfo::isReadable() const</code>: Returns <code>true</code> if the <code>URL</code> is readable; otherwise returns <code>false</code>.</li>
<li><code>bool QUrlInfo::isSymLink() const</code>: Returns <code>true</code> if the <code>URL</code> is a symbolic link; otherwise returns <code>false</code>.</li>
<li><code>bool QUrlInfo::isValid() const</code>: Returns <code>true</code> if the <code>URL</code> info is valid; otherwise returns <code>false</code>. Valid means that the <code>QUrlInfo</code> contains real information. You should always check if the <code>URL</code> info is valid before relying on the values.</li>
<li><code>bool QUrlInfo::isWritable() const</code>: Returns <code>true</code> if the <code>URL</code> is writable; otherwise returns <code>false</code>.</li>
<li><code>QDateTime QUrlInfo::lastModified() const</code>: Returns the last modification date of the <code>URL</code>.</li>
<li><code>QDateTime QUrlInfo::lastRead() const</code>: Returns the date when the URL was last read.</li>
<li><code>bool QUrlInfo::lessThan(const QUrlInfo &amp; i1, const QUrlInfo &amp; i2, int sortBy) [static]</code>: Returns <code>true</code> if <code>i1</code> is less than <code>i2</code>; otherwise returns <code>false</code>. The objects are compared by the value, which is specified by <code>sortBy</code>. This must be one of <code>QDir::Name</code>, <code>QDir::Time</code> or <code>QDir::Size</code>.</li>
<li><code>QString QUrlInfo::name() const</code>: Returns the file name of the <code>URL</code>.</li>
<li><code>QString QUrlInfo::owner() const</code>: Returns the owner of the <code>URL</code>.</li>
<li><code>int QUrlInfo::permissions() const</code>: Returns the permissions of the <code>URL</code>. You can use the <code>PermissionSpec</code> flags to test for certain permissions.</li>
<li><code>void QUrlInfo::setDir(bool b) [virtual]</code>: If <code>b</code> is <code>true</code> then the <code>URL</code> is set to be a directory; if <code>b</code> is <code>false</code> then the <code>URL</code> is set not to be a directory (which normally means it is a file). (Note that a <code>URL</code> can refer to both a file and a directory even though most file systems do not support this.) If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>void QUrlInfo::setFile(bool b) [virtual]</code>: If <code>b</code> is <code>true</code> then the <code>URL</code> is set to be a file; if is false then the <code>URL</code> is set not to be a file (which normally means it is a directory). (Note that a <code>URL</code> can refer to both a file and a directory even though most file systems do not support this.) If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>void QUrlInfo::setGroup(const QString &amp; s) [virtual]</code>: Specifies that the owning group of the <code>URL</code> is called <code>s</code>. If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>void QUrlInfo::setLastModified(const QDateTime &amp; dt) [virtual]</code>: Specifies that the object the <code>URL</code> refers to was last modified at <code>dt</code>. If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>void QUrlInfo::setLastRead(const QDateTime &amp; dt)</code>: Specifies that the object the <code>URL</code> refers to was last read at <code>dt</code>. If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>void QUrlInfo::setName(const QString &amp; name) [virtual]</code>: Sets the name of the <code>URL</code> to name. The name is the full text, for example, <code>http://qt.nokia.com/doc/qurlinfo.html</code>. If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>void QUrlInfo::setOwner(const QString &amp; s) [virtual]</code>: Specifies that the owner of the <code>URL</code> is called <code>s</code>. If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>void QUrlInfo::setPermissions(int p) [virtual]</code>: Specifies that the <code>URL</code> has access permissions <code>p</code>. If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>void QUrlInfo::setReadable(bool b) [virtual]</code>: Specifies that the <code>URL</code> is readable if <code>b</code> is <code>true</code> and not readable if <code>b</code> is <code>false</code>. If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>void QUrlInfo::setSize(qint64 size) [virtual]</code>: Specifies the <code>size</code> of the <code>URL</code>. If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>void QUrlInfo::setSymLink(bool b) [virtual]</code>: Specifies that the <code>URL</code> refers to a symbolic link if <code>b</code> is <code>true</code> and that it does not if <code>b</code> is <code>false</code>. If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>void QUrlInfo::setWritable(bool b) [virtual]</code>: Specifies that the <code>URL</code> is writable if <code>b</code> is <code>true</code> and not writable if <code>b</code> is <code>false</code>. If you call this function for an invalid <code>URL</code> info, this function turns it into a valid one.</li>
<li><code>qint64 QUrlInfo::size() const</code>: Returns the <code>size</code> of the <code>URL</code>.</li>
<li><code>bool QUrlInfo::operator!=(const QUrlInfo &amp; other) const</code>: Returns <code>true</code> if this <code>QUrlInfo</code> is not equal to other; otherwise returns <code>false</code>.</li>
<li><code>QUrlInfo &amp; QUrlInfo::operator=(const QUrlInfo &amp; ui)</code>: Assigns the values of <code>ui</code> to this <code>QUrlInfo</code> object.</li>
<li><code>bool QUrlInfo::operator==(const QUrlInfo &amp; other) const</code>: Returns <code>true</code> if this <code>QUrlInfo</code> is equal to other; otherwise returns <code>false</code>.</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/49/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/49/">49</a><span class="page-number current">50</span><a class="page-number" href="/page/51/">51</a><span class="space">&hellip;</span><a class="page-number" href="/page/96/">96</a><a class="extend next" rel="next" href="/page/51/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">付康为</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">955</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">付康为</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
