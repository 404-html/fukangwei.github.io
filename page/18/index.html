<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="泥腿子出身">
<meta property="og:url" content="http://fukangwei.gitee.io/page/18/index.html">
<meta property="og:site_name" content="泥腿子出身">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="泥腿子出身">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '561O3H1PZB',
      apiKey: '7631d3cf19ac49bd39ada7163ec937a7',
      indexName: 'fuxinzi',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="http://fukangwei.gitee.io/page/18/">





  <title>泥腿子出身</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">泥腿子出身</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/Qt应用示例/Qt之FTP客户端_QFtp/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/Qt应用示例/Qt之FTP客户端_QFtp/" itemprop="url">Qt之FTP客户端_QFtp</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T15:50:52+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt应用示例/" itemprop="url" rel="index">
                    <span itemprop="name">Qt应用示例</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Ftp文件阅读器-匿名登录"><a href="#Ftp文件阅读器-匿名登录" class="headerlink" title="Ftp文件阅读器(匿名登录)"></a>Ftp文件阅读器(匿名登录)</h3><p>&emsp;&emsp;<code>mainwindow.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MAINWINDOW_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAINWINDOW_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMainWindow&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QFtp</span>;</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span> :</span> <span class="keyword">public</span> QMainWindow &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MainWindow</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~MainWindow();</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::MainWindow *ui;</span><br><span class="line">    QFtp *ftp;</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ftpCommandStarted</span> <span class="params">( <span class="keyword">int</span> )</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ftpCommandFinished</span> <span class="params">( <span class="keyword">int</span>, <span class="keyword">bool</span> )</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MAINWINDOW_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mainwindow.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mainwindow.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_mainwindow.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFtp&gt;</span></span></span><br><span class="line">​</span><br><span class="line">MainWindow::MainWindow ( QWidget *parent ) : QMainWindow ( parent ), ui ( <span class="keyword">new</span> Ui::MainWindow ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">    ftp = <span class="keyword">new</span> QFtp ( <span class="keyword">this</span> );</span><br><span class="line">    ftp-&gt;connectToHost ( <span class="string">"ftp.qt.nokia.com"</span> );</span><br><span class="line">    ftp-&gt;login();</span><br><span class="line">    ftp-&gt;cd ( <span class="string">"qt"</span> );</span><br><span class="line">    ftp-&gt;get ( <span class="string">"INSTALL"</span> );</span><br><span class="line">    ftp-&gt;close();</span><br><span class="line">    connect ( ftp, SIGNAL ( commandStarted ( <span class="keyword">int</span> ) ), <span class="keyword">this</span>, SLOT ( ftpCommandStarted ( <span class="keyword">int</span> ) ) );</span><br><span class="line">    connect ( ftp, SIGNAL ( commandFinished ( <span class="keyword">int</span>, <span class="keyword">bool</span> ) ), <span class="keyword">this</span>, SLOT ( ftpCommandFinished ( <span class="keyword">int</span>, <span class="keyword">bool</span> ) ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">MainWindow::~MainWindow() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::ftpCommandStarted ( <span class="keyword">int</span> ) &#123;</span><br><span class="line">    <span class="keyword">int</span> id = ftp-&gt;currentCommand();</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">switch</span> ( id ) &#123;</span><br><span class="line">        <span class="keyword">case</span> QFtp::ConnectToHost :</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"正在连接到服务器…"</span> ) );</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">case</span> QFtp::Login :</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"正在登录…"</span> ) );</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">case</span> QFtp::Get :</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"正在下载…"</span> ) );</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">case</span> QFtp::Close :</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"正在关闭连接…"</span> ) );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::ftpCommandFinished ( <span class="keyword">int</span>, <span class="keyword">bool</span> error ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ftp-&gt;currentCommand() == QFtp::ConnectToHost ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( error ) &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"连接服务器出现错误：%1"</span> ).arg ( ftp-&gt;errorString() ) );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"连接到服务器成功"</span> ) );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( ftp-&gt;currentCommand() == QFtp::Login ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( error ) &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"登录出现错误：%1"</span> ).arg ( ftp-&gt;errorString() ) );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"登录成功"</span> ) );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( ftp-&gt;currentCommand() == QFtp::Get ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( error ) &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"下载出现错误：%1"</span> ).arg ( ftp-&gt;errorString() ) );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"已经完成下载"</span> ) );</span><br><span class="line">            ui-&gt;textBrowser-&gt;setText ( ftp-&gt;readAll() );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( ftp-&gt;currentCommand() == QFtp::Close ) &#123;</span><br><span class="line">        ui-&gt;label-&gt;setText ( tr ( <span class="string">"已经关闭连接"</span> ) );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt应用示例/Qt之FTP客户端_QFtp/1.png" height="252" width="312"></p>
<hr>
<h3 id="ftp文件下载器-密码登录"><a href="#ftp文件下载器-密码登录" class="headerlink" title="ftp文件下载器(密码登录)"></a>ftp文件下载器(密码登录)</h3><p>&emsp;&emsp;<code>mainwindow.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MAINWINDOW_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAINWINDOW_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMainWindow&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QFtp</span>;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QHash&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QFile</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QUrlInfo</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QTreeWidgetItem</span>;</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span> :</span> <span class="keyword">public</span> QMainWindow &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MainWindow</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~MainWindow();</span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    Ui::MainWindow *ui;</span><br><span class="line">    QFtp *ftp;</span><br><span class="line">    QHash&lt;QString, <span class="keyword">bool</span>&gt; isDirectory; <span class="comment">/* 用来存储一个路径是否为目录的信息 */</span></span><br><span class="line">    QString currentPath; <span class="comment">/* 用来存储现在的路径 */</span></span><br><span class="line">    QFile *file; <span class="comment">/* 用来表示下载的文件 */</span></span><br><span class="line">  <span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ftpCommandStarted</span> <span class="params">( <span class="keyword">int</span> )</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ftpCommandFinished</span> <span class="params">( <span class="keyword">int</span>, <span class="keyword">bool</span> )</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updateDataTransferProgress</span> <span class="params">( qint64, qint64 )</span></span>; <span class="comment">/* 更新进度条 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addToList</span> <span class="params">( <span class="keyword">const</span> QUrlInfo &amp;urlInfo )</span></span>; <span class="comment">/* 将服务器上的文件添加到“Tree Widget”部件中 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">processItem</span> <span class="params">( QTreeWidgetItem *, <span class="keyword">int</span> )</span></span>; <span class="comment">/* 双击一个目录时显示其内容 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_connectButton_clicked</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_cdToParentButton_clicked</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_downloadButton_clicked</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MAINWINDOW_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mainwindow.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mainwindow.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_mainwindow.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFtp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QTreeWidgetItem&gt;</span></span></span><br><span class="line">​</span><br><span class="line">MainWindow::MainWindow ( QWidget *parent ) : QMainWindow ( parent ), ui ( <span class="keyword">new</span> Ui::MainWindow ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">    ui-&gt;progressBar-&gt;setValue ( <span class="number">0</span> );</span><br><span class="line">    connect ( ui-&gt;fileList, SIGNAL ( itemActivated ( QTreeWidgetItem *, <span class="keyword">int</span> ) ), \</span><br><span class="line">              <span class="keyword">this</span>, SLOT ( processItem ( QTreeWidgetItem *, <span class="keyword">int</span> ) ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">MainWindow::~MainWindow() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::ftpCommandStarted ( <span class="keyword">int</span> ) &#123;</span><br><span class="line">    <span class="keyword">int</span> id = ftp-&gt;currentCommand();</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">switch</span> ( id ) &#123;</span><br><span class="line">        <span class="keyword">case</span> QFtp::ConnectToHost :</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"正在连接到服务器…"</span> ) );</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">case</span> QFtp::Login :</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"正在登录…"</span> ) );</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">case</span> QFtp::Get :</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"正在下载…"</span> ) );</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">case</span> QFtp::Close :</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"正在关闭连接…"</span> ) );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::ftpCommandFinished ( <span class="keyword">int</span>, <span class="keyword">bool</span> error ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( ftp-&gt;currentCommand() == QFtp::ConnectToHost ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( error ) &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"连接服务器出现错误：%1"</span> ).arg ( ftp-&gt;errorString() ) );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"连接到服务器成功"</span> ) );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( ftp-&gt;currentCommand() == QFtp::Login ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( error ) &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"登录出现错误：%1"</span> ).arg ( ftp-&gt;errorString() ) );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"登录成功"</span> ) );</span><br><span class="line">            ftp-&gt;<span class="built_in">list</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( ftp-&gt;currentCommand() == QFtp::Get ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( error ) &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"下载出现错误：%1"</span> ).arg ( ftp-&gt;errorString() ) );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"已经完成下载"</span> ) );</span><br><span class="line">            file-&gt;close();</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        ui-&gt;downloadButton-&gt;setEnabled ( <span class="literal">true</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( ftp-&gt;currentCommand() == QFtp::List ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( isDirectory.isEmpty() ) &#123;</span><br><span class="line">            ui-&gt;fileList-&gt;addTopLevelItem ( <span class="keyword">new</span> QTreeWidgetItem ( QStringList() &lt;&lt; tr ( <span class="string">"&lt;empty&gt;"</span> ) ) );</span><br><span class="line">            ui-&gt;fileList-&gt;setEnabled ( <span class="literal">false</span> );</span><br><span class="line">            ui-&gt;label-&gt;setText ( tr ( <span class="string">"该目录为空"</span> ) );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( ftp-&gt;currentCommand() == QFtp::Close ) &#123;</span><br><span class="line">        ui-&gt;label-&gt;setText ( tr ( <span class="string">"已经关闭连接"</span> ) );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::on_connectButton_clicked() &#123; <span class="comment">/* 连接按钮 */</span></span><br><span class="line">    ui-&gt;fileList-&gt;clear();</span><br><span class="line">    currentPath.clear();</span><br><span class="line">    isDirectory.clear();</span><br><span class="line">    ftp = <span class="keyword">new</span> QFtp ( <span class="keyword">this</span> );</span><br><span class="line">    connect ( ftp, SIGNAL ( commandStarted ( <span class="keyword">int</span> ) ), <span class="keyword">this</span>, SLOT ( ftpCommandStarted ( <span class="keyword">int</span> ) ) );</span><br><span class="line">    connect ( ftp, SIGNAL ( commandFinished ( <span class="keyword">int</span>, <span class="keyword">bool</span> ) ), <span class="keyword">this</span>, SLOT ( ftpCommandFinished ( <span class="keyword">int</span>, <span class="keyword">bool</span> ) ) );</span><br><span class="line">    connect ( ftp, SIGNAL ( listInfo ( QUrlInfo ) ), <span class="keyword">this</span>, SLOT ( addToList ( QUrlInfo ) ) );</span><br><span class="line">    connect ( ftp, SIGNAL ( dataTransferProgress ( qint64, qint64 ) ), \</span><br><span class="line">              <span class="keyword">this</span>, SLOT ( updateDataTransferProgress ( qint64, qint64 ) ) );</span><br><span class="line">    QString ftpServer = ui-&gt;ftpServerLineEdit-&gt;text();</span><br><span class="line">    QString userName = ui-&gt;userNameLineEdit-&gt;text();</span><br><span class="line">    QString passWord = ui-&gt;passWordLineEdit-&gt;text();</span><br><span class="line">    ftp-&gt;connectToHost ( ftpServer, <span class="number">21</span> );</span><br><span class="line">    ftp-&gt;login ( userName, passWord );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::addToList ( <span class="keyword">const</span> QUrlInfo &amp;urlInfo ) &#123;</span><br><span class="line">    QTreeWidgetItem *item = <span class="keyword">new</span> QTreeWidgetItem;</span><br><span class="line">    item-&gt;setText ( <span class="number">0</span>, urlInfo.name() );</span><br><span class="line">    item-&gt;setText ( <span class="number">1</span>, QString::number ( urlInfo.size() ) );</span><br><span class="line">    item-&gt;setText ( <span class="number">2</span>, urlInfo.owner() );</span><br><span class="line">    item-&gt;setText ( <span class="number">3</span>, urlInfo.group() );</span><br><span class="line">    item-&gt;setText ( <span class="number">4</span>, urlInfo.lastModified().toString ( <span class="string">"MMM dd yyyy"</span> ) );</span><br><span class="line">    <span class="function">QPixmap <span class="title">pixmap</span> <span class="params">( urlInfo.isDir() ? <span class="string">"../myFTP/dir.png"</span> : <span class="string">"../myFTP/file.png"</span> )</span></span>;</span><br><span class="line">    item-&gt;setIcon ( <span class="number">0</span>, pixmap );</span><br><span class="line">    isDirectory[urlInfo.name()] = urlInfo.isDir();</span><br><span class="line">    ui-&gt;fileList-&gt;addTopLevelItem ( item );</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( !ui-&gt;fileList-&gt;currentItem() ) &#123;</span><br><span class="line">        ui-&gt;fileList-&gt;setCurrentItem ( ui-&gt;fileList-&gt;topLevelItem ( <span class="number">0</span> ) );</span><br><span class="line">        ui-&gt;fileList-&gt;setEnabled ( <span class="literal">true</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::processItem ( QTreeWidgetItem *item, <span class="keyword">int</span> ) &#123;</span><br><span class="line">    QString name = item-&gt;text ( <span class="number">0</span> );</span><br><span class="line">​</span><br><span class="line">    <span class="comment">/* 如果这个文件是个目录，则打开 */</span></span><br><span class="line">    <span class="keyword">if</span> ( isDirectory.value ( name ) ) &#123;</span><br><span class="line">        ui-&gt;fileList-&gt;clear();</span><br><span class="line">        isDirectory.clear();</span><br><span class="line">        currentPath += <span class="string">"/"</span>;</span><br><span class="line">        currentPath += name;</span><br><span class="line">        ftp-&gt;cd ( name );</span><br><span class="line">        ftp-&gt;<span class="built_in">list</span>();</span><br><span class="line">        ui-&gt;cdToParentButton-&gt;setEnabled ( <span class="literal">true</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::on_cdToParentButton_clicked() &#123; <span class="comment">/* 返回上级目录按钮 */</span></span><br><span class="line">    ui-&gt;fileList-&gt;clear();</span><br><span class="line">    isDirectory.clear();</span><br><span class="line">    currentPath = currentPath.left ( currentPath.lastIndexOf ( <span class="string">'/'</span> ) );</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( currentPath.isEmpty() ) &#123;</span><br><span class="line">        ui-&gt;cdToParentButton-&gt;setEnabled ( <span class="literal">false</span> );</span><br><span class="line">        ftp-&gt;cd ( <span class="string">"/"</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        ftp-&gt;cd ( currentPath );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    ftp-&gt;<span class="built_in">list</span>();</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::on_downloadButton_clicked() &#123; <span class="comment">/* 下载按钮 */</span></span><br><span class="line">    QString fileName = ui-&gt;fileList-&gt;currentItem()-&gt;text ( <span class="number">0</span> );</span><br><span class="line">    file = <span class="keyword">new</span> QFile ( fileName );</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( !file-&gt;open ( QIODevice::WriteOnly ) ) &#123;</span><br><span class="line">        <span class="keyword">delete</span> file;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    ui-&gt;downloadButton-&gt;setEnabled ( <span class="literal">false</span> );</span><br><span class="line">    ftp-&gt;get ( ui-&gt;fileList-&gt;currentItem()-&gt;text ( <span class="number">0</span> ), file );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::updateDataTransferProgress ( qint64 readBytes, qint64 totalBytes ) &#123;</span><br><span class="line">    ui-&gt;progressBar-&gt;setMaximum ( totalBytes );</span><br><span class="line">    ui-&gt;progressBar-&gt;setValue ( readBytes );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt应用示例/Qt之FTP客户端_QFtp/2.png" height="265" width="356"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/Qt应用示例/Qt之应用程序主窗口/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/Qt应用示例/Qt之应用程序主窗口/" itemprop="url">Qt之应用程序主窗口</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T15:28:43+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt应用示例/" itemprop="url" rel="index">
                    <span itemprop="name">Qt应用示例</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>mainwindow.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MAINWINDOW_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAINWINDOW_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMainWindow&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span> :</span> <span class="keyword">public</span> QMainWindow &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MainWindow</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~MainWindow();</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_action_New_triggered</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_action_Dock_triggered</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::MainWindow *ui;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MAINWINDOW_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mainwindow.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mainwindow.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_mainwindow.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QToolButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QSpinBox&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QTextEdit&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMdiSubWindow&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QLabel&gt;</span></span></span><br><span class="line">​</span><br><span class="line">MainWindow::MainWindow ( QWidget *parent ) : QMainWindow ( parent ), ui ( <span class="keyword">new</span> Ui::MainWindow ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">    QMenu *editMenu = ui-&gt;menuBar-&gt;addMenu ( tr ( <span class="string">"编辑(&amp;E)"</span> ) ); <span class="comment">/* 添加编辑菜单 */</span></span><br><span class="line">    <span class="comment">/* 添加打开菜单(图片位于images目录下) */</span></span><br><span class="line">    QAction *action_Open = editMenu-&gt;addAction ( QIcon ( <span class="string">":/myImage/images/open.png"</span> ), tr ( <span class="string">"打开文件(&amp;O)"</span> ) );</span><br><span class="line">    action_Open-&gt;setShortcut ( QKeySequence ( <span class="string">"Ctrl+O"</span> ) ); <span class="comment">/* 设置快捷键 */</span></span><br><span class="line">    ui-&gt;mainToolBar-&gt;addAction ( action_Open ); <span class="comment">/* 在工具栏中添加动作 */</span></span><br><span class="line">    QActionGroup *group = <span class="keyword">new</span> QActionGroup ( <span class="keyword">this</span> ); <span class="comment">/* 建立动作组 */</span></span><br><span class="line">    <span class="comment">/* 向动作组中添加动作，设置动作checkable属性为true，最后指定action_L为选中状态 */</span></span><br><span class="line">    QAction *action_L = group-&gt;addAction ( tr ( <span class="string">"左对齐(&amp;L)"</span> ) );</span><br><span class="line">    action_L-&gt;setCheckable ( <span class="literal">true</span> );</span><br><span class="line">    QAction *action_R = group-&gt;addAction ( tr ( <span class="string">"右对齐(&amp;R)"</span> ) );</span><br><span class="line">    action_R-&gt;setCheckable ( <span class="literal">true</span> );</span><br><span class="line">    QAction *action_C = group-&gt;addAction ( tr ( <span class="string">"居中(&amp;C)"</span> ) );</span><br><span class="line">    action_C-&gt;setCheckable ( <span class="literal">true</span> );</span><br><span class="line">    action_L-&gt;setChecked ( <span class="literal">true</span> );</span><br><span class="line">    editMenu-&gt;addSeparator(); <span class="comment">/* 向菜单中添加间隔器 */</span></span><br><span class="line">    <span class="comment">/* 向菜单中添加动作 */</span></span><br><span class="line">    editMenu-&gt;addAction ( action_L );</span><br><span class="line">    editMenu-&gt;addAction ( action_R );</span><br><span class="line">    editMenu-&gt;addAction ( action_C );</span><br><span class="line">    <span class="comment">/* 创建QToolButton */</span></span><br><span class="line">    QToolButton *toolBtn = <span class="keyword">new</span> QToolButton ( <span class="keyword">this</span> );</span><br><span class="line">    toolBtn-&gt;setText ( tr ( <span class="string">"颜色"</span> ) );</span><br><span class="line">    <span class="comment">/* 创建一个菜单 */</span></span><br><span class="line">    QMenu *colorMenu = <span class="keyword">new</span> QMenu ( <span class="keyword">this</span> );</span><br><span class="line">    colorMenu-&gt;addAction ( tr ( <span class="string">"红色"</span> ) );</span><br><span class="line">    colorMenu-&gt;addAction ( tr ( <span class="string">"绿色"</span> ) );</span><br><span class="line">    toolBtn-&gt;setMenu ( colorMenu ); <span class="comment">/* 添加菜单 */</span></span><br><span class="line">    toolBtn-&gt;setPopupMode ( QToolButton::MenuButtonPopup ); <span class="comment">/* 设置弹出模式 */</span></span><br><span class="line">    ui-&gt;mainToolBar-&gt;addWidget ( toolBtn ); <span class="comment">/* 向工具栏添加QToolButton按钮 */</span></span><br><span class="line">    QSpinBox *spinBox = <span class="keyword">new</span> QSpinBox ( <span class="keyword">this</span> ); <span class="comment">/* 创建QSpinBox */</span></span><br><span class="line">    ui-&gt;mainToolBar-&gt;addWidget ( spinBox ); <span class="comment">/* 向工具栏添加QSpinBox部件 */</span></span><br><span class="line">    <span class="comment">/* 显示临时消息，显示2000毫秒即2秒钟 */</span></span><br><span class="line">    ui-&gt;statusBar-&gt;showMessage ( tr ( <span class="string">"欢迎使用多文档编辑器"</span> ), <span class="number">2000</span> );</span><br><span class="line">    QLabel *permanent = <span class="keyword">new</span> QLabel ( <span class="keyword">this</span> ); <span class="comment">/* 创建标签 */</span></span><br><span class="line">    permanent-&gt;setFrameStyle ( QFrame::Box | QFrame::Sunken ); <span class="comment">/* 标签样式 */</span></span><br><span class="line">    permanent-&gt;setText ( <span class="string">"www.yafeilinux.com"</span> ); <span class="comment">/* 显示信息 */</span></span><br><span class="line">    ui-&gt;statusBar-&gt;addPermanentWidget ( permanent ); <span class="comment">/* 将标签设置为永久部件 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">MainWindow::~MainWindow() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::on_action_New_triggered() &#123; <span class="comment">/* 新建文件菜单 */</span></span><br><span class="line">    QTextEdit *edit = <span class="keyword">new</span> QTextEdit ( <span class="keyword">this</span> ); <span class="comment">/* 新建文本编辑器部件 */</span></span><br><span class="line">    <span class="comment">/* 使用QMdiArea类的addSubWindow函数创建子窗口，以文本编辑器为中心部件 */</span></span><br><span class="line">    QMdiSubWindow *child = ui-&gt;mdiArea-&gt;addSubWindow ( edit );</span><br><span class="line">    child-&gt;setWindowTitle ( tr ( <span class="string">"多文档编辑器子窗口"</span> ) );</span><br><span class="line">    child-&gt;show(); <span class="comment">/* 显示子窗口 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::on_action_Dock_triggered() &#123; <span class="comment">/* 显示Dock菜单 */</span></span><br><span class="line">    ui-&gt;dockWidget-&gt;show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt应用示例/Qt之应用程序主窗口/1.png" height="230" width="281"></p>
<hr>
<h3 id="QT之菜单栏QMenu、下拉菜单QAction、工具栏QToolBar的使用"><a href="#QT之菜单栏QMenu、下拉菜单QAction、工具栏QToolBar的使用" class="headerlink" title="QT之菜单栏QMenu、下拉菜单QAction、工具栏QToolBar的使用"></a>QT之菜单栏QMenu、下拉菜单QAction、工具栏QToolBar的使用</h3><p>&emsp;&emsp;如下内容是实现一个菜单栏以及下拉菜单的制作：<br>&emsp;&emsp;在<code>mainwindow.h</code>中添加如下内容：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QAction</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QMenu</span>;</span></span><br></pre></td></tr></table></figure>
<p>在<code>pro</code>中添加<code>QT += widgets</code>。<code>QMenu</code>类作为菜单栏，<code>QAction</code>类作为点击菜单栏的下拉菜单使用<code>QMenu</code>类对象的<code>addaction(QAction类的对象)</code>来添加：<br>&emsp;&emsp;<code>main.c</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mainwindow.h"</span></span></span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[] )</span> </span>&#123;</span><br><span class="line">    Q_INIT_RESOURCE ( application ); <span class="comment">/* 初始化qrc资源 */</span></span><br><span class="line">    <span class="function">QApplication <span class="title">a</span> <span class="params">( argc, argv )</span></span>;</span><br><span class="line">    a.setOrganizationName ( <span class="string">"Qtporject"</span> );</span><br><span class="line">    a.setApplicationName ( <span class="string">"Application  hello Example"</span> ); <span class="comment">/* 给窗口添加name */</span></span><br><span class="line">    MainWindow w;</span><br><span class="line">    w.show();</span><br><span class="line">    <span class="keyword">return</span> a.exec();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mainwindow.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MAINWINDOW_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAINWINDOW_H</span></span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QPlainTextEdit</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QAction</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QMenu</span>;</span></span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span> :</span> <span class="keyword">public</span> QMainWindow &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MainWindow</span><span class="params">()</span></span>;</span><br><span class="line">    ~MainWindow();</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createActions</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createMenus</span><span class="params">()</span></span>;</span><br><span class="line">    QPlainTextEdit *textEdit; <span class="comment">/* 文本框 */</span></span><br><span class="line">    QMenu *fileMenu; <span class="comment">/* file菜单 */</span></span><br><span class="line">    <span class="comment">/* 定义了file的下拉菜单为new、open、save、saveAS、exit */</span></span><br><span class="line">    QAction *newAct;</span><br><span class="line">    QAction *open;</span><br><span class="line">    QAction *Save;</span><br><span class="line">    QAction *saveAs;</span><br><span class="line">    QAction *<span class="built_in">exit</span>;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MAINWINDOW_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mainwindow.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mainwindow.h"</span></span></span><br><span class="line">​</span><br><span class="line">MainWindow::MainWindow() &#123;</span><br><span class="line">    textEdit = <span class="keyword">new</span> QPlainTextEdit; <span class="comment">/* 创建一个文本编辑器 */</span></span><br><span class="line">    setCentralWidget ( textEdit ); <span class="comment">/* 设置文本编辑器为中心位置 */</span></span><br><span class="line">    createActions(); <span class="comment">/* 首先创建file下拉的菜单栏 */</span></span><br><span class="line">    createMenus(); <span class="comment">/* 再来创建菜单目录，把下拉菜单的内容addaction加入到menu中 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">MainWindow::~MainWindow() &#123;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::test() &#123;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="comment">/* file下拉菜单，名字为new、open、Save、saveAs和exit，并且添加了快捷键和图标，以及相应的槽函数 */</span></span><br><span class="line"><span class="keyword">void</span> MainWindow::createActions() &#123;</span><br><span class="line">    newAct = <span class="keyword">new</span> QAction ( QIcon ( <span class="string">":/image/new.png"</span> ), tr ( <span class="string">"&amp;New"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    newAct-&gt;setShortcuts ( QKeySequence::New );</span><br><span class="line">    newAct-&gt;setStatusTip ( tr ( <span class="string">"Create a new file"</span> ) );</span><br><span class="line">    connect ( newAct, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( test() ) ); <span class="comment">/* New点击事件调用test */</span></span><br><span class="line">    open = <span class="keyword">new</span> QAction ( QIcon ( <span class="string">":/image/open.png"</span> ), tr ( <span class="string">"&amp;Open"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    open-&gt;setShortcuts ( QKeySequence::Open );</span><br><span class="line">    open-&gt;setStatusTip ( tr ( <span class="string">"open a new file"</span> ) );</span><br><span class="line">    connect ( open, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( test() ) ); <span class="comment">/* 点击Open事件调用test */</span></span><br><span class="line">    Save = <span class="keyword">new</span> QAction ( QIcon ( <span class="string">":/image/save.png"</span> ), tr ( <span class="string">"&amp;Save"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    Save-&gt;setShortcuts ( QKeySequence::Save );</span><br><span class="line">    Save-&gt;setStatusTip ( tr ( <span class="string">"Save a new file"</span> ) );</span><br><span class="line">    connect ( Save, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( test() ) ); <span class="comment">/* 点击Save事件调用test */</span></span><br><span class="line">    saveAs = <span class="keyword">new</span> QAction ( tr ( <span class="string">"&amp;SaveAs"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    saveAs-&gt;setShortcuts ( QKeySequence::SaveAs );</span><br><span class="line">    newAct-&gt;setStatusTip ( tr ( <span class="string">"SaveAs a new file"</span> ) );</span><br><span class="line">    connect ( saveAs, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( test() ) ); <span class="comment">/* saveAS点击事件调用test */</span></span><br><span class="line">    <span class="built_in">exit</span> = <span class="keyword">new</span> QAction ( tr ( <span class="string">"&amp;exit"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    <span class="built_in">exit</span>-&gt;setShortcuts ( QKeySequence::Close );</span><br><span class="line">    <span class="built_in">exit</span>-&gt;setStatusTip ( tr ( <span class="string">"exit a new file"</span> ) );</span><br><span class="line">    connect ( <span class="built_in">exit</span>, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( close() ) ); <span class="comment">/* 点击exit事件调用test */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::createMenus() &#123;</span><br><span class="line">    fileMenu = menuBar()-&gt;addMenu ( tr ( <span class="string">"&amp;File"</span> ) ); <span class="comment">/* 创建一个name为file的菜单栏 */</span></span><br><span class="line">    <span class="comment">/* 在这个菜单栏添加action即下拉菜单 */</span></span><br><span class="line">    fileMenu-&gt;addAction ( newAct );</span><br><span class="line">    fileMenu-&gt;addAction ( open );</span><br><span class="line">    fileMenu-&gt;addAction ( Save );</span><br><span class="line">    fileMenu-&gt;addAction ( saveAs );</span><br><span class="line">    fileMenu-&gt;addSeparator(); <span class="comment">/* 添加一个分割器 */</span></span><br><span class="line">    fileMenu-&gt;addAction ( <span class="built_in">exit</span> ); <span class="comment">/* 推出下拉菜单 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt应用示例/Qt之应用程序主窗口/2.png" height="168" width="182"></p>
<p>&emsp;&emsp;下文在原来的基础上添加了菜单栏<code>edit</code>、<code>help</code>，以及<code>edit</code>、<code>help</code>的下拉菜单，还添加了<code>file</code>工具栏和<code>edit</code>工具栏。菜单栏及下拉菜单与上面使用的一样，创建菜单栏类如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QMenu *fileMenu;</span><br><span class="line">QMenu *editMenu;</span><br><span class="line">QMenu *helpMenu;</span><br></pre></td></tr></table></figure>
<p>下拉菜单的类如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 定义edit的下拉菜单cut、copy、past */</span></span><br><span class="line">QAction *cut;</span><br><span class="line">QAction *copy;</span><br><span class="line">QAction *past;</span><br><span class="line"><span class="comment">/* 定义help的下拉菜单about、aboutQt */</span></span><br><span class="line">QAction *about;</span><br><span class="line">QAction *aboutQt;</span><br><span class="line">edit与help的使用方法为：</span><br><span class="line"><span class="comment">/* 创建一个name为edit的菜单栏 */</span></span><br><span class="line">editMenu = menuBar()-&gt;addMenu ( tr ( <span class="string">"&amp;Edit"</span> ) );</span><br><span class="line"><span class="comment">/* 在这个菜单栏添加action，即下拉菜单 */</span></span><br><span class="line">editMenu-&gt;addAction ( cut );</span><br><span class="line">editMenu-&gt;addAction ( copy );</span><br><span class="line">editMenu-&gt;addAction ( past );</span><br><span class="line">​</span><br><span class="line"><span class="comment">/* 创建一个name为help的菜单栏 */</span></span><br><span class="line">helpMenu = menuBar()-&gt;addMenu ( tr ( <span class="string">"&amp;Help"</span> ) );</span><br><span class="line"><span class="comment">/* 在这个菜单栏添加action，即下拉菜单 */</span></span><br><span class="line">helpMenu-&gt;addAction ( about );</span><br><span class="line">helpMenu-&gt;addAction ( aboutQt );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;工具栏使用的使用如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QToolBar *fileToolBar;</span><br><span class="line">QToolBar *editToolBar;</span><br></pre></td></tr></table></figure>
<p>使用方法为：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fileToolBar = addToolBar ( tr ( <span class="string">"File"</span> ) );</span><br><span class="line">fileToolBar-&gt;addAction ( newAct );</span><br><span class="line">fileToolBar-&gt;addAction ( open ) ；</span><br><span class="line">fileToolBar-&gt;addAction ( Save );</span><br><span class="line">editToolBar = addToolBar ( tr ( <span class="string">"Edit"</span> ) );</span><br><span class="line">editToolBar-&gt;addAction ( cut );</span><br><span class="line">editToolBar-&gt;addAction ( copy );</span><br><span class="line">editToolBar-&gt;addAction ( past );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mainwindow.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MAINWINDOW_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAINWINDOW_H</span></span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QPlainTextEdit</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QAction</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QMenu</span>;</span></span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span> :</span> <span class="keyword">public</span> QMainWindow&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MainWindow</span><span class="params">()</span></span>;</span><br><span class="line">    ~MainWindow();</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createActions</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createMenus</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">createToolBars</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    QPlainTextEdit *textEdit; <span class="comment">/* 文本框 */</span></span><br><span class="line">    <span class="comment">/* file菜单 */</span></span><br><span class="line">    QMenu *fileMenu;</span><br><span class="line">    QMenu *editMenu;</span><br><span class="line">    QMenu *helpMenu;</span><br><span class="line">    QToolBar *fileToolBar;</span><br><span class="line">    QToolBar *editToolBar;</span><br><span class="line">    <span class="comment">/* 定义了file的下拉菜单为new、open、save、saveAS和exit */</span></span><br><span class="line">    QAction *newAct;</span><br><span class="line">    QAction *open;</span><br><span class="line">    QAction *Save;</span><br><span class="line">    QAction *saveAs;</span><br><span class="line">    QAction *<span class="built_in">exit</span>;</span><br><span class="line">    <span class="comment">/* 定义edit的下拉菜单cut、copy、past */</span></span><br><span class="line">    QAction *cut;</span><br><span class="line">    QAction *copy;</span><br><span class="line">    QAction *past;</span><br><span class="line">    <span class="comment">/* 定义help的下拉菜单about aboutQt */</span></span><br><span class="line">    QAction *about;</span><br><span class="line">    QAction *aboutQt;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MAINWINDOW_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mainwindow.cpp</code>代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mainwindow.h"</span></span></span><br><span class="line">​</span><br><span class="line">MainWindow::MainWindow() &#123;</span><br><span class="line">    textEdit = <span class="keyword">new</span> QPlainTextEdit;</span><br><span class="line">    setCentralWidget ( textEdit );</span><br><span class="line">    createActions(); <span class="comment">/* 首先创建file下拉的菜单栏 */</span></span><br><span class="line">    createMenus(); <span class="comment">/* 再来创建菜单目录，把下拉菜单的内容addaction加入到menu中 */</span></span><br><span class="line">    createToolBars();</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">MainWindow::~MainWindow() &#123;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::test() &#123;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::createActions() &#123;</span><br><span class="line">    newAct = <span class="keyword">new</span> QAction ( QIcon ( <span class="string">":/image/new.png"</span> ), tr ( <span class="string">"&amp;New"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    newAct-&gt;setShortcuts ( QKeySequence::New );</span><br><span class="line">    newAct-&gt;setStatusTip ( tr ( <span class="string">"Create a new file"</span> ) );</span><br><span class="line">    connect ( newAct, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( test() ) );</span><br><span class="line">    open = <span class="keyword">new</span> QAction ( QIcon ( <span class="string">":/image/open.png"</span> ), tr ( <span class="string">"&amp;Open"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    open-&gt;setShortcuts ( QKeySequence::Open );</span><br><span class="line">    open-&gt;setStatusTip ( tr ( <span class="string">"open a new file"</span> ) );</span><br><span class="line">    connect ( open, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( test() ) );</span><br><span class="line">    Save = <span class="keyword">new</span> QAction ( QIcon ( <span class="string">":/image/save.png"</span> ), tr ( <span class="string">"&amp;Save"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    Save-&gt;setShortcuts ( QKeySequence::Save );</span><br><span class="line">    Save-&gt;setStatusTip ( tr ( <span class="string">"Save a new file"</span> ) );</span><br><span class="line">    connect ( Save, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( test() ) );</span><br><span class="line">    saveAs = <span class="keyword">new</span> QAction ( tr ( <span class="string">"&amp;SaveAs"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    saveAs-&gt;setShortcuts ( QKeySequence::SaveAs );</span><br><span class="line">    newAct-&gt;setStatusTip ( tr ( <span class="string">"SaveAs a new file"</span> ) );</span><br><span class="line">    connect ( saveAs, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( test() ) );</span><br><span class="line">    <span class="built_in">exit</span> = <span class="keyword">new</span> QAction ( tr ( <span class="string">"&amp;exit"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    <span class="built_in">exit</span>-&gt;setShortcuts ( QKeySequence::Close );</span><br><span class="line">    <span class="built_in">exit</span>-&gt;setStatusTip ( tr ( <span class="string">"exit a new file"</span> ) );</span><br><span class="line">    connect ( <span class="built_in">exit</span>, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( close() ) );</span><br><span class="line">    cut = <span class="keyword">new</span> QAction ( QIcon ( <span class="string">":/image/cut.png"</span> ), tr ( <span class="string">"&amp;Cut"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    cut-&gt;setShortcuts ( QKeySequence::Cut );</span><br><span class="line">    cut-&gt;setStatusTip ( tr ( <span class="string">"Save a new file"</span> ) );</span><br><span class="line">    connect ( cut, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( test() ) );</span><br><span class="line">    copy = <span class="keyword">new</span> QAction ( QIcon ( <span class="string">":/image/copy.png"</span> ), tr ( <span class="string">"&amp;Copy"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    saveAs-&gt;setShortcuts ( QKeySequence::Copy );</span><br><span class="line">    copy-&gt;setStatusTip ( tr ( <span class="string">"SaveAs a new file"</span> ) );</span><br><span class="line">    connect ( copy, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( test() ) );</span><br><span class="line">    past = <span class="keyword">new</span> QAction ( QIcon ( <span class="string">":/image/paste.png"</span> ), tr ( <span class="string">"&amp;Paste"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    past-&gt;setShortcuts ( QKeySequence::Paste );</span><br><span class="line">    past-&gt;setStatusTip ( tr ( <span class="string">"exit a new file"</span> ) );</span><br><span class="line">    connect ( past, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( close() ) );</span><br><span class="line">    about = <span class="keyword">new</span> QAction ( tr ( <span class="string">"&amp;about"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    about-&gt;setStatusTip ( tr ( <span class="string">"SaveAs a new file"</span> ) );</span><br><span class="line">    connect ( about, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( test() ) );</span><br><span class="line">    aboutQt = <span class="keyword">new</span> QAction ( tr ( <span class="string">"&amp;aboutQt"</span> ), <span class="keyword">this</span> );</span><br><span class="line">    aboutQt-&gt;setStatusTip ( tr ( <span class="string">"exit a new file"</span> ) );</span><br><span class="line">    connect ( aboutQt, SIGNAL ( triggered() ), <span class="keyword">this</span>, SLOT ( close() ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::createToolBars() &#123;</span><br><span class="line">    fileToolBar = addToolBar ( tr ( <span class="string">"File"</span> ) );</span><br><span class="line">    fileToolBar-&gt;addAction ( newAct );</span><br><span class="line">    fileToolBar-&gt;addAction ( open );</span><br><span class="line">    fileToolBar-&gt;addAction ( Save );</span><br><span class="line">    editToolBar = addToolBar ( tr ( <span class="string">"Edit"</span> ) );</span><br><span class="line">    editToolBar-&gt;addAction ( cut );</span><br><span class="line">    editToolBar-&gt;addAction ( copy );</span><br><span class="line">    editToolBar-&gt;addAction ( past );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::createMenus() &#123;</span><br><span class="line">    fileMenu = menuBar()-&gt;addMenu ( tr ( <span class="string">"&amp;File"</span> ) ); <span class="comment">/* 创建一个name为file的菜单栏 */</span></span><br><span class="line">    <span class="comment">/* 在这个菜单栏添加action即下拉菜单 */</span></span><br><span class="line">    fileMenu-&gt;addAction ( newAct );</span><br><span class="line">    fileMenu-&gt;addAction ( open );</span><br><span class="line">    fileMenu-&gt;addAction ( Save );</span><br><span class="line">    fileMenu-&gt;addAction ( saveAs );</span><br><span class="line">    fileMenu-&gt;addSeparator(); <span class="comment">/* 添加一个分割器 */</span></span><br><span class="line">    fileMenu-&gt;addAction ( <span class="built_in">exit</span> ); <span class="comment">/* 推出下拉菜单 */</span></span><br><span class="line">    editMenu = menuBar()-&gt;addMenu ( tr ( <span class="string">"&amp;Edit"</span> ) ); <span class="comment">/* 创建一个name为edit的菜单栏 */</span></span><br><span class="line">    <span class="comment">/* 在这个菜单栏添加action即下拉菜单 */</span></span><br><span class="line">    editMenu-&gt;addAction ( cut );</span><br><span class="line">    editMenu-&gt;addAction ( copy );</span><br><span class="line">    editMenu-&gt;addAction ( past );</span><br><span class="line">    helpMenu = menuBar()-&gt;addMenu ( tr ( <span class="string">"&amp;Help"</span> ) ); <span class="comment">/* 创建一个name为help的菜单栏 */</span></span><br><span class="line">    <span class="comment">/* 在这个菜单栏添加action即下拉菜单 */</span></span><br><span class="line">    helpMenu-&gt;addAction ( about );</span><br><span class="line">    helpMenu-&gt;addAction ( aboutQt );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt应用示例/Qt之应用程序主窗口/3.png" height="180" width="176"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/Qt应用示例/Qt之事件过滤器应用/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/Qt应用示例/Qt之事件过滤器应用/" itemprop="url">Qt之事件过滤器应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T12:04:03+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt应用示例/" itemprop="url" rel="index">
                    <span itemprop="name">Qt应用示例</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="事件过滤器"><a href="#事件过滤器" class="headerlink" title="事件过滤器"></a>事件过滤器</h3><p>&emsp;&emsp;<code>mylineedit.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MYLINEEDIT_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MYLINEEDIT_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QLineEdit&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyLineEdit</span> :</span> <span class="keyword">public</span> QLineEdit &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MyLineEdit</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">event</span> <span class="params">( QEvent *event )</span></span>;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">keyPressEvent</span> <span class="params">( QKeyEvent *event )</span></span>;</span><br><span class="line">signals:</span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MYLINEEDIT_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>widget.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> WIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WIDGET_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QWidget&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Widget</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyLineEdit</span>;</span></span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> :</span> <span class="keyword">public</span> QWidget &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Widget</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~Widget();</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">eventFilter</span> <span class="params">( QObject *obj, QEvent *event )</span></span>;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">keyPressEvent</span> <span class="params">( QKeyEvent *event )</span></span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::Widget *ui;</span><br><span class="line">    MyLineEdit *lineEdit;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// WIDGET_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>widget.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"widget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_widget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mylineedit.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QKeyEvent&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDebug&gt;</span></span></span><br><span class="line">​</span><br><span class="line">Widget::Widget ( QWidget *parent ) : QWidget ( parent ), ui ( <span class="keyword">new</span> Ui::Widget ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">    lineEdit = <span class="keyword">new</span> MyLineEdit ( <span class="keyword">this</span> );</span><br><span class="line">    lineEdit-&gt;move ( <span class="number">100</span>, <span class="number">100</span> );</span><br><span class="line">    lineEdit-&gt;installEventFilter ( <span class="keyword">this</span> ); <span class="comment">/* 在Widget上为lineEdit安装事件过滤器 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">Widget::~Widget() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> Widget::keyPressEvent ( QKeyEvent *event ) &#123;</span><br><span class="line">    qDebug() &lt;&lt; tr ( <span class="string">"Widget键盘按下事件"</span> );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">bool</span> Widget::eventFilter ( QObject *obj, QEvent *event ) &#123; <span class="comment">/* 事件过滤器 */</span></span><br><span class="line">    <span class="keyword">if</span> ( obj == lineEdit ) &#123; <span class="comment">/* 如果是lineEdit部件上的事件 */</span></span><br><span class="line">        <span class="keyword">if</span> ( event-&gt;type() == QEvent::KeyPress ) &#123;</span><br><span class="line">            qDebug() &lt;&lt; tr ( <span class="string">"Widget的事件过滤器"</span> );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">return</span> QWidget::eventFilter ( obj, event );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mylineedit.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mylineedit.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QKeyEvent&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDebug&gt;</span></span></span><br><span class="line">​</span><br><span class="line">MyLineEdit::MyLineEdit ( QWidget *parent ) : QLineEdit ( parent ) &#123;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MyLineEdit::keyPressEvent ( QKeyEvent *event ) &#123; <span class="comment">/* 键盘按下事件 */</span></span><br><span class="line">    qDebug() &lt;&lt; tr ( <span class="string">"MyLineEdit键盘按下事件"</span> );</span><br><span class="line">    QLineEdit::keyPressEvent ( event ); <span class="comment">/* 执行QLineEdit类的默认事件处理 */</span></span><br><span class="line">    event-&gt;ignore(); <span class="comment">/* 忽略该事件 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">bool</span> MyLineEdit::event ( QEvent *event ) &#123; <span class="comment">/* 事件 */</span></span><br><span class="line">    <span class="keyword">if</span> ( event-&gt;type() == QEvent::KeyPress ) &#123;</span><br><span class="line">        qDebug() &lt;&lt; tr ( <span class="string">"MyLineEdit的event()函数"</span> );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">return</span> QLineEdit::event ( event ); <span class="comment">/* 执行QLineEdit类event函数的默认操作 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt应用示例/Qt之事件过滤器应用/1.png" height="189" width="352"></p>
<p>&emsp;&emsp;在事件过滤器中，先判断该事件的对象是不是<code>lineEdit</code>，如果是，再判断事件类型。最后返回了<code>QWidget</code>类默认的事件过滤器的执行结果。<br>&emsp;&emsp;可以看到，事件的传递顺序是这样的：先是事件过滤器，然后是该部件的<code>event</code>函数，最后是该部件的事件处理函数。这里还要注意，<code>event</code>和事件处理函数是在该部件内进行重新定义的，而事件过滤器却是在该部件的父部件中进行定义的。</p>
<hr>
<h3 id="事件过滤器与事件的发送"><a href="#事件过滤器与事件的发送" class="headerlink" title="事件过滤器与事件的发送"></a>事件过滤器与事件的发送</h3><p>&emsp;&emsp;<code>widget.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> WIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WIDGET_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QWidget&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Widget</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> :</span> <span class="keyword">public</span> QWidget &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Widget</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~Widget();</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">eventFilter</span> <span class="params">( QObject *obj, QEvent *event )</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::Widget *ui;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// WIDGET_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>widget.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"widget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_widget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QKeyEvent&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QWheelEvent&gt;</span></span></span><br><span class="line">​</span><br><span class="line">Widget::Widget ( QWidget *parent ) : QWidget ( parent ), ui ( <span class="keyword">new</span> Ui::Widget ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">    ui-&gt;textEdit-&gt;installEventFilter ( <span class="keyword">this</span> ); <span class="comment">/* 为编辑器部件在本窗口上安装事件过滤器 */</span></span><br><span class="line">    ui-&gt;spinBox-&gt;installEventFilter ( <span class="keyword">this</span> );</span><br><span class="line">    <span class="function">QKeyEvent <span class="title">myEvent</span> <span class="params">( QEvent::KeyPress, Qt::Key_Up, Qt::NoModifier )</span></span>;</span><br><span class="line">    <span class="comment">// qApp-&gt;sendEvent( ui-&gt;spinBox, &amp;myEvent ); /* 发送键盘事件到spinBox部件 */</span></span><br><span class="line">    QApplication::sendEvent ( ui-&gt;spinBox, &amp;myEvent );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">Widget::~Widget() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">bool</span> Widget::eventFilter ( QObject *obj, QEvent *event ) &#123; <span class="comment">/* 事件过滤器 */</span></span><br><span class="line">    <span class="keyword">if</span> ( obj == ui-&gt;textEdit ) &#123; <span class="comment">/* 判断部件 */</span></span><br><span class="line">        <span class="keyword">if</span> ( event-&gt;type() == QEvent::Wheel ) &#123; <span class="comment">/* 判断事件 */</span></span><br><span class="line">            <span class="comment">/* 将event强制转换为发生的事件的类型 */</span></span><br><span class="line">            QWheelEvent *wheelEvent = <span class="keyword">static_cast</span>&lt;QWheelEvent *&gt; ( event );</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">if</span> ( wheelEvent-&gt;delta() &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">                ui-&gt;textEdit-&gt;zoomIn();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                ui-&gt;textEdit-&gt;zoomOut();</span><br><span class="line">            &#125;</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">/* 该事件已经被处理 */</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">/* 如果是其他事件，可以进行进一步的处理 */</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( obj == ui-&gt;spinBox ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( event-&gt;type() == QEvent::KeyPress ) &#123;</span><br><span class="line">            QKeyEvent *keyEvent = <span class="keyword">static_cast</span>&lt;QKeyEvent *&gt; ( event );</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">if</span> ( keyEvent-&gt;key() == Qt::Key_Space ) &#123;</span><br><span class="line">                ui-&gt;spinBox-&gt;setValue ( <span class="number">0</span> );</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> QWidget::eventFilter ( obj, event );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt应用示例/Qt之事件过滤器应用/2.png" height="204" width="247"></p>
<p>&emsp;&emsp;要对一个部件使用事件过滤器，那么就要先使用该部件的<code>installEventFilter</code>函数为该部件安装事件过滤器，这个函数的参数表明了监视对象。比如这里就是为<code>textEdit</code>和<code>spinBox</code>部件安装了事件过滤器，其参数<code>this</code>表明要在本部件即<code>Widget</code>中监视<code>textEdit</code>和<code>spinBox</code>的事件。这样就需要重新实现<code>Widget</code>类的<code>eventFilter</code>函数，在其中截获并处理两个子部件的事件。<br>&emsp;&emsp;如果要对一个特定的事件进行处理，而且不希望它在后面的传递过程中再被处理，那么就返回<code>true</code>，否则返回<code>false</code>。<code>qApp</code>是<code>QApplication</code>对象的全局指针，每一个应用程序中只能使用一个<code>QApplication</code>对象，这里等价于使用<code>QApplication::sendEvent</code>。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/Qt应用示例/Qt之启动线程/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/Qt应用示例/Qt之启动线程/" itemprop="url">Qt之启动线程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T11:56:41+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt应用示例/" itemprop="url" rel="index">
                    <span itemprop="name">Qt应用示例</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>mythread.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MYTHREAD_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MYTHREAD_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QThread&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> :</span> <span class="keyword">public</span> QThread &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MyThread</span> <span class="params">( QObject *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">volatile</span> <span class="keyword">bool</span> stopped;</span><br><span class="line">signals:</span><br><span class="line">  <span class="keyword">public</span> slots:</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MYTHREAD_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>dialog.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> DIALOG_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DIALOG_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDialog&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mythread.h"</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Dialog</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dialog</span> :</span> <span class="keyword">public</span> QDialog &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Dialog</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~Dialog();</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_startButton_clicked</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_stopButton_clicked</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::Dialog *ui;</span><br><span class="line">    MyThread thread;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// DIALOG_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mythread.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mythread.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDebug&gt;</span></span></span><br><span class="line">​</span><br><span class="line">MyThread::MyThread ( QObject *parent ) : QThread ( parent ) &#123;</span><br><span class="line">    stopped = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MyThread::run() &#123;</span><br><span class="line">    qreal i = <span class="number">0</span>;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">while</span> ( !stopped ) &#123;</span><br><span class="line">        qDebug() &lt;&lt; QString ( <span class="string">"in MyThread: %1"</span> ).arg ( i++ );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    stopped = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MyThread::stop() &#123;</span><br><span class="line">    stopped = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>dialog.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"dialog.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_dialog.h"</span></span></span><br><span class="line">​</span><br><span class="line">Dialog::Dialog ( QWidget *parent ) : QDialog ( parent ), ui ( <span class="keyword">new</span> Ui::Dialog ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">Dialog::~Dialog() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> Dialog::on_startButton_clicked() &#123; <span class="comment">/* 启动线程按钮 */</span></span><br><span class="line">    thread.start();</span><br><span class="line">    ui-&gt;startButton-&gt;setEnabled ( <span class="literal">false</span> );</span><br><span class="line">    ui-&gt;stopButton-&gt;setEnabled ( <span class="literal">true</span> );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> Dialog::on_stopButton_clicked() &#123; <span class="comment">/* 终止线程按钮 */</span></span><br><span class="line">    <span class="keyword">if</span> ( thread.isRunning() ) &#123;</span><br><span class="line">        thread.stop();</span><br><span class="line">        ui-&gt;startButton-&gt;setEnabled ( <span class="literal">true</span> );</span><br><span class="line">        ui-&gt;stopButton-&gt;setEnabled ( <span class="literal">false</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>main.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QtGui/QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"dialog.h"</span></span></span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[] )</span> </span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span> <span class="params">( argc, argv )</span></span>;</span><br><span class="line">    Dialog w;</span><br><span class="line">    w.show();</span><br><span class="line">    <span class="keyword">return</span> a.exec();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt应用示例/Qt之启动线程/1.png" height="214" width="376"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/Qt应用示例/Qt之自定义信号/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/Qt应用示例/Qt之自定义信号/" itemprop="url">Qt之自定义信号</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T11:48:15+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt应用示例/" itemprop="url" rel="index">
                    <span itemprop="name">Qt应用示例</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>widget.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> WIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WIDGET_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QWidget&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Widget</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> :</span> <span class="keyword">public</span> QWidget &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Widget</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~Widget();</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">showValue</span> <span class="params">( <span class="keyword">int</span> value )</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::Widget *ui;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// WIDGET_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mydialog.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MYDIALOG_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MYDIALOG_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDialog&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyDialog</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDialog</span> :</span> <span class="keyword">public</span> QDialog &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MyDialog</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~MyDialog();</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_pushButton_clicked</span><span class="params">()</span></span>;</span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dlgReturn</span> <span class="params">( <span class="keyword">int</span> )</span></span>; <span class="comment">/* 自定义的信号 */</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::MyDialog *ui;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MYDIALOG_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>widget.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"widget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_widget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mydialog.h"</span></span></span><br><span class="line">​</span><br><span class="line">Widget::Widget ( QWidget *parent ) : QWidget ( parent ), ui ( <span class="keyword">new</span> Ui::Widget ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">    MyDialog *dlg = <span class="keyword">new</span> MyDialog ( <span class="keyword">this</span> ); <span class="comment">/* 创建对话框 */</span></span><br><span class="line">    <span class="comment">/* 将对话框中的自定义信号与主界面中的自定义槽函数进行关联 */</span></span><br><span class="line">    connect ( dlg, SIGNAL ( dlgReturn ( <span class="keyword">int</span> ) ), <span class="keyword">this</span>, SLOT ( showValue ( <span class="keyword">int</span> ) ) );</span><br><span class="line">    dlg-&gt;show(); <span class="comment">/* 显示对话框 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">Widget::~Widget() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> Widget::showValue ( <span class="keyword">int</span> value ) &#123; <span class="comment">/* 自定义槽函数 */</span></span><br><span class="line">    ui-&gt;label-&gt;setText ( tr ( <span class="string">"获取的值是：%1"</span> ).arg ( value ) );</span><br><span class="line">&#125;</span><br><span class="line">   mydialog.cpp：</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mydialog.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_mydialog.h"</span></span></span><br><span class="line">​</span><br><span class="line">MyDialog::MyDialog ( QWidget *parent ) : QDialog ( parent ), ui ( <span class="keyword">new</span> Ui::MyDialog ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">MyDialog::~MyDialog() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MyDialog::on_pushButton_clicked() &#123; <span class="comment">/* 确定按钮 */</span></span><br><span class="line">    <span class="keyword">int</span> value = ui-&gt;spinBox-&gt;value(); <span class="comment">/* 获取输入的数值 */</span></span><br><span class="line">    <span class="function">emit <span class="title">dlgReturn</span> <span class="params">( value )</span></span>; <span class="comment">/* 发射信号 */</span></span><br><span class="line">    close(); <span class="comment">/* 关闭对话框 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt应用示例/Qt之自定义信号/1.png" height="225" width="557"></p>
<p>&emsp;&emsp;声明一个信号要使用<code>signals</code>关键字，在<code>signals</code>前面不能使用<code>public</code>、<code>private</code>和<code>protected</code>等限定符，因为只有定义该信号的类以及子类才可以发射该信号。而且信号只用声明，不需要也不能对它进行定义实现。信号没有返回值，只能是<code>void</code>类型的。因为只有<code>QObject</code>类以及其子类派生的类才能使用信号和槽机制。使用信号和槽还必须在类声明的最开始处添加<code>Q_OBJECT</code>宏。<br>&emsp;&emsp;声明一个槽需要使用<code>slots</code>关键词。一个槽可以是<code>private</code>、<code>public</code>或者<code>protected</code>类型的，也可以声明为虚函数，这与普通的成员函数是一样的，也可以像调用一个普通函数一样来调用槽。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/Qt应用示例/Qt窗口间的相互切换/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/Qt应用示例/Qt窗口间的相互切换/" itemprop="url">Qt窗口间的相互切换</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T11:35:55+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt应用示例/" itemprop="url" rel="index">
                    <span itemprop="name">Qt应用示例</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;在用<code>Qt</code>设计<code>GUI</code>时，经常要设计两个窗口之间的相互切换，即以从一个窗口跳转到另一个窗口，然后又从另一个窗口跳转回原窗口。下面来介绍具体的实现方法。<br>&emsp;&emsp;首先建立<code>Qt</code>的<code>Gui</code>应用，项目名是<code>TwoWindowsHandoff</code>，基类选择<code>QMainWindow</code>。然后右击项目，添加<code>Qt</code>设计器界面类，类名取为<code>logindialog</code>。我们在这里假设一个窗口是登录对话框，另一个窗口是主界面；登录对话框有两个按钮，分别更改显示文本为<code>login</code>、<code>exit</code>；主界面也有两个按钮，分别更改显示文本为<code>relogin</code>、<code>quit</code>。我们最终的实现功能是：程序运行时，出现登录对话框，点击<code>login</code>按钮进入主界面且登录对话框消失；在主界面点击<code>relogin</code>按钮回到登录对话框且主界面消失，点击<code>exit</code>按钮或<code>quit</code>按钮都会退出程序。<br>&emsp;&emsp;我们可以通过<code>Qt Designer</code>来在两个窗口上分别添加上述按钮，主要的问题是如何设计信号和槽。我们先设计两个窗口的退出按钮：分别右击<code>exit</code>和<code>quit</code>按钮，转到槽，在槽函数中发射<code>quit</code>信号，然后将信号与<code>QApplication</code>对象的<code>quit</code>槽函数关联，这样就设计好了两个退出按钮的退出操作。对于<code>login</code>按钮，我们在其槽函数中发射<code>showmainwindow</code>信号，隐藏对话框，然后在主窗口类中定义对应的槽函数<code>receivelogin</code>，在该函数中应该显示主窗口。同理，对于<code>relogin</code>窗口，我们在其槽函数中发射<code>dlgshow</code>信号，隐藏主窗口，然后在登录对话框类中定义对应的槽函数<code>receivelshow</code>，在该函数中应该显示登录对话框。具体的程序实现如下：<br>&emsp;&emsp;<code>mainwindow.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MAINWINDOW_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAINWINDOW_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMainWindow&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span> :</span> <span class="keyword">public</span> QMainWindow &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">​</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MainWindow</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~MainWindow();</span><br><span class="line">​</span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    Ui::MainWindow *ui;</span><br><span class="line">​</span><br><span class="line">  <span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">receivelogin</span><span class="params">()</span></span>; <span class="comment">/* 与login中发射的信号关联的槽函数 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_pushButton_clicked</span><span class="params">()</span></span>; <span class="comment">/* 与relogin的click关联的槽函数 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_pushButton_2_clicked</span><span class="params">()</span></span>; <span class="comment">/* 与quit的click关联的槽函数 */</span></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dlgshow</span><span class="params">()</span></span>; <span class="comment">/* 显示登录对话框信号 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">quit</span><span class="params">()</span></span>; <span class="comment">/* 退出信号 */</span></span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MAINWINDOW_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mydialog.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MYDIALOG_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MYDIALOG_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDialog&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyDialog</span>;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDialog</span> :</span> <span class="keyword">public</span> QDialog &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MyDialog</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~MyDialog();</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_pushButton_clicked</span><span class="params">()</span></span>; <span class="comment">/* 与login关联的槽函数 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">receiveshow</span><span class="params">()</span></span>; <span class="comment">/* 与relogin中发射的信号关联的槽函数 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_pushButton_2_clicked</span><span class="params">()</span></span>; <span class="comment">/* 与exit关联的槽函数 */</span></span><br><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">showmainwindow</span><span class="params">()</span></span>; <span class="comment">/* 显示主窗口信号 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">quit</span><span class="params">()</span></span>; <span class="comment">/* 退出信号 */</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::MyDialog *ui;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MYDIALOG_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>main.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QtGui/QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mainwindow.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mydialog.h"</span></span></span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[] )</span> </span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span> <span class="params">( argc, argv )</span></span>;</span><br><span class="line">    MainWindow w;</span><br><span class="line">    MyDialog dlg;</span><br><span class="line">    dlg.show();</span><br><span class="line">    <span class="comment">/* 信号与槽之间进行关联 */</span></span><br><span class="line">    QObject::connect ( &amp;dlg, SIGNAL ( showmainwindow() ), &amp;w, SLOT ( receivelogin() ) );</span><br><span class="line">    QObject::connect ( &amp;w, SIGNAL ( dlgshow() ), &amp;dlg, SLOT ( receiveshow() ) );</span><br><span class="line">    QObject::connect ( &amp;w, SIGNAL ( quit() ), &amp;a, SLOT ( quit() ) );</span><br><span class="line">    QObject::connect ( &amp;dlg, SIGNAL ( quit() ), &amp;a, SLOT ( quit() ) );</span><br><span class="line">    <span class="keyword">return</span> a.exec();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mainwindow.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mainwindow.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_mainwindow.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QPushButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QHBoxLayout&gt;</span></span></span><br><span class="line">​</span><br><span class="line">MainWindow::MainWindow ( QWidget *parent ) : QMainWindow ( parent ), ui ( <span class="keyword">new</span> Ui::MainWindow ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> ); <span class="comment">/* 默认是类名 */</span></span><br><span class="line">    setWindowTitle ( tr ( <span class="string">"myMainWindow"</span> ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">MainWindow::~MainWindow() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::receivelogin() &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;show(); <span class="comment">/* 显示主窗口 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::on_pushButton_clicked() &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;hide(); <span class="comment">/* 隐藏主窗口 */</span></span><br><span class="line">    <span class="function">emit <span class="title">dlgshow</span><span class="params">()</span></span>; <span class="comment">/* 发射显示登录对话框信号 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::on_pushButton_2_clicked() &#123;</span><br><span class="line">    <span class="function">emit <span class="title">quit</span><span class="params">()</span></span>; <span class="comment">/* 发射退出信号 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mydialog.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mydialog.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_mydialog.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QHBoxLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;mainwindow.h&gt;</span></span></span><br><span class="line">​</span><br><span class="line">MyDialog::MyDialog ( QWidget *parent ) :   QDialog ( parent ),  ui ( <span class="keyword">new</span> Ui::MyDialog ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">MyDialog::~MyDialog() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MyDialog::on_pushButton_clicked() &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;hide(); <span class="comment">/* 隐藏登录对话框 */</span></span><br><span class="line">    <span class="function">emit <span class="title">showmainwindow</span><span class="params">()</span></span>; <span class="comment">/* 显示主窗口 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MyDialog::receiveshow() &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;show(); <span class="comment">/* 显示登录对话框 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MyDialog::on_pushButton_2_clicked() &#123;</span><br><span class="line">    <span class="function">emit <span class="title">quit</span><span class="params">()</span></span>; <span class="comment">/* 发射退出信号 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt应用示例/Qt窗口间的相互切换/1.png" height="198" width="492"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/Qt语法详解/Qt之LineEdit/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/Qt语法详解/Qt之LineEdit/" itemprop="url">Qt之LineEdit</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T10:45:35+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="行编辑器"><a href="#行编辑器" class="headerlink" title="行编辑器"></a>行编辑器</h3><p>&emsp;&emsp;<code>mywidget.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MYWIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MYWIDGET_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QWidget&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyWidget</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyWidget</span> :</span> <span class="keyword">public</span> QWidget &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MyWidget</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~MyWidget();</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_lineEdit2_returnPressed</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">on_lineEdit3_returnPressed</span><span class="params">()</span></span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::MyWidget *ui;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MYWIDGET_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mywidget.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mywidget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_mywidget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QCompleter&gt;</span></span></span><br><span class="line">​</span><br><span class="line">MyWidget::MyWidget ( QWidget *parent ) : QWidget ( parent ), ui ( <span class="keyword">new</span> Ui::MyWidget ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">    QValidator *validator = <span class="keyword">new</span> QIntValidator ( <span class="number">100</span>, <span class="number">999</span>, <span class="keyword">this</span> ); <span class="comment">/* 新建验证器，指定范围为100至999 */</span></span><br><span class="line">    ui-&gt;lineEdit3-&gt;setValidator ( validator ); <span class="comment">/* 在行编辑器中使用验证器 */</span></span><br><span class="line">    QStringList wordList;</span><br><span class="line">    wordList &lt;&lt; <span class="string">"Qt"</span> &lt;&lt; <span class="string">"Qt Creator"</span> &lt;&lt; tr ( <span class="string">"你好"</span> );</span><br><span class="line">    QCompleter *completer = <span class="keyword">new</span> QCompleter ( wordList, <span class="keyword">this</span> ); <span class="comment">/* 新建自动完成器 */</span></span><br><span class="line">    completer-&gt;setCaseSensitivity ( Qt::CaseInsensitive ); <span class="comment">/* 设置大小写不敏感 */</span></span><br><span class="line">    ui-&gt;lineEdit4-&gt;setCompleter ( completer );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">MyWidget::~MyWidget() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MyWidget::on_lineEdit2_returnPressed() &#123; <span class="comment">/* 回车键按下信号的槽 */</span></span><br><span class="line">    ui-&gt;lineEdit3-&gt;setFocus(); <span class="comment">/* 让lineEdit3获得光标 */</span></span><br><span class="line">    qDebug() &lt;&lt; ui-&gt;lineEdit2-&gt;text(); <span class="comment">/* 输出lineEdit2的内容 */</span></span><br><span class="line">    qDebug() &lt;&lt; ui-&gt;lineEdit2-&gt;displayText(); <span class="comment">/* 输出lineEdit2显示的内容 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MyWidget::on_lineEdit3_returnPressed() &#123; <span class="comment">/* 回车键按下信号的槽 */</span></span><br><span class="line">    ui-&gt;lineEdit4-&gt;setFocus();</span><br><span class="line">    qDebug() &lt;&lt; ui-&gt;lineEdit3-&gt;text();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt语法详解/Qt之LineEdit/1.png" height="230" width="284"></p>
<hr>
<h3 id="lineEdit-gt-textChanged信号不触发的原因"><a href="#lineEdit-gt-textChanged信号不触发的原因" class="headerlink" title="lineEdit-&gt;textChanged信号不触发的原因"></a>lineEdit-&gt;textChanged信号不触发的原因</h3><p>&emsp;&emsp;项目要求是当<code>lineEdit</code>中的内容发生改变时，激活<code>find</code>按纽。但实际运行结果却不行，发现是自己的<code>connect</code>语句写错了：</p>
<p><img src="/2019/02/23/Qt语法详解/Qt之LineEdit/2.png"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// connect ( lineEdit, SIGNAL ( textChanged ( QString &amp; ) ), this, SLOT ( enableFindButton ( QString &amp; ) ) ); /* 错误写法 */</span></span><br><span class="line">connect ( lineEdit, SIGNAL ( textChanged ( <span class="keyword">const</span> QString &amp; ) ), <span class="keyword">this</span>, SLOT ( enableFindButton ( <span class="keyword">const</span> QString &amp; ) ) );</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Qt设置密码输入框"><a href="#Qt设置密码输入框" class="headerlink" title="Qt设置密码输入框"></a>Qt设置密码输入框</h3><p>&emsp;&emsp;<code>QLineEdit</code>类自带<code>public function: void setEchoMode(EchoMode)</code>以实现密码输入框效果。<code>EchoMode</code>的枚举值如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Constant</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QLineEdit::Normal</code></td>
<td><code>0</code></td>
<td>正常显示形式，也就是一边输入一边显示</td>
</tr>
<tr>
<td><code>QLineEdit::NoEcho</code></td>
<td><code>1</code></td>
<td>不会显示任何字符，包括字符串长度</td>
</tr>
<tr>
<td><code>QLineEdit::Password</code></td>
<td><code>2</code></td>
<td>根据平台使用模糊字符代替你实际输入的字符</td>
</tr>
<tr>
<td><code>QLineEdit::PasswordEchoOnEdit</code></td>
<td><code>3</code></td>
<td>当你处于输入状态的时候，是正常显示字符。输入完毕之后使用<code>Password</code>形式隐藏字符</td>
</tr>
</tbody>
</table>
</div>
<p>通过<code>EchoMode</code>提供枚举值有选择的设置<code>setEchoMode(EchoMode)</code>，以达到自己想要的效果。</p>
<hr>
<ul>
<li><code>text()</code>：获得<code>lineEdit</code>中的内容，为<code>QString</code>类型。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/22/Qt语法详解/Qt之QTreeWidget/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/22/Qt语法详解/Qt之QTreeWidget/" itemprop="url">Qt之QTreeWidget</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-22T13:17:33+08:00">
                2019-02-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>Qt</code>中实现树形结构可以使用<code>QTreeWidget</code>类，也可以使用<code>QTreeView</code>类，<code>QTreeWidget</code>继承自<code>QTreeView</code>类，其效果如下：</p>
<p><img src="/2019/02/22/Qt语法详解/Qt之QTreeWidget/1.png"></p>
<h3 id="树形结构实现"><a href="#树形结构实现" class="headerlink" title="树形结构实现"></a>树形结构实现</h3><p>&emsp;&emsp;<code>QT</code>的<code>GUI</code>中有<code>treeWidget</code>部件，将该控件在<code>GUI</code>中布局好，假设其对象名为<code>treeWidget</code>。树形结构通过<code>QTreeWidget</code>类和<code>QTreeWidgetItem</code>类实现，<code>QTreeWidgetItem</code>类实现结点的添加。上图代码实现如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ui-&gt;treeWidget-&gt;setColumnCount ( <span class="number">1</span> ); <span class="comment">/* 设置列数 */</span></span><br><span class="line">ui-&gt;treeWidget-&gt;setHeaderLabel ( tr ( <span class="string">"图像选择"</span> ) ); <span class="comment">/* 设置头的标题 */</span></span><br><span class="line">​</span><br><span class="line">QTreeWidgetItem *imageItem1 = <span class="keyword">new</span> QTreeWidgetItem ( ui-&gt;treeWidget, QStringList ( QString ( <span class="string">"图像1"</span> ) ) );</span><br><span class="line">imageItem1-&gt;setIcon ( <span class="number">0</span>, QIcon ( <span class="string">"xxx.png"</span> ) );</span><br><span class="line">QTreeWidgetItem *imageItem1_1 = <span class="keyword">new</span> QTreeWidgetItem ( imageItem1, QStringList ( QString ( <span class="string">"Band1"</span> ) ) ); <span class="comment">/* 子节点1 */</span></span><br><span class="line">imageItem1-&gt;addChild ( imageItem1_1 ); <span class="comment">/* 添加子节点 */</span></span><br><span class="line">​</span><br><span class="line">QTreeWidgetItem *imageItem2 = <span class="keyword">new</span> QTreeWidgetItem ( ui-&gt;treeWidget, QStringList ( QString ( <span class="string">"图像2"</span> ) ) );</span><br><span class="line">QTreeWidgetItem *imageItem2_1 = <span class="keyword">new</span> QTreeWidgetItem ( imageItem2, QStringList ( QString ( <span class="string">"Band1"</span> ) ) ); <span class="comment">/* 子节点1 */</span></span><br><span class="line">QTreeWidgetItem *imageItem2_2 = <span class="keyword">new</span> QTreeWidgetItem ( imageItem2, QStringList ( QString ( <span class="string">"Band2"</span> ) ) ); <span class="comment">/* 子节点2 */</span></span><br><span class="line">imageItem2-&gt;addChild ( imageItem2_1 ); <span class="comment">/* 添加子节点 */</span></span><br><span class="line">imageItem2-&gt;addChild ( imageItem2_2 );</span><br><span class="line">​</span><br><span class="line">ui-&gt;treeWidget-&gt;expandAll(); <span class="comment">/* 结点全部展开 */</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;除了使用上面这种方法之外，还可以使用<code>QList&lt;QTreeWidgetItem *&gt; &amp; items</code>实现结点的添加：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;QTreeWidgetItem *&gt; rootList;</span><br><span class="line">​</span><br><span class="line">QTreeWidgetItem *imageItem1 = <span class="keyword">new</span> QTreeWidgetItem; <span class="comment">/* 添加第一个父节点 */</span></span><br><span class="line">imageItem1-&gt;setText ( <span class="number">0</span>, tr ( <span class="string">"图像1"</span> ) );</span><br><span class="line">rootList.append ( imageItem1 );</span><br><span class="line">​</span><br><span class="line">QTreeWidgetItem *imageItem1_1 = <span class="keyword">new</span> QTreeWidgetItem ( imageItem1, QStringList ( QString ( <span class="string">"Band1"</span> ) ) ); <span class="comment">/* 添加子节点 */</span></span><br><span class="line">imageItem1-&gt;addChild ( imageItem1_1 );</span><br><span class="line">​</span><br><span class="line">QTreeWidgetItem *imageItem2 = <span class="keyword">new</span> QTreeWidgetItem; <span class="comment">/* 添加第二个父节点 */</span></span><br><span class="line">imageItem2-&gt;setText ( <span class="number">0</span>, tr ( <span class="string">"图像2"</span> ) );</span><br><span class="line">rootList.append ( imageItem2 );</span><br><span class="line">​</span><br><span class="line">QTreeWidgetItem *imageItem2_1 = <span class="keyword">new</span> QTreeWidgetItem ( imageItem2, QStringList ( QString ( <span class="string">"Band1"</span> ) ) ); <span class="comment">/* 添加子节点 */</span></span><br><span class="line">QTreeWidgetItem *imageItem2_2 = <span class="keyword">new</span> QTreeWidgetItem ( imageItem2, QStringList ( QString ( <span class="string">"Band2"</span> ) ) );</span><br><span class="line">imageItem2-&gt;addChild ( imageItem2_1 );</span><br><span class="line">imageItem2-&gt;addChild ( imageItem2_2 );</span><br><span class="line">​</span><br><span class="line">ui-&gt;treeWidget-&gt;insertTopLevelItems ( <span class="number">0</span>, rootList ); <span class="comment">/* 将结点插入部件中 */</span></span><br><span class="line">​</span><br><span class="line">ui-&gt;treeWidget-&gt;expandAll(); <span class="comment">/* 全部展开 */</span></span><br></pre></td></tr></table></figure>
<h3 id="点击节点的事件响应"><a href="#点击节点的事件响应" class="headerlink" title="点击节点的事件响应"></a>点击节点的事件响应</h3><p>&emsp;&emsp;首先想到有没有点击某个节点的信号，查看文档后发现有一个<code>void itemClicked ( QTreeWidgetItem * item, int column )</code>信号，它是双击某个节点的信号。将该信号与某个自定义槽相连，当双击节点时触发槽函数。第一个参数为点击的<code>QTreeWidgetItem</code>类对象，第二个参数为节点所在列号。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">showSelectedImage</span> <span class="params">( QTreeWidgetItem *item, <span class="keyword">int</span> column )</span></span>; <span class="comment">/* 点击树节点事件 */</span></span><br><span class="line">​</span><br><span class="line">connect ( ui-&gt;treeWidget, SIGNAL ( itemDoubleClicked ( QTreeWidgetItem *, <span class="keyword">int</span> ) ), \</span><br><span class="line">          <span class="keyword">this</span>, SLOT ( showSelectedImage ( QTreeWidgetItem *, <span class="keyword">int</span> ) ) );</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::showSelectedImage ( QTreeWidgetItem *item, <span class="keyword">int</span> column ) &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>&emsp;&emsp;The <code>QTreeWidget</code> class provides a tree view that uses a predefined tree model.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Header</th>
<th>Inherits</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QTreeWidget</code></td>
<td><code>QTreeView</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Public-Functions"><a href="#Public-Functions" class="headerlink" title="Public Functions"></a>Public Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><code>QTreeWidget(QWidget * parent = 0)</code></td>
</tr>
<tr>
<td></td>
<td><code>~QTreeWidget()</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>addTopLevelItem(QTreeWidgetItem * item)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>addTopLevelItems(const QList&lt;QTreeWidgetItem *&gt; &amp; items)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>closePersistentEditor(QTreeWidgetItem * item, int column = 0)</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>columnCount() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>currentColumn() const</code></td>
</tr>
<tr>
<td><code>QTreeWidgetItem *</code></td>
<td><code>currentItem() const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>editItem(QTreeWidgetItem * item, int column = 0)</code></td>
</tr>
<tr>
<td><code>QList&lt;QTreeWidgetItem *&gt;</code></td>
<td><code>findItems(const QString &amp; text, Qt::MatchFlags flags, int column = 0) const</code></td>
</tr>
<tr>
<td><code>QTreeWidgetItem *</code></td>
<td><code>headerItem() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>indexOfTopLevelItem(QTreeWidgetItem * item) const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>insertTopLevelItem(int index, QTreeWidgetItem * item)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>insertTopLevelItems(int index, const QList&lt;QTreeWidgetItem *&gt; &amp; items)</code></td>
</tr>
<tr>
<td><code>QTreeWidgetItem *</code></td>
<td><code>invisibleRootItem() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isFirstItemColumnSpanned(const QTreeWidgetItem * item) const</code></td>
</tr>
<tr>
<td><code>QTreeWidgetItem *</code></td>
<td><code>itemAbove(const QTreeWidgetItem * item) const</code></td>
</tr>
<tr>
<td><code>QTreeWidgetItem *</code></td>
<td><code>itemAt(const QPoint &amp; p) const</code></td>
</tr>
<tr>
<td><code>QTreeWidgetItem *</code></td>
<td><code>itemAt(int x, int y) const</code></td>
</tr>
<tr>
<td><code>QTreeWidgetItem *</code></td>
<td><code>itemBelow(const QTreeWidgetItem * item) const</code></td>
</tr>
<tr>
<td><code>QWidget *</code></td>
<td><code>itemWidget(QTreeWidgetItem * item, int column) const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>openPersistentEditor(QTreeWidgetItem * item, int column = 0)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>removeItemWidget(QTreeWidgetItem * item, int column)</code></td>
</tr>
<tr>
<td><code>QList&lt;QTreeWidgetItem *&gt;</code></td>
<td><code>selectedItems() const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setColumnCount(int columns)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setCurrentItem(QTreeWidgetItem * item)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setCurrentItem(QTreeWidgetItem * item, int column)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setCurrentItem(QTreeWidgetItem * item, int column, QItemSelectionModel::SelectionFlags command)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setFirstItemColumnSpanned(const QTreeWidgetItem * item, bool span)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setHeaderItem(QTreeWidgetItem * item)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setHeaderLabel(const QString &amp; label)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setHeaderLabels(const QStringList &amp; labels)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setItemWidget(QTreeWidgetItem * item, int column, QWidget * widget)</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>sortColumn() const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>sortItems(int column, Qt::SortOrder order)</code></td>
</tr>
<tr>
<td><code>QTreeWidgetItem *</code></td>
<td><code>takeTopLevelItem(int index)</code></td>
</tr>
<tr>
<td><code>QTreeWidgetItem *</code></td>
<td><code>topLevelItem(int index) const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>topLevelItemCount() const</code></td>
</tr>
<tr>
<td><code>QRect</code></td>
<td><code>visualItemRect(const QTreeWidgetItem * item) const</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Reimplemented-Public-Functions"><a href="#Reimplemented-Public-Functions" class="headerlink" title="Reimplemented Public Functions"></a>Reimplemented Public Functions</h3><ul>
<li><code>virtual void setSelectionModel(QItemSelectionModel * selectionModel)</code></li>
</ul>
<h3 id="Public-Slots"><a href="#Public-Slots" class="headerlink" title="Public Slots"></a>Public Slots</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>void</code></td>
<td><code>clear()</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>collapseItem(const QTreeWidgetItem * item)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>expandItem(const QTreeWidgetItem * item)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>scrollToItem(const QTreeWidgetItem * item, QAbstractItemView::ScrollHint hint = EnsureVisible)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Signals"><a href="#Signals" class="headerlink" title="Signals"></a>Signals</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>void</code></td>
<td><code>currentItemChanged(QTreeWidgetItem * current, QTreeWidgetItem * previous)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>itemActivated(QTreeWidgetItem * item, int column)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>itemChanged(QTreeWidgetItem * item, int column)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>itemClicked(QTreeWidgetItem * item, int column)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>itemCollapsed(QTreeWidgetItem * item)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>itemDoubleClicked(QTreeWidgetItem * item, int column)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>itemEntered(QTreeWidgetItem * item, int column)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>itemExpanded(QTreeWidgetItem * item)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>itemPressed(QTreeWidgetItem * item, int column)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>itemSelectionChanged()</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Protected-Functions"><a href="#Protected-Functions" class="headerlink" title="Protected Functions"></a>Protected Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>virtual bool</code></td>
<td><code>dropMimeData(QTreeWidgetItem * parent, int index, const QMimeData * data, Qt::DropAction action)</code></td>
</tr>
<tr>
<td><code>QModelIndex</code></td>
<td><code>indexFromItem(QTreeWidgetItem * item, int column = 0) const</code></td>
</tr>
<tr>
<td><code>QTreeWidgetItem *</code></td>
<td><code>itemFromIndex(const QModelIndex &amp; index) const</code></td>
</tr>
<tr>
<td><code>virtual QMimeData *</code></td>
<td><code>mimeData(const QList&lt;QTreeWidgetItem *&gt; items) const</code></td>
</tr>
<tr>
<td><code>virtual QStringList</code></td>
<td><code>mimeTypes() const</code></td>
</tr>
<tr>
<td><code>virtual Qt::DropActions</code></td>
<td><code>supportedDropActions() const</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Reimplemented-Protected-Functions"><a href="#Reimplemented-Protected-Functions" class="headerlink" title="Reimplemented Protected Functions"></a>Reimplemented Protected Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>virtual void</code></td>
<td><code>dropEvent(QDropEvent * event)</code></td>
</tr>
<tr>
<td><code>virtual bool</code></td>
<td><code>event(QEvent * e)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Detailed-Description"><a href="#Detailed-Description" class="headerlink" title="Detailed Description"></a>Detailed Description</h3><p>&emsp;&emsp;The <code>QTreeWidget</code> class provides a tree view that uses a predefined tree model.<br>&emsp;&emsp;The <code>QTreeWidget</code> class is a convenience class that provides a standard tree widget with a classic <code>item-based</code> interface similar to that used by the <code>QListView</code> class in <code>Qt 3</code>. This class is based on <code>Qt&#39;s</code> <code>Model/View</code> architecture and uses a default model to hold items, each of which is a <code>QTreeWidgetItem</code>.<br>&emsp;&emsp;Developers who do not need the flexibility of the <code>Model/View</code> framework can use this class to create simple hierarchical lists very easily. A more flexible approach involves combining a <code>QTreeView</code> with a standard item model. This allows the storage of data to be separated from its representation.<br>&emsp;&emsp;In its simplest form, a tree widget can be constructed in the following way:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">QTreeWidget *treeWidget = <span class="keyword">new</span> QTreeWidget();</span><br><span class="line">treeWidget-&gt;setColumnCount ( <span class="number">1</span> );</span><br><span class="line">QList&lt;QTreeWidgetItem *&gt; items;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i ) &#123;</span><br><span class="line">    items.append ( <span class="keyword">new</span> QTreeWidgetItem ( ( QTreeWidget * ) <span class="number">0</span>, QStringList ( QString ( <span class="string">"item: %1"</span> ).arg ( i ) ) ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">treeWidget-&gt;insertTopLevelItems ( <span class="number">0</span>, items );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;Before items can be added to the tree widget, the number of columns must be set with <code>setColumnCount()</code>. This allows each item to have one or more labels or other decorations. The number of columns in use can be found with the <code>columnCount()</code> function.<br>&emsp;&emsp;The tree can have a header that contains a section for each column in the widget. It is easiest to set up the labels for each section by supplying a list of strings with <code>setHeaderLabels()</code>, but a custom header can be constructed with a <code>QTreeWidgetItem</code> and inserted into the tree with the <code>setHeaderItem()</code> function.<br>&emsp;&emsp;The items in the tree can be sorted by column according to a predefined sort order. If sorting is enabled, the user can sort the items by clicking on a column header. Sorting can be enabled or disabled by calling <code>setSortingEnabled()</code>. The <code>isSortingEnabled()</code> function indicates whether sorting is enabled.</p>
<p><img src="/2019/02/22/Qt语法详解/Qt之QTreeWidget/2.png" height="157" width="642"></p>
<h3 id="Property-Documentation"><a href="#Property-Documentation" class="headerlink" title="Property Documentation"></a>Property Documentation</h3><ul>
<li><code>columnCount : int</code>: This property holds the number of columns displayed in the tree widget. By default, this property has a value of <code>1</code>. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">columnCount</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setColumnCount</span><span class="params">(<span class="keyword">int</span> columns)</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>topLevelItemCount : const int</code>: This property holds the number of <code>top-level</code> items. By default, this property has a value of <code>0</code>. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">topLevelItemCount</span><span class="params">()</span> <span class="keyword">const</span></span></span><br></pre></td></tr></table></figure>
<h3 id="Member-Function-Documentation"><a href="#Member-Function-Documentation" class="headerlink" title="Member Function Documentation"></a>Member Function Documentation</h3><ul>
<li><code>QTreeWidget::QTreeWidget(QWidget * parent = 0)</code>: Constructs a tree widget with the given <code>parent</code>.</li>
<li><code>QTreeWidget::~QTreeWidget()</code>: Destroys the tree widget and all its items.</li>
<li><code>void QTreeWidget::addTopLevelItem(QTreeWidgetItem * item)</code>: Appends the <code>item</code> as a <code>top-level</code> item in the widget.</li>
<li><code>void QTreeWidget::addTopLevelItems(const QList&lt;QTreeWidgetItem *&gt; &amp; items)</code>: Appends the list of <code>items</code> as a <code>top-level</code> items in the widget.</li>
<li><code>void QTreeWidget::clear() [slot]</code>: Clears the tree widget by removing all of its items and selections. <strong>Note</strong>: Since each item is removed from the tree widget before being deleted, the return value of <code>QTreeWidgetItem::treeWidget()</code> will be invalid when called from an item’s destructor.</li>
<li><code>void QTreeWidget::closePersistentEditor(QTreeWidgetItem * item, int column = 0)</code>: Closes the persistent editor for the <code>item</code> in the given <code>column</code>. This function has no effect if no persistent editor is open for this combination of <code>item</code> and <code>column</code>.</li>
<li><code>void QTreeWidget::collapseItem(const QTreeWidgetItem * item) [slot]</code>: Closes the <code>item</code>. This causes the tree containing the item’s children to be collapsed.</li>
<li><code>int QTreeWidget::currentColumn() const</code>: Returns the current column in the tree widget.</li>
<li><code>QTreeWidgetItem * QTreeWidget::currentItem() const</code>: Returns the current item in the tree widget.</li>
<li><code>void QTreeWidget::currentItemChanged(QTreeWidgetItem * current, QTreeWidgetItem * previous) [signal]</code>: This signal is emitted when the current item changes. The current item is specified by <code>current</code>, and this replaces the <code>previous</code> current item.</li>
<li><code>void QTreeWidget::dropEvent(QDropEvent * event) [virtual protected]</code>: Reimplemented from QWidget::dropEvent().</li>
<li><code>bool QTreeWidget::dropMimeData(QTreeWidgetItem * parent, int index, const QMimeData * data, Qt::DropAction action) [virtual protected]</code>: Handles the <code>data</code> supplied by a drag and drop operation that ended with the given <code>action</code> in the <code>index</code> in the given <code>parent</code> item. The default implementation returns true if the drop was successfully handled by decoding the mime data and inserting it into the model; otherwise it returns false.</li>
<li><code>void QTreeWidget::editItem(QTreeWidgetItem * item, int column = 0)</code>: Starts editing the <code>item</code> in the given <code>column</code> if it is editable.</li>
<li><code>bool QTreeWidget::event(QEvent * e) [virtual protected]</code>: Reimplemented from <code>QObject::event()</code>.</li>
<li><code>void QTreeWidget::expandItem(const QTreeWidgetItem * item) [slot]</code>: Expands the <code>item</code>. This causes the tree containing the item’s children to be expanded.</li>
<li><code>QList&lt;QTreeWidgetItem *&gt; QTreeWidget::findItems(const QString &amp; text, Qt::MatchFlags flags, int column = 0) const</code>: Returns a list of items that match the given <code>text</code>, using the given <code>flags</code>, in the given <code>column</code>.</li>
<li><code>QTreeWidgetItem * QTreeWidget::headerItem() const</code>: Returns the item used for the tree widget’s header.</li>
<li><code>QModelIndex QTreeWidget::indexFromItem(QTreeWidgetItem * item, int column = 0) const [protected]</code>: Returns the QModelIndex assocated with the given <code>item</code> in the given <code>column</code>.</li>
<li><code>int QTreeWidget::indexOfTopLevelItem(QTreeWidgetItem * item) const</code>: Returns the index of the given <code>top-level</code> <code>item</code>, or <code>-1</code> if the <code>item</code> cannot be found.</li>
<li><code>void QTreeWidget::insertTopLevelItem(int index, QTreeWidgetItem * item)</code>: Inserts the <code>item</code> at index in the top level in the view. If the <code>item</code> has already been inserted somewhere else it wont be inserted.</li>
<li><code>void QTreeWidget::insertTopLevelItems(int index, const QList&lt;QTreeWidgetItem *&gt; &amp; items)</code>: Inserts the list of <code>items</code> at index in the top level in the view. Items that have already been inserted somewhere else wont be inserted.</li>
<li><code>QTreeWidgetItem * QTreeWidget::invisibleRootItem() const</code>: Returns the tree widget’s invisible root item. The invisible root item provides access to the tree widget’s <code>top-level</code> items through the <code>QTreeWidgetItem</code> <code>API</code>, making it possible to write functions that can treat <code>top-level</code> items and their children in a uniform way; for example, recursive functions.</li>
<li><code>bool QTreeWidget::isFirstItemColumnSpanned(const QTreeWidgetItem * item) const</code>: Returns true if the given <code>item</code> is set to show only one section over all columns; otherwise returns false.</li>
<li><code>QTreeWidgetItem * QTreeWidget::itemAbove(const QTreeWidgetItem * item) const</code>: Returns the item above the given <code>item</code>.</li>
<li><code>void QTreeWidget::itemActivated(QTreeWidgetItem * item, int column) [signal]</code>: This signal is emitted when the user activates an <code>item</code> by <code>single-</code> or <code>double-clicking</code> (depending on the platform, i.e. on the <code>QStyle::SH_ItemView_ActivateItemOnSingleClick</code> style hint) or pressing a special key (e.g., Enter). The specified <code>item</code> is the item that was clicked, or <code>0</code> if no item was clicked. The <code>column</code> is the item’s column that was clicked, or <code>-1</code> if no item was clicked.</li>
<li><code>QTreeWidgetItem * QTreeWidget::itemAt(const QPoint &amp; p) const</code>: Returns a pointer to the item at the coordinates <code>p</code>. The coordinates are relative to the tree widget’s <code>viewport()</code>.</li>
<li><code>QTreeWidgetItem * QTreeWidget::itemAt(int x, int y) const</code>: This is an overloaded function. Returns a pointer to the item at the coordinates <code>(x, y)</code>. The coordinates are relative to the tree widget’s <code>viewport()</code>.</li>
<li><code>QTreeWidgetItem * QTreeWidget::itemBelow(const QTreeWidgetItem * item) const</code>: Returns the item visually below the given <code>item</code>.</li>
<li><code>void QTreeWidget::itemChanged(QTreeWidgetItem * item, int column) [signal]</code>: This signal is emitted when the contents of the <code>column</code> in the specified <code>item</code> changes.</li>
<li><code>void QTreeWidget::itemClicked(QTreeWidgetItem * item, int column) [signal]</code>: This signal is emitted when the user clicks inside the widget. The specified <code>item</code> is the item that was clicked. The <code>column</code> is the item’s column that was clicked. If no item was clicked, no signal will be emitted.</li>
<li><code>void QTreeWidget::itemCollapsed(QTreeWidgetItem * item) [signal]</code>: This signal is emitted when the specified <code>item</code> is collapsed so that none of its children are displayed. <strong>Note</strong>: This signal will not be emitted if an item changes its state when <code>collapseAll()</code> is invoked.</li>
<li><code>void QTreeWidget::itemDoubleClicked(QTreeWidgetItem * item, int column) [signal]</code>: This signal is emitted when the user double clicks inside the widget. The specified <code>item</code> is the item that was clicked, or 0 if no item was clicked. The <code>column</code> is the item’s column that was clicked. If no item was double clicked, no signal will be emitted.</li>
<li><code>void QTreeWidget::itemEntered(QTreeWidgetItem * item, int column) [signal]</code>: This signal is emitted when the mouse cursor enters an <code>item</code> over the specified <code>column</code>. <code>QTreeWidget</code> mouse tracking needs to be enabled for this feature to work.</li>
<li><code>void QTreeWidget::itemExpanded(QTreeWidgetItem * item) [signal]</code>: This signal is emitted when the specified <code>item</code> is expanded so that all of its children are displayed. <strong>Note</strong>: This signal will not be emitted if an item changes its state when <code>expandAll()</code> is invoked.</li>
<li><code>QTreeWidgetItem * QTreeWidget::itemFromIndex(const QModelIndex &amp; index) const [protected]</code>: Returns a pointer to the <code>QTreeWidgetItem</code> assocated with the given <code>index</code>.</li>
<li><code>void QTreeWidget::itemPressed(QTreeWidgetItem * item, int column) [signal]</code>: This signal is emitted when the user presses a mouse button inside the widget. The specified <code>item</code> is the item that was clicked, or <code>0</code> if no item was clicked. The <code>column</code> is the item’s column that was clicked, or <code>-1</code> if no item was clicked.</li>
<li><code>void QTreeWidget::itemSelectionChanged() [signal]</code>: This signal is emitted when the selection changes in the tree widget. The current selection can be found with <code>selectedItems()</code>.</li>
<li><code>QWidget * QTreeWidget::itemWidget(QTreeWidgetItem * item, int column) const</code>: Returns the widget displayed in the cell specified by <code>item</code> and the given <code>column</code>. <strong>Note</strong>: The tree takes ownership of the widget.</li>
<li><code>QMimeData * QTreeWidget::mimeData(const QList&lt;QTreeWidgetItem *&gt; items) const [virtual protected]</code>: Returns an object that contains a serialized description of the specified <code>items</code>. The format used to describe the items is obtained from the <code>mimeTypes()</code> function. If the list of <code>items</code> is empty, <code>0</code> is returned rather than a serialized empty list.</li>
<li><code>QStringList QTreeWidget::mimeTypes() const [virtual protected]</code>: Returns a list of <code>MIME</code> types that can be used to describe a list of treewidget items.</li>
<li><code>void QTreeWidget::openPersistentEditor(QTreeWidgetItem * item, int column = 0)</code>: Opens a persistent editor for the <code>item</code> in the given <code>column</code>.</li>
<li><code>void QTreeWidget::removeItemWidget(QTreeWidgetItem * item, int column)</code>: Removes the widget set in the given <code>item</code> in the given <code>column</code>.</li>
<li><code>void QTreeWidget::scrollToItem(const QTreeWidgetItem * item, QAbstractItemView::ScrollHint hint = EnsureVisible) [slot]</code>: Ensures that the <code>item</code> is visible, scrolling the view if necessary using the specified <code>hint</code>.</li>
<li><code>QList&lt;QTreeWidgetItem *&gt; QTreeWidget::selectedItems() const</code>: Returns a list of all selected <code>non-hidden</code> items.</li>
<li><code>void QTreeWidget::setCurrentItem(QTreeWidgetItem * item)</code>: Sets the current <code>item</code> in the tree widget. Unless the selection mode is <code>NoSelection</code>, the item is also be selected.</li>
<li><code>void QTreeWidget::setCurrentItem(QTreeWidgetItem * item, int column)</code>: Sets the current <code>item</code> in the tree widget and the current <code>column</code> to column.</li>
<li><code>void QTreeWidget::setCurrentItem(QTreeWidgetItem * item, int column, QItemSelectionModel::SelectionFlags command)</code>: Sets the current <code>item</code> in the tree widget and the current <code>column</code> to column, using the given <code>command</code>.</li>
<li><code>void QTreeWidget::setFirstItemColumnSpanned(const QTreeWidgetItem * item, bool span)</code>: Sets the given <code>item</code> to only show one section for all columns if <code>span</code> is <code>true</code>; otherwise the item will show one section per column.</li>
<li><code>void QTreeWidget::setHeaderItem(QTreeWidgetItem * item)</code>: Sets the header <code>item</code> for the tree widget. The label for each column in the header is supplied by the corresponding label in the item. The tree widget takes ownership of the item.</li>
<li><code>void QTreeWidget::setHeaderLabel(const QString &amp; label)</code>: Same as <code>setHeaderLabels(QStringList(label))</code>.</li>
<li><code>void QTreeWidget::setHeaderLabels(const QStringList &amp; labels)</code>: Adds a column in the header for each item in the <code>labels</code> list, and sets the label for each column. Note that <code>setHeaderLabels()</code> won’t remove existing columns.</li>
<li><code>void QTreeWidget::setItemWidget(QTreeWidgetItem * item, int column, QWidget * widget)</code>: Sets the given <code>widget</code> to be displayed in the cell specified by the given <code>item</code> and <code>column</code>. The given widget’s <code>autoFillBackground</code> property must be set to <code>true</code>, otherwise the widget’s background will be transparent, showing both the model data and the tree widget item. This function should only be used to display static content in the place of a tree widget item. If you want to display custom dynamic content or implement a custom editor widget, use <code>QTreeView</code> and subclass <code>QItemDelegate</code> instead. This function cannot be called before the item hierarchy has been set up, i.e., the <code>QTreeWidgetItem</code> that will hold widget must have been added to the view before widget is set. <strong>Note</strong>: The tree takes ownership of the widget.</li>
<li><code>void QTreeWidget::setSelectionModel(QItemSelectionModel * selectionModel) [virtual]</code>: Reimplemented from <code>QAbstractItemView::setSelectionModel()</code>.</li>
<li><code>int QTreeWidget::sortColumn() const</code>: Returns the column used to sort the contents of the widget.</li>
<li><code>void QTreeWidget::sortItems(int column, Qt::SortOrder order)</code>: Sorts the items in the widget in the specified <code>order</code> by the values in the given <code>column</code>.</li>
<li><code>Qt::DropActions QTreeWidget::supportedDropActions() const [virtual protected]</code>: Returns the drop actions supported by this view.</li>
<li><code>QTreeWidgetItem * QTreeWidget::takeTopLevelItem(int index)</code>: Removes the <code>top-level</code> item at the given <code>index</code> in the tree and returns it, otherwise returns <code>0</code>.</li>
<li><code>QTreeWidgetItem * QTreeWidget::topLevelItem(int index) const</code>: Returns the top level item at the given <code>index</code>, or <code>0</code> if the item does not exist.</li>
<li><code>QRect QTreeWidget::visualItemRect(const QTreeWidgetItem * item) const</code>: Returns the rectangle on the viewport occupied by the <code>item</code> at item.</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/22/Qt语法详解/Qt之QTextTableFormat/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/22/Qt语法详解/Qt之QTextTableFormat/" itemprop="url">Qt之QTextTableFormat</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-22T10:35:23+08:00">
                2019-02-22
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;The <code>QTextTableFormat</code> class provides formatting information for tables in a <code>QTextDocument</code>.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Header</th>
<th>Inherits</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QTextTableFormat</code></td>
<td><code>QTextFrameFormat</code></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Note</strong>: All functions in this class are reentrant.</p>
<h3 id="Public-Functions"><a href="#Public-Functions" class="headerlink" title="Public Functions"></a>Public Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><code>QTextTableFormat()</code></td>
</tr>
<tr>
<td><code>Qt::Alignment</code></td>
<td><code>alignment() const</code></td>
</tr>
<tr>
<td><code>qreal</code></td>
<td><code>cellPadding() const</code></td>
</tr>
<tr>
<td><code>qreal</code></td>
<td><code>cellSpacing() const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>clearColumnWidthConstraints()</code></td>
</tr>
<tr>
<td><code>QVector&lt;QTextLength&gt;</code></td>
<td><code>columnWidthConstraints() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>columns() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>headerRowCount() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isValid() const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setAlignment(Qt::Alignment alignment)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setCellPadding(qreal padding)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setCellSpacing(qreal spacing)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setColumnWidthConstraints(const QVector&lt;QTextLength&gt; &amp; constraints)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setHeaderRowCount(int count)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Detailed-Description"><a href="#Detailed-Description" class="headerlink" title="Detailed Description"></a>Detailed Description</h3><p>&emsp;&emsp;The <code>QTextTableFormat</code> class provides formatting information for tables in a <code>QTextDocument</code>.<br>&emsp;&emsp;A table is a group of cells ordered into rows and columns. Each table contains at least one row and one column. Each cell contains a block. Tables in rich text documents are formatted using the properties defined in this class.<br>&emsp;&emsp;Tables are horizontally justified within their parent frame according to the table’s alignment. This can be read with the <code>alignment()</code> function and set with <code>setAlignment()</code>.<br>&emsp;&emsp;Cells within the table are separated by cell spacing. The number of pixels between cells is set with <code>setCellSpacing()</code> and read with <code>cellSpacing()</code>. The contents of each cell is surrounded by cell padding. The number of pixels between each cell edge and its contents is set with <code>setCellPadding()</code> and read with <code>cellPadding()</code>.</p>
<p><img src="/2019/02/22/Qt语法详解/Qt之QTextTableFormat/1.png" height="154" width="219"></p>
<p>&emsp;&emsp;The table’s background color can be read with the <code>background()</code> function, and can be specified with <code>setBackground()</code>. The background color of each cell can be set independently, and will control the color of the cell within the padded area.<br>&emsp;&emsp;The table format also provides a way to constrain the widths of the columns in the table. Columns can be assigned a fixed width, a variable width, or a percentage of the available width. The <code>columns()</code> function returns the number of columns with constraints, and the <code>columnWidthConstraints()</code> function returns the constraints defined for the table. These quantities can also be set by calling <code>setColumnWidthConstraints()</code> with a vector containing new constraints. If no constraints are required, <code>clearColumnWidthConstraints()</code> can be used to remove them.</p>
<h3 id="Member-Function-Documentation"><a href="#Member-Function-Documentation" class="headerlink" title="Member Function Documentation"></a>Member Function Documentation</h3><ul>
<li><code>QTextTableFormat::QTextTableFormat()</code>: Constructs a new table format object.</li>
<li><code>Qt::Alignment QTextTableFormat::alignment() const</code>: Returns the table’s alignment.</li>
<li><code>qreal QTextTableFormat::cellPadding() const</code>: Returns the table’s cell padding. This describes the distance between the border of a cell and its contents.</li>
<li><code>qreal QTextTableFormat::cellSpacing() const</code>: Returns the table’s cell spacing. This describes the distance between adjacent cells.</li>
<li><code>void QTextTableFormat::clearColumnWidthConstraints()</code>: Clears the column width constraints for the table.</li>
<li><code>QVector&lt;QTextLength&gt; QTextTableFormat::columnWidthConstraints() const</code>: Returns a list of constraints used by this table format to control the appearance of columns in a table.</li>
<li><code>int QTextTableFormat::columns() const</code>: Returns the number of columns specified by the table format.</li>
<li><code>int QTextTableFormat::headerRowCount() const</code>: Returns the number of rows in the table that define the header.</li>
<li><code>bool QTextTableFormat::isValid() const</code>: Returns true if this table format is valid; otherwise returns false.</li>
<li><code>void QTextTableFormat::setAlignment(Qt::Alignment alignment)</code>: Sets the table’s <code>alignment</code>.</li>
<li><code>void QTextTableFormat::setCellPadding(qreal padding)</code>: Sets the cell <code>padding</code> for the table. This determines the distance between the border of a cell and its contents.</li>
<li><code>void QTextTableFormat::setCellSpacing(qreal spacing)</code>: Sets the cell <code>spacing</code> for the table. This determines the distance between adjacent cells.</li>
<li><code>void QTextTableFormat::setColumnWidthConstraints(const QVector&lt;QTextLength&gt; &amp; constraints)</code>: Sets the column width <code>constraints</code> for the table.</li>
<li><code>void QTextTableFormat::setHeaderRowCount(int count)</code>: Declares the first <code>count</code> rows of the table as table header. The table header rows get repeated when a table is broken across a page boundary.</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/21/Qt语法详解/Qt之QComboBox/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/21/Qt语法详解/Qt之QComboBox/" itemprop="url">Qt之QComboBox</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-21T16:23:06+08:00">
                2019-02-21
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>QComboBox</code>提供了下拉列表框的控件，下面简单地介绍几个的方法和属性。<br>&emsp;&emsp;<code>addItems</code>在列表的最后一项添加一个文本内容为<code>text</code>选项：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addItem</span> <span class="params">( <span class="keyword">const</span> QString &amp;text, <span class="keyword">const</span> QVariant &amp;userData = QVariant() )</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addItem</span> <span class="params">( <span class="keyword">const</span> QIcon &amp;icon, <span class="keyword">const</span> QString &amp;text, <span class="keyword">const</span> QVariant &amp;userData = QVariant() )</span></span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>currentText</code>返回下拉列表框中当前选中的文本：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QString <span class="title">currentText</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>count</code>返回当前列表框中选项数量：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>currentIndex</code>返回当前列表框中选中文本的序号：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">currentIndex</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"widget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QComboBox&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDebug&gt;</span></span></span><br><span class="line">​</span><br><span class="line">Widget::Widget ( QWidget *parent ) : QWidget ( parent ) &#123;</span><br><span class="line">    QComboBox *combobox = <span class="keyword">new</span> QComboBox ( <span class="keyword">this</span> );</span><br><span class="line">    combobox-&gt;addItem ( tr ( <span class="string">"Circle"</span> ) );</span><br><span class="line">    combobox-&gt;addItem ( tr ( <span class="string">"Pology"</span> ) );</span><br><span class="line">    QGridLayout *mainLayout = <span class="keyword">new</span> QGridLayout ( <span class="keyword">this</span> );</span><br><span class="line">    mainLayout-&gt;addWidget ( combobox, <span class="number">0</span>, <span class="number">0</span> );</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">"Now there are "</span> &lt;&lt; combobox-&gt;count() &lt;&lt; <span class="string">"Items"</span>;</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">"The current item is"</span> &lt;&lt; combobox-&gt;currentText();</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">Widget::~Widget() &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/21/Qt语法详解/Qt之QComboBox/1.png"></p>
<p>执行结果：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Now there are <span class="number">2</span> Items</span><br><span class="line">The current item is <span class="string">"Circle"</span></span><br></pre></td></tr></table></figure>
<hr>
<p>&emsp;&emsp;The <code>QComboBox</code> widget is a combined button and popup list.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Header</th>
<th>Inherits</th>
<th>Inherited By</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QComboBox</code></td>
<td><code>QWidget</code></td>
<td><code>QFontComboBox</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Public-Functions"><a href="#Public-Functions" class="headerlink" title="Public Functions"></a>Public Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><code>QComboBox(QWidget * parent = 0)</code></td>
</tr>
<tr>
<td></td>
<td><code>~QComboBox()</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>addItem(const QString &amp; text, const QVariant &amp; userData = QVariant())</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>addItem(const QIcon &amp; icon, const QString &amp; text, const QVariant &amp; userData = QVariant())</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>addItems(const QStringList &amp; texts)</code></td>
</tr>
<tr>
<td><code>QCompleter *</code></td>
<td><code>completer() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>count() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>currentIndex() const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>currentText() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>duplicatesEnabled() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>findData(const QVariant &amp; data, int role = Qt::UserRole, Qt::MatchFlags flags = static_cast<qt::matchflags> ( Qt::MatchExactly &#124; Qt::MatchCaseSensitive )) const<code \=""></code></qt::matchflags></code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>findText(const QString &amp; text, Qt::MatchFlags flags = static_cast<qt::matchflags> ( Qt::MatchExactly &#124; Qt::MatchCaseSensitive )) const<code \=""></code></qt::matchflags></code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>hasFrame() const</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>hidePopup()</code></td>
</tr>
<tr>
<td><code>QSize</code></td>
<td><code>iconSize() const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>insertItem(int index, const QString &amp; text, const QVariant &amp; userData = QVariant())</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>insertItem(int index, const QIcon &amp; icon, const QString &amp; text, const QVariant &amp; userData = QVariant())</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>insertItems(int index, const QStringList &amp; list)</code></td>
</tr>
<tr>
<td><code>InsertPolicy</code></td>
<td><code>insertPolicy() const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>insertSeparator(int index)</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isEditable() const</code></td>
</tr>
<tr>
<td><code>QVariant</code></td>
<td><code>itemData(int index, int role = Qt::UserRole) const</code></td>
</tr>
<tr>
<td><code>QAbstractItemDelegate *</code></td>
<td><code>itemDelegate() const</code></td>
</tr>
<tr>
<td><code>QIcon</code></td>
<td><code>itemIcon(int index) const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>itemText(int index) const</code></td>
</tr>
<tr>
<td><code>QLineEdit *</code></td>
<td><code>lineEdit() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>maxCount() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>maxVisibleItems() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>minimumContentsLength() const</code></td>
</tr>
<tr>
<td><code>QAbstractItemModel *</code></td>
<td><code>model() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>modelColumn() const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>removeItem(int index)</code></td>
</tr>
<tr>
<td><code>QModelIndex</code></td>
<td><code>rootModelIndex() const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setCompleter(QCompleter * completer)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setDuplicatesEnabled(bool enable)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setEditable(bool editable)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setFrame(bool)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setIconSize(const QSize &amp; size)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setInsertPolicy(InsertPolicy policy)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setItemData(int index, const QVariant &amp; value, int role = Qt::UserRole)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setItemDelegate(QAbstractItemDelegate * delegate)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setItemIcon(int index, const QIcon &amp; icon)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setItemText(int index, const QString &amp; text)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setLineEdit(QLineEdit * edit)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setMaxCount(int max)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setMaxVisibleItems(int maxItems)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setMinimumContentsLength(int characters)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setModel(QAbstractItemModel * model)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setModelColumn(int visibleColumn)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setRootModelIndex(const QModelIndex &amp; index)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setSizeAdjustPolicy(SizeAdjustPolicy policy)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setValidator(const QValidator * validator)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setView(QAbstractItemView * itemView)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>showPopup()</code></td>
</tr>
<tr>
<td><code>SizeAdjustPolicy</code></td>
<td><code>sizeAdjustPolicy() const</code></td>
</tr>
<tr>
<td><code>const QValidator *</code></td>
<td><code>validator() const</code></td>
</tr>
<tr>
<td><code>QAbstractItemView *</code></td>
<td><code>view() const</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Reimplemented-Public-Functions"><a href="#Reimplemented-Public-Functions" class="headerlink" title="Reimplemented Public Functions"></a>Reimplemented Public Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>virtual bool</code></td>
<td><code>event(QEvent * event)</code></td>
</tr>
<tr>
<td><code>virtual QSize</code></td>
<td><code>minimumSizeHint() const</code></td>
</tr>
<tr>
<td><code>virtual QSize</code></td>
<td><code>sizeHint() const</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Public-Slots"><a href="#Public-Slots" class="headerlink" title="Public Slots"></a>Public Slots</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>void</code></td>
<td><code>clear()</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>clearEditText()</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setCurrentIndex(int index)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setEditText(const QString &amp; text)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Signals"><a href="#Signals" class="headerlink" title="Signals"></a>Signals</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>void</code></td>
<td><code>activated(int index)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>activated(const QString &amp; text)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>currentIndexChanged(int index)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>currentIndexChanged(const QString &amp; text)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>editTextChanged(const QString &amp; text)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>highlighted(int index)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>highlighted(const QString &amp; text)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Protected-Functions"><a href="#Protected-Functions" class="headerlink" title="Protected Functions"></a>Protected Functions</h3><ul>
<li><code>void initStyleOption(QStyleOptionComboBox * option) const</code></li>
</ul>
<h3 id="Reimplemented-Protected-Functions"><a href="#Reimplemented-Protected-Functions" class="headerlink" title="Reimplemented Protected Functions"></a>Reimplemented Protected Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>virtual void</code></td>
<td><code>changeEvent(QEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>contextMenuEvent(QContextMenuEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>focusInEvent(QFocusEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>focusOutEvent(QFocusEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>hideEvent(QHideEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>inputMethodEvent(QInputMethodEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual QVariant</code></td>
<td><code>inputMethodQuery(Qt::InputMethodQuery query) const</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>keyPressEvent(QKeyEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>keyReleaseEvent(QKeyEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>mousePressEvent(QMouseEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>mouseReleaseEvent(QMouseEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>paintEvent(QPaintEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>resizeEvent(QResizeEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>showEvent(QShowEvent * e)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>wheelEvent(QWheelEvent * e)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Detailed-Description"><a href="#Detailed-Description" class="headerlink" title="Detailed Description"></a>Detailed Description</h3><p>&emsp;&emsp;The <code>QComboBox</code> widget is a combined button and popup list.<br>&emsp;&emsp;A <code>QComboBox</code> provides a means of presenting a list of options to the user in a way that takes up the minimum amount of screen space.<br>&emsp;&emsp;A combobox is a selection widget that displays the current item, and can pop up a list of selectable items. A combobox may be editable, allowing the user to modify each item in the list.<br>&emsp;&emsp;Comboboxes can contain pixmaps as well as strings; the <code>insertItem()</code> and <code>setItemText()</code> functions are suitably overloaded. For editable comboboxes, the function <code>clearEditText()</code> is provided, to clear the displayed string without changing the combobox’s contents.<br>&emsp;&emsp;There are two signals emitted if the current item of a combobox changes, <code>currentIndexChanged()</code> and <code>activated()</code>. <code>currentIndexChanged()</code> is always emitted regardless if the change was done programmatically or by user interaction, while <code>activated()</code> is only emitted when the change is caused by user interaction. The <code>highlighted()</code> signal is emitted when the user highlights an item in the combobox popup list. All three signals exist in two versions, one with a <code>QString</code> argument and one with an int argument. If the user selects or highlights a pixmap, only the int signals are emitted. Whenever the text of an editable combobox is changed the <code>editTextChanged()</code> signal is emitted.<br>&emsp;&emsp;When the user enters a new string in an editable combobox, the widget may or may not insert it, and it can insert it in several locations. The default policy is is <code>AtBottom</code> but you can change this using <code>setInsertPolicy()</code>.<br>&emsp;&emsp;It is possible to constrain the input to an editable combobox using <code>QValidator</code>; see <code>setValidator()</code>. By default, any input is accepted.<br>&emsp;&emsp;A combobox can be populated using the insert functions, <code>insertItem()</code> and <code>insertItems()</code> for example. Items can be changed with <code>setItemText()</code>. An item can be removed with <code>removeItem()</code> and all items can be removed with <code>clear()</code>. The text of the current item is returned by <code>currentText()</code>, and the text of a numbered item is returned with <code>text()</code>. The current item can be set with <code>setCurrentIndex()</code>. The number of items in the combobox is returned by <code>count()</code>; the maximum number of items can be set with <code>setMaxCount()</code>. You can allow editing using <code>setEditable()</code>. For editable comboboxes you can set <code>auto-completion</code> using <code>setCompleter()</code> and whether or not the user can add duplicates is set with <code>setDuplicatesEnabled()</code>.<br>&emsp;&emsp;<code>QComboBox</code> uses the <code>model/view</code> framework for its popup list and to store its items. By default a <code>QStandardItemModel</code> stores the items and a <code>QListView</code> subclass displays the popuplist. You can access the model and view directly (with <code>model()</code> and <code>view()</code>), but <code>QComboBox</code> also provides functions to set and get item data (e.g., <code>setItemData()</code> and <code>itemText()</code>). You can also set a new model and view (with <code>setModel()</code> and <code>setView()</code>). For the text and icon in the combobox label, the data in the model that has the <code>Qt::DisplayRole</code> and <code>Qt::DecorationRole</code> is used. Note that you cannot alter the <code>SelectionMode</code> of the <code>view()</code>, e.g., by using <code>setSelectionMode()</code>.</p>
<p><img src="/2019/02/21/Qt语法详解/Qt之QComboBox/2.png"></p>
<h3 id="Member-Type-Documentation"><a href="#Member-Type-Documentation" class="headerlink" title="Member Type Documentation"></a>Member Type Documentation</h3><ul>
<li>enum <code>QComboBox::InsertPolicy</code>: This enum specifies what the <code>QComboBox</code> should do when a new string is entered by the user.</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>Constant</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QComboBox::NoInsert</code></td>
<td><code>0</code></td>
<td>The string will not be inserted into the combobox.</td>
</tr>
<tr>
<td><code>QComboBox::InsertAtTop</code></td>
<td><code>1</code></td>
<td>The string will be inserted as the first item in the combobox.</td>
</tr>
<tr>
<td><code>QComboBox::InsertAtCurrent</code></td>
<td><code>2</code></td>
<td>The current item will be replaced by the string.</td>
</tr>
<tr>
<td><code>QComboBox::InsertAtBottom</code></td>
<td><code>3</code></td>
<td>The string will be inserted after the last item in the combobox.</td>
</tr>
<tr>
<td><code>QComboBox::InsertAfterCurrent</code></td>
<td><code>4</code></td>
<td>The string is inserted after the current item in the combobox.</td>
</tr>
<tr>
<td><code>QComboBox::InsertBeforeCurrent</code></td>
<td><code>5</code></td>
<td>The string is inserted before the current item in the combobox.</td>
</tr>
<tr>
<td><code>QComboBox::InsertAlphabetically</code></td>
<td><code>6</code></td>
<td>The string is inserted in the alphabetic order in the combobox.</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>enum <code>QComboBox::SizeAdjustPolicy</code>: This enum specifies how the size hint of the <code>QComboBox</code> should adjust when new content is added or content changes.</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>Constant</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QComboBox::AdjustToContents</code></td>
<td><code>0</code></td>
<td>The combobox will always adjust to the contents</td>
</tr>
<tr>
<td><code>QComboBox::AdjustToContentsOnFirstShow</code></td>
<td><code>1</code></td>
<td>The combobox will adjust to its contents the first time it is shown.</td>
</tr>
<tr>
<td><code>QComboBox::AdjustToMinimumContentsLength</code></td>
<td><code>2</code></td>
<td>Use <code>AdjustToContents</code> or <code>AdjustToContentsOnFirstShow</code> instead.</td>
</tr>
<tr>
<td><code>QComboBox::AdjustToMinimumContentsLengthWithIcon</code></td>
<td><code>3</code></td>
<td>The combobox will adjust to <code>minimumContentsLength</code> plus space for an icon. For performance reasons use this policy on large models.</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Property-Documentation"><a href="#Property-Documentation" class="headerlink" title="Property Documentation"></a>Property Documentation</h3><ul>
<li><code>count : const int</code>: This property holds the number of items in the combobox. By default, for an empty combo box, this property has a value of <code>0</code>. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">()</span> <span class="keyword">const</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>currentIndex : int</code>: This property holds the index of the current item in the combobox. The current index can change when inserting or removing items. By default, for an empty combo box or a combo box in which no current item is set, this property has a value of <code>-1</code>. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">currentIndex</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setCurrentIndex</span> <span class="params">( <span class="keyword">int</span> index )</span></span></span><br></pre></td></tr></table></figure>
<p>Notifier signal:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">currentIndexChanged</span> <span class="params">( <span class="keyword">int</span> index )</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">currentIndexChanged</span> <span class="params">( <span class="keyword">const</span> QString &amp;text )</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>currentText : const QString</code>: This property holds the current text. If the combo box is editable, the current text is the value displayed by the line edit. Otherwise, it is the value of the current item or an empty string if the combo box is empty or no current item is set. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QString <span class="title">currentText</span><span class="params">()</span> <span class="keyword">const</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>duplicatesEnabled : bool</code>: This property holds whether the user can enter duplicate items into the combobox. Note that it is always possible to programmatically insert duplicate items into the combobox. By default, this property is false (duplicates are not allowed). Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">duplicatesEnabled</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setDuplicatesEnabled</span> <span class="params">( <span class="keyword">bool</span> enable )</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>editable : bool</code>: This property holds whether the combo box can be edited by the user. By default, this property is false. The effect of editing depends on the insert policy. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isEditable</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setEditable</span> <span class="params">( <span class="keyword">bool</span> editable )</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>frame : bool</code>: This property holds whether the combo box draws itself with a frame. If enabled (the default) the combo box draws itself inside a frame, otherwise the combo box draws itself without any frame. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">hasFrame</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setFrame</span> <span class="params">( <span class="keyword">bool</span> )</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>iconSize : QSize</code>: This property holds the size of the icons shown in the combobox. Unless explicitly set this returns the default value of the current style. This size is the maximum size that icons can have; icons of smaller size are not scaled up. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QSize <span class="title">iconSize</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setIconSize</span> <span class="params">( <span class="keyword">const</span> QSize &amp;size )</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>insertPolicy : InsertPolicy</code>: This property holds the policy used to determine where <code>user-inserted</code> items should appear in the combobox. The default value is <code>AtBottom</code>, indicating that new items will appear at the bottom of the list of items. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">InsertPolicy <span class="title">insertPolicy</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setInsertPolicy</span> <span class="params">( InsertPolicy policy )</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>maxCount : int</code>: This property holds the maximum number of items allowed in the combobox. <strong>Note</strong>: If you set the maximum number to be less then the current amount of items in the combobox, the extra items will be truncated. This also applies if you have set an external model on the combobox. By default, this property’s value is derived from the highest signed integer available (typically <code>2147483647</code>). Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxCount</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setMaxCount</span> <span class="params">( <span class="keyword">int</span> max )</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>maxVisibleItems : int</code>: This property holds the maximum allowed size on screen of the combo box, measured in items. By default, this property has a value of <code>10</code>. <strong>Note</strong>: This property is ignored for <code>non-editable</code> comboboxes in styles that returns true for <code>QStyle::SH_ComboBox_Popup</code> such as the <code>Mac</code> style or the <code>Gtk+</code> Style. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">maxVisibleItems</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setMaxVisibleItems</span> <span class="params">( <span class="keyword">int</span> maxItems )</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>minimumContentsLength : int</code>: This property holds the minimum number of characters that should fit into the combobox. The default value is <code>0</code>. If this property is set to a positive value, the <code>minimumSizeHint()</code> and <code>sizeHint()</code> take it into account. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">minimumContentsLength</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setMinimumContentsLength</span> <span class="params">( <span class="keyword">int</span> characters )</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>modelColumn : int</code>: This property holds the column in the model that is visible. If set prior to populating the combo box, the <code>pop-up</code> view will not be affected and will show the first column (using this property’s default value). By default, this property has a value of <code>0</code>. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">modelColumn</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setModelColumn</span> <span class="params">( <span class="keyword">int</span> visibleColumn )</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>sizeAdjustPolicy : SizeAdjustPolicy</code>: This property holds the policy describing how the size of the combobox changes when the content changes. The default value is <code>AdjustToContentsOnFirstShow</code>. Access functions:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">SizeAdjustPolicy <span class="title">sizeAdjustPolicy</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setSizeAdjustPolicy</span> <span class="params">( SizeAdjustPolicy policy )</span></span></span><br></pre></td></tr></table></figure>
<h3 id="Member-Function-Documentation"><a href="#Member-Function-Documentation" class="headerlink" title="Member Function Documentation"></a>Member Function Documentation</h3><ul>
<li><code>QComboBox::QComboBox(QWidget * parent = 0)</code>: Constructs a combobox with the given <code>parent</code>, using the default model <code>QStandardItemModel</code>.</li>
<li><code>QComboBox::~QComboBox()</code>: Destroys the combobox.</li>
<li><code>void QComboBox::activated(int index) [signal]</code>: This signal is sent when the user chooses an item in the combobox. The item’s <code>index</code> is passed. Note that this signal is sent even when the choice is not changed. If you need to know when the choice actually changes, use signal <code>currentIndexChanged()</code>.</li>
<li><code>void QComboBox::activated(const QString &amp; text) [signal]</code>: This signal is sent when the user chooses an item in the combobox. The item’s <code>text</code> is passed. Note that this signal is sent even when the choice is not changed. If you need to know when the choice actually changes, use signal <code>currentIndexChanged()</code>.</li>
<li><code>void QComboBox::addItem(const QString &amp; text, const QVariant &amp; userData = QVariant())</code>: Adds an item to the combobox with the given <code>text</code>, and containing the specified <code>userData</code> (stored in the <code>Qt::UserRole</code>). The item is appended to the list of existing items.</li>
<li><code>void QComboBox::addItem(const QIcon &amp; icon, const QString &amp; text, const QVariant &amp; userData = QVariant())</code>: Adds an item to the combobox with the given <code>icon</code> and <code>text</code>, and containing the specified <code>userData</code> (stored in the <code>Qt::UserRole</code>). The item is appended to the list of existing items.</li>
<li><code>void QComboBox::addItems(const QStringList &amp; texts)</code>: Adds each of the strings in the given <code>texts</code> to the combobox. Each item is appended to the list of existing items in turn.  </li>
<li><code>void QComboBox::changeEvent(QEvent * e) [virtual protected]</code>: Reimplemented from <code>QWidget::changeEvent()</code>.</li>
<li><code>void QComboBox::clear() [slot]</code>: Clears the combobox, removing all items. <strong>Note</strong>: If you have set an external model on the combobox this model will still be cleared when calling this function.</li>
<li><code>void QComboBox::clearEditText() [slot]</code>: Clears the contents of the line edit used for editing in the combobox.</li>
<li><code>QCompleter * QComboBox::completer() const</code>: Returns the completer that is used to auto complete text input for the combobox.</li>
<li><code>void QComboBox::contextMenuEvent(QContextMenuEvent * e) [virtual protected]</code>: Reimplemented from <code>QWidget::contextMenuEvent()</code>.</li>
<li><code>void QComboBox::editTextChanged(const QString &amp; text) [signal]</code>: This signal is emitted when the <code>text</code> in the combobox’s line edit widget is changed. The new text is specified by <code>text</code>.</li>
<li><code>bool QComboBox::event(QEvent * event) [virtual]</code>: Reimplemented from <code>QObject::event()</code>.</li>
<li><code>int QComboBox::findData(const QVariant &amp; data, int role = Qt::UserRole, Qt::MatchFlags flags = static_cast&lt;Qt::MatchFlags&gt; ( Qt::MatchExactly | Qt::MatchCaseSensitive )) const</code>: Returns the index of the item containing the given <code>data</code> for the given <code>role</code>; otherwise returns <code>-1</code>. The <code>flags</code> specify how the items in the combobox are searched.</li>
<li><code>int QComboBox::findText(const QString &amp; text, Qt::MatchFlags flags = static_cast&lt;Qt::MatchFlags&gt; ( Qt::MatchExactly | Qt::MatchCaseSensitive )) const</code>: Returns the index of the item containing the given <code>text</code>; otherwise returns <code>-1</code>. The <code>flags</code> specify how the items in the combobox are searched.</li>
<li><code>void QComboBox::focusInEvent(QFocusEvent * e) [virtual protected]</code>: Reimplemented from <code>QWidget::focusInEvent()</code>.</li>
<li><code>void QComboBox::focusOutEvent(QFocusEvent * e) [virtual protected]</code>: Reimplemented from <code>QWidget::focusOutEvent()</code>.</li>
<li><code>void QComboBox::hideEvent(QHideEvent * e) [virtual protected]</code>: Reimplemented from <code>QWidget::hideEvent()</code>.</li>
<li><code>void QComboBox::hidePopup() [virtual]</code>: Hides the list of items in the combobox if it is currently visible and resets the internal state, so that if the custom <code>pop-up</code> was shown inside the reimplemented <code>showPopup()</code>, then you also need to reimplement the <code>hidePopup()</code> function to hide your custom <code>pop-up</code> and call the base class implementation to reset the internal state whenever your custom <code>pop-up</code> widget is hidden.</li>
<li><code>void QComboBox::highlighted(int index) [signal]</code>: This signal is sent when an item in the combobox popup list is highlighted by the user. The item’s <code>index</code> is passed.</li>
<li><code>void QComboBox::highlighted(const QString &amp; text) [signal]</code>: This signal is sent when an item in the combobox popup list is highlighted by the user. The item’s <code>text</code> is passed.</li>
<li><code>void QComboBox::initStyleOption(QStyleOptionComboBox * option) const [protected]</code>:  Initialize <code>option</code> with the values from this <code>QComboBox</code>. This method is useful for subclasses when they need a <code>QStyleOptionComboBox</code>, but don’t want to fill in all the information themselves.</li>
<li><code>void QComboBox::inputMethodEvent(QInputMethodEvent * e) [virtual protected]</code>: Reimplemented from <code>QWidget::inputMethodEvent()</code>.</li>
<li><code>QVariant QComboBox::inputMethodQuery(Qt::InputMethodQuery query) const [virtual protected]</code>: Reimplemented from <code>QWidget::inputMethodQuery()</code>.</li>
<li><code>void QComboBox::insertItem(int index, const QString &amp; text, const QVariant &amp; userData = QVariant())</code>: Inserts the <code>text</code> and <code>userData</code> (stored in the <code>Qt::UserRole</code>) into the combobox at the given <code>index</code>. If the <code>index</code> is equal to or higher than the total number of items, the new item is appended to the list of existing items. If the <code>index</code> is <code>0</code> or negative, the new item is prepended to the list of existing items.</li>
<li><code>void QComboBox::insertItem(int index, const QIcon &amp; icon, const QString &amp; text, const QVariant &amp; userData = QVariant())</code>: Inserts the <code>icon</code>, <code>text</code> and <code>userData</code> (stored in the <code>Qt::UserRole</code>) into the combobox at the given <code>index</code>. If the <code>index</code> is equal to or higher than the total number of items, the new item is appended to the list of existing items. If the <code>index</code> is <code>0</code> or negative, the new item is prepended to the list of existing items.</li>
<li><p><code>void QComboBox::insertItems(int index, const QStringList &amp; list)</code>: Inserts the strings from the <code>list</code> into the combobox as separate items, starting at the <code>index</code> specified. If the <code>index</code> is equal to or higher than the total number of items, the new items are appended to the list of existing items. If the <code>index</code> is <code>0</code> or negative, the new items are prepended to the list of existing items.</p>
</li>
<li><p><code>void QComboBox::insertSeparator(int index)</code>: Inserts a separator item into the combobox at the given index. If the index is equal to or higher than the total number of items, the new item is appended to the list of existing items. If the index is zero or negative, the new item is prepended to the list of existing items.</p>
</li>
<li><code>QVariant QComboBox::itemData(int index, int role = Qt::UserRole) const</code>: Returns the data for the given role in the given index in the combobox, or QVariant::Invalid if there is no data for this role.</li>
<li><code>QAbstractItemDelegate * QComboBox::itemDelegate() const</code>: Returns the item delegate used by the popup list view.</li>
<li><code>QIcon QComboBox::itemIcon(int index) const</code>: Returns the icon for the given index in the combobox.</li>
<li><code>QString QComboBox::itemText(int index) const</code>: Returns the text for the given index in the combobox.</li>
<li><code>void QComboBox::keyPressEvent(QKeyEvent * e) [virtual protected]</code>: Reimplemented from QWidget::keyPressEvent().</li>
<li><code>void QComboBox::keyReleaseEvent(QKeyEvent * e) [virtual protected]</code>: Reimplemented from QWidget::keyReleaseEvent().</li>
<li><code>QLineEdit * QComboBox::lineEdit() const</code>: Returns the line edit used to edit items in the combobox, or 0 if there is no line edit. Only editable combo boxes have a line edit.</li>
<li><code>QSize QComboBox::minimumSizeHint() const [virtual]</code>: Reimplemented from QWidget::minimumSizeHint().</li>
<li><code>QAbstractItemModel * QComboBox::model() const</code>: Returns the model used by the combobox.</li>
<li><code>void QComboBox::mousePressEvent(QMouseEvent * e) [virtual protected]</code>: Reimplemented from QWidget::mousePressEvent().</li>
<li><code>void QComboBox::mouseReleaseEvent(QMouseEvent * e) [virtual protected]</code>: Reimplemented from QWidget::mouseReleaseEvent().</li>
<li><code>void QComboBox::paintEvent(QPaintEvent * e) [virtual protected]</code>: Reimplemented from QWidget::paintEvent().</li>
<li><code>void QComboBox::removeItem(int index)</code>: Removes the item at the given index from the combobox. This will update the current index if the index is removed. This function does nothing if index is out of range.</li>
<li><code>void QComboBox::resizeEvent(QResizeEvent * e) [virtual protected]</code>: Reimplemented from QWidget::resizeEvent().</li>
<li><code>QModelIndex QComboBox::rootModelIndex() const</code>: Returns the root model item index for the items in the combobox.</li>
<li><code>void QComboBox::setCompleter(QCompleter * completer)</code>: Sets the completer to use instead of the current completer. If completer is 0, auto completion is disabled. By default, for an editable combo box, a QCompleter that performs case insensitive inline completion is automatically created.</li>
<li><code>void QComboBox::setEditText(const QString &amp; text) [slot]</code>: Sets the text in the combobox’s text edit.</li>
<li><code>void QComboBox::setItemData(int index, const QVariant &amp; value, int role = Qt::UserRole)</code>: Sets the data role for the item on the given index in the combobox to the specified value.</li>
<li><code>void QComboBox::setItemDelegate(QAbstractItemDelegate * delegate)</code>: Sets the item delegate for the popup list view. The combobox takes ownership of the delegate. Warning: You should not share the same instance of a delegate between comboboxes, widget mappers or views. Doing so can cause incorrect or unintuitive editing behavior since each view connected to a given delegate may receive the closeEditor() signal, and attempt to access, modify or close an editor that has already been closed.</li>
<li><code>void QComboBox::setItemIcon(int index, const QIcon &amp; icon)</code>: Sets the icon for the item on the given index in the combobox.</li>
<li><code>void QComboBox::setItemText(int index, const QString &amp; text)</code>: Sets the text for the item on the given index in the combobox.</li>
<li><code>void QComboBox::setLineEdit(QLineEdit * edit)</code>: Sets the line edit to use instead of the current line edit widget. The combo box takes ownership of the line edit.</li>
<li><code>void QComboBox::setModel(QAbstractItemModel * model)</code>: Sets the model to be model. model must not be 0. If you want to clear the contents of a model, call clear().</li>
<li><code>void QComboBox::setRootModelIndex(const QModelIndex &amp; index)</code>: Sets the root model item index for the items in the combobox.</li>
<li><code>void QComboBox::setValidator(const QValidator * validator)</code>: Sets the validator to use instead of the current validator.</li>
<li><code>void QComboBox::setView(QAbstractItemView * itemView)</code>: Sets the view to be used in the combobox popup to the given itemView. The combobox takes ownership of the view. Note: If you want to use the convenience views (like QListWidget, QTableWidget or QTreeWidget), make sure to call setModel() on the combobox with the convenience widgets model before calling this function.</li>
<li><code>void QComboBox::showEvent(QShowEvent * e) [virtual protected]</code>: Reimplemented from QWidget::showEvent().</li>
<li><code>void QComboBox::showPopup() [virtual]</code>: Displays the list of items in the combobox. If the list is empty then the no items will be shown. If you reimplement this function to show a custom pop-up, make sure you call hidePopup() to reset the internal state.</li>
<li><code>QSize QComboBox::sizeHint() const [virtual]</code>: Reimplemented from QWidget::sizeHint(). This implementation caches the size hint to avoid resizing when the contents change dynamically. To invalidate the cached value change the sizeAdjustPolicy.</li>
<li><code>const QValidator * QComboBox::validator() const</code>: Returns the validator that is used to constrain text input for the combobox.</li>
<li><code>QAbstractItemView * QComboBox::view() const</code>: Returns the list view used for the combobox popup.</li>
<li><code>void QComboBox::wheelEvent(QWheelEvent * e) [virtual protected]</code>: Reimplemented from QWidget::wheelEvent().</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/17/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><span class="page-number current">18</span><a class="page-number" href="/page/19/">19</a><span class="space">&hellip;</span><a class="page-number" href="/page/95/">95</a><a class="extend next" rel="next" href="/page/19/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">付康为</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">943</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">付康为</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
