<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="泥腿子出身">
<meta property="og:url" content="http://fukangwei.gitee.io/page/17/index.html">
<meta property="og:site_name" content="泥腿子出身">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="泥腿子出身">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '561O3H1PZB',
      apiKey: '7631d3cf19ac49bd39ada7163ec937a7',
      indexName: 'fuxinzi',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="http://fukangwei.gitee.io/page/17/">





  <title>泥腿子出身</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">泥腿子出身</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/24/Node_JS/事件循环/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/24/Node_JS/事件循环/" itemprop="url">事件循环</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-24T15:18:19+08:00">
                2019-02-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>Node.js</code>是单进程单线程应用程序，但是因为<code>V8</code>引擎提供的异步执行回调接口，通过这些接口可以处理大量的并发，所以性能非常高。<code>Node.js</code>基本上所有的事件机制都是用设计模式中观察者模式实现。</p>
<h3 id="事件驱动程序"><a href="#事件驱动程序" class="headerlink" title="事件驱动程序"></a>事件驱动程序</h3><p>&emsp;&emsp;<code>Node.js</code>使用事件驱动模型，这个模型非常高效且可扩展性非常强，因为<code>webserver</code>一直接受请求而不等待任何读写操作(这也被称之为非阻塞式<code>I/O</code>或者事件驱动<code>I/O</code>)。在事件驱动模型中，会生成一个主循环来监听事件，当检测到事件时触发回调函数：</p>
<p><img src="/2019/02/24/Node_JS/事件循环/1.png" height="120" width="313"></p>
<p>&emsp;&emsp;有些类似于观察者模式，事件相当于一个主题(<code>Subject</code>)，而所有注册到这个事件上的处理函数相当于观察者(<code>Observer</code>)。<code>Node.js</code>有多个内置的事件，我们可以通过引入<code>events</code>模块，并通过实例化<code>EventEmitter</code>类来绑定和监听事件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> events = <span class="built_in">require</span>(<span class="string">'events'</span>); <span class="comment">/* 引入events模块 */</span></span><br><span class="line"><span class="keyword">var</span> eventEmitter = <span class="keyword">new</span> events.EventEmitter(); <span class="comment">/* 创建eventEmitter对象 */</span></span><br></pre></td></tr></table></figure>
<p>以下程序绑定事件处理程序：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eventEmitter.on(<span class="string">'eventName'</span>, eventHandler); <span class="comment">/* 绑定事件以及事件的处理程序 */</span></span><br></pre></td></tr></table></figure>
<p>我们可以通过程序触发事件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eventEmitter.emit(<span class="string">'eventName'</span>); <span class="comment">/* 触发事件 */</span></span><br></pre></td></tr></table></figure>
<p>创建<code>main.js</code>文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> events = <span class="built_in">require</span>(<span class="string">'events'</span>); <span class="comment">/* 引入events模块 */</span></span><br><span class="line"><span class="keyword">var</span> eventEmitter = <span class="keyword">new</span> events.EventEmitter(); <span class="comment">/* 创建eventEmitter对象 */</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">var</span> connectHandler = <span class="function"><span class="keyword">function</span> <span class="title">connected</span>(<span class="params"></span>) </span>&#123; <span class="comment">/* 创建事件处理程序 */</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'连接成功。'</span>);</span><br><span class="line">    eventEmitter.emit(<span class="string">'data_received'</span>); <span class="comment">/* 触发data_received事件 */</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="comment">/* 绑定connection事件处理程序 */</span></span><br><span class="line">eventEmitter.on(<span class="string">'connection'</span>, connectHandler);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 使用匿名函数绑定data_received事件 */</span></span><br><span class="line">eventEmitter.on(<span class="string">'data_received'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'数据接收成功。'</span>);</span><br><span class="line">&#125;);</span><br><span class="line">​</span><br><span class="line">eventEmitter.emit(<span class="string">'connection'</span>); <span class="comment">/* 触发connection事件 */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"程序执行完毕。"</span>);</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">连接成功。</span><br><span class="line">数据接收成功。</span><br><span class="line">程序执行完毕。</span><br></pre></td></tr></table></figure>
<h3 id="Node应用程序是如何工作的？"><a href="#Node应用程序是如何工作的？" class="headerlink" title="Node应用程序是如何工作的？"></a>Node应用程序是如何工作的？</h3><p>&emsp;&emsp;在<code>Node.js</code>应用程序中，执行异步操作的函数将回调函数作为最后一个参数，回调函数接收错误对象作为第一个参数。<br>&emsp;&emsp;创建<code>input.txt</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">菜鸟教程官网地址：www.runoob.com</span><br></pre></td></tr></table></figure>
<p>创建<code>main.js</code>文件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line">​</span><br><span class="line">fs.readFile(<span class="string">'input.txt'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err.stack);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(data.toString());</span><br><span class="line">&#125;);</span><br><span class="line">​</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"程序执行完毕"</span>);</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">程序执行完毕</span><br><span class="line">菜鸟教程官网地址：www.runoob.com</span><br></pre></td></tr></table></figure>
<p><code>fs.readFile</code>是异步函数，用于读取文件，如果在读取文件过程中发生错误，错误<code>err</code>对象就会输出错误信息。如果没有发生错误，<code>readFile</code>跳过<code>err</code>对象的输出，文件内容就通过回调函数输出。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/24/Python语法/csv模块/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/24/Python语法/csv模块/" itemprop="url">csv模块</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-24T13:21:56+08:00">
                2019-02-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;逗号分隔值(<code>Comma Separated Values</code>，有时也称为<code>字符分隔值</code>，因为分隔字符也可以不是逗号)，其文件以纯文本形式存储表格数据(数字和文本)。<code>CSV</code>文件由任意数目的记录组成，记录间以某种换行符分隔；每条记录由字段组成，字段间的分隔符是其它字符或字符串，最常见的是逗号或制表符。通常，所有记录都有完全相同的字段序列。<br>&emsp;&emsp;每条记录占一行，以逗号为分隔符，逗号前后的空格会被忽略。如果字段中包含有逗号、换行符，该字段必须用双引号括起来；如果字段前后包含有空格，该字段必须用双引号括起来；字段中的双引号用两个双引号表示。第一条记录，可以是字段名。<br>&emsp;&emsp;有以下表格：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>年</th>
<th>制造商</th>
<th>型号</th>
<th>说明</th>
<th>价值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>1997</code></td>
<td><code>Ford</code></td>
<td><code>E350</code></td>
<td><code>ac, abs, moon</code></td>
<td><code>3000.00</code></td>
</tr>
<tr>
<td><code>1999</code></td>
<td><code>Chevy</code></td>
<td><code>Venture &quot;Extended Edition&quot;</code></td>
<td></td>
<td><code>4900.00</code></td>
</tr>
<tr>
<td><code>1999</code></td>
<td><code>Chevy</code></td>
<td><code>Venture &quot;Extended Edition, Very Large&quot;</code></td>
<td></td>
<td><code>5000.00</code></td>
</tr>
<tr>
<td><code>1996</code></td>
<td><code>Jeep</code></td>
<td><code>Grand Cherokee</code></td>
<td><code>MUST SELL!</code></td>
<td><code>4799.00</code></td>
</tr>
</tbody>
</table>
</div>
<p>上面表格内容若以<code>CSV</code>格式表示，就会像下列：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">年,制造商,型号,说明,价值</span><br><span class="line"><span class="number">1997</span>,Ford,E350,<span class="string">"ac, abs, moon"</span>,<span class="number">3000.00</span></span><br><span class="line"><span class="number">1999</span>,Chevy,<span class="string">"Venture "</span><span class="string">"Extended Edition"</span><span class="string">""</span>,<span class="string">""</span>,<span class="number">4900.00</span></span><br><span class="line"><span class="number">1999</span>,Chevy,<span class="string">"Venture "</span><span class="string">"Extended Edition, Very Large"</span><span class="string">""</span>,<span class="string">""</span>,<span class="number">5000.00</span></span><br><span class="line"><span class="number">1996</span>,Jeep,Grand Cherokee,<span class="string">"MUST SELL!"</span>,<span class="number">4799.00</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;The <code>so-called</code> <code>CSV</code> (<code>Comma Separated Values</code>) format is the most common import and export format for spreadsheets and databases. <code>CSV</code> format was used for many years prior to attempts to describe the format in a standardized way in <code>RFC 4180</code>. The lack of a <code>well-defined</code> standard means that subtle differences often exist in the data produced and consumed by different applications. These differences can make it annoying to process <code>CSV</code> files from multiple sources. Still, while the delimiters and quoting characters vary, the overall format is similar enough that it is possible to write a single module which can efficiently manipulate such data, hiding the details of reading and writing the data from the programmer.<br>&emsp;&emsp;The csv module implements classes to read and write tabular data in <code>CSV</code> format. It allows programmers to say, <code>write this data in the format preferred by Excel,</code> or <code>read data from this file which was generated by Excel,</code> without knowing the precise details of the <code>CSV</code> format used by <code>Excel</code>. Programmers can also describe the <code>CSV</code> formats understood by other applications or define their own <code>special-purpose</code> <code>CSV</code> formats.<br>&emsp;&emsp;The csv module’s reader and writer objects read and write sequences. Programmers can also read and write data in dictionary form using the <code>DictReader</code> and <code>DictWriter</code> classes.</p>
<h3 id="Module-Contents"><a href="#Module-Contents" class="headerlink" title="Module Contents"></a>Module Contents</h3><p>&emsp;&emsp;The csv module defines the following functions:</p>
<ul>
<li><code>csv.reader(csvfile, dialect=&#39;excel&#39;, **fmtparams)</code>: Return a reader object which will iterate over lines in the given <code>csvfile</code>. <code>csvfile</code> can be any object which supports the iterator protocol and returns a string each time its <code>__next__()</code> method is called: file objects and list objects are both suitable. If <code>csvfile</code> is a file object, it should be opened with <code>newline=&#39;&#39;</code>. An optional <code>dialect</code> parameter can be given which is used to define a set of parameters specific to a particular <code>CSV</code> <code>dialect</code>. It may be an instance of a subclass of the Dialect class or one of the strings returned by the <code>list_dialects()</code> function. The other optional <code>fmtparams</code> keyword arguments can be given to override individual formatting parameters in the current <code>dialect</code>.</li>
</ul>
<p>&emsp;&emsp;Each row read from the csv file is returned as a list of strings. No automatic data type conversion is performed unless the <code>QUOTE_NONNUMERIC</code> format option is specified (in which case unquoted fields are transformed into floats).<br>&emsp;&emsp;A short usage example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> csv</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> open(<span class="string">'eggs.csv'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line"><span class="meta">... </span>    spamreader = csv.reader(csvfile, delimiter=<span class="string">' '</span>, quotechar=<span class="string">'|'</span>)</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">for</span> row <span class="keyword">in</span> spamreader:</span><br><span class="line"><span class="meta">... </span>        print(<span class="string">', '</span>.join(row))</span><br><span class="line">Spam, Spam, Spam, Spam, Spam, Baked Beans</span><br><span class="line">Spam, Lovely Spam, Wonderful Spam</span><br></pre></td></tr></table></figure>
<ul>
<li><code>csv.writer(csvfile, dialect=&#39;excel&#39;, **fmtparams)</code>: Return a writer object responsible for converting the user’s data into delimited strings on the given <code>file-like</code> object. <code>csvfile</code> can be any object with a <code>write()</code> method. If <code>csvfile</code> is a file object, it should be opened with <code>newline=&#39;&#39;</code>. An optional <code>dialect</code> parameter can be given which is used to define a set of parameters specific to a particular <code>CSV</code> <code>dialect</code>. It may be an instance of a subclass of the <code>Dialect</code> class or one of the strings returned by the <code>list_dialects()</code> function. The other optional <code>fmtparams</code> keyword arguments can be given to override individual formatting parameters in the current <code>dialect</code>. To make it as easy as possible to interface with modules which implement the <code>DB API</code>, the value <code>None</code> is written as the empty string. While this isn’t a reversible transformation, it makes it easier to dump <code>SQL NULL</code> data values to <code>CSV</code> files without preprocessing the data returned from a <code>cursor.fetch*</code> call. All other <code>non-string</code> data are stringified with <code>str()</code> before being written.</li>
</ul>
<p>&emsp;&emsp;A short usage example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'eggs.csv'</span>, <span class="string">'w'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">    spamwriter = csv.writer(csvfile, delimiter=<span class="string">' '</span>, quotechar=<span class="string">'|'</span>, quoting=csv.QUOTE_MINIMAL)</span><br><span class="line">    spamwriter.writerow([<span class="string">'Spam'</span>] * <span class="number">5</span> + [<span class="string">'Baked Beans'</span>])</span><br><span class="line">    spamwriter.writerow([<span class="string">'Spam'</span>, <span class="string">'Lovely Spam'</span>, <span class="string">'Wonderful Spam'</span>])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>csv.register_dialect(name[, dialect[, **fmtparams]])</code>: Associate <code>dialect</code> with <code>name</code>. <code>name</code> must be a string. The <code>dialect</code> can be specified either by passing a <code>sub-class</code> of <code>Dialect</code>, or by <code>fmtparams</code> keyword arguments, or both, with keyword arguments overriding parameters of the <code>dialect</code>.</li>
<li><code>csv.unregister_dialect(name)</code>: Delete the dialect associated with <code>name</code> from the dialect registry. An <code>Error</code> is raised if <code>name</code> is not a registered dialect name.</li>
<li><code>csv.get_dialect(name)</code>: Return the dialect associated with <code>name</code>. An <code>Error</code> is raised if <code>name</code> is not a registered dialect name. This function returns an immutable <code>Dialect</code>.</li>
<li><code>csv.list_dialects()</code>: Return the names of all registered dialects.</li>
<li><code>csv.field_size_limit([new_limit])</code>: Returns the current maximum field size allowed by the parser. If <code>new_limit</code> is given, this becomes the new limit.</li>
</ul>
<p>&emsp;&emsp;The csv module defines the following classes:</p>
<ul>
<li><code>csv.DictReader(f, fieldnames=None, restkey=None, restval=None, dialect=&#39;excel&#39;, *args, **kwds):</code> Create an object that operates like a regular reader but maps the information in each row to an <code>OrderedDict</code> whose keys are given by the optional <code>fieldnames</code> parameter.</li>
</ul>
<p>&emsp;&emsp;The <code>fieldnames</code> parameter is a sequence. If <code>fieldnames</code> is omitted, the values in the first row of file <code>f</code> will be used as the <code>fieldnames</code>. Regardless of how the <code>fieldnames</code> are determined, the ordered dictionary preserves their original ordering.<br>&emsp;&emsp;If a row has more fields than <code>fieldnames</code>, the remaining data is put in a list and stored with the fieldname specified by <code>restkey</code> (which defaults to <code>None</code>). If a <code>non-blank</code> row has fewer fields than <code>fieldnames</code>, the missing values are <code>filled-in</code> with <code>None</code>.<br>&emsp;&emsp;All other optional or keyword arguments are passed to the underlying reader instance.<br>&emsp;&emsp;A short usage example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> csv</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> open(<span class="string">'names.csv'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line"><span class="meta">... </span>    reader = csv.DictReader(csvfile)</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line"><span class="meta">... </span>        print(row[<span class="string">'first_name'</span>], row[<span class="string">'last_name'</span>])</span><br><span class="line">...</span><br><span class="line">Eric Idle</span><br><span class="line">John Cleese</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(row)</span><br><span class="line">OrderedDict([(<span class="string">'first_name'</span>, <span class="string">'John'</span>), (<span class="string">'last_name'</span>, <span class="string">'Cleese'</span>)])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>class csv.DictWriter(f, fieldnames, restval=&#39;&#39;, extrasaction=&#39;raise&#39;, dialect=&#39;excel&#39;, *args, **kwds)</code>: Create an object which operates like a regular writer but maps dictionaries onto output rows. The <code>fieldnames</code> parameter is a sequence of keys that identify the order in which values in the dictionary passed to the <code>writerow()</code> method are written to file <code>f</code>. The optional <code>restval</code> parameter specifies the value to be written if the dictionary is missing a key in <code>fieldnames</code>. If the dictionary passed to the <code>writerow()</code> method contains a key not found in <code>fieldnames</code>, the optional <code>extrasaction</code> parameter indicates what action to take. If it is set to <code>raise</code>, the default value, a <code>ValueError</code> is raised. If it is set to <code>ignore</code>, extra values in the dictionary are ignored. Any other optional or keyword arguments are passed to the underlying writer instance.</li>
</ul>
<p>&emsp;&emsp;Note that unlike the <code>DictReader</code> class, the <code>fieldnames</code> parameter of the <code>DictWriter</code> is not optional. Since <code>Python&#39;s</code> dict objects are not ordered, there is not enough information available to deduce the order in which the row should be written to file <code>f</code>.<br>&emsp;&emsp;A short usage example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'names.csv'</span>, <span class="string">'w'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">    fieldnames = [<span class="string">'first_name'</span>, <span class="string">'last_name'</span>]</span><br><span class="line">    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)</span><br><span class="line">    writer.writeheader()</span><br><span class="line">    writer.writerow(&#123;<span class="string">'first_name'</span>: <span class="string">'Baked'</span>, <span class="string">'last_name'</span>: <span class="string">'Beans'</span>&#125;)</span><br><span class="line">    writer.writerow(&#123;<span class="string">'first_name'</span>: <span class="string">'Lovely'</span>, <span class="string">'last_name'</span>: <span class="string">'Spam'</span>&#125;)</span><br><span class="line">    writer.writerow(&#123;<span class="string">'first_name'</span>: <span class="string">'Wonderful'</span>, <span class="string">'last_name'</span>: <span class="string">'Spam'</span>&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>class csv.Dialect</code>: The <code>Dialect</code> class is a container class relied on primarily for its attributes, which are used to define the parameters for a specific reader or writer instance.</li>
<li><code>class csv.excel</code>: The excel class defines the usual properties of an <code>Excel-generated</code> <code>CSV</code> file. It is registered with the dialect name <code>excel</code>.</li>
<li><code>class csv.excel_tab</code>: The <code>excel_tab</code> class defines the usual properties of an <code>Excel-generated</code> <code>TAB-delimited</code> file. It is registered with the dialect name <code>excel-tab</code>.</li>
<li><code>class csv.unix_dialect</code>: The <code>unix_dialect</code> class defines the usual properties of a <code>CSV</code> file generated on <code>UNIX</code> systems, i.e. using <code>\n</code> as line terminator and quoting all fields. It is registered with the dialect name <code>unix</code>.</li>
<li><code>class csv.Sniffer</code>: The <code>Sniffer</code> class is used to deduce the format of a <code>CSV</code> file.</li>
</ul>
<p>&emsp;&emsp;The <code>Sniffer</code> class provides two methods:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sniff(sample, delimiters=<span class="keyword">None</span>)</span><br></pre></td></tr></table></figure>
<p>Analyze the given <code>sample</code> and return a <code>Dialect</code> subclass reflecting the parameters found. If the optional <code>delimiters</code> parameter is given, it is interpreted as a string containing possible valid delimiter characters.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">has_header(sample)</span><br></pre></td></tr></table></figure>
<p>Analyze the <code>sample</code> text (presumed to be in <code>CSV</code> format) and return <code>True</code> if the first row appears to be a series of column headers.<br>&emsp;&emsp;An example for <code>Sniffer</code> use:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">'example.csv'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">    dialect = csv.Sniffer().sniff(csvfile.read(<span class="number">1024</span>))</span><br><span class="line">    csvfile.seek(<span class="number">0</span>)</span><br><span class="line">    reader = csv.reader(csvfile, dialect)</span><br><span class="line">    <span class="comment"># process CSV file contents here</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;The csv module defines the following constants:</p>
<ul>
<li><code>csv.QUOTE_ALL</code>: Instructs writer objects to quote all fields.</li>
<li><code>csv.QUOTE_MINIMAL</code>: Instructs writer objects to only quote those fields which contain special characters such as delimiter, quotechar or any of the characters in lineterminator.</li>
<li><code>csv.QUOTE_NONNUMERIC</code>: Instructs writer objects to quote all <code>non-numeric</code> fields. Instructs the reader to convert all <code>non-quoted</code> fields to type float.</li>
<li><code>csv.QUOTE_NONE</code>: Instructs writer objects to never quote fields. When the current delimiter occurs in output data it is preceded by the current escapechar character. If escapechar is not set, the writer will raise <code>Error</code> if any characters that require escaping are encountered.</li>
</ul>
<p>&emsp;&emsp;Instructs reader to perform no special processing of quote characters.<br>&emsp;&emsp;The csv module defines the following exception:</p>
<ul>
<li><code>exception csv.Error</code>: Raised by any of the functions when an error is detected.</li>
</ul>
<h3 id="Dialects-and-Formatting-Parameters"><a href="#Dialects-and-Formatting-Parameters" class="headerlink" title="Dialects and Formatting Parameters"></a>Dialects and Formatting Parameters</h3><p>&emsp;&emsp;To make it easier to specify the format of input and output records, specific formatting parameters are grouped together into dialects. A dialect is a subclass of the <code>Dialect</code> class having a set of specific methods and a single <code>validate()</code> method. When creating reader or writer objects, the programmer can specify a string or a subclass of the <code>Dialect</code> class as the dialect parameter. In addition to, or instead of, the dialect parameter, the programmer can also specify individual formatting parameters, which have the same names as the attributes defined below for the <code>Dialect</code> class.<br>&emsp;&emsp;Dialects support the following attributes:</p>
<ul>
<li><code>Dialect.delimiter</code>: A <code>one-character</code> string used to separate fields. It defaults to <code>,</code>.</li>
<li><code>Dialect.doublequote</code>: Controls how instances of quotechar appearing inside a field should themselves be quoted. When <code>True</code>, the character is doubled. When <code>False</code>, the escapechar is used as a prefix to the quotechar. It defaults to <code>True</code>.</li>
</ul>
<p>&emsp;&emsp;On output, if doublequote is <code>False</code> and no escapechar is set, Error is raised if a quotechar is found in a field.</p>
<ul>
<li><code>Dialect.escapechar</code>: A <code>one-character</code> string used by the writer to escape the delimiter if quoting is set to <code>QUOTE_NONE</code> and the quotechar if doublequote is <code>False</code>. On reading, the escapechar removes any special meaning from the following character. It defaults to <code>None</code>, which disables escaping.</li>
<li><code>Dialect.lineterminator</code>: The string used to terminate lines produced by the writer. It defaults to <code>\r\n</code>.</li>
</ul>
<p>&emsp;&emsp;<strong>Note</strong>: The reader is <code>hard-coded</code> to recognise either <code>\r</code> or <code>\n</code> as <code>end-of-line</code>, and ignores lineterminator. This behavior may change in the future.</p>
<ul>
<li><code>Dialect.quotechar</code>: A <code>one-character</code> string used to quote fields containing special characters, such as the delimiter or quotechar, or which contain <code>new-line</code> characters. It defaults to <code>&quot;</code>.</li>
<li><code>Dialect.quoting</code>: Controls when quotes should be generated by the writer and recognised by the reader. It can take on any of the <code>QUOTE_*</code> constants and defaults to <code>QUOTE_MINIMAL</code>.</li>
<li><code>Dialect.skipinitialspace</code>: When <code>True</code>, whitespace immediately following the delimiter is ignored. The default is <code>False</code>.</li>
<li><code>Dialect.strict</code>: When <code>True</code>, raise exception Error on bad <code>CSV</code> input. The default is <code>False</code>.</li>
</ul>
<h3 id="Reader-Objects"><a href="#Reader-Objects" class="headerlink" title="Reader Objects"></a>Reader Objects</h3><p>&emsp;&emsp;<code>Reader</code> objects (<code>DictReader</code> instances and objects returned by the <code>reader()</code> function) have the following public methods:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csvreader.__next__()</span><br></pre></td></tr></table></figure>
<p>Return the next row of the reader’s iterable object as a list (if the object was returned from <code>reader()</code>) or a dict (if it is a <code>DictReader</code> instance), parsed according to the current dialect. Usually you should call this as <code>next(reader)</code>.<br>&emsp;&emsp;<code>Reader</code> objects have the following public attributes:</p>
<ul>
<li><code>csvreader.dialect</code>: A <code>read-only</code> description of the dialect in use by the parser.</li>
<li><code>csvreader.line_num</code>: The number of lines read from the source iterator. This is not the same as the number of records returned, as records can span multiple lines.</li>
</ul>
<p>&emsp;&emsp;<code>DictReader</code> objects have the following public attribute:</p>
<ul>
<li><code>csvreader.fieldnames</code>: If not passed as a parameter when creating the object, this attribute is initialized upon first access or when the first record is read from the file.</li>
</ul>
<h3 id="Writer-Objects"><a href="#Writer-Objects" class="headerlink" title="Writer Objects"></a>Writer Objects</h3><p>&emsp;&emsp;<code>Writer</code> objects (<code>DictWriter</code> instances and objects returned by the <code>writer()</code> function) have the following public methods. A row must be an iterable of strings or numbers for <code>Writer</code> objects and a dictionary mapping fieldnames to strings or numbers (by passing them through <code>str()</code> first) for <code>DictWriter</code> objects. Note that complex numbers are written out surrounded by parens. This may cause some problems for other programs which read <code>CSV</code> files (assuming they support complex numbers at all).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csvwriter.writerow(row):</span><br></pre></td></tr></table></figure>
<p>Write the row parameter to the writer’s file object, formatted according to the current dialect.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csvwriter.writerows(rows):</span><br></pre></td></tr></table></figure>
<p>Write all the rows parameters (a list of row objects as described above) to the writer’s file object, formatted according to the current dialect.<br>&emsp;&emsp;<code>Writer</code> objects have the following public attribute:</p>
<ul>
<li><code>csvwriter.dialect</code>: A <code>read-only</code> description of the dialect in use by the writer.</li>
</ul>
<p>&emsp;&emsp;<code>DictWriter</code> objects have the following public method:</p>
<ul>
<li><code>DictWriter.writeheader()</code>: Write a row with the field names (as specified in the constructor).</li>
</ul>
<h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><p>&emsp;&emsp;The simplest example of reading a <code>CSV</code> file:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'some.csv'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        print(row)</span><br></pre></td></tr></table></figure>
<p>Reading a file with an alternate format:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'passwd'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f, delimiter=<span class="string">':'</span>, quoting=csv.QUOTE_NONE)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        print(row)</span><br></pre></td></tr></table></figure>
<p>The corresponding simplest possible writing example is:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'some.csv'</span>, <span class="string">'w'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">    writer = csv.writer(f)</span><br><span class="line">    writer.writerows(someiterable)</span><br></pre></td></tr></table></figure>
<p>Since <code>open()</code> is used to open a <code>CSV</code> file for reading, the file will by default be decoded into unicode using the system default encoding. To decode a file using a different encoding, use the encoding argument of open:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'some.csv'</span>, newline=<span class="string">''</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        print(row)</span><br></pre></td></tr></table></figure>
<p>The same applies to writing in something other than the system default encoding: specify the encoding argument when opening the output file.<br>&emsp;&emsp;Registering a new dialect:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line">csv.register_dialect(<span class="string">'unixpwd'</span>, delimiter=<span class="string">':'</span>, quoting=csv.QUOTE_NONE)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'passwd'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f, <span class="string">'unixpwd'</span>)</span><br></pre></td></tr></table></figure>
<p>A slightly more advanced use of the reader — catching and reporting errors:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv, sys</span><br><span class="line">​</span><br><span class="line">filename = <span class="string">'some.csv'</span></span><br><span class="line"><span class="keyword">with</span> open(filename, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">            print(row)</span><br><span class="line">    <span class="keyword">except</span> csv.Error <span class="keyword">as</span> e:</span><br><span class="line">        sys.exit(<span class="string">'file &#123;&#125;, line &#123;&#125;: &#123;&#125;'</span>.format(filename, reader.line_num, e))</span><br></pre></td></tr></table></figure>
<p>And while the module doesn’t directly support parsing strings, it can easily be done:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> csv.reader([<span class="string">'one,two,three'</span>]):</span><br><span class="line">    print(row)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<strong>Footnotes</strong>: If <code>newline=&#39;&#39;</code> is not specified, newlines embedded inside quoted fields will not be interpreted correctly, and on platforms that use <code>\r\n</code> linendings on write an extra <code>\r</code> will be added. It should always be safe to specify <code>newline=&#39;&#39;</code>, since the csv module does its own (universal) newline handling.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/24/Python语法/数据类型和循环/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/24/Python语法/数据类型和循环/" itemprop="url">数据类型和循环</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-24T12:07:14+08:00">
                2019-02-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p>&emsp;&emsp;<code>Python</code>的数据类型分为整型、布尔类型、浮点型、<code>e</code>记法。在终端输入<code>a = 0.00000000000000000015</code>，再输入<code>a</code>得到<code>1.5e-19</code>；在终端输入<code>b = 1.5e12</code>，再输入<code>b</code>，得到<code>1500000000000.0</code>，这就是<code>e</code>记法。也可以输入<code>b = 15e11</code>，达到同样的结果。<br>&emsp;&emsp;布尔类型是特殊的整型，在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">True</span> + <span class="keyword">True</span>  <span class="comment"># 结果为2</span></span><br><span class="line"><span class="keyword">True</span> * <span class="keyword">True</span>  <span class="comment"># 结果为1</span></span><br><span class="line"><span class="keyword">True</span> + <span class="keyword">False</span>  <span class="comment"># 结果为1</span></span><br><span class="line"><span class="keyword">True</span> * <span class="keyword">False</span>  <span class="comment"># 结果为0</span></span><br><span class="line"><span class="keyword">True</span> / <span class="keyword">False</span>  <span class="comment"># 结果出错</span></span><br></pre></td></tr></table></figure>
<p>类型转换如下：</p>
<p><img src="/2019/02/24/Python语法/数据类型和循环/1.jpg" height="233" width="277"></p>
<p>&emsp;&emsp;在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">'520'</span></span><br><span class="line">b = int(a)  <span class="comment"># b为得到整数520</span></span><br></pre></td></tr></table></figure>
<p>如果<code>a</code>为<code>hello</code>，则程序出错。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">5.99</span></span><br><span class="line">c = int(a)  <span class="comment"># c为整数5</span></span><br><span class="line">c = str(<span class="number">5e19</span>)  <span class="comment"># c为字符串“5e+19”</span></span><br></pre></td></tr></table></figure>
<p>注意<code>str</code>的使用，在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">"hello"</span></span><br><span class="line">c = str(<span class="number">520</span>)  <span class="comment"># 这样会报错！</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;关于获取类型的信息，使用<code>type</code>或者<code>isinstance</code>这些<code>BIF</code>。在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">'510'</span></span><br><span class="line">type(a)  <span class="comment"># 得到&lt;class 'str'&gt;</span></span><br><span class="line">type(<span class="number">5.2</span>)  <span class="comment"># 得到&lt;class 'float'&gt;</span></span><br><span class="line">type(<span class="keyword">True</span>)  <span class="comment"># 得到&lt;class 'bool'&gt;</span></span><br><span class="line">type(<span class="number">5e12</span>)  <span class="comment"># 得到&lt;class 'float'&gt;</span></span><br><span class="line"><span class="comment"># --------------------------------</span></span><br><span class="line">a = <span class="string">"hello"</span></span><br><span class="line">isinstance(a, str)  <span class="comment"># 结果为True</span></span><br><span class="line">isinstance(a, int)  <span class="comment"># 结果为False</span></span><br><span class="line">isinstance(<span class="number">520</span>, int)  <span class="comment"># 结果为True</span></span><br><span class="line">isinstance(<span class="number">320.25</span>, float)  <span class="comment"># 结果为True</span></span><br><span class="line">isinstance(<span class="number">320.25</span>, bool)  <span class="comment"># 结果为False</span></span><br></pre></td></tr></table></figure>
<h4 id="多个变量赋值"><a href="#多个变量赋值" class="headerlink" title="多个变量赋值"></a>多个变量赋值</h4><p>&emsp;&emsp;<code>Python</code>允许你同时为多个变量赋值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = b = c = <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>以上实例创建一个整型对象(值为<code>1</code>)，从后向前赋值，三个变量被赋予相同的数值。也可以为多个对象指定多个变量：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a, b, c = <span class="number">1</span>, <span class="number">2</span>, <span class="string">"runoob"</span></span><br></pre></td></tr></table></figure>
<p>两个整型对象<code>1</code>和<code>2</code>被分配给变量<code>a</code>和<code>b</code>，字符串对象<code>runoob</code>分配给变量<code>c</code>。</p>
<hr>
<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><h4 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h4><p>&emsp;&emsp;语法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 目标 <span class="keyword">in</span> 表达式:</span><br><span class="line">    循环体</span><br></pre></td></tr></table></figure>
<p>在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">favourite = <span class="string">"hello"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> favourite:</span><br><span class="line">    print(i, end=<span class="string">' '</span>)  <span class="comment"># 打印“h e l l o ”</span></span><br></pre></td></tr></table></figure>
<p>在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">member = [<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>]  <span class="comment"># Python的列表，相当于C语言的数组</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> member:</span><br><span class="line">    print(each, len(each))  <span class="comment"># len是Python的BIF</span></span><br></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">one <span class="number">3</span></span><br><span class="line">two <span class="number">3</span></span><br><span class="line">three <span class="number">5</span></span><br><span class="line">four <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h4 id="for和else"><a href="#for和else" class="headerlink" title="for和else"></a>for和else</h4><p>&emsp;&emsp;使用<code>break</code>关键字终止当前循环就不会执行<code>else</code>语句，而使用<code>continue</code>则进入下一轮循环。如果正常地结束循环，就会触发<code>else</code>语句。<br>&emsp;&emsp;正常结束的循环：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> list:</span><br><span class="line">    print(x, end=<span class="string">" "</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"else"</span>)</span><br></pre></td></tr></table></figure>
<p>执行结果为<code>1 2 3 4 5 else</code>。使用<code>continue</code>关键字：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> list:</span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line">    print(x)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"else"</span>)</span><br></pre></td></tr></table></figure>
<p>执行结果为<code>else</code>。不触发<code>else</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> list:</span><br><span class="line">    print(x)</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"else"</span>)</span><br></pre></td></tr></table></figure>
<p>执行结果为<code>1</code>。</p>
<h4 id="range"><a href="#range" class="headerlink" title="range"></a>range</h4><p>&emsp;&emsp;语法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">range([start, ] stop[, step = <span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>这个<code>BIF</code>有三个参数，其中括号括起来的表示这两个参数是可选的。<code>range</code>的作用是生成一个从<code>start</code>参数的值开始到<code>stop</code>参数的值结束的数字序列。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">range(<span class="number">5</span>)  <span class="comment"># 得到range(0, 5)</span></span><br><span class="line">list(range(<span class="number">5</span>))  <span class="comment"># 得到[0, 1, 2, 3, 4]</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">    print(i)  <span class="comment"># 得到0、1、2、3、4这5个数字</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, <span class="number">9</span>):</span><br><span class="line">    print(i)  <span class="comment"># 得到2、3、4、5、6、7、8这7个数字</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10</span>, <span class="number">2</span>):</span><br><span class="line">    print(i)  <span class="comment"># 得到1、3、5、7、9这5个数字</span></span><br></pre></td></tr></table></figure>
<h4 id="break和continue"><a href="#break和continue" class="headerlink" title="break和continue"></a>break和continue</h4><p>&emsp;&emsp;<code>Python</code>的<code>break</code>、<code>continue</code>语句和<code>C</code>语言的类似。<code>break</code>用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">bingo = <span class="string">"hello"</span></span><br><span class="line">​</span><br><span class="line">answer = input(<span class="string">"Please input the answer: "</span>)</span><br><span class="line">​</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">if</span> answer == bingo:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    answer = input(<span class="string">"No, you are wrong! Input the answer again: "</span>)</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"Yes! you are right!"</span>)</span><br></pre></td></tr></table></figure>
<p><code>continue</code>用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">        print(i)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    i += <span class="number">2</span></span><br><span class="line">    print(i)</span><br></pre></td></tr></table></figure>
<p>最后结果是<code>2</code>、<code>1</code>、<code>4</code>、<code>3</code>、<code>6</code>、<code>5</code>、<code>8</code>、<code>7</code>、<code>10</code>、<code>9</code>这些数字。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/24/Python语法/Python内置函数/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/24/Python语法/Python内置函数/" itemprop="url">Python内置函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-24T10:42:11+08:00">
                2019-02-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="chr"><a href="#chr" class="headerlink" title="chr"></a>chr</h3><p>&emsp;&emsp;<code>chr</code>用一个范围在<code>range(256)</code>内的(就是<code>0</code>至<code>255</code>)整数作参数，返回一个对应的字符：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr(i)</span><br></pre></td></tr></table></figure>
<p>参数<code>i</code>可以是<code>10</code>进制也可以是<code>16</code>进制的形式的数字。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(chr(<span class="number">0x30</span>), chr(<span class="number">0x31</span>), chr(<span class="number">0x61</span>))  <span class="comment"># 十六进制</span></span><br><span class="line">print(chr(<span class="number">48</span>), chr(<span class="number">49</span>), chr(<span class="number">97</span>))  <span class="comment"># 十进制</span></span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> <span class="number">1</span> a</span><br><span class="line"><span class="number">0</span> <span class="number">1</span> a</span><br></pre></td></tr></table></figure>
<h3 id="ord"><a href="#ord" class="headerlink" title="ord"></a>ord</h3><p>&emsp;&emsp;<code>ord</code>以一个字符(长度为1的字符串)作为参数，返回对应的<code>ASCII</code>数值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ord(c)</span><br></pre></td></tr></table></figure>
<p>参数<code>c</code>是字符。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>ord(<span class="string">'a'</span>)</span><br><span class="line"><span class="number">97</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ord(<span class="string">'b'</span>)</span><br><span class="line"><span class="number">98</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ord(<span class="string">'c'</span>)</span><br><span class="line"><span class="number">99</span></span><br></pre></td></tr></table></figure>
<h3 id="len"><a href="#len" class="headerlink" title="len"></a>len</h3><p>&emsp;&emsp;<code>len</code>返回对象(字符、列表、元组等)长度或项目个数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">len(s)</span><br></pre></td></tr></table></figure>
<p>参数s是一个对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">"runoob"</span></span><br><span class="line">len(str)  <span class="comment"># 字符串长度，结果为“6”</span></span><br><span class="line">l = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">len(l)  <span class="comment"># 列表元素个数，结果为“5”</span></span><br></pre></td></tr></table></figure>
<p><code>len</code>也可以用于计算文件的行数，以及目录下的文件个数。</p>
<h3 id="range"><a href="#range" class="headerlink" title="range"></a>range</h3><p>&emsp;&emsp;<code>range</code>可创建一个整数列表，一般用在<code>for</code>循环中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">range(start, stop[, step])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>start</code>：计数从<code>start</code>开始，默认是从<code>0</code>开始。例如<code>range(5)</code>等价于<code>range(0, 5)</code>。</li>
<li><code>end</code>：计数到<code>end</code>结束，但不包括<code>end</code>。例如<code>range(0, 5)</code>的结果为<code>[0, 1, 2, 3, 4]</code>。</li>
<li><code>step</code>：这是步长，默认为<code>1</code>。例如<code>range(0, 5)</code>等价于<code>range(0, 5, 1)</code>。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>range(<span class="number">10</span>)  <span class="comment"># 从0开始到10</span></span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>range(<span class="number">1</span>, <span class="number">11</span>)  <span class="comment"># 从1开始到11</span></span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>range(<span class="number">0</span>, <span class="number">30</span>, <span class="number">5</span>)  <span class="comment"># 步长为5</span></span><br><span class="line">[<span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">25</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>range(<span class="number">0</span>, <span class="number">10</span>, <span class="number">3</span>)  <span class="comment"># 步长为3</span></span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>range(<span class="number">0</span>, <span class="number">-10</span>, <span class="number">-1</span>) <span class="comment"># 负数</span></span><br><span class="line">[<span class="number">0</span>, <span class="number">-1</span>, <span class="number">-2</span>, <span class="number">-3</span>, <span class="number">-4</span>, <span class="number">-5</span>, <span class="number">-6</span>, <span class="number">-7</span>, <span class="number">-8</span>, <span class="number">-9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>range(<span class="number">0</span>)</span><br><span class="line">[]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>range(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">[]</span><br></pre></td></tr></table></figure>
<p>以下是<code>range</code>在<code>for</code>中的使用，循环出<code>runoob</code>的每个字母：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="string">'runoob'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(x)):</span><br><span class="line">    print(x[i])</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>Python 3.x</code>的<code>range</code>函数返回的是一个整数序列的对象，而不是列表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(range(<span class="number">10</span>))</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">range</span>'&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以利用<code>list</code>函数返回列表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(range(<span class="number">10</span>))</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br></pre></td></tr></table></figure>
<h3 id="int"><a href="#int" class="headerlink" title="int"></a>int</h3><p>&emsp;&emsp;<code>int</code>用于将一个数字或字符串转换为整型：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">int</span><span class="params">(x, base=<span class="number">10</span>)</span></span></span><br></pre></td></tr></table></figure>
<p>参数<code>x</code>是字符串或数字，<code>base</code>是进制数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>int()  <span class="comment"># 不传入参数时，得到结果0</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>int(<span class="number">3</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>int(<span class="number">3.6</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>int(<span class="string">'12'</span>, <span class="number">16</span>)  <span class="comment"># 如果带参数base，“12”要以字符串的形式进行输入</span></span><br><span class="line"><span class="number">18</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>int(<span class="string">'0xa'</span>, <span class="number">16</span>)</span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>int(<span class="string">'10'</span>, <span class="number">8</span>)</span><br><span class="line"><span class="number">8</span></span><br></pre></td></tr></table></figure>
<h3 id="abs"><a href="#abs" class="headerlink" title="abs"></a>abs</h3><p>&emsp;&emsp;<code>abs</code>返回数字的绝对值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abs(x)</span><br></pre></td></tr></table></figure>
<p>参数<code>x</code>是数值表达式，可以是整数、浮点数和复数。如果参数是一个复数，则返回它的大小。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"abs(-40):"</span>, abs(<span class="number">-40</span>))  <span class="comment"># 输出“abs(-40): 40”</span></span><br><span class="line">print(<span class="string">"abs(100.10):"</span>, abs(<span class="number">100.10</span>))  <span class="comment"># 输出“abs(100.10): 100.1”</span></span><br></pre></td></tr></table></figure>
<h3 id="list"><a href="#list" class="headerlink" title="list"></a>list</h3><p>&emsp;&emsp;<code>list</code>用于将序列(列表、元组、字符串)转换为列表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list(seq)</span><br></pre></td></tr></table></figure>
<p>参数<code>seq</code>是要转换为列表的序列。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aTuple = (<span class="number">123</span>, <span class="string">'Google'</span>, <span class="string">'Runoob'</span>, <span class="string">'Taobao'</span>)</span><br><span class="line">list1 = list(aTuple)</span><br><span class="line">print(list1)  <span class="comment"># 输出“[123, 'Google', 'Runoob', 'Taobao']”</span></span><br><span class="line">str = <span class="string">"Hello World"</span></span><br><span class="line">list2 = list(str)</span><br><span class="line">print(list2)  <span class="comment"># 输出“['H', 'e', 'l', 'l', 'o', ' ', 'W', 'o', 'r', 'l', 'd']”</span></span><br></pre></td></tr></table></figure>
<h3 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h3><p>&emsp;&emsp;<code>zip</code>用于将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回由这些元组组成的列表。如果各个迭代器的元素个数不一致，则返回列表长度与最短的对象相同，利用<code>*</code>操作符，可以将元组解压为列表。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip([iterable, ...])</span><br></pre></td></tr></table></figure>
<p>参数<code>iterable</code>是一个或多个迭代器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>zipped = zip(a, b) <span class="comment"># 打包为元组的列表</span></span><br><span class="line">[(<span class="number">1</span>, <span class="number">4</span>), (<span class="number">2</span>, <span class="number">5</span>), (<span class="number">3</span>, <span class="number">6</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>zip(a, c) <span class="comment"># 元素个数与最短的列表一致</span></span><br><span class="line">[(<span class="number">1</span>, <span class="number">4</span>), (<span class="number">2</span>, <span class="number">5</span>), (<span class="number">3</span>, <span class="number">6</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>zip(*zipped) <span class="comment"># 与zip相反，可理解为解压，返回二维矩阵式</span></span><br><span class="line">[(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), (<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)]</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>zip(*iterables)</code>: Make an iterator that aggregates elements from each of the <code>iterables</code>.<br>&emsp;&emsp;Returns an iterator of tuples, where the <code>i-th</code> tuple contains the <code>i-th</code> element from each of the argument sequences or iterables. The iterator stops when the shortest input iterable is exhausted. With a single iterable argument, it returns an iterator of <code>1-tuples</code>. With no arguments, it returns an empty iterator. Equivalent to:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">zip</span><span class="params">(*iterables)</span>:</span></span><br><span class="line">    <span class="comment"># zip('ABCD', 'xy') --&gt; Ax By</span></span><br><span class="line">    sentinel = object()</span><br><span class="line">    iterators = [iter(it) <span class="keyword">for</span> it <span class="keyword">in</span> iterables]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> iterators:</span><br><span class="line">        result = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> it <span class="keyword">in</span> iterators:</span><br><span class="line">            elem = next(it, sentinel)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> elem <span class="keyword">is</span> sentinel:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            result.append(elem)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">yield</span> tuple(result)</span><br></pre></td></tr></table></figure>
<p>The <code>left-to-right</code> evaluation order of the iterables is guaranteed. This makes possible an idiom for clustering a data series into <code>n-length</code> groups using <code>zip(*[iter(s)] * n)</code>. This repeats the same iterator <code>n</code> times so that each output tuple has the result of <code>n</code> calls to the iterator. This has the effect of dividing the input into <code>n-length</code> chunks.<br>&emsp;&emsp;<code>zip()</code> should only be used with unequal length inputs when you don’t care about trailing, unmatched values from the longer iterables. If those values are important, use <code>itertools.zip_longest()</code> instead.<br>&emsp;&emsp;<code>zip()</code> in conjunction with the <code>*</code> operator can be used to unzip a list:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>zipped = zip(x, y)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(zipped)</span><br><span class="line">[(<span class="number">1</span>, <span class="number">4</span>), (<span class="number">2</span>, <span class="number">5</span>), (<span class="number">3</span>, <span class="number">6</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x2, y2 = zip(*zip(x, y))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x == list(x2) <span class="keyword">and</span> y == list(y2)</span><br><span class="line"><span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<h3 id="sorted"><a href="#sorted" class="headerlink" title="sorted"></a>sorted</h3><p>&emsp;&emsp;<code>sorted</code>函数对所有可迭代的对象进行排序操作。<code>sort</code>与<code>sorted</code>区别：<code>sort</code>是应用在<code>list</code>上的方法，<code>sorted</code>可以对所有可迭代的对象进行排序操作。<code>list</code>的<code>sort</code>方法返回的是对已经存在的列表进行操作，而内建函数<code>sorted</code>方法返回的是一个新的<code>list</code>，而不是在原来的基础上进行的操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sorted(iterable[, cmp[, key[, reverse]]])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>iterable</code>：可迭代对象。</li>
<li><code>cmp</code>：用于比较的函数，这个具有两个参数，参数的值都是从可迭代对象中取出。此函数必须遵守的规则为：大于则返回<code>1</code>，小于则返回<code>-1</code>，等于则返回<code>0</code>。</li>
<li><code>key</code>：主要是用来进行比较的元素，只有一个参数，具体的函数的参数就是取自于可迭代对象中，指定可迭代对象中的一个元素来进行排序。</li>
<li><code>reverse</code>：排序规则，为<code>True</code>表示降序，为<code>False</code>表示升序(默认)。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">5</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = sorted(a)  <span class="comment"># 保留原列表</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="number">5</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>L = [(<span class="string">'b'</span>,<span class="number">2</span>),(<span class="string">'a'</span>,<span class="number">1</span>),(<span class="string">'c'</span>,<span class="number">3</span>),(<span class="string">'d'</span>,<span class="number">4</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sorted(L, cmp=<span class="keyword">lambda</span> x,y:cmp(x[<span class="number">1</span>],y[<span class="number">1</span>]))  <span class="comment"># 利用cmp函数</span></span><br><span class="line">[(<span class="string">'a'</span>, <span class="number">1</span>), (<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'c'</span>, <span class="number">3</span>), (<span class="string">'d'</span>, <span class="number">4</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sorted(L, key=<span class="keyword">lambda</span> x:x[<span class="number">1</span>])  <span class="comment"># 利用key</span></span><br><span class="line">[(<span class="string">'a'</span>, <span class="number">1</span>), (<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'c'</span>, <span class="number">3</span>), (<span class="string">'d'</span>, <span class="number">4</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>students = [(<span class="string">'john'</span>, <span class="string">'A'</span>, <span class="number">15</span>), (<span class="string">'jane'</span>, <span class="string">'B'</span>, <span class="number">12</span>), (<span class="string">'dave'</span>, <span class="string">'B'</span>, <span class="number">10</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sorted(students, key=<span class="keyword">lambda</span> s: s[<span class="number">2</span>])  <span class="comment"># 按年龄排序</span></span><br><span class="line">[(<span class="string">'dave'</span>, <span class="string">'B'</span>, <span class="number">10</span>), (<span class="string">'jane'</span>, <span class="string">'B'</span>, <span class="number">12</span>), (<span class="string">'john'</span>, <span class="string">'A'</span>, <span class="number">15</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sorted(students, key=<span class="keyword">lambda</span> s: s[<span class="number">2</span>], reverse=<span class="keyword">True</span>)  <span class="comment"># 按降序</span></span><br><span class="line">[(<span class="string">'john'</span>, <span class="string">'A'</span>, <span class="number">15</span>), (<span class="string">'jane'</span>, <span class="string">'B'</span>, <span class="number">12</span>), (<span class="string">'dave'</span>, <span class="string">'B'</span>, <span class="number">10</span>)]</span><br></pre></td></tr></table></figure>
<p>按年龄进行排序可以使用如下方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> operator <span class="keyword">import</span> itemgetter</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>students = [(<span class="string">'john'</span>, <span class="string">'A'</span>, <span class="number">15</span>), (<span class="string">'jane'</span>, <span class="string">'B'</span>, <span class="number">12</span>), (<span class="string">'dave'</span>, <span class="string">'B'</span>, <span class="number">10</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sorted(students, key=itemgetter(<span class="number">2</span>))</span><br><span class="line">[(<span class="string">'dave'</span>, <span class="string">'B'</span>, <span class="number">10</span>), (<span class="string">'jane'</span>, <span class="string">'B'</span>, <span class="number">12</span>), (<span class="string">'john'</span>, <span class="string">'A'</span>, <span class="number">15</span>)]</span><br></pre></td></tr></table></figure>
<h3 id="round"><a href="#round" class="headerlink" title="round"></a>round</h3><p>&emsp;&emsp;<code>round</code>返回浮点数<code>x</code>的四舍五入值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">round(x[, n])</span><br></pre></td></tr></table></figure>
<p>参数<code>x</code>是一个浮点数，<code>n</code>是保留的小数位数(可选项，如果不写的话，默认保留到整数)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"round(70.23456):"</span>, round(<span class="number">70.23456</span>))</span><br><span class="line">print(<span class="string">"round(56.659, 1):"</span>, round(<span class="number">56.659</span>, <span class="number">1</span>))</span><br><span class="line">print(<span class="string">"round(80.264, 2):"</span>, round(<span class="number">80.264</span>, <span class="number">2</span>))</span><br><span class="line">print(<span class="string">"round(100.000056, 3):"</span>, round(<span class="number">100.000056</span>, <span class="number">3</span>))</span><br><span class="line">print(<span class="string">"round(-100.000056, 3):"</span>, round(<span class="number">-100.000056</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">round(<span class="number">70.23456</span>): <span class="number">70</span></span><br><span class="line">round(<span class="number">56.659</span>, <span class="number">1</span>): <span class="number">56.7</span></span><br><span class="line">round(<span class="number">80.264</span>, <span class="number">2</span>): <span class="number">80.26</span></span><br><span class="line">round(<span class="number">100.000056</span>, <span class="number">3</span>): <span class="number">100.0</span></span><br><span class="line">round(<span class="number">-100.000056</span>, <span class="number">3</span>): <span class="number">-100.0</span></span><br></pre></td></tr></table></figure>
<p>在实际使用中发现，<code>round</code>函数并不总是如上所说的四舍五入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">round(2.355, 2)  # 执行结果是2.35</span><br></pre></td></tr></table></figure>
<p>而且在不用的<code>python</code>版本中，其结果也不一样。<br>&emsp;&emsp;在<code>python 2.7</code>的<code>doc</code>中，<code>round</code>的说明写着<code>Values are rounded to the closest multiple of 10 to the power minus ndigits; if two multiples are equally close, rounding is done away from 0.</code>，保留值将保留到离上一位更近的一端(四舍六入)，如果距离两端一样远，则保留到离<code>0</code>远的一边。所以<code>round(0.5)</code>会近似到<code>1</code>，而<code>round(-0.5)</code>会近似到<code>-1</code>。但是到了<code>python 3.5</code>的<code>doc</code>中，文档变成了<code>values are rounded to the closest multiple of 10 to the power minus ndigits; if two multiples are equally close, rounding is done toward the even choice.</code>，如果距离两边一样远，会保留到偶数的一边。比如<code>round(0.5)</code>和<code>round(-0.5)</code>都会保留到<code>0</code>，而<code>round(1.5)</code>会保留到<code>2</code>。所以如果有项目是从<code>py2</code>迁移到<code>py3</code>的，需要注意<code>round</code>函数。</p>
<h3 id="map"><a href="#map" class="headerlink" title="map"></a>map</h3><p>&emsp;&emsp;<code>map</code>会根据提供的函数对指定序列做映射。参数<code>function</code>以参数序列<code>iterable</code>中的每一个元素调用<code>function</code>函数。返回包含每次<code>function</code>函数返回值的新列表。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">map(function, iterable, ...)</span><br></pre></td></tr></table></figure>
<p>实例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">square</span><span class="params">(x)</span>:</span>  <span class="comment"># 计算平方数</span></span><br><span class="line">    <span class="keyword">return</span> x ** <span class="number">2</span></span><br><span class="line"></span><br><span class="line">result = map(square, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line">print(list(result))  <span class="comment"># 执行结果是[1, 4, 9, 16, 25]</span></span><br><span class="line">result = map(<span class="keyword">lambda</span> x: x ** <span class="number">2</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line">print(list(result))  <span class="comment"># 执行结果是[1, 4, 9, 16, 25]</span></span><br><span class="line">result = map(<span class="keyword">lambda</span> x, y: x + y, [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>], [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>])</span><br><span class="line">print(list(result))  <span class="comment"># 执行结果是[3, 7, 11, 15, 19]</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>map</code>还可以用于转换列表中的元素类型：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>list_float = [<span class="number">1.3</span>, <span class="number">2.3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list_int = map(int, list_float)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(list(list_int))</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br></pre></td></tr></table></figure>
<h3 id="str"><a href="#str" class="headerlink" title="str"></a>str</h3><p>&emsp;&emsp;<code>str</code>将对象转化为<code>string</code>格式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">str</span><span class="params">(object=<span class="string">''</span>)</span></span></span><br></pre></td></tr></table></figure>
<p>参数<code>object</code>是对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'RUNOOB'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str(s)</span><br><span class="line"><span class="string">'RUNOOB'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dict = &#123;<span class="string">'runoob'</span>: <span class="string">'runoob.com'</span>, <span class="string">'google'</span>: <span class="string">'google.com'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>str(dict)</span><br><span class="line"><span class="string">"&#123;'runoob': 'runoob.com', 'google': 'google.com'&#125;"</span></span><br></pre></td></tr></table></figure>
<h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><p>&emsp;&emsp;<code>filter</code>函数用于过滤序列，过滤掉不符合条件的元素，返回由符合条件元素组成的新列表。参数<code>function</code>为函数，参数<code>iterable</code>为序列，序列的每个元素作为参数传递给函数进行判，然后返回<code>True</code>或<code>False</code>，最后将返回<code>True</code>的元素放到新列表中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filter(function, iterable)</span><br></pre></td></tr></table></figure>
<p>实例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_odd</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> n % <span class="number">2</span> == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">newlist = filter(is_odd, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>])</span><br><span class="line">print(list(newlist))  <span class="comment"># 输出“[1, 3, 5, 7, 9]”</span></span><br></pre></td></tr></table></figure>
<h3 id="bool"><a href="#bool" class="headerlink" title="bool"></a>bool</h3><p>&emsp;&emsp;<code>bool</code>函数用于将给定参数转换为布尔类型，如果没有参数，则返回<code>False</code>。<code>bool</code>是<code>int</code>的子类。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">bool</span><span class="params">([x])</span></span></span><br></pre></td></tr></table></figure>
<p>参数<code>x</code>是要进行转换的参数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>bool()</span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bool(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bool(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bool(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>issubclass(bool, int)  <span class="comment"># bool是int的子类</span></span><br><span class="line"><span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<h3 id="super"><a href="#super" class="headerlink" title="super"></a>super</h3><p>&emsp;&emsp;<code>super</code>用于调用一个父类(超类)，并返回该父类实例。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">super(type[, object-<span class="keyword">or</span>-type])</span><br></pre></td></tr></table></figure>
<p>参数<code>type</code>是类，<code>object-or-type</code>一般是<code>self</code>，该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FooParent</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.parent = <span class="string">'I\'m the parent.'</span></span><br><span class="line">        print(<span class="string">'Parent'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">(self, message)</span>:</span></span><br><span class="line">        print(<span class="string">"%s from Parent"</span> % message)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FooChild</span><span class="params">(FooParent)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># super(FooChild, self)首先找到FooChild的父类(就是类FooParent)，</span></span><br><span class="line">        <span class="comment"># 然后把类B的对象FooChild转换为类FooParent的对象</span></span><br><span class="line">        super(FooChild, self).__init__()</span><br><span class="line">        print(<span class="string">'Child'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">(self, message)</span>:</span></span><br><span class="line">        super(FooChild, self).bar(message)</span><br><span class="line">        print(<span class="string">'Child bar fuction'</span>)</span><br><span class="line">        print(self.parent)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    fooChild = FooChild()</span><br><span class="line">    fooChild.bar(<span class="string">'HelloWorld'</span>)</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Parent</span><br><span class="line">Child</span><br><span class="line">HelloWorld <span class="keyword">from</span> Parent</span><br><span class="line">Child bar fuction</span><br><span class="line">I<span class="string">'m the parent.</span></span><br></pre></td></tr></table></figure>
<h3 id="min"><a href="#min" class="headerlink" title="min"></a>min</h3><p>&emsp;&emsp;<code>min</code>返回给定参数的最小值，参数可以为序列，而<code>max</code>方法返回的是最大值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">min(x, y, z, ...)</span><br></pre></td></tr></table></figure>
<p>参数<code>x</code>、<code>y</code>和<code>z</code>都是数值表达式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"min(80, 100, 1000):"</span>, min(<span class="number">80</span>, <span class="number">100</span>, <span class="number">1000</span>))</span><br><span class="line">print(<span class="string">"min(-20, 100, 400):"</span>, min(<span class="number">-20</span>, <span class="number">100</span>, <span class="number">400</span>))</span><br><span class="line">print(<span class="string">"min(-80, -20, -10):"</span>, min(<span class="number">-80</span>, <span class="number">-20</span>, <span class="number">-10</span>))</span><br><span class="line">print(<span class="string">"min(0, 100, -400):"</span>, min(<span class="number">0</span>, <span class="number">100</span>, <span class="number">-400</span>))</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">min(<span class="number">80</span>, <span class="number">100</span>, <span class="number">1000</span>): <span class="number">80</span></span><br><span class="line">min(<span class="number">-20</span>, <span class="number">100</span>, <span class="number">400</span>): <span class="number">-20</span></span><br><span class="line">min(<span class="number">-80</span>, <span class="number">-20</span>, <span class="number">-10</span>): <span class="number">-80</span></span><br><span class="line">min(<span class="number">0</span>, <span class="number">100</span>, <span class="number">-400</span>): <span class="number">-400</span></span><br></pre></td></tr></table></figure>
<h3 id="sum"><a href="#sum" class="headerlink" title="sum"></a>sum</h3><p>&emsp;&emsp;<code>sum</code>对序列进行求和计算：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum(iterable[, start])</span><br></pre></td></tr></table></figure>
<p>参数<code>iterable</code>是可迭代对象，例如列表；<code>start</code>是指定相加的参数，如果没有设置这个值，默认为<code>0</code>。该方法返回计算结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sum([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sum((<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>), <span class="number">1</span>)  <span class="comment"># 元组计算总和后再加1</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sum([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="number">2</span>)  <span class="comment"># 列表计算总和后再加2</span></span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure>
<h3 id="isinstance"><a href="#isinstance" class="headerlink" title="isinstance"></a>isinstance</h3><p>&emsp;&emsp;<code>isinstance</code>函数来判断一个对象是否是一个已知的类型，类似于<code>type</code>。<code>isinstance</code>与<code>type</code>的区别如下：</p>
<ul>
<li><code>type</code>不会认为子类是一种父类类型，不考虑继承关系。</li>
<li><code>isinstance</code>会认为子类是一种父类类型，考虑继承关系。</li>
</ul>
<p>如果要判断两个类型是否相同，推荐使用<code>isinstance</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">isinstance(object, classinfo)</span><br></pre></td></tr></table></figure>
<p>参数<code>object</code>是实例对象；<code>classinfo</code>可以是直接或间接类名、基本类型或者由它们组成的元组。如果对象的类型与参数<code>classinfo</code>相同，则返回<code>True</code>，否则返回<code>False</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance (a, int)</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance (a, str)</span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance (a, (str, int, list))  <span class="comment"># 是元组中的一个，返回True</span></span><br><span class="line"><span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<p><code>type</code>与<code>isinstance</code>的区别如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span><span class="params">(A)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">isinstance(A(), A)  <span class="comment"># returns True</span></span><br><span class="line">type(A()) == A      <span class="comment"># returns True</span></span><br><span class="line">isinstance(B(), A)  <span class="comment"># returns True</span></span><br><span class="line">type(B()) == A      <span class="comment"># returns False</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;对于基本类型来说，<code>classinfo</code>可以是<code>int</code>、<code>float</code>、<code>bool</code>、<code>complex</code>、<code>str</code>、<code>list</code>、<code>dict</code>、<code>set</code>和<code>tuple</code>。</p>
<h3 id="dir"><a href="#dir" class="headerlink" title="dir"></a>dir</h3><p>&emsp;&emsp;<code>dir</code>不带参数时，返回当前范围内的变量、方法和定义的类型列表；带参数时，返回参数的属性、方法列表。如果参数包含方法<code>__dir__</code>，该方法将被调用；如果参数不包含<code>__dir__</code>，该方法将最大限度地收集参数信息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir([object])</span><br></pre></td></tr></table></figure>
<p>参数<code>object</code>是对象、变量或类型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir()  <span class="comment"># 获得当前模块的属性列表</span></span><br><span class="line">[<span class="string">'__builtins__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__name__'</span>, <span class="string">'__package__'</span>, <span class="string">'arr'</span>, <span class="string">'myslice'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir([ ])  <span class="comment"># 查看列表的方法</span></span><br><span class="line">[<span class="string">'__add__'</span>, <span class="string">'__class__'</span>, <span class="string">'__contains__'</span>, <span class="string">'__delattr__'</span>, <span class="string">'__delitem__'</span>, <span class="string">'__delslice__'</span>,</span><br><span class="line"><span class="string">'__doc__'</span>, <span class="string">'__eq__'</span>, <span class="string">'__format__'</span>, <span class="string">'__ge__'</span>, <span class="string">'__getattribute__'</span>, <span class="string">'__getitem__'</span>, <span class="string">'__getslice__'</span>,</span><br><span class="line"><span class="string">'__gt__'</span>, <span class="string">'__hash__'</span>, <span class="string">'__iadd__'</span>, <span class="string">'__imul__'</span>, <span class="string">'__init__'</span>, <span class="string">'__iter__'</span>, <span class="string">'__le__'</span>, <span class="string">'__len__'</span>, <span class="string">'__lt__'</span>,</span><br><span class="line"><span class="string">'__mul__'</span>, <span class="string">'__ne__'</span>, <span class="string">'__new__'</span>, <span class="string">'__reduce__'</span>, <span class="string">'__reduce_ex__'</span>, <span class="string">'__repr__'</span>, <span class="string">'__reversed__'</span>,</span><br><span class="line"><span class="string">'__rmul__'</span>, <span class="string">'__setattr__'</span>, <span class="string">'__setitem__'</span>, <span class="string">'__setslice__'</span>, <span class="string">'__sizeof__'</span>, <span class="string">'__str__'</span>, <span class="string">'__subclasshook__'</span>,</span><br><span class="line"><span class="string">'append'</span>, <span class="string">'count'</span>, <span class="string">'extend'</span>, <span class="string">'index'</span>, <span class="string">'insert'</span>, <span class="string">'pop'</span>, <span class="string">'remove'</span>, <span class="string">'reverse'</span>, <span class="string">'sort'</span>]</span><br></pre></td></tr></table></figure>
<h3 id="set"><a href="#set" class="headerlink" title="set"></a>set</h3><p>&emsp;&emsp;<code>set</code>创建一个无序不重复元素集，可进行关系测试、删除重复数据，还可以计算交集、差集、并集等。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">set</span><span class="params">([iterable])</span></span></span><br></pre></td></tr></table></figure>
<p>参数<code>iterable</code>是可迭代对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = set(<span class="string">'runoob'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = set(<span class="string">'google'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y</span><br><span class="line">(set([<span class="string">'b'</span>, <span class="string">'r'</span>, <span class="string">'u'</span>, <span class="string">'o'</span>, <span class="string">'n'</span>]), set([<span class="string">'e'</span>, <span class="string">'o'</span>, <span class="string">'g'</span>, <span class="string">'l'</span>]))  <span class="comment"># 重复的元素被删除</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x &amp; y  <span class="comment"># 交集</span></span><br><span class="line">set([<span class="string">'o'</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x | y  <span class="comment"># 并集</span></span><br><span class="line">set([<span class="string">'b'</span>, <span class="string">'e'</span>, <span class="string">'g'</span>, <span class="string">'l'</span>, <span class="string">'o'</span>, <span class="string">'n'</span>, <span class="string">'r'</span>, <span class="string">'u'</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x - y  <span class="comment"># 差集</span></span><br><span class="line">set([<span class="string">'r'</span>, <span class="string">'b'</span>, <span class="string">'u'</span>, <span class="string">'n'</span>])</span><br></pre></td></tr></table></figure>
<h3 id="iter"><a href="#iter" class="headerlink" title="iter"></a>iter</h3><p>&emsp;&emsp;<code>iter</code>用来生成迭代器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iter(object[, sentinel])</span><br></pre></td></tr></table></figure>
<p>参数<code>object</code>是支持迭代的集合对象；对于<code>sentinel</code>，如果传递了第二个参数，则参数<code>object</code>必须是一个可调用的对象(例如函数)，此时<code>iter</code>创建了一个迭代器对象，每次调用这个迭代器对象的<code>__next__</code>方法时，都会调用<code>object</code>。该函数返回迭代器对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> i <span class="keyword">in</span> iter(lst):</span><br><span class="line"><span class="meta">... </span>    print(i)</span><br><span class="line">...</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<h3 id="next"><a href="#next" class="headerlink" title="next"></a>next</h3><p>&emsp;&emsp;<code>next</code>返回迭代器的下一个项目。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">next(iterator[, default])</span><br></pre></td></tr></table></figure>
<p>参数<code>iterator</code>是可迭代对象；<code>default</code>是可选的，用于设置在没有下一个元素时返回的默认值，如果不设置，又没有下一个元素时则会触发<code>StopIteration</code>异常。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">it = iter([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])  <span class="comment"># 首先获得Iterator对象</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:  <span class="comment"># 循环：</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        x = next(it)  <span class="comment"># 获得下一个值</span></span><br><span class="line">        print(x)</span><br><span class="line">    <span class="keyword">except</span> StopIteration:  <span class="comment"># 遇到StopIteration就退出循环</span></span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h3 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h3><p>&emsp;&emsp;<code>eval</code>函数用来执行一个字符串表达式，并返回表达式的值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(expression[, globals[, locals]])</span><br></pre></td></tr></table></figure>
<p>参数<code>expression</code>是表达式；<code>globals</code>是变量作用域，全局命名空间，如果被提供，则必须是一个字典对象；<code>locals</code>是变量作用域，局部命名空间，如果被提供，可以是任何映射对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">7</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>eval(<span class="string">'3 * x'</span>)</span><br><span class="line"><span class="number">21</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>eval(<span class="string">'pow(2,2)'</span>)</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>eval(<span class="string">'2 + 2'</span>)</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>n = <span class="number">81</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>eval(<span class="string">"n + 4"</span>)</span><br><span class="line"><span class="number">85</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>eval</code>在做计算前并不知道需要转化的内容是不是合法的(安全的)<code>python</code>数据类型，只是在调用函数的时候去计算。如果被计算的内容不是合法的，<code>python</code>类型就会抛出异常。<br>&emsp;&emsp;<code>ast.literal</code>则会判断需要计算的内容计算后是不是合法的<code>python</code>类型，如果是则进行运算，否则就不进行运算。</p>
<h3 id="staticmethod"><a href="#staticmethod" class="headerlink" title="staticmethod"></a>staticmethod</h3><p>&emsp;&emsp;<code>staticmethod</code>返回函数的静态方法。该方法不强制要求传递参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span><span class="params">(object)</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(arg1, arg2, ...)</span>:</span></span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>
<p>以上实例声明了静态方法<code>f</code>，类可以不用实例化就可以调用该方法(如<code>C.f()</code>)，当然也可以实例化后调用(如<code>C().f()</code>)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span><span class="params">(object)</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></span><br><span class="line">        print(<span class="string">'runoob'</span>)</span><br><span class="line"></span><br><span class="line">C.f()  <span class="comment"># 静态方法无需实例化</span></span><br><span class="line">cobj = C()</span><br><span class="line">cobj.f()  <span class="comment"># 也可以实例化后调用</span></span><br></pre></td></tr></table></figure>
<h3 id="bytearray"><a href="#bytearray" class="headerlink" title="bytearray"></a>bytearray</h3><p>&emsp;&emsp;<code>bytearray</code>返回一个字节数组。这个数组里的元素是可变的，并且每个元素的值范围是<code>0 &lt;= x &lt; 256</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">bytearray</span><span class="params">([source[, encoding[, errors]]])</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>如果<code>source</code>为整数，则返回一个长度为<code>source</code>的初始化数组。</li>
<li>如果<code>source</code>为字符串，则按照指定的<code>encoding</code>将字符串转换为字节序列。</li>
<li>如果<code>source</code>为可迭代类型，则元素必须为<code>[0, 255]</code>中的整数。</li>
<li>如果没有输入任何参数，默认就是初始化数组为<code>0</code>个元素。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>bytearray()</span><br><span class="line">bytearray(<span class="string">b''</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bytearray([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">bytearray(<span class="string">b'\x01\x02\x03'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bytearray(<span class="string">'runoob'</span>, <span class="string">'utf-8'</span>)</span><br><span class="line">bytearray(<span class="string">b'runoob'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="repr"><a href="#repr" class="headerlink" title="repr"></a>repr</h3><p>&emsp;&emsp;<code>repr</code>将对象转化为供解释器读取的形式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">repr(object)</span><br></pre></td></tr></table></figure>
<p>该函数返回一个对象的<code>string</code>格式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'RUNOOB'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>repr(s)</span><br><span class="line"><span class="string">"'RUNOOB'"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dict = &#123;<span class="string">'runoob'</span>: <span class="string">'runoob.com'</span>, <span class="string">'google'</span>: <span class="string">'google.com'</span>&#125;;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>repr(dict)</span><br><span class="line"><span class="string">"&#123;'google': 'google.com', 'runoob': 'runoob.com'&#125;"</span></span><br></pre></td></tr></table></figure>
<h3 id="enumerate"><a href="#enumerate" class="headerlink" title="enumerate"></a>enumerate</h3><p>&emsp;&emsp;<code>enumerate</code>用于将一个可遍历的数据对象(如列表、元组或字符串)组合为一个索引序列，同时列出数据和数据下标，一般用在<code>for</code>循环当中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enumerate(sequence, [start=<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<p>参数<code>sequence</code>是一个序列、迭代器或其他支持迭代对象，<code>start</code>是下标起始位置，该函数返回<code>enumerate</code>对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>seasons = [<span class="string">'Spring'</span>, <span class="string">'Summer'</span>, <span class="string">'Fall'</span>, <span class="string">'Winter'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(enumerate(seasons))</span><br><span class="line">[(<span class="number">0</span>, <span class="string">'Spring'</span>), (<span class="number">1</span>, <span class="string">'Summer'</span>), (<span class="number">2</span>, <span class="string">'Fall'</span>), (<span class="number">3</span>, <span class="string">'Winter'</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(enumerate(seasons, start=<span class="number">1</span>))  <span class="comment"># 下标从“1”开始</span></span><br><span class="line">[(<span class="number">1</span>, <span class="string">'Spring'</span>), (<span class="number">2</span>, <span class="string">'Summer'</span>), (<span class="number">3</span>, <span class="string">'Fall'</span>), (<span class="number">4</span>, <span class="string">'Winter'</span>)]</span><br></pre></td></tr></table></figure>
<h3 id="locals"><a href="#locals" class="headerlink" title="locals"></a>locals</h3><p>&emsp;&emsp;<code>locals</code>函数会以字典类型返回当前位置的全部局部变量。对于函数、方法、<code>lambda</code>函式、类、以及实现了<code>__call__</code>方法的类实例，它都返回<code>True</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">runoob</span><span class="params">(arg)</span>:</span>  <span class="comment"># 两个局部变量，即arg和z</span></span><br><span class="line"><span class="meta">... </span>    z = <span class="number">1</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">print</span> (locals())</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>runoob(<span class="number">4</span>)</span><br><span class="line">&#123;<span class="string">'z'</span>: <span class="number">1</span>, <span class="string">'arg'</span>: <span class="number">4</span>&#125;  <span class="comment"># 返回一个名字/值对的字典</span></span><br></pre></td></tr></table></figure>
<h3 id="var"><a href="#var" class="headerlink" title="var"></a>var</h3><p>&emsp;&emsp;<code>vars</code>返回对象<code>object</code>的属性和属性值的字典对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vars([object])</span><br></pre></td></tr></table></figure>
<p>参数<code>object</code>是对象。如果没有参数，就打印当前调用位置的属性和属性值，类似于<code>locals</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(vars())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">'__builtins__'</span>: &lt;module <span class="string">'__builtin__'</span> (built-<span class="keyword">in</span>)&gt;,</span><br><span class="line">    <span class="string">'__name__'</span>: <span class="string">'__main__'</span>, <span class="string">'__doc__'</span>: <span class="keyword">None</span>, <span class="string">'__package__'</span>: <span class="keyword">None</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Runoob</span>:</span></span><br><span class="line"><span class="meta">... </span>    a = <span class="number">1</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(vars(Runoob))</span><br><span class="line">&#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'__module__'</span>: <span class="string">'__main__'</span>, <span class="string">'__doc__'</span>: <span class="keyword">None</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>runoob = Runoob()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(vars(runoob))</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h3><p>&emsp;&emsp;<code>exec</code>执行储存在字符串或文件中的<code>Python</code>语句，相比于<code>eval</code>，<code>exec</code>可以执行更复杂的<code>Python</code>代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec(object[, globals[, locals]])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>object</code>：必选参数，表示需要被指定的<code>Python</code>代码，它必须是字符串或<code>code</code>对象。如果<code>object</code>是一个字符串，该字符串会先被解析为一组<code>Python</code>语句，然后再执行(除非发生语法错误)。如果<code>object</code>是一个<code>code</code>对象，那么它只是被简单的执行。</li>
<li><code>globals</code>：可选参数，表示全局命名空间(存放全局变量)。如果被提供，则必须是一个字典对象。</li>
<li><code>locals</code>：可选参数，表示当前局部命名空间(存放局部变量)。如果被提供，可以是任何映射对象。如果该参数被忽略，那么它将会取与<code>globals</code>相同的值。</li>
</ul>
<p><code>exec</code>返回值永远为<code>None</code>。单行语句字符串如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>exec(<span class="string">'print("Hello World")'</span>)</span><br><span class="line">Hello World</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>exec(<span class="string">"print('runoob.com')"</span>)</span><br><span class="line">runoob.com</span><br></pre></td></tr></table></figure>
<p>多行语句字符串如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">expr = <span class="string">"""</span></span><br><span class="line"><span class="string">z = 30</span></span><br><span class="line"><span class="string">sum = x + y + z</span></span><br><span class="line"><span class="string">print(sum)</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">()</span>:</span></span><br><span class="line">    y = <span class="number">20</span></span><br><span class="line">    exec(expr)  <span class="comment"># 输出“60”</span></span><br><span class="line">    exec(expr, &#123;<span class="string">'x'</span>: <span class="number">1</span>, <span class="string">'y'</span>: <span class="number">2</span>&#125;)  <span class="comment"># 输出“33”</span></span><br><span class="line">    exec(expr, &#123;<span class="string">'x'</span>: <span class="number">1</span>, <span class="string">'y'</span>: <span class="number">2</span>&#125;, &#123;<span class="string">'y'</span>: <span class="number">3</span>, <span class="string">'z'</span>: <span class="number">4</span>&#125;)  <span class="comment"># 输出“34”</span></span><br><span class="line"></span><br><span class="line">func()</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/24/opencv和图像处理/Condensation算法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/24/opencv和图像处理/Condensation算法/" itemprop="url">Condensation算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-24T10:18:45+08:00">
                2019-02-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;自<code>opencv 2.3</code>以后，<code>condensation</code>算法放在<code>legacy</code>中了，也就是说要引入下面的头文件：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/legacy/legacy.hpp&gt;</span></span></span><br></pre></td></tr></table></figure>
<p><code>condensation</code>算法的函数原型在<code>OpenCV/sources/modules/legacy/src</code>中，可以直接搜索<code>condens.cpp</code>。<br>&emsp;&emsp;整个<code>Condensation</code>算法只涉及<code>5</code>个变量和函数：</p>
<ul>
<li><code>CvConDensation</code></li>
<li><code>cvCreateConDensation</code></li>
<li><code>cvConDensInitSampleSet</code></li>
<li><code>cvConDensUpdateByTime</code></li>
<li><code>cvReleaseConDensation</code></li>
</ul>
<p><code>CvConDensation</code>结构体如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">CvConDensation</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> MP; <span class="comment">/* Dimension of measurement vector 测量向量的维数 */</span></span><br><span class="line">    <span class="keyword">int</span> DP; <span class="comment">/* Dimension of state vector 状态向量的维数 */</span></span><br><span class="line">    <span class="keyword">float</span> *DynamMatr; <span class="comment">/* Matrix of the linear Dynamics system 线性动态系统矩阵 */</span></span><br><span class="line">    <span class="keyword">float</span> *State; <span class="comment">/* Vector of State 状态向量 */</span></span><br><span class="line">    <span class="keyword">int</span> SamplesNum; <span class="comment">/* Number of the Samples 粒子数 */</span></span><br><span class="line">    <span class="keyword">float</span> **flSamples; <span class="comment">/* array of the Sample Vectors 粒子向量数组 */</span></span><br><span class="line">    <span class="keyword">float</span> **flNewSamples; <span class="comment">/* temporary array of the Sample Vectors 粒子向量临时数组 */</span></span><br><span class="line">    <span class="keyword">float</span> *flConfidence; <span class="comment">/* Confidence for each Sample 每个粒子的置信度(译者注：也就是粒子的权值) */</span></span><br><span class="line">    <span class="keyword">float</span> *flCumulative; <span class="comment">/* Cumulative confidence 权值的累计 */</span></span><br><span class="line">    <span class="keyword">float</span> *Temp; <span class="comment">/* Temporary vector 临时向量 */</span></span><br><span class="line">    <span class="keyword">float</span> *RandomSample; <span class="comment">/* RandomVector to update sample set 用来更新粒子集的随机向量 */</span></span><br><span class="line">    CvRandState *RandS; <span class="comment">/* Array of structures to generate random vectors 产生随机向量的结构数组 */</span></span><br><span class="line">&#125; CvConDensation;</span><br></pre></td></tr></table></figure>
<p>这个是粒子结构体，<code>ConDens-&gt;flConfidence[i]</code>表示第<code>i</code>个粒子的权重，<code>ConDens-&gt;flSamples[i][k]</code>表示第<code>i</code>个粒子的状态向量的第<code>k</code>维的值。<br>&emsp;&emsp;<code>cvCreateConDensation</code>用于构造上述滤波器数据结构，输入参数分别是系统状态向量维数、测量向量维数以及粒子个数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CvConDensation *<span class="title">cvCreateConDensation</span> <span class="params">( intDP, intMP, intSamplesNum )</span></span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>cvReleaseConDensation</code>用于释放滤波器占用的空间：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cvReleaseConDensation</span> <span class="params">( CvConDensation **ConDensation )</span></span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>cvConDensInitSampleSet</code>用于初始化粒子集：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cvConDensInitSampleSet</span> <span class="params">( CvConDensation *conDens, CvMat *lowerBound, CvMat *upperBound )</span></span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>cvConDensUpdateByTime</code>用于更新粒子集：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cvConDensUpdateByTime</span> <span class="params">( CvConDensation *ConDens )</span></span>;</span><br></pre></td></tr></table></figure>
<p>运行完上述函数之后，经重采样后的粒子保存在<code>flSamples</code>中，同时上次迭代的加权系统状态保存在<code>State</code>中。<br>&emsp;&emsp;以下代码实现了在窗口上对鼠标进行检测与跟踪：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/video/tracking.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/legacy/legacy.hpp&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> drawCross( center, color, d )                               \</span></span><br><span class="line">    line( img,  Point( center.x - d, center.y - d ),                \</span><br><span class="line">          Point( center.x + d, center.y + d ), color, <span class="number">2</span>, CV_AA, <span class="number">0</span>); \</span><br><span class="line">    line( img,  Point( center.x + d, center.y - d ),                \</span><br><span class="line">          Point( center.x - d, center.y + d ), color, <span class="number">2</span>, CV_AA, <span class="number">0</span> )</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mouse_info_struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">mouse_info_struct</span> <span class="title">mouse_info</span> = &#123;</span> <span class="number">-1</span>, <span class="number">-1</span>&#125;, last_mouse;</span><br><span class="line">​</span><br><span class="line"><span class="built_in">vector</span>&lt; Point&gt; mouseV, particleV;</span><br><span class="line"><span class="keyword">int</span> counter = <span class="number">-1</span>;</span><br><span class="line">​</span><br><span class="line"><span class="comment">/* Define this to proceed one click at a time. */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PLOT_PARTICLES 1</span></span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">on_mouse</span> <span class="params">( <span class="keyword">int</span> event, <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> flags, <span class="keyword">void</span> *param )</span> </span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> CLICK</span></span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( event == CV_EVENT_LBUTTONUP )</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        last_mouse = mouse_info;</span><br><span class="line">        mouse_info.x = x;</span><br><span class="line">        mouse_info.y = y;</span><br><span class="line">        counter = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> *<span class="keyword">const</span> argv[] )</span> </span>&#123;</span><br><span class="line">    <span class="function">Mat <span class="title">img</span> <span class="params">( <span class="number">650</span>, <span class="number">650</span>, CV_8UC3 )</span></span>;</span><br><span class="line">    <span class="keyword">char</span> code = ( <span class="keyword">char</span> ) - <span class="number">1</span>;</span><br><span class="line">    namedWindow ( <span class="string">"mouse particle"</span> );</span><br><span class="line">    setMouseCallback ( <span class="string">"mouse particle"</span>, on_mouse, <span class="number">0</span> );</span><br><span class="line">    Mat_&lt;<span class="keyword">float</span>&gt; measurement ( <span class="number">2</span>, <span class="number">1</span> );</span><br><span class="line">    measurement.setTo ( Scalar ( <span class="number">0</span> ) );</span><br><span class="line">    <span class="keyword">int</span> dim = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> nParticles = <span class="number">25</span>;</span><br><span class="line">    <span class="keyword">float</span> xRange = <span class="number">650.0</span>;</span><br><span class="line">    <span class="keyword">float</span> yRange = <span class="number">650.0</span>;</span><br><span class="line">    <span class="keyword">float</span> minRange[] = &#123; <span class="number">0</span>, <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">float</span> maxRange[] = &#123; xRange, yRange &#125;;</span><br><span class="line">    CvMat LB, UB;</span><br><span class="line">    cvInitMatHeader ( &amp;LB, <span class="number">2</span>, <span class="number">1</span>, CV_32FC1, minRange );</span><br><span class="line">    cvInitMatHeader ( &amp;UB, <span class="number">2</span>, <span class="number">1</span>, CV_32FC1, maxRange );</span><br><span class="line">    CvConDensation *condens = cvCreateConDensation ( dim, dim, nParticles );</span><br><span class="line">    cvConDensInitSampleSet ( condens, &amp;LB, &amp;UB );</span><br><span class="line">    <span class="comment">/* The OpenCV documentation doesn't tell you to initialize this</span></span><br><span class="line"><span class="comment">       transition matrix, but you have to do it. For this 2D example,</span></span><br><span class="line"><span class="comment">       we're just using a 2x2 identity matrix. I'm sure there's a slicker</span></span><br><span class="line"><span class="comment">       way to do this, left as an exercise for the reader. */</span></span><br><span class="line">    condens-&gt;DynamMatr[<span class="number">0</span>] = <span class="number">1.0</span>;</span><br><span class="line">    condens-&gt;DynamMatr[<span class="number">1</span>] = <span class="number">0.0</span>;</span><br><span class="line">    condens-&gt;DynamMatr[<span class="number">2</span>] = <span class="number">0.0</span>;</span><br><span class="line">    condens-&gt;DynamMatr[<span class="number">3</span>] = <span class="number">1.0</span>;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">for</span> ( ;; ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( mouse_info.x &lt; <span class="number">0</span> || mouse_info.y &lt; <span class="number">0</span> ) &#123;</span><br><span class="line">            imshow ( <span class="string">"mouse particle"</span>, img );</span><br><span class="line">            waitKey ( <span class="number">30</span> );</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        mouseV.clear();</span><br><span class="line">        particleV.clear();</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">for</span> ( ;; ) &#123;</span><br><span class="line">            code = ( <span class="keyword">char</span> ) waitKey ( <span class="number">100</span> );</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">if</span> ( code &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> CLICK</span></span><br><span class="line">​</span><br><span class="line">            <span class="keyword">if</span> ( counter++ &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">            measurement ( <span class="number">0</span> ) = mouse_info.x;</span><br><span class="line">            measurement ( <span class="number">1</span> ) = mouse_info.y;</span><br><span class="line">            <span class="function">Point <span class="title">measPt</span> <span class="params">( measurement ( <span class="number">0</span> ), measurement ( <span class="number">1</span> ) )</span></span>;</span><br><span class="line">            mouseV.push_back ( measPt );</span><br><span class="line">            <span class="comment">/* Clear screen */</span></span><br><span class="line">            img =  Scalar::all ( <span class="number">100</span> );</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; condens-&gt;SamplesNum; i++ ) &#123;</span><br><span class="line">                <span class="keyword">float</span> diffX = ( measurement ( <span class="number">0</span> ) - condens-&gt;flSamples[i][<span class="number">0</span>] ) / xRange;</span><br><span class="line">                <span class="keyword">float</span> diffY = ( measurement ( <span class="number">1</span> ) - condens-&gt;flSamples[i][<span class="number">1</span>] ) / yRange;</span><br><span class="line">                condens-&gt;flConfidence[i] = <span class="number">1.0</span> / ( <span class="built_in">sqrt</span> ( diffX * diffX + diffY * diffY ) );</span><br><span class="line">                <span class="comment">/* plot particles */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> PLOT_PARTICLES</span></span><br><span class="line">                <span class="function">Point <span class="title">partPt</span> <span class="params">( condens-&gt;flSamples[i][<span class="number">0</span>], condens-&gt;flSamples[i][<span class="number">1</span>] )</span></span>;</span><br><span class="line">                drawCross ( partPt ,  Scalar ( <span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span> ), <span class="number">2</span> );</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">            &#125;</span><br><span class="line">​</span><br><span class="line">            cvConDensUpdateByTime ( condens );</span><br><span class="line">            <span class="function">Point <span class="title">statePt</span> <span class="params">( condens-&gt;State[<span class="number">0</span>], condens-&gt;State[<span class="number">1</span>] )</span></span>;</span><br><span class="line">            particleV.push_back ( statePt );</span><br><span class="line">            <span class="comment">/* plot points */</span></span><br><span class="line">            drawCross ( statePt,  Scalar ( <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span> ), <span class="number">5</span> );</span><br><span class="line">            drawCross ( measPt,  Scalar ( <span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span> ), <span class="number">5</span> );</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mouseV.size() - <span class="number">1</span>; i++ ) &#123;</span><br><span class="line">                line ( img, mouseV[i], mouseV[i + <span class="number">1</span>],  Scalar ( <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span> ), <span class="number">1</span> );</span><br><span class="line">            &#125;</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; particleV.size() - <span class="number">1</span>; i++ ) &#123;</span><br><span class="line">                line ( img, particleV[i], particleV[i + <span class="number">1</span>],  Scalar ( <span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span> ), <span class="number">1</span> );</span><br><span class="line">            &#125;</span><br><span class="line">​</span><br><span class="line">            imshow ( <span class="string">"mouse particle"</span>, img );</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">if</span> ( code == <span class="number">27</span> || code == <span class="string">'q'</span> || code == <span class="string">'Q'</span> ) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/24/opencv和图像处理/Condensation算法/1.png" height="339" width="325"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/opencv和图像处理/运动模板/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/opencv和图像处理/运动模板/" itemprop="url">运动模板</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T20:26:52+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;运动模板是一种有效的跟踪普通运动的方法，尤其应用在姿态识别中。运动模板方法首先需要的是知道物体的轮廓，而轮廓的获取可以有很多的方法，关于轮廓的获取方法在此不做多余的叙述。<br>&emsp;&emsp;运动模板程序的大致编程思路应该是是这样的：获得当前帧与上一帧的差，然后对差图像进行二值化；更新运动历史图像；然后计算运动历史图像的梯度方向，并将整个运动分割为独立的运动部分，在用一个结构序列标记每一个运动分割，最后计算出选择区域的全局运动方向，从而获得运动目标的质心位置与运动方向。<br>&emsp;&emsp;<code>opencv</code>中完成运动模板构建的函数是<code>cvUpdateMotionHistory</code>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cvUpdateMotionHistory</span> <span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> CvArr *silhouette, <span class="comment">/* 非0像素代表前景物体的最新的分割轮廓 */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    CvArr *mhi, <span class="comment">/* 运动模板，也即运动历史图像 */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">double</span> timestamp, <span class="comment">/* 当前系统时间 */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">double</span> duration <span class="comment">/* 运动跟踪的最大持续时间 */</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure>
<p>在<code>cvUpdateMotionHistory</code>中，所有图像都是单通道图像，图像<code>silhouette</code>是一幅单字节图像，其中非零像素代表前景物体的分割轮廓。图像<code>mhi</code>是一幅浮点值图像，代表运动模板(也就是运动历史图像)。<code>timestamp</code>是当前系统时间，以毫秒为单位。<code>mhi</code>中任何比<code>timestamp</code>减去<code>duration</code>的值早(少)的像素将被设置为<code>0</code>。<br>&emsp;&emsp;一旦运动模板记录了不同时间的物体轮廓，就可以用计算<code>mhi</code>图像的梯度来获取全局运动信息。使用如下函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cvCalcMotionGradient</span> <span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> CvArrs *mhi, <span class="comment">/* 运动历史图像 */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    CvArr *mask, <span class="comment">/* 非0值代表此点处的梯度有效 */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    CvArr *orientation, <span class="comment">/* 每一点梯度方向的角度 */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">double</span> delta1,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">double</span> delta2, <span class="comment">/* delta1、delta2分别是允许的最小和最大梯度值 */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> aperture_size = <span class="number">3</span> <span class="comment">/* 设置梯度算子的宽和高 */</span></span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure>
<p>梯度方向求出后，即可以计算全局运动方向，给出如下函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cvCalcGlobalOrientation</span> <span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="comment">/* 前三个参数都是根据上面两个函数得出来的 */</span></span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> CvArr *orientation,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> CvArr *mask,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> CvArr *mhi,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">double</span> timestamp,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">double</span> duration</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;分割和计算局部运动的函数是<code>cvSegmentMotion</code>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CvSeq *<span class="title">cvSegmentMotion</span> <span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> CvArr *mhi, CvArr *seg_mask, CvMemStorage *storage,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">double</span> timestamp, <span class="keyword">double</span> seg_thresh)</span></span>;</span><br></pre></td></tr></table></figure>
<p>示例代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"opencv2/video/tracking.hpp"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"opencv2/highgui/highgui.hpp"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"opencv2/imgproc/imgproc_c.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctype.h&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="comment">/* 不同的跟踪参数 */</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> MHI_DURATION = <span class="number">0.5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> MAX_TIME_DELTA = <span class="number">0.5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> MIN_TIME_DELTA = <span class="number">0.05</span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2</span>; <span class="comment">/* 用于运动检测的循环帧数，与机器速度及FPS设置有关 */</span></span><br><span class="line">IplImage **buf = <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">int</span> last = <span class="number">0</span>;</span><br><span class="line">​</span><br><span class="line"><span class="comment">/* 临时图像 */</span></span><br><span class="line">IplImage *mhi = <span class="number">0</span>; <span class="comment">/* MHI：运动历史图像 */</span></span><br><span class="line">IplImage *orient = <span class="number">0</span>; <span class="comment">/* 方向 */</span></span><br><span class="line">IplImage *mask = <span class="number">0</span>; <span class="comment">/* 有效的运动掩码 */</span></span><br><span class="line">IplImage *segmask = <span class="number">0</span>; <span class="comment">/* 运动分割映射 */</span></span><br><span class="line">CvMemStorage *storage = <span class="number">0</span>; <span class="comment">/* 临时存储区 */</span></span><br><span class="line">​</span><br><span class="line"><span class="comment">/* parameters:</span></span><br><span class="line"><span class="comment">  img - input video frame</span></span><br><span class="line"><span class="comment">  dst - resultant motion picture</span></span><br><span class="line"><span class="comment">  args - optional parameters */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update_mhi</span> <span class="params">( IplImage *img, IplImage *dst, <span class="keyword">int</span> diff_threshold )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> timestamp = ( <span class="keyword">double</span> ) clock() / CLOCKS_PER_SEC; <span class="comment">/* 获取当前时间，以秒为单位 */</span></span><br><span class="line">    CvSize size = cvSize ( img-&gt;width, img-&gt;height ); <span class="comment">/* 获取当前帧尺寸 */</span></span><br><span class="line">    <span class="keyword">int</span> i, idx1 = last, idx2;</span><br><span class="line">    IplImage *silh;</span><br><span class="line">    CvSeq *seq;</span><br><span class="line">    CvRect comp_rect;</span><br><span class="line">    <span class="keyword">double</span> count;</span><br><span class="line">    <span class="keyword">double</span> angle;</span><br><span class="line">    CvPoint center;</span><br><span class="line">    <span class="keyword">double</span> magnitude;</span><br><span class="line">    CvScalar color;</span><br><span class="line">​</span><br><span class="line">    <span class="comment">/* 开始时为图像分配内存 or 帧尺寸改变时重新分配内存 */</span></span><br><span class="line">    <span class="keyword">if</span> ( !mhi || mhi-&gt;width != size.width || mhi-&gt;height != size.height ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( buf == <span class="number">0</span> ) &#123;</span><br><span class="line">            buf = ( IplImage ** ) <span class="built_in">malloc</span> ( N * <span class="keyword">sizeof</span> ( buf[<span class="number">0</span>] ) );</span><br><span class="line">            <span class="built_in">memset</span> ( buf, <span class="number">0</span>, N * <span class="keyword">sizeof</span> ( buf[<span class="number">0</span>] ) );</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; N; i++ ) &#123;</span><br><span class="line">            cvReleaseImage ( &amp;buf[i] );</span><br><span class="line">            buf[i] = cvCreateImage ( size, IPL_DEPTH_8U, <span class="number">1</span> );</span><br><span class="line">            cvZero ( buf[i] );</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        cvReleaseImage ( &amp;mhi );</span><br><span class="line">        cvReleaseImage ( &amp;orient );</span><br><span class="line">        cvReleaseImage ( &amp;segmask );</span><br><span class="line">        cvReleaseImage ( &amp;mask );</span><br><span class="line">        mhi = cvCreateImage ( size, IPL_DEPTH_32F, <span class="number">1</span> );</span><br><span class="line">        cvZero ( mhi ); <span class="comment">/* clear MHI at the beginning */</span></span><br><span class="line">        orient = cvCreateImage ( size, IPL_DEPTH_32F, <span class="number">1</span> );</span><br><span class="line">        segmask = cvCreateImage ( size, IPL_DEPTH_32F, <span class="number">1</span> );</span><br><span class="line">        mask = cvCreateImage ( size, IPL_DEPTH_8U, <span class="number">1</span> );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    cvCvtColor ( img, buf[last], CV_BGR2GRAY ); <span class="comment">/* RGB帧图像格式转换为gray */</span></span><br><span class="line">    idx2 = ( last + <span class="number">1</span> ) % N; <span class="comment">/* index of (last - (N-1))th frame */</span></span><br><span class="line">    last = idx2;</span><br><span class="line">    silh = buf[idx2];</span><br><span class="line">    <span class="comment">/* 相邻两帧的差 */</span></span><br><span class="line">    cvAbsDiff ( buf[idx1], buf[idx2], silh );</span><br><span class="line">    cvThreshold ( silh, silh, diff_threshold, <span class="number">1</span>, CV_THRESH_BINARY ); <span class="comment">/* 对差图像做二值化 */</span></span><br><span class="line">    cvUpdateMotionHistory ( silh, mhi, timestamp, MHI_DURATION ); <span class="comment">/* 更新运动历史 */</span></span><br><span class="line">    <span class="comment">/* convert MHI to blue 8u image</span></span><br><span class="line"><span class="comment">       cvCvtScale的第四个参数 shift = (MHI_DURATION - timestamp) * 255. / MHI_DURATION</span></span><br><span class="line"><span class="comment">       控制帧差的消失速率 */</span></span><br><span class="line">    cvCvtScale ( mhi, mask, <span class="number">255.</span> / MHI_DURATION, ( MHI_DURATION - timestamp ) * <span class="number">255.</span> / MHI_DURATION );</span><br><span class="line">    cvZero ( dst );</span><br><span class="line">    cvMerge ( mask, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, dst );</span><br><span class="line">    <span class="comment">/* B, G, R, 0 convert to BLUE image</span></span><br><span class="line"><span class="comment">       计算运动的梯度方向以及正确的方向掩码</span></span><br><span class="line"><span class="comment">       Filter size = 3 */</span></span><br><span class="line">    cvCalcMotionGradient ( mhi, mask, orient, MAX_TIME_DELTA, MIN_TIME_DELTA, <span class="number">3</span> );</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( !storage ) &#123;</span><br><span class="line">        storage = cvCreateMemStorage ( <span class="number">0</span> );</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        cvClearMemStorage ( storage );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="comment">/* 运动分割：获得运动部件的连续序列 */</span></span><br><span class="line">    seq = cvSegmentMotion ( mhi, segmask, storage, timestamp, MAX_TIME_DELTA );</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">-1</span>; i &lt; seq-&gt;total; i++ ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( i &lt; <span class="number">0</span> ) &#123; <span class="comment">/* 对整幅图像操作 */</span></span><br><span class="line">            comp_rect = cvRect ( <span class="number">0</span>, <span class="number">0</span>, size.width, size.height );</span><br><span class="line">            color = CV_RGB ( <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span> );</span><br><span class="line">            magnitude = <span class="number">100</span>; <span class="comment">/* 画线长度以及圆半径的大小控制 */</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">/* 第i个运动组件 */</span></span><br><span class="line">            comp_rect = ( ( CvConnectedComp * ) cvGetSeqElem ( seq, i ) )-&gt;rect;</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">if</span> ( comp_rect.width + comp_rect.height &lt; <span class="number">100</span> ) &#123; <span class="comment">/* 去掉小的部分 */</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">​</span><br><span class="line">            color = CV_RGB ( <span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span> );</span><br><span class="line">            magnitude = <span class="number">30</span>;</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        <span class="comment">/* 选择组件ROI */</span></span><br><span class="line">        cvSetImageROI ( silh, comp_rect );</span><br><span class="line">        cvSetImageROI ( mhi, comp_rect );</span><br><span class="line">        cvSetImageROI ( orient, comp_rect );</span><br><span class="line">        cvSetImageROI ( mask, comp_rect );</span><br><span class="line">        <span class="comment">/* 在选择的区域内，计算运动方向 */</span></span><br><span class="line">        angle = cvCalcGlobalOrientation ( orient, mask, mhi, timestamp,  MHI_DURATION );</span><br><span class="line">        angle = <span class="number">360.0</span> - angle; <span class="comment">/* adjust for images with top-left origin */</span></span><br><span class="line">        <span class="comment">/* 在轮廓内计算点数；Norm(L1) = 所有像素值的和 */</span></span><br><span class="line">        count = cvNorm ( silh, <span class="number">0</span>, CV_L1, <span class="number">0</span> );</span><br><span class="line">        cvResetImageROI ( mhi );</span><br><span class="line">        cvResetImageROI ( orient );</span><br><span class="line">        cvResetImageROI ( mask );</span><br><span class="line">        cvResetImageROI ( silh );</span><br><span class="line">​</span><br><span class="line">        <span class="comment">/* 检查小运动的情形 */</span></span><br><span class="line">        <span class="keyword">if</span> ( count &lt; comp_rect.width * comp_rect.height * <span class="number">0.05</span> ) &#123; <span class="comment">/* 像素的5% */</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        <span class="comment">/* 画一个带箭头的记录以表示方向 */</span></span><br><span class="line">        center = cvPoint ( ( comp_rect.x + comp_rect.width / <span class="number">2</span> ), ( comp_rect.y + comp_rect.height / <span class="number">2</span> ) );</span><br><span class="line">        cvCircle ( dst, center, cvRound ( magnitude * <span class="number">1.2</span> ), color, <span class="number">3</span>, CV_AA, <span class="number">0</span> );</span><br><span class="line">        cvLine (</span><br><span class="line">            dst, center,</span><br><span class="line">            cvPoint (</span><br><span class="line">                cvRound ( center.x + magnitude * <span class="built_in">cos</span> ( angle * CV_PI / <span class="number">180</span> ) ),</span><br><span class="line">                cvRound ( center.y - magnitude * <span class="built_in">sin</span> ( angle * CV_PI / <span class="number">180</span> ) )</span><br><span class="line">            ),</span><br><span class="line">            color, <span class="number">3</span>, CV_AA, <span class="number">0</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> **argv )</span> </span>&#123;</span><br><span class="line">    IplImage *motion = <span class="number">0</span>;</span><br><span class="line">    CvCapture *capture = <span class="number">0</span>;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( argc == <span class="number">1</span> || ( argc == <span class="number">2</span> &amp;&amp; <span class="built_in">strlen</span> ( argv[<span class="number">1</span>] ) == <span class="number">1</span> &amp;&amp; <span class="built_in">isdigit</span> ( argv[<span class="number">1</span>][<span class="number">0</span>] ) ) ) &#123;</span><br><span class="line">        capture = cvCaptureFromCAM ( argc == <span class="number">2</span> ? argv[<span class="number">1</span>][<span class="number">0</span>] - <span class="string">'0'</span> : <span class="number">0</span> );</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( argc == <span class="number">2</span> ) &#123;</span><br><span class="line">        capture = cvCaptureFromAVI ( argv[<span class="number">1</span>] );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( capture ) &#123;</span><br><span class="line">        cvNamedWindow ( <span class="string">"Motion"</span>, <span class="number">1</span> );</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">for</span> ( ;; ) &#123;</span><br><span class="line">            IplImage *image = cvQueryFrame ( capture );</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">if</span> ( !image ) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">if</span> ( !motion ) &#123;</span><br><span class="line">                motion = cvCreateImage ( cvSize ( image-&gt;width, image-&gt;height ), <span class="number">8</span>, <span class="number">3</span> );</span><br><span class="line">                cvZero ( motion );</span><br><span class="line">                motion-&gt;origin = image-&gt;origin;</span><br><span class="line">            &#125;</span><br><span class="line">​</span><br><span class="line">            update_mhi ( image, motion, <span class="number">30</span> );</span><br><span class="line">            cvShowImage ( <span class="string">"Motion"</span>, motion );</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">if</span> ( cvWaitKey ( <span class="number">1</span> ) &gt;= <span class="number">0</span> ) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        cvReleaseCapture ( &amp;capture );</span><br><span class="line">        cvDestroyWindow ( <span class="string">"Motion"</span> );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/opencv和图像处理/运动模板/1.png" height="249" width="316"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/opencv和图像处理/imdecode和imencode/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/opencv和图像处理/imdecode和imencode/" itemprop="url">imdecode和imencode</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T20:01:13+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>cv2.imdecode</code>函数从指定的内存缓存中读取数据，并把数据转换(解码)成图像格式，主要用于从网络传输数据中恢复出图像。<br>&emsp;&emsp;<code>cv2.imencode</code>函数是将图片格式转换(编码)成流数据，赋值到内存缓存中，主要用于图像数据格式的压缩，方便网络传输。</p>
<h3 id="imdecode的使用"><a href="#imdecode的使用" class="headerlink" title="imdecode的使用"></a>imdecode的使用</h3><p>&emsp;&emsp;从网络读取图像数据，并转换成图片格式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line">​</span><br><span class="line">url = <span class="string">'http://www.pyimagesearch.com/wp-content/uploads/2015/01/google_logo.png'</span></span><br><span class="line">resp = urllib.request.urlopen(url)</span><br><span class="line">image = np.asarray(bytearray(resp.read()), dtype=<span class="string">"uint8"</span>)</span><br><span class="line">image = cv2.imdecode(image, cv2.IMREAD_COLOR)</span><br><span class="line">cv2.imshow(<span class="string">'URL2Image'</span>, image)</span><br><span class="line">cv2.waitKey(<span class="number">0</span>)</span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/opencv和图像处理/imdecode和imencode/1.png" height="144" width="358"></p>
<h3 id="imencode的使用"><a href="#imencode的使用" class="headerlink" title="imencode的使用"></a>imencode的使用</h3><p>&emsp;&emsp;将图片编码到缓存，并保存到本地：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line">​</span><br><span class="line">img = cv2.imread(<span class="string">'left.jpg'</span>)</span><br><span class="line"><span class="comment"># “.jpg”表示把当前图片img按照jpg格式编码，不同格式编码的结果不一样</span></span><br><span class="line">img_encode = cv2.imencode(<span class="string">'.jpg'</span>, img)[<span class="number">1</span>]</span><br><span class="line">​</span><br><span class="line">data_encode = np.array(img_encode)</span><br><span class="line">str_encode = data_encode.tostring()</span><br><span class="line">​</span><br><span class="line"><span class="comment"># 缓存数据保存到本地</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'img_encode.txt'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(str_encode)</span><br><span class="line">    f.flush</span><br></pre></td></tr></table></figure>
<h3 id="imencode和imdecode的使用"><a href="#imencode和imdecode的使用" class="headerlink" title="imencode和imdecode的使用"></a>imencode和imdecode的使用</h3><p>&emsp;&emsp;将图片编码保存到本地，读取本地文件解码恢复成图片格式：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line">​</span><br><span class="line">img = cv2.imread(<span class="string">'left.jpg'</span>)</span><br><span class="line">img_encode = cv2.imencode(<span class="string">'.jpg'</span>, img)[<span class="number">1</span>]</span><br><span class="line">data_encode = np.array(img_encode)</span><br><span class="line">str_encode = data_encode.tostring()</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'img_encode.txt'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(str_encode)</span><br><span class="line">    f.flush</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'img_encode.txt'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    str_encode = f.read()</span><br><span class="line">​</span><br><span class="line">nparr = np.fromstring(str_encode, np.uint8)</span><br><span class="line">img_decode = cv2.imdecode(nparr, cv2.IMREAD_COLOR)</span><br><span class="line">cv2.imshow(<span class="string">"img_decode"</span>, img_decode)</span><br><span class="line">cv2.waitKey()</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/opencv和图像处理/读写xml和yml文件/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/opencv和图像处理/读写xml和yml文件/" itemprop="url">读写xml和yml文件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T17:27:09+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;有时我们在处理完图像后，需要保存数据到文件上，以供下一步的处理。一个比较广泛的需求场景是：我们对一幅图像进行特征提取之后，需要把特征点信息保存到文件上，以供后面的机器学习分类操作。那么如果遇到这样的场景，我们有什么好方法？我想到的是把这些数据全写到文件上，如果下次需要这些数据时，就把它们从文件里读出来就好了。<br>&emsp;&emsp;其实更好的办法是使用<code>xml</code>和<code>yml</code>，因为它们更具有可读性，简直就是为保存数据结构而生。<code>OpenCV</code>提供了很好用的读写<code>xml</code>和<code>yml</code>的类，只要掌握其读写要领，很容易就可以实现这个小型数据库。<br>&emsp;&emsp;简单的数据写入示例：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">int</span> y;</span><br><span class="line">    <span class="built_in">string</span> s;</span><br><span class="line">&#125; <span class="keyword">test_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> **argv )</span> </span>&#123;</span><br><span class="line">    <span class="function">FileStorage <span class="title">fs</span> <span class="params">( <span class="string">"test.xml"</span>, FileStorage::WRITE )</span></span>;</span><br><span class="line">    <span class="keyword">int</span> a1 = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">char</span> a2 = <span class="number">-1</span>;</span><br><span class="line">    <span class="built_in">string</span> str = <span class="string">"hello sysu!"</span>;</span><br><span class="line">    <span class="keyword">int</span> arr[<span class="number">10</span>] = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span> &#125;;</span><br><span class="line">    <span class="keyword">test_t</span> t = &#123; <span class="number">3</span>, <span class="number">4</span>, <span class="string">"hi sysu"</span> &#125;;</span><br><span class="line">    <span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; m;</span><br><span class="line">    m[<span class="string">"kobe"</span>] = <span class="number">100</span>;</span><br><span class="line">    m[<span class="string">"james"</span>] = <span class="number">99</span>;</span><br><span class="line">    m[<span class="string">"curry"</span>] = <span class="number">98</span>;</span><br><span class="line">    <span class="comment">/* 写入文件操作，先写标注，再写数据 */</span></span><br><span class="line">    fs &lt;&lt; <span class="string">"int_data"</span> &lt;&lt; a1;</span><br><span class="line">    fs &lt;&lt; <span class="string">"char_data"</span> &lt;&lt; a2;</span><br><span class="line">    fs &lt;&lt; <span class="string">"string_data"</span> &lt;&lt; str;</span><br><span class="line">    <span class="comment">/* 写入数组 */</span></span><br><span class="line">    fs &lt;&lt; <span class="string">"array_data"</span> &lt;&lt; <span class="string">"["</span>; <span class="comment">/* 数组开始 */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ ) &#123;</span><br><span class="line">        fs &lt;&lt; arr[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fs &lt;&lt; <span class="string">"]"</span>; <span class="comment">/* 数组结束 */</span></span><br><span class="line">    <span class="comment">/* 写入结构体 */</span></span><br><span class="line">    fs &lt;&lt; <span class="string">"struct_data"</span> &lt;&lt; <span class="string">"&#123;"</span>; <span class="comment">/* 结构体开始 */</span></span><br><span class="line">    fs &lt;&lt; <span class="string">"x"</span> &lt;&lt; t.x;</span><br><span class="line">    fs &lt;&lt; <span class="string">"y"</span> &lt;&lt; t.y;</span><br><span class="line">    fs &lt;&lt; <span class="string">"s"</span> &lt;&lt; t.s;</span><br><span class="line">    fs &lt;&lt; <span class="string">"&#125;"</span>; <span class="comment">/* 结构结束 */</span></span><br><span class="line">    <span class="comment">/* map的写入 */</span></span><br><span class="line">    fs &lt;&lt; <span class="string">"map_data"</span> &lt;&lt; <span class="string">"&#123;"</span>; <span class="comment">/* map的开始写入 */</span></span><br><span class="line">    <span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt;::iterator it = m.begin();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ( ; it != m.end(); it++ ) &#123;</span><br><span class="line">        fs &lt;&lt; it-&gt;first &lt;&lt; it-&gt;second;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fs &lt;&lt; <span class="string">"&#125;"</span>; <span class="comment">/* map写入结束 */</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打开<code>test.xml</code>文件，内容如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">opencv_storage</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">int_data</span>&gt;</span>2<span class="tag">&lt;/<span class="name">int_data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">char_data</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">char_data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string_data</span>&gt;</span>"hello sysu!"<span class="tag">&lt;/<span class="name">string_data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array_data</span>&gt;</span></span><br><span class="line">  1 2 3 4 5 6 7 8 9 10<span class="tag">&lt;/<span class="name">array_data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">struct_data</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">x</span>&gt;</span>3<span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">y</span>&gt;</span>4<span class="tag">&lt;/<span class="name">y</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">s</span>&gt;</span>"hi sysu"<span class="tag">&lt;/<span class="name">s</span>&gt;</span><span class="tag">&lt;/<span class="name">struct_data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">map_data</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">curry</span>&gt;</span>98<span class="tag">&lt;/<span class="name">curry</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">james</span>&gt;</span>99<span class="tag">&lt;/<span class="name">james</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">kobe</span>&gt;</span>100<span class="tag">&lt;/<span class="name">kobe</span>&gt;</span><span class="tag">&lt;/<span class="name">map_data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">opencv_storage</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;如果将文件存为<code>test.yml</code>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">FileStorage <span class="title">fs</span> <span class="params">( <span class="string">"test.yml"</span>, FileStorage::WRITE )</span></span>;</span><br></pre></td></tr></table></figure>
<p>其内容如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">%YAML:1.0</span></span><br><span class="line"><span class="attr">int_data:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">char_data:</span> <span class="bullet">-1</span></span><br><span class="line"><span class="attr">string_data:</span> <span class="string">"hello sysu!"</span></span><br><span class="line"><span class="attr">array_data:</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">1</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">2</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">3</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">4</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">5</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">6</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">7</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">8</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">9</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">10</span></span><br><span class="line"><span class="attr">struct_data:</span></span><br><span class="line"><span class="attr">   x:</span> <span class="number">3</span></span><br><span class="line"><span class="attr">   y:</span> <span class="number">4</span></span><br><span class="line"><span class="attr">   s:</span> <span class="string">hi</span> <span class="string">sysu</span></span><br><span class="line"><span class="attr">map_data:</span></span><br><span class="line"><span class="attr">   curry:</span> <span class="number">98</span></span><br><span class="line"><span class="attr">   james:</span> <span class="number">99</span></span><br><span class="line"><span class="attr">   kobe:</span> <span class="number">100</span></span><br></pre></td></tr></table></figure>
<p>其实还可以保存为<code>txt</code>或<code>doc</code>格式。显然<code>yml</code>文件的排版更加简洁明了，<code>xml</code>文件却有点冗余和杂乱了。</p>
<hr>
<h3 id="XML-YAML-file-storages"><a href="#XML-YAML-file-storages" class="headerlink" title="XML/YAML file storages"></a>XML/YAML file storages</h3><p>&emsp;&emsp;You can store and then restore various <code>OpenCV</code> data structures to/from <code>XML</code> or <code>YAML</code> formats. Also, it is possible store and load arbitrarily complex data structures, which include <code>OpenCV</code> data structures, as well as primitive data types (integer and <code>floating-point</code> numbers and text strings) as their elements.<br>&emsp;&emsp;Use the following procedure to write something to <code>XML</code> or <code>YAML</code>:</p>
<ol>
<li>Create new <code>FileStorage</code> and open it for writing. It can be done with a single call to <code>FileStorage::FileStorage()</code> constructor that takes a filename, or you can use the default constructor and then call <code>FileStorage::open()</code>. Format of the file (<code>XML</code> or <code>YAML</code>) is determined from the filename extension (<code>.xml</code> and <code>.yml</code>/<code>.yaml</code>, respectively)</li>
<li>Write all the data you want using the streaming operator <code>&lt;&lt;</code>, just like in the case of <code>STL</code> streams.</li>
<li>Close the file using <code>FileStorage::release()</code>. <code>FileStorage</code> destructor also closes the file.</li>
</ol>
<p>&emsp;&emsp;Here is an example:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span>, <span class="keyword">char</span> **argv )</span> </span>&#123;</span><br><span class="line">    <span class="function">FileStorage <span class="title">fs</span> <span class="params">( <span class="string">"test.yml"</span>, FileStorage::WRITE )</span></span>;</span><br><span class="line">    fs &lt;&lt; <span class="string">"frameCount"</span> &lt;&lt; <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">time_t</span> rawtime;</span><br><span class="line">    time ( &amp;rawtime );</span><br><span class="line">    fs &lt;&lt; <span class="string">"calibrationDate"</span> &lt;&lt; asctime ( localtime ( &amp;rawtime ) );</span><br><span class="line">    Mat cameraMatrix = ( Mat_&lt;<span class="keyword">double</span>&gt; ( <span class="number">3</span>, <span class="number">3</span> ) &lt;&lt; <span class="number">1000</span>, <span class="number">0</span>, <span class="number">320</span>, <span class="number">0</span>, <span class="number">1000</span>, <span class="number">240</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> );</span><br><span class="line">    Mat distCoeffs = ( Mat_&lt;<span class="keyword">double</span>&gt; ( <span class="number">5</span>, <span class="number">1</span> ) &lt;&lt; <span class="number">0.1</span>, <span class="number">0.01</span>, <span class="number">-0.001</span>, <span class="number">0</span>, <span class="number">0</span> );</span><br><span class="line">    fs &lt;&lt; <span class="string">"cameraMatrix"</span> &lt;&lt; cameraMatrix &lt;&lt; <span class="string">"distCoeffs"</span> &lt;&lt; distCoeffs;</span><br><span class="line">    fs &lt;&lt; <span class="string">"features"</span> &lt;&lt; <span class="string">"["</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++ ) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = rand() % <span class="number">640</span>;</span><br><span class="line">        <span class="keyword">int</span> y = rand() % <span class="number">480</span>;</span><br><span class="line">        uchar lbp = rand() % <span class="number">256</span>;</span><br><span class="line">        fs &lt;&lt; <span class="string">"&#123;:"</span> &lt;&lt; <span class="string">"x"</span> &lt;&lt; x &lt;&lt; <span class="string">"y"</span> &lt;&lt; y &lt;&lt; <span class="string">"lbp"</span> &lt;&lt; <span class="string">"[:"</span>;</span><br><span class="line">        <span class="keyword">for</span> ( <span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++ ) &#123;</span><br><span class="line">            fs &lt;&lt; ( ( lbp &gt;&gt; j ) &amp; <span class="number">1</span> );</span><br><span class="line">        &#125;</span><br><span class="line">        fs &lt;&lt; <span class="string">"]"</span> &lt;&lt; <span class="string">"&#125;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fs &lt;&lt; <span class="string">"]"</span>;</span><br><span class="line">    fs.release();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The sample above stores to <code>XML</code> and integer, text string (calibration date), <code>2</code> matrices, and a custom structure <code>feature</code>, which includes feature coordinates and <code>LBP</code> (<code>local binary pattern</code>) value. Here is output of the sample:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">%YAML:1.0</span></span><br><span class="line"><span class="attr">frameCount:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">calibrationDate:</span> <span class="string">"Sun Dec  3 14:59:13 2017\n"</span></span><br><span class="line"><span class="attr">cameraMatrix:</span> <span class="type">!!opencv</span><span class="bullet">-matrix</span></span><br><span class="line"><span class="attr">   rows:</span> <span class="number">3</span></span><br><span class="line"><span class="attr">   cols:</span> <span class="number">3</span></span><br><span class="line"><span class="attr">   dt:</span> <span class="string">d</span></span><br><span class="line"><span class="attr">   data:</span> <span class="string">[</span> <span class="number">1000.</span><span class="string">,</span> <span class="number">0.</span><span class="string">,</span> <span class="number">320.</span><span class="string">,</span> <span class="number">0.</span><span class="string">,</span> <span class="number">1000.</span><span class="string">,</span> <span class="number">240.</span><span class="string">,</span> <span class="number">0.</span><span class="string">,</span> <span class="number">0.</span><span class="string">,</span> <span class="number">1.</span> <span class="string">]</span></span><br><span class="line"><span class="attr">distCoeffs:</span> <span class="type">!!opencv</span><span class="bullet">-matrix</span></span><br><span class="line"><span class="attr">   rows:</span> <span class="number">5</span></span><br><span class="line"><span class="attr">   cols:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">   dt:</span> <span class="string">d</span></span><br><span class="line"><span class="attr">   data:</span> <span class="string">[</span> <span class="number">1.0000000000000001e-01</span><span class="string">,</span> <span class="number">1.0000000000000000e-02</span><span class="string">,</span></span><br><span class="line"><span class="bullet">       -</span><span class="number">1.0000000000000000e-03</span><span class="string">,</span> <span class="number">0.</span><span class="string">,</span> <span class="number">0.</span> <span class="string">]</span></span><br><span class="line"><span class="attr">features:</span></span><br><span class="line"><span class="bullet">   -</span> <span class="string">&#123;</span> <span class="attr">x:103,</span> <span class="attr">y:166,</span> <span class="attr">lbp:[</span> <span class="number">1</span><span class="string">,</span> <span class="number">0</span><span class="string">,</span> <span class="number">0</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">0</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">0</span> <span class="string">]</span> <span class="string">&#125;</span></span><br><span class="line"><span class="bullet">   -</span> <span class="string">&#123;</span> <span class="attr">x:115,</span> <span class="attr">y:113,</span> <span class="attr">lbp:[</span> <span class="number">1</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">1</span> <span class="string">]</span> <span class="string">&#125;</span></span><br><span class="line"><span class="bullet">   -</span> <span class="string">&#123;</span> <span class="attr">x:586,</span> <span class="attr">y:12,</span> <span class="attr">lbp:[</span> <span class="number">1</span><span class="string">,</span> <span class="number">0</span><span class="string">,</span> <span class="number">0</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">0</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">0</span><span class="string">,</span> <span class="number">0</span> <span class="string">]</span> <span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;To read the previously written <code>XML</code> or <code>YAML</code> file, do the following:</p>
<ol>
<li>Open the file storage using <code>FileStorage::FileStorage()</code> constructor or <code>FileStorage::open()</code> method. In the current implementation the whole file is parsed and the whole representation of file storage is built in memory as a hierarchy of file nodes.</li>
<li>Read the data you are interested in. Use <code>FileStorage::operator []()</code>, <code>FileNode::operator []()</code> and/or <code>FileNodeIterator</code>.</li>
<li>Close the storage using <code>FileStorage::release()</code>.</li>
</ol>
<p>&emsp;&emsp;Here is how to read the file created by the code sample above:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span>, <span class="keyword">char</span> **argv )</span> </span>&#123;</span><br><span class="line">    <span class="function">FileStorage <span class="title">fs2</span> <span class="params">( <span class="string">"test.yml"</span>, FileStorage::READ )</span></span>;</span><br><span class="line">    <span class="comment">/* first method: use (type) operator on FileNode. */</span></span><br><span class="line">    <span class="keyword">int</span> frameCount = ( <span class="keyword">int</span> ) fs2[<span class="string">"frameCount"</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> date;</span><br><span class="line">    <span class="comment">/* second method: use FileNode::operator &gt;&gt; */</span></span><br><span class="line">    fs2[<span class="string">"calibrationDate"</span>] &gt;&gt; date;</span><br><span class="line">    Mat cameraMatrix2, distCoeffs2;</span><br><span class="line">    fs2[<span class="string">"cameraMatrix"</span>] &gt;&gt; cameraMatrix2;</span><br><span class="line">    fs2[<span class="string">"distCoeffs"</span>] &gt;&gt; distCoeffs2;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"frameCount: "</span> &lt;&lt; frameCount &lt;&lt; <span class="built_in">endl</span></span><br><span class="line">         &lt;&lt; <span class="string">"calibration date: "</span> &lt;&lt; date &lt;&lt; <span class="built_in">endl</span></span><br><span class="line">         &lt;&lt; <span class="string">"camera matrix: "</span> &lt;&lt; cameraMatrix2 &lt;&lt; <span class="built_in">endl</span></span><br><span class="line">         &lt;&lt; <span class="string">"distortion coeffs: "</span> &lt;&lt; distCoeffs2 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    FileNode features = fs2[<span class="string">"features"</span>];</span><br><span class="line">    FileNodeIterator it = features.begin(), it_end = features.end();</span><br><span class="line">    <span class="keyword">int</span> idx = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;uchar&gt; lbpval;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* iterate through a sequence using FileNodeIterator */</span></span><br><span class="line">    <span class="keyword">for</span> ( ; it != it_end; ++it, idx++ ) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"feature #"</span> &lt;&lt; idx &lt;&lt; <span class="string">": "</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"x="</span> &lt;&lt; ( <span class="keyword">int</span> ) ( *it ) [<span class="string">"x"</span>] &lt;&lt; <span class="string">", y="</span> &lt;&lt; ( <span class="keyword">int</span> ) ( *it ) [<span class="string">"y"</span>] &lt;&lt; <span class="string">", lbp: ("</span>;</span><br><span class="line">        <span class="comment">/* you can also easily read numerical arrays using FileNode &gt;&gt; std::vector operator. */</span></span><br><span class="line">        ( *it ) [<span class="string">"lbp"</span>] &gt;&gt; lbpval;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ( <span class="keyword">int</span> ) lbpval.size(); i++ ) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; ( <span class="keyword">int</span> ) lbpval[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">")"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fs2.release();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The result is:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">frameCount:</span> <span class="number">5</span></span><br><span class="line"><span class="string">calibration</span> <span class="attr">date:</span> <span class="string">Sun</span> <span class="string">Dec</span>  <span class="number">3</span> <span class="number">14</span><span class="string">:59:13</span> <span class="number">2017</span></span><br><span class="line"><span class="string">camera</span> <span class="attr">matrix:</span> <span class="string">[1000,</span> <span class="number">0</span><span class="string">,</span> <span class="number">320</span><span class="string">;</span></span><br><span class="line">  <span class="number">0</span><span class="string">,</span> <span class="number">1000</span><span class="string">,</span> <span class="number">240</span><span class="string">;</span></span><br><span class="line">  <span class="number">0</span><span class="string">,</span> <span class="number">0</span><span class="string">,</span> <span class="number">1</span><span class="string">]</span></span><br><span class="line"><span class="string">distortion</span> <span class="attr">coeffs:</span> <span class="string">[0.1;</span></span><br><span class="line">  <span class="number">0.01</span><span class="string">;</span></span><br><span class="line"><span class="bullet">  -</span><span class="number">0.001</span><span class="string">;</span></span><br><span class="line">  <span class="number">0</span><span class="string">;</span></span><br><span class="line">  <span class="number">0</span><span class="string">]</span></span><br><span class="line"><span class="string">feature</span> <span class="comment">#0: x=103, y=166, lbp: ( 1 0 0 1 0 1 1 0)</span></span><br><span class="line"><span class="string">feature</span> <span class="comment">#1: x=115, y=113, lbp: ( 1 1 1 1 1 1 1 1)</span></span><br><span class="line"><span class="string">feature</span> <span class="comment">#2: x=586, y=12, lbp: ( 1 0 0 1 0 1 0 0)</span></span><br></pre></td></tr></table></figure>
<h3 id="class-FileStorage"><a href="#class-FileStorage" class="headerlink" title="class FileStorage"></a>class FileStorage</h3><p>&emsp;&emsp;<code>XML/YAML</code> file storage class that encapsulates all the information necessary for writing or reading data to/from a file.</p>
<h4 id="FileStorage-FileStorage"><a href="#FileStorage-FileStorage" class="headerlink" title="FileStorage::FileStorage"></a>FileStorage::FileStorage</h4><p>&emsp;&emsp;The constructors.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FileStorage::FileStorage();</span><br><span class="line">FileStorage::FileStorage ( <span class="keyword">const</span> <span class="built_in">string</span> &amp;source, <span class="keyword">int</span> flags, <span class="keyword">const</span> <span class="built_in">string</span> &amp;encoding = <span class="built_in">string</span>() );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>source</code>: Name of the file to open or the text string to read the data from. Extension of the file (<code>.xml</code> or <code>.yml</code>/<code>.yaml</code>) determines its format (<code>XML</code> or <code>YAML</code> respectively). Also you can append <code>.gz</code> to work with compressed files, for example <code>myHugeMatrix.xml.gz</code>. If both <code>FileStorage::WRITE</code> and <code>FileStorage::MEMORY</code> flags are specified, source is used just to specify the output file format (e.g. <code>mydata.xml</code>, <code>.yml</code> etc.).</li>
<li><code>flags</code>: Mode of operation. Possible values are:</li>
</ul>
<ol>
<li><code>FileStorage::READ</code> Open the file for reading.</li>
<li><code>FileStorage::WRITE</code> Open the file for writing.</li>
<li><code>FileStorage::APPEND</code> Open the file for appending.</li>
<li><code>FileStorage::MEMORY</code> Read data from source or write data to the internal buffer (which is returned by <code>FileStorage::release</code>).</li>
</ol>
<ul>
<li><code>encoding</code>: Encoding of the file. Note that <code>UTF-16</code> <code>XML</code> encoding is not supported currently and you should use <code>8-bit</code> encoding instead of it.</li>
</ul>
<p>&emsp;&emsp;The full constructor opens the file. Alternatively you can use the default constructor and then call <code>FileStorage::open()</code>.</p>
<h4 id="FileStorage-open"><a href="#FileStorage-open" class="headerlink" title="FileStorage::open"></a>FileStorage::open</h4><p>&emsp;&emsp;Opens a file.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> FileStorage::open ( <span class="keyword">const</span> <span class="built_in">string</span> &amp;filename, <span class="keyword">int</span> flags, <span class="keyword">const</span> <span class="built_in">string</span> &amp;encoding = <span class="built_in">string</span>() );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>filename</code>: Name of the file to open or the text string to read the data from. Extension of the file (<code>.xml</code> or <code>.yml</code>/<code>.yaml</code>) determines its format (<code>XML</code> or <code>YAML</code> respectively). Also you can append <code>.gz</code> to work with compressed files, for example <code>myHugeMatrix.xml.gz</code>. If both <code>FileStorage::WRITE</code> and <code>FileStorage::MEMORY</code> flags are specified, source is used just to specify the output file format (e.g. <code>mydata.xml</code>, <code>.yml</code> etc.).</li>
<li><code>flags</code>: Mode of operation.</li>
<li><code>encoding</code>: Encoding of the file. Note that <code>UTF-16</code> <code>XML</code> encoding is not supported currently and you should use <code>8-bit</code> encoding instead of it.</li>
</ul>
<h4 id="FileStorage-isOpened"><a href="#FileStorage-isOpened" class="headerlink" title="FileStorage::isOpened"></a>FileStorage::isOpened</h4><p>&emsp;&emsp;Checks whether the file is opened.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> FileStorage::isOpened() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return <code>true</code> if the object is associated with the current file and <code>false</code> otherwise.<br>&emsp;&emsp;It is a good practice to call this method after you tried to open a file.</p>
<h4 id="FileStorage-release"><a href="#FileStorage-release" class="headerlink" title="FileStorage::release"></a>FileStorage::release</h4><p>&emsp;&emsp;Closes the file and releases all the memory buffers.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> FileStorage::release();</span><br></pre></td></tr></table></figure>
<p>Call this method after all <code>I/O</code> operations with the storage are finished.</p>
<h4 id="FileStorage-releaseAndGetString"><a href="#FileStorage-releaseAndGetString" class="headerlink" title="FileStorage::releaseAndGetString"></a>FileStorage::releaseAndGetString</h4><p>&emsp;&emsp;Closes the file and releases all the memory buffers.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> FileStorage::releaseAndGetString();</span><br></pre></td></tr></table></figure>
<p>Call this method after all <code>I/O</code> operations with the storage are finished. If the storage was opened for writing data and <code>FileStorage::WRITE</code> was specified</p>
<h4 id="FileStorage-getFirstTopLevelNode"><a href="#FileStorage-getFirstTopLevelNode" class="headerlink" title="FileStorage::getFirstTopLevelNode"></a>FileStorage::getFirstTopLevelNode</h4><p>&emsp;&emsp;Returns the first element of the <code>top-level</code> mapping.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNode FileStorage::getFirstTopLevelNode() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return The first element of the <code>top-level</code> mapping.</p>
<h4 id="FileStorage-root"><a href="#FileStorage-root" class="headerlink" title="FileStorage::root"></a>FileStorage::root</h4><p>&emsp;&emsp;Return the <code>top-level</code> mapping.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNode FileStorage::root ( <span class="keyword">int</span> streamidx = <span class="number">0</span> ) <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>streamidx</code>: Zero-based index of the stream. In most cases there is only one stream in the file. However, YAML supports multiple streams and so there can be several.</li>
</ul>
<h4 id="FileStorage-operator"><a href="#FileStorage-operator" class="headerlink" title="FileStorage::operator[]"></a>FileStorage::operator[]</h4><p>&emsp;&emsp;Returns the specified element of the <code>top-level</code> mapping.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FileNode FileStorage::<span class="keyword">operator</span>[] ( <span class="keyword">const</span> <span class="built_in">string</span> &amp;nodename ) <span class="keyword">const</span>;</span><br><span class="line">FileNode FileStorage::<span class="keyword">operator</span>[] ( <span class="keyword">const</span> <span class="keyword">char</span> *nodename ) <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>nodename</code>: Name of the file node.</li>
</ul>
<h4 id="FileStorage-operator-1"><a href="#FileStorage-operator-1" class="headerlink" title="FileStorage::operator*"></a>FileStorage::operator*</h4><p>&emsp;&emsp;Returns the obsolete <code>C</code> <code>FileStorage</code> structure.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CvFileStorage *FileStorage::<span class="keyword">operator</span>*();</span><br><span class="line"><span class="keyword">const</span> CvFileStorage *FileStorage::<span class="keyword">operator</span>*() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<h4 id="FileStorage-writeRaw"><a href="#FileStorage-writeRaw" class="headerlink" title="FileStorage::writeRaw"></a>FileStorage::writeRaw</h4><p>&emsp;&emsp;Writes multiple numbers.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> FileStorage::writeRaw ( <span class="keyword">const</span> <span class="built_in">string</span> &amp;fmt, <span class="keyword">const</span> uchar *vec, <span class="keyword">size_t</span> len );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fmt</code>: Specification of each array element that has the following format (<code>[count]{&#39;u&#39;|&#39;c&#39;|&#39;w&#39;|&#39;s&#39;|&#39;i&#39;|&#39;f&#39;|&#39;d&#39;}</code>) where the characters correspond to fundamental <code>C++</code> types:</li>
</ul>
<ol>
<li><code>u</code>: <code>8-bit</code> unsigned number.</li>
<li><code>c</code>: <code>8-bit</code> signed number.</li>
<li><code>w</code>: <code>16-bit</code> unsigned number.</li>
<li><code>s</code>: <code>16-bit</code> signed number.</li>
<li><code>i</code>: <code>32-bit</code> signed number.</li>
<li><code>f</code>: single precision <code>floating-point</code> number.</li>
<li><code>d</code>: double precision <code>floating-point</code> number.</li>
</ol>
<p>&emsp;&emsp;<code>count</code> is the optional counter of values of a given type. For example, <code>2if</code> means that each array element is a structure of <code>2</code> integers, followed by a <code>single-precision</code> <code>floating-point</code> number. The equivalent notations of the above specification are <code>(space)iif(space)</code>, <code>(space)2i1f(space)</code> and so forth. Other examples: <code>u</code> means that the array consists of bytes, and <code>2d</code> means the array consists of pairs of doubles.</p>
<ul>
<li><code>vec</code>: Pointer to the written array.</li>
<li><code>len</code>: Number of the uchar elements to write.</li>
</ul>
<p>&emsp;&emsp;Writes one or more numbers of the specified format to the currently written structure. Usually it is more convenient to use <code>operator &lt;&lt;()</code> instead of this method.</p>
<h4 id="FileStorage-writeObj"><a href="#FileStorage-writeObj" class="headerlink" title="FileStorage::writeObj"></a>FileStorage::writeObj</h4><p>&emsp;&emsp;Writes the registered <code>C</code> structure (<code>CvMat</code>, <code>CvMatND</code>, <code>CvSeq</code>).</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> FileStorage::writeObj ( <span class="keyword">const</span> <span class="built_in">string</span> &amp;name, <span class="keyword">const</span> <span class="keyword">void</span> *obj );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>name</code>: Name of the written object.</li>
<li><code>obj</code>: Pointer to the object.</li>
</ul>
<h4 id="FileStorage-getDefaultObjectName"><a href="#FileStorage-getDefaultObjectName" class="headerlink" title="FileStorage::getDefaultObjectName"></a>FileStorage::getDefaultObjectName</h4><p>&emsp;&emsp;Returns the normalized object name for the specified name of a file.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="built_in">string</span> FileStorage::getDefaultObjectName ( <span class="keyword">const</span> <span class="built_in">string</span> &amp;filename );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>filename</code>: Name of a file.</li>
</ul>
<h4 id="operator-lt-lt"><a href="#operator-lt-lt" class="headerlink" title="operator &lt;&lt;"></a>operator &lt;&lt;</h4><p>&emsp;&emsp;Writes data to a file storage.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _Tp&gt; FileStorage &amp;<span class="keyword">operator</span>&lt;&lt; ( FileStorage &amp;fs, <span class="keyword">const</span> _Tp &amp;value );</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _Tp&gt; FileStorage &amp;<span class="keyword">operator</span>&lt;&lt; ( FileStorage &amp;fs, <span class="keyword">const</span> <span class="built_in">vector</span>&lt;_Tp&gt; &amp;vec );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fs</code>: Opened file storage to write data.</li>
<li><code>value</code>: Value to be written to the file storage.</li>
<li><code>vec</code>: Vector of values to be written to the file storage.</li>
</ul>
<p>&emsp;&emsp;It is the main function to write data to a file storage.</p>
<h4 id="operator-gt-gt"><a href="#operator-gt-gt" class="headerlink" title="operator &gt;&gt;"></a>operator &gt;&gt;</h4><p>&emsp;&emsp;Reads data from a file storage.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _Tp&gt; <span class="keyword">void</span> <span class="keyword">operator</span>&gt;&gt; ( <span class="keyword">const</span> FileNode &amp;n, _Tp &amp;value );</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _Tp&gt; <span class="keyword">void</span> <span class="keyword">operator</span>&gt;&gt; ( <span class="keyword">const</span> FileNode &amp;n, <span class="built_in">vector</span>&lt;_Tp&gt; &amp;vec );</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _Tp&gt; FileNodeIterator &amp;<span class="keyword">operator</span>&gt;&gt; ( FileNodeIterator &amp;it, _Tp &amp;value );</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _Tp&gt; FileNodeIterator &amp;<span class="keyword">operator</span>&gt;&gt; ( FileNodeIterator &amp;it, <span class="built_in">vector</span>&lt;_Tp&gt; &amp;vec );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>n</code>: Node from which data will be read.</li>
<li><code>it</code>: Iterator from which data will be read.</li>
<li><code>value</code>: Value to be read from the file storage.</li>
<li><code>vec</code>: Vector of values to be read from the file storage.</li>
</ul>
<p>&emsp;&emsp;It is the main function to read data from a file storage.</p>
<h3 id="class-FileNode"><a href="#class-FileNode" class="headerlink" title="class FileNode"></a>class FileNode</h3><p>&emsp;&emsp;<code>File Storage Node</code> class. The node is used to store each and every element of the file storage opened for reading. When <code>XML/YAML</code> file is read, it is first parsed and stored in the memory as a hierarchical collection of nodes. Each node can be a <code>leaf</code> that is contain a single number or a string, or be a collection of other nodes. There can be named collections (<code>mappings</code>) where each element has a name and it is accessed by a name, and ordered collections (<code>sequences</code>) where elements do not have names but rather accessed by index. Type of the file node can be determined using <code>FileNode::type()</code> method.<br>&emsp;&emsp;Note that file nodes are only used for navigating file storages opened for reading. When a file storage is opened for writing, no data is stored in memory after it is written.</p>
<h4 id="FileNode-FileNode"><a href="#FileNode-FileNode" class="headerlink" title="FileNode::FileNode"></a>FileNode::FileNode</h4><p>&emsp;&emsp;The constructors.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FileNode::FileNode();</span><br><span class="line">FileNode::FileNode ( <span class="keyword">const</span> CvFileStorage *fs, <span class="keyword">const</span> CvFileNode *node );</span><br><span class="line">FileNode::FileNode ( <span class="keyword">const</span> FileNode &amp;node );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fs</code>: Pointer to the obsolete file storage structure.</li>
<li><code>node</code>: File node to be used as initialization for the created file node.</li>
</ul>
<p>&emsp;&emsp;These constructors are used to create a default file node, construct it from obsolete structures or from the another file node.</p>
<h4 id="FileNode-operator"><a href="#FileNode-operator" class="headerlink" title="FileNode::operator[]"></a>FileNode::operator[]</h4><p>&emsp;&emsp;Returns element of a mapping node or a sequence node.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FileNode FileNode::<span class="keyword">operator</span>[] ( <span class="keyword">const</span> <span class="built_in">string</span> &amp;nodename ) <span class="keyword">const</span>;</span><br><span class="line">FileNode FileNode::<span class="keyword">operator</span>[] ( <span class="keyword">const</span> <span class="keyword">char</span> *nodename ) <span class="keyword">const</span>;</span><br><span class="line">FileNode FileNode::<span class="keyword">operator</span>[] ( <span class="keyword">int</span> i ) <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>nodename</code>: Name of an element in the mapping node.</li>
<li><code>i</code>: Index of an element in the sequence node.</li>
</ul>
<h4 id="FileNode-type"><a href="#FileNode-type" class="headerlink" title="FileNode::type"></a>FileNode::type</h4><p>&emsp;&emsp;Returns type of the node.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> FileNode::type() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Possible values are:</p>
<ul>
<li><code>FileNode::NONE</code>: Empty node.</li>
<li><code>FileNode::INT</code>: Integer.</li>
<li><code>FileNode::REAL</code>: <code>Floating-point</code> number.</li>
<li><code>FileNode::FLOAT</code>: <code>Synonym</code> or <code>REAL</code>.</li>
<li><code>FileNode::STR</code>: Text string in <code>UTF-8</code> encoding.</li>
<li><code>FileNode::STRING</code>: Synonym for <code>STR</code>.</li>
<li><code>FileNode::REF</code>: Integer of type <code>size_t</code>. Typically used for storing complex dynamic structures where some elements reference the others.</li>
<li><code>FileNode::SEQ</code>: Sequence.</li>
<li><code>FileNode::MAP</code>: Mapping.</li>
<li><code>FileNode::FLOW</code>: Compact representation of a sequence or mapping. Used only by the <code>YAML</code> writer.</li>
<li><code>FileNode::USER</code>: Registered object (e.g. a matrix).</li>
<li><code>FileNode::EMPTY</code>: Empty structure (sequence or mapping).</li>
<li><code>FileNode::NAMED</code>: The node has a name (i.e. it is an element of a mapping).</li>
</ul>
<h4 id="FileNode-empty"><a href="#FileNode-empty" class="headerlink" title="FileNode::empty"></a>FileNode::empty</h4><p>&emsp;&emsp;Checks whether the node is empty.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> FileNode::empty() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return <code>true</code> if the node is empty.</p>
<h4 id="FileNode-isNone"><a href="#FileNode-isNone" class="headerlink" title="FileNode::isNone"></a>FileNode::isNone</h4><p>&emsp;&emsp;Checks whether the node is a <code>none</code> object.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> FileNode::isNone() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return <code>true</code> if the node is a <code>none</code> object.</p>
<h4 id="FileNode-isSeq"><a href="#FileNode-isSeq" class="headerlink" title="FileNode::isSeq"></a>FileNode::isSeq</h4><p>&emsp;&emsp;Checks whether the node is a sequence.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> FileNode::isSeq() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return <code>true</code> if the node is a sequence.</p>
<h4 id="FileNode-isMap"><a href="#FileNode-isMap" class="headerlink" title="FileNode::isMap"></a>FileNode::isMap</h4><p>&emsp;&emsp;Checks whether the node is a mapping.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> FileNode::isMap() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return <code>true</code> if the node is a mapping.</p>
<h4 id="FileNode-isInt"><a href="#FileNode-isInt" class="headerlink" title="FileNode::isInt"></a>FileNode::isInt</h4><p>&emsp;&emsp;Checks whether the node is an integer.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> FileNode::isInt() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return <code>true</code> if the node is an integer.</p>
<h4 id="FileNode-isReal"><a href="#FileNode-isReal" class="headerlink" title="FileNode::isReal"></a>FileNode::isReal</h4><p>&emsp;&emsp;Checks whether the node is a <code>floating-point</code> number.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> FileNode::isReal() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return <code>true</code> if the node is a <code>floating-point</code> number.</p>
<h4 id="FileNode-isString"><a href="#FileNode-isString" class="headerlink" title="FileNode::isString"></a>FileNode::isString</h4><p>&emsp;&emsp;Checks whether the node is a text string.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> FileNode::isString() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return <code>true</code> if the node is a text string.</p>
<h4 id="FileNode-isNamed"><a href="#FileNode-isNamed" class="headerlink" title="FileNode::isNamed"></a>FileNode::isNamed</h4><p>&emsp;&emsp;Checks whether the node has a name.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> FileNode::isNamed() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return <code>true</code> if the node has a name.</p>
<h4 id="FileNode-name"><a href="#FileNode-name" class="headerlink" title="FileNode::name"></a>FileNode::name</h4><p>&emsp;&emsp;Returns the node name.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> FileNode::name() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return the node name or an empty string if the node is nameless.</p>
<h4 id="FileNode-size"><a href="#FileNode-size" class="headerlink" title="FileNode::size"></a>FileNode::size</h4><p>&emsp;&emsp;Returns the number of elements in the node.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">size_t</span> FileNode::size() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<p>Return the number of elements in the node, if it is a sequence or mapping, or <code>1</code> otherwise.</p>
<h4 id="FileNode-operator-int"><a href="#FileNode-operator-int" class="headerlink" title="FileNode::operator int"></a>FileNode::operator int</h4><p>&emsp;&emsp;Returns the node content as an integer.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNode::<span class="function"><span class="keyword">operator</span> <span class="title">int</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br></pre></td></tr></table></figure>
<p>Return the node content as an integer. If the node stores a <code>floating-point</code> number, it is rounded.</p>
<h4 id="FileNode-operator-float"><a href="#FileNode-operator-float" class="headerlink" title="FileNode::operator float"></a>FileNode::operator float</h4><p>&emsp;&emsp;Returns the node content as float.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNode::<span class="function"><span class="keyword">operator</span> <span class="title">float</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br></pre></td></tr></table></figure>
<h4 id="FileNode-operator-double"><a href="#FileNode-operator-double" class="headerlink" title="FileNode::operator double"></a>FileNode::operator double</h4><p>&emsp;&emsp;Returns the node content as double.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNode::<span class="function"><span class="keyword">operator</span> <span class="title">double</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br></pre></td></tr></table></figure>
<h4 id="FileNode-operator-string"><a href="#FileNode-operator-string" class="headerlink" title="FileNode::operator string"></a>FileNode::operator string</h4><p>&emsp;&emsp;Returns the node content as text string.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNode::<span class="function"><span class="keyword">operator</span> <span class="title">string</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br></pre></td></tr></table></figure>
<h4 id="FileNode-operator-1"><a href="#FileNode-operator-1" class="headerlink" title="FileNode::operator*"></a>FileNode::operator*</h4><p>&emsp;&emsp;Returns pointer to the underlying obsolete file node structure.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CvFileNode *FileNode::<span class="keyword">operator</span>*();</span><br></pre></td></tr></table></figure>
<h4 id="FileNode-begin"><a href="#FileNode-begin" class="headerlink" title="FileNode::begin"></a>FileNode::begin</h4><p>&emsp;&emsp;Returns the iterator pointing to the first node element.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNodeIterator FileNode::begin() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<h4 id="FileNode-end"><a href="#FileNode-end" class="headerlink" title="FileNode::end"></a>FileNode::end</h4><p>&emsp;&emsp;Returns the iterator pointing to the element following the last node element.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNodeIterator FileNode::end() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<h4 id="FileNode-readRaw"><a href="#FileNode-readRaw" class="headerlink" title="FileNode::readRaw"></a>FileNode::readRaw</h4><p>&emsp;&emsp;Reads node elements to the buffer with the specified format.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> FileNode::readRaw ( <span class="keyword">const</span> <span class="built_in">string</span> &amp;fmt, uchar *vec, <span class="keyword">size_t</span> len ) <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fmt</code>: Specification of each array element. It has the same format as in <code>FileStorage::writeRaw()</code>.</li>
<li><code>vec</code>: Pointer to the destination array.</li>
<li><code>len</code>: Number of elements to read. If it is greater than number of remaining elements then all of them will be read.</li>
</ul>
<p>Usually it is more convenient to use <code>operator &gt;&gt;()</code> instead of this method.</p>
<h4 id="FileNode-readObj"><a href="#FileNode-readObj" class="headerlink" title="FileNode::readObj"></a>FileNode::readObj</h4><p>&emsp;&emsp;Reads the registered object.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> *FileNode::readObj() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<h3 id="class-FileNodeIterator"><a href="#class-FileNodeIterator" class="headerlink" title="class FileNodeIterator"></a>class FileNodeIterator</h3><p>&emsp;&emsp;The class <code>FileNodeIterator</code> is used to iterate through sequences and mappings. A standard <code>STL</code> notation, with <code>node.begin()</code>, <code>node.end()</code> denoting the beginning and the end of a sequence, stored in node.</p>
<h4 id="FileNodeIterator-FileNodeIterator"><a href="#FileNodeIterator-FileNodeIterator" class="headerlink" title="FileNodeIterator::FileNodeIterator"></a>FileNodeIterator::FileNodeIterator</h4><p>&emsp;&emsp;The constructors.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FileNodeIterator::FileNodeIterator();</span><br><span class="line">FileNodeIterator::FileNodeIterator ( <span class="keyword">const</span> CvFileStorage *fs, <span class="keyword">const</span> CvFileNode *node, <span class="keyword">size_t</span> ofs = <span class="number">0</span> );</span><br><span class="line">FileNodeIterator::FileNodeIterator ( <span class="keyword">const</span> FileNodeIterator &amp;it );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fs</code>: File storage for the iterator.</li>
<li><code>node</code>: File node for the iterator.</li>
<li><code>ofs</code>: Index of the element in the node. The created iterator will point to this element.</li>
<li><code>it</code>: Iterator to be used as initialization for the created iterator.</li>
</ul>
<p>These constructors are used to create a default iterator, set it to specific element in a file node or construct it from another iterator.</p>
<h4 id="FileNodeIterator-operator"><a href="#FileNodeIterator-operator" class="headerlink" title="FileNodeIterator::operator*"></a>FileNodeIterator::operator*</h4><p>&emsp;&emsp;Returns the currently observed element.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNode FileNodeIterator::<span class="keyword">operator</span>*() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<h4 id="FileNodeIterator-operator-gt"><a href="#FileNodeIterator-operator-gt" class="headerlink" title="FileNodeIterator::operator-&gt;"></a>FileNodeIterator::operator-&gt;</h4><p>&emsp;&emsp;Accesses methods of the currently observed element.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNode FileNodeIterator::<span class="keyword">operator</span>-&gt;() <span class="keyword">const</span>;</span><br></pre></td></tr></table></figure>
<h4 id="FileNodeIterator-operator-1"><a href="#FileNodeIterator-operator-1" class="headerlink" title="FileNodeIterator::operator ++"></a>FileNodeIterator::operator ++</h4><p>&emsp;&emsp;Moves iterator to the next node.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FileNodeIterator &amp;FileNodeIterator::<span class="keyword">operator</span>++();</span><br><span class="line">FileNodeIterator FileNodeIterator::<span class="keyword">operator</span>++ ( <span class="keyword">int</span> None );</span><br></pre></td></tr></table></figure>
<h4 id="FileNodeIterator-operator-—"><a href="#FileNodeIterator-operator-—" class="headerlink" title="FileNodeIterator::operator —"></a>FileNodeIterator::operator —</h4><p>&emsp;&emsp;Moves iterator to the previous node.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FileNodeIterator &amp;FileNodeIterator::<span class="keyword">operator</span>--();</span><br><span class="line">FileNodeIterator FileNodeIterator::<span class="keyword">operator</span>-- ( <span class="keyword">int</span> None );</span><br></pre></td></tr></table></figure>
<h4 id="FileNodeIterator-operator-2"><a href="#FileNodeIterator-operator-2" class="headerlink" title="FileNodeIterator::operator +="></a>FileNodeIterator::operator +=</h4><p>&emsp;&emsp;Moves iterator forward by the specified offset.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNodeIterator &amp;FileNodeIterator::<span class="keyword">operator</span>+= ( <span class="keyword">int</span> ofs );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ofs</code>: Offset (possibly negative) to move the iterator.</li>
</ul>
<h4 id="FileNodeIterator-operator-3"><a href="#FileNodeIterator-operator-3" class="headerlink" title="FileNodeIterator::operator -="></a>FileNodeIterator::operator -=</h4><p>&emsp;&emsp;Moves iterator backward by the specified offset (possibly negative).</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FileNodeIterator &amp;FileNodeIterator::<span class="keyword">operator</span>-= ( <span class="keyword">int</span> ofs );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ofs</code>: Offset (possibly negative) to move the iterator.</li>
</ul>
<h4 id="FileNodeIterator-readRaw"><a href="#FileNodeIterator-readRaw" class="headerlink" title="FileNodeIterator::readRaw"></a>FileNodeIterator::readRaw</h4><p>&emsp;&emsp;Reads node elements to the buffer with the specified format.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FileNodeIterator &amp;FileNodeIterator::readRaw (</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">string</span> &amp;fmt, uchar *vec,</span><br><span class="line">    <span class="keyword">size_t</span> maxCount = ( <span class="keyword">size_t</span> ) INT_MAX );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fmt</code>: Specification of each array element. It has the same format as in <code>FileStorage::writeRaw()</code>.</li>
<li><code>vec</code>: Pointer to the destination array.</li>
<li><code>maxCount</code>: Number of elements to read. If it is greater than number of remaining elements then all of them will be read.</li>
</ul>
<p>Usually it is more convenient to use <code>operator &gt;&gt;()</code> instead of this method.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/opencv和图像处理/OpenCV基本数据类型/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/opencv和图像处理/OpenCV基本数据类型/" itemprop="url">OpenCV基本数据类型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T16:37:31+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>OpenCV</code>提供了多种基本数据类型，虽然这些数据类型在<code>C</code>语言中不是基本类型，但结构都很简单，可将它们作为原子类型。可以在<code>/OpenCV/cxcore/include</code>目录下的<code>cxtypes.h</code>文件中查看其详细定义。<br>&emsp;&emsp;数据类型中最简单的就是<code>CvPoint</code>，它是一个包含<code>integer</code>类型成员<code>x</code>和<code>y</code>的简单结构体。<code>CvPoint</code>有两个变体类型，即<code>CvPoint2D32f</code>和<code>CvPoint3D32f</code>。前者同样有两个成员<code>x</code>和<code>y</code>，但它们是浮点类型；而后者却多了一个浮点类型的成员<code>z</code>。<br>&emsp;&emsp;<code>CvSize</code>类型与<code>CvPoint</code>非常相似，但它的数据成员是<code>integer</code>类型的<code>width</code>和<code>height</code>。如果希望使用浮点类型，则选用<code>CvSize</code>的变体类型<code>CvSize2D32f</code>。<br>&emsp;&emsp;<code>CvRect</code>类型派生于<code>CvPoint</code>和<code>CvSize</code>，它包含<code>4</code>个数据成员，即<code>x</code>、<code>y</code>、<code>width</code>和<code>height</code>。</p>
<h3 id="CvScalar"><a href="#CvScalar" class="headerlink" title="CvScalar"></a>CvScalar</h3><p>&emsp;&emsp;<code>C</code>语言接口中定义为结构体<code>CvScalar</code>，<code>C++</code>接口中定义为类<code>Scalar</code>。<code>CvScalar</code>中包含一个可以用来存放<code>4</code>个<code>double</code>数值的数组，一般用来存放像素值，最多可以存放<code>4</code>个通道。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">CvScalar</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> val[<span class="number">4</span>];</span><br><span class="line">&#125; CvScalar;</span><br></pre></td></tr></table></figure>
<p>赋值函数有如下几种：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> CvScalar <span class="title">cvScalar</span> <span class="params">( <span class="keyword">double</span> val0, <span class="keyword">double</span> val1 = <span class="number">0</span>, <span class="keyword">double</span> val2 = <span class="number">0</span>, <span class="keyword">double</span> val3 = <span class="number">0</span> )</span></span>;</span><br></pre></td></tr></table></figure>
<p>最通用的函数，可初始化<code>1</code>至<code>4</code>个通道。<code>cvScalar(255)</code>用于存放单通道图像中的像素，<code>cvScalar(255, 255, 255)</code>用于存放三通道图像中的像素。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> CvScalar <span class="title">cvRealScalar</span> <span class="params">( <span class="keyword">double</span> val0 )</span></span>;</span><br></pre></td></tr></table></figure>
<p>该函数只使用第一个通道，即<code>val[0] = val0</code>，等同于<code>cvScalar(val0, 0, 0, 0)</code>。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> CvScalar <span class="title">cvScalarAll</span> <span class="params">( <span class="keyword">double</span> val0123 )</span></span>;</span><br></pre></td></tr></table></figure>
<p>所用通道都用<code>val0123</code>进行赋值。<br>&emsp;&emsp;<code>CV_RGB</code>是<code>OPENCV</code>中的一个宏，用于创建一个色彩值：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CV_RGB(r, g, b)  cvScalar((b), (g), (r), 0)</span></span><br></pre></td></tr></table></figure>
<p>当转换为<code>cvScalar</code>时，<code>rgb</code>的顺序变为<code>bgr</code>，这是因为<code>opencv</code>存储<code>RGB</code>模式的彩图时，采用的通道顺序是<code>BGR</code>。<br>&emsp;&emsp;各数据类型的内联构造函数被列在下表中：<code>cvPoint</code>、<code>cvSize</code>、<code>cvRect</code>和<code>cvScalar</code>。这些结构都十分有用，因为它们不仅使代码更容易编写，而且也更易于阅读。假设要在<code>(5, 10)</code>和<code>(20, 30)</code>之间画一个白色矩形，只需简单调用：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cvRectangle ( myImg, cvPoint ( <span class="number">5</span>, <span class="number">10</span> ), cvPoint ( <span class="number">20</span>, <span class="number">30</span> ), cvScalar ( <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span> ) );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>points</code>、<code>size</code>、<code>rectangles</code>和<code>calar</code>三元组的结构如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>结构</th>
<th>成员</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CvPoint</code></td>
<td><code>int x, y</code></td>
<td>图像中的点</td>
</tr>
<tr>
<td><code>CvPoint2D32f</code></td>
<td><code>float x, y</code></td>
<td>二维空间中的点</td>
</tr>
<tr>
<td><code>CvPoint3D32f</code></td>
<td><code>float x, y, z</code></td>
<td>三维空间中的点</td>
</tr>
<tr>
<td><code>CvSize</code></td>
<td><code>int width, height</code></td>
<td>图像的尺寸</td>
</tr>
<tr>
<td><code>CvRect</code></td>
<td><code>int x, y, width, height</code></td>
<td>图像的部分区域</td>
</tr>
<tr>
<td><code>CvScalar</code></td>
<td><code>double val[4]</code></td>
<td><code>RGBA</code>值</td>
</tr>
</tbody>
</table>
</div>
<h3 id="矩阵和图像类型"><a href="#矩阵和图像类型" class="headerlink" title="矩阵和图像类型"></a>矩阵和图像类型</h3><p>&emsp;&emsp;下图为我们展示了三种图像的类或结构层次结构。使用<code>OpenCV</code>时，会频繁遇到<code>IplImage</code>数据类型，<code>IplImage</code>是我们用来为通常所说的图像进行编码的基本结构。这些图像可能是灰度、彩色、<code>4</code>通道的(<code>RGB + alpha</code>)，其中每个通道可以包含任意的整数或浮点数。因此，该类型比常见的、易于理解的<code>3</code>通道<code>8</code>位<code>RGB</code>图像更通用。<br>&emsp;&emsp;<code>OpenCV</code>提供了大量实用的图像操作符，包括缩放图像、单通道提取、找出特定通道最大最小值、两个图像求和、对图像进行阈值操作等。<br>&emsp;&emsp;虽然<code>OpenCV</code>是由<code>C</code>语言实现的，但它使用的结构体也是遵循面向对象的思想设计的。实际上，<code>IplImage</code>由<code>CvMat</code>派生，而<code>CvMat</code>由<code>CvArr</code>派生。</p>
<p><img src="/2019/02/23/opencv和图像处理/OpenCV基本数据类型/1.png"></p>
<p>&emsp;&emsp;在开始探讨图像细节之前，我们需要先了解另一种数据类型<code>CvMat</code>，它是<code>OpenCV</code>的矩阵结构。虽然<code>OpenCV</code>完全由<code>C</code>语言实现，但<code>CvMat</code>和<code>IplImage</code>之间的关系就如同<code>C++</code>中的继承关系。实质上，<code>IplImage</code>可以被视为从<code>CvMat</code>中派生的。因此在试图了解复杂的派生类之前，最好先了解基本的类。第三个类<code>CvArr</code>可以被视为一个抽象基类，<code>CvMat</code>由它派生。在函数原型中，会经常看到<code>CvArr</code>(更准确地说是<code>CvArr *</code>)，当它出现时，便可以将<code>CvMat *</code>或<code>IplImage *</code>传递到程序。</p>
<h3 id="CvMat矩阵结构"><a href="#CvMat矩阵结构" class="headerlink" title="CvMat矩阵结构"></a>CvMat矩阵结构</h3><p>&emsp;&emsp;在开始学习矩阵的相关内容之前，我们需要知道两件事情：第一，在<code>OpenCV</code>中没有向量(<code>vector</code>)结构。任何时候需要向量，都只需要一个列矩阵(如果需要一个转置或者共轭向量，则需要一个行矩阵)；第二，<code>OpenCV</code>矩阵的概念与我们在线性代数课上学习的概念相比，更加抽象，尤其是矩阵的元素，并非只能取简单的数值类型。例如，一个用于新建一个二维矩阵的例程具有以下原型：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">cvMat *<span class="title">cvCreateMat</span> <span class="params">( <span class="keyword">int</span> rows, <span class="keyword">int</span> cols, <span class="keyword">int</span> type )</span></span>;</span><br></pre></td></tr></table></figure>
<p><code>type</code>可以是任何预定义类型，预定义类型的结构如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CV_&lt;bit_depth&gt; (S|U|F)C&lt;number_of_channels&gt;</span><br></pre></td></tr></table></figure>
<p>于是，矩阵的元素可以是<code>32</code>位浮点型数据(<code>CV_32FC1</code>)，或者是无符号的<code>8</code>位三元组的整型数据(<code>CV_8UC3</code>)，或者是无数的其他类型的元素。一个<code>CvMat</code>的元素不一定就是个单一的数字。在矩阵中可以通过单一(简单)的输入来表示多值，这样我们可以在一个三原色图像上描绘多重色彩通道。对于一个包含<code>RGB</code>通道的简单图像，大多数的图像操作将分别应用于每一个通道(除非另有说明)。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">CvMat</span> &#123;</span> <span class="comment">/* CvMat矩阵头 */</span></span><br><span class="line">    <span class="keyword">int</span> type; <span class="comment">/* 数据类型 */</span></span><br><span class="line">    <span class="keyword">int</span> step; <span class="comment">/* 每行数据的字节数：元素个数*元素类型的字节长度 */</span></span><br><span class="line">    <span class="keyword">int</span> *refcount; <span class="comment">/* for internal use only */</span></span><br><span class="line">    <span class="keyword">int</span> hdr_refcount;</span><br><span class="line">    <span class="keyword">union</span> &#123;</span><br><span class="line">        uchar *ptr; <span class="comment">/* 指向data数据的第一个元素 */</span></span><br><span class="line">        <span class="keyword">short</span> *s;</span><br><span class="line">        <span class="keyword">int</span> *i;</span><br><span class="line">        <span class="keyword">float</span> *fl;</span><br><span class="line">        <span class="keyword">double</span> *db;</span><br><span class="line">    &#125; data; <span class="comment">/* 共同体data，里面成员共用一个空间 */</span></span><br><span class="line">    <span class="keyword">union</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> rows; <span class="comment">/* 像素的行数 */</span></span><br><span class="line">        <span class="keyword">int</span> height; <span class="comment">/* 图片的高度 */</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">union</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> cols; <span class="comment">/* 像素的列数 */</span></span><br><span class="line">        <span class="keyword">int</span> width; <span class="comment">/* 图片的宽度 */</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125; CvMat;</span><br></pre></td></tr></table></figure>
<h3 id="IplImage数据结构"><a href="#IplImage数据结构" class="headerlink" title="IplImage数据结构"></a>IplImage数据结构</h3><p>&emsp;&emsp;从本质上讲，它是一个<code>CvMat</code>对象，但它还有其他一些成员变量将矩阵解释为图像。这个结构最初被定义为<code>Intel</code>图像处理库(<code>IPL</code>)的一部分。<code>IplImage</code>结构的准确定义如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IplImage</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> nSize;</span><br><span class="line">    <span class="keyword">int</span> ID;</span><br><span class="line">    <span class="keyword">int</span> nChannels;</span><br><span class="line">    <span class="keyword">int</span> alphaChannel;</span><br><span class="line">    <span class="keyword">int</span> depth;</span><br><span class="line">    <span class="keyword">char</span> colorModel[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">char</span> channelSeq[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">int</span> dataOrder;</span><br><span class="line">    <span class="keyword">int</span> origin;</span><br><span class="line">    <span class="keyword">int</span> align;</span><br><span class="line">    <span class="keyword">int</span> width;</span><br><span class="line">    <span class="keyword">int</span> height;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">IplROI</span> *<span class="title">roi</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">IplImage</span> *<span class="title">maskROI</span>;</span></span><br><span class="line">    <span class="keyword">void</span> *imageId;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">IplTileInfo</span> *<span class="title">tileInfo</span>;</span></span><br><span class="line">    <span class="keyword">int</span> imageSize;</span><br><span class="line">    <span class="keyword">char</span> *imageData;</span><br><span class="line">    <span class="keyword">int</span> widthStep;</span><br><span class="line">    <span class="keyword">int</span> BorderMode[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">int</span> BorderConst[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">char</span> *imageDataOrigin;</span><br><span class="line">&#125; IplImage;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>width</code>和<code>height</code>这两个变量很重要，其次是<code>depth</code>和<code>nchannals</code>。<code>depth</code>变量的值取自<code>ipl.h</code>中定义的一组数据，但与在矩阵中看到的对应变量不同。因为在图像中，我们往往将深度和通道数分开处理，而在矩阵中，我们往往同时表示它们。可用的深度值如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>宏</th>
<th>图像像素类型</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>IPL_DEPTH_8U</code></td>
<td>无符号<code>8</code>位整数(<code>8u</code>)</td>
</tr>
<tr>
<td><code>IPL_DEPTH_8S</code></td>
<td>有符号<code>8</code>位整数(<code>8s</code>)</td>
</tr>
<tr>
<td><code>IPL_DEPTH_16S</code></td>
<td>有符号<code>16</code>位整数(<code>16s</code>)</td>
</tr>
<tr>
<td><code>IPL_DEPTH_32S</code></td>
<td>有符号<code>32</code>位整数(<code>32s</code>)</td>
</tr>
<tr>
<td><code>IPL_DEPTH_32F</code></td>
<td><code>32</code>位浮点数单精度(<code>32f</code>)</td>
</tr>
<tr>
<td><code>IPL_DEPTH_64F</code></td>
<td><code>64</code>位浮点数双精度(<code>64f</code>)</td>
</tr>
</tbody>
</table>
</div>
<p>通道数<code>nChannels</code>可取的值是<code>1</code>、<code>2</code>、<code>3</code>或<code>4</code>。<br>&emsp;&emsp;随后两个重要成员是<code>origin</code>和<code>dataOrder</code>。<code>origin</code>变量可以有两种取值：<code>IPL_ORIGIN_TL</code>或者<code>IPL_ORIGIN_BL</code>，分别设置坐标原点的位置于图像的左上角或者左下角。在计算机视觉领域，一个重要的错误来源就是原点位置的定义不统一。具体而言，图像的来源、操作系统、编解码器和存储格式等因素都可以影响图像坐标原点的选取。举例来说，你或许认为自己正在从图像上面的脸部附近取样，但实际上却在图像下方的裙子附近取样。避免此类现象发生的最好办法是在最开始的时候检查一下系统，在所操作的图像块的地方画点东西试试。<br>&emsp;&emsp;<code>dataOrder</code>的取值可以是<code>IPL_DATA_ORDER_PIXEL</code>或<code>IPL_DATA_ORDER_PLANE</code>，前者指明数据是将像素点不同通道的值交错排在一起(这是常用的交错排列方式)，后者是把所有像素同通道值排在一起，形成通道平面，再把平面排列起来。<br>&emsp;&emsp;参数<code>widthStep</code>与前面讨论过的<code>CvMat</code>中的<code>step</code>参数类似，包括相邻行的同列点之间的字节数。仅凭变量<code>width</code>是不能计算这个值的，因为为了处理过程更高效每行都会用固定的字节数来对齐；因此在第<code>i</code>行末和第<code>i + 1</code>行开始处可能会有些冗于字节。参数<code>imageData</code>包含一个指向第一行图像数据的指针。如果图像中有些独立的平面(如当<code>dataOrder = IPL_DATA_ORDER_PLANE</code>)那么把它们作为单独的图像连续摆放，总行数为<code>height</code>和<code>nChannels</code>的乘积。但通常情况下，它们是交错的，使得行数等于高度，而且每一行都有序地包含交错的通道。<br>&emsp;&emsp;最后还有一个实用的重要参数 — 感兴趣的区域(<code>ROI</code>)，实际上它是另一个<code>IPL/IPP</code>结构<code>IplROI</code>的实例。<code>IplROI</code>包含<code>xOffset</code>、<code>yOffset</code>、<code>height</code>、<code>width</code>和<code>coi</code>成员变量，其中<code>COI</code>代表<code>channel of interest</code>(感兴趣的通道)。<code>ROI</code>的思想是：一旦设定<code>ROI</code>，通常作用于整幅图像的函数便会只对<code>ROI</code>所表示的子图像进行操作。如果<code>IplImage</code>变量中设置了<code>ROI</code>，则所有的<code>OpenCV</code>函数就会使用该<code>ROI</code>变量。如果<code>COI</code>被设置成非<code>0</code>值，则对该图像的操作就只作用于被指定的通道上了。</p>
<h3 id="Vec3b"><a href="#Vec3b" class="headerlink" title="Vec3b"></a>Vec3b</h3><p>&emsp;&emsp;<code>Vec</code>类似于<code>C++</code>中的<code>vector</code>，例如<code>Vec&lt;uchar, 3&gt;</code>其实就是定义一个<code>uchar</code>类型的数组，长度为<code>3</code>。<code>8U</code>类型的<code>RGB</code>彩色图像可以使用<code>&lt;Vec3b&gt;</code>，<code>3</code>通道<code>float</code>类型的矩阵可以使用<code>&lt;Vec3f&gt;</code>。对于<code>Vec</code>对象，可以使用<code>[]</code>符号如操作数组般读写其元素：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vec3b color; <span class="comment">/* 用color变量描述一种RGB颜色 */</span></span><br><span class="line">color[<span class="number">0</span>] = <span class="number">255</span>; <span class="comment">/* B通道 */</span></span><br><span class="line">color[<span class="number">1</span>] = <span class="number">0</span>; <span class="comment">/* G通道 */</span></span><br><span class="line">color[<span class="number">2</span>] = <span class="number">0</span>; <span class="comment">/* R通道 */</span></span><br></pre></td></tr></table></figure>
<p><code>cv::mat</code>的成员函数<code>at(int y, int x)</code>可以用来存取图像中对应坐标为<code>(x, y)</code>的元素坐标。但是在使用它时要注意，在编译期必须要已知图像的数据类型，这是因为<code>cv::mat</code>可以存放任意数据类型的元素，因此at方法的实现是用模板函数来实现的。假设提前已知一幅图像<code>img</code>的数据类型为<code>unsigned char</code>型灰度图，要对坐标为<code>(14, 25)</code>的像素重新赋值为<code>25</code>，则对应操作如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">srcImage.at&lt;uchar&gt; ( <span class="number">14</span>, <span class="number">25</span> ) = <span class="number">25</span>;</span><br></pre></td></tr></table></figure>
<p>如果要操作的图片<code>img</code>是一幅数据类型同样为<code>unsigned char</code>的彩色图片，再次要求将坐标<code>(14, 25)</code>的像素赋值为<code>25</code>。这个操作跟上面的就有点区别了，需要对这个像素三个通道的每个对应元素赋值。<code>Opencv</code>中图像三原色在内存中的排列顺序为<code>B</code>、<code>G</code>和<code>R</code>，操作过程如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">img.at&lt;Vec3b&gt; ( <span class="number">14</span>, <span class="number">25</span> ) [<span class="number">0</span>] = <span class="number">25</span>; <span class="comment">/* B通道 */</span></span><br><span class="line">img.at&lt;Vec3b&gt; ( <span class="number">14</span>, <span class="number">25</span> ) [<span class="number">1</span>] = <span class="number">25</span>; <span class="comment">/* G通道 */</span></span><br><span class="line">img.at&lt;Vec3b&gt; ( <span class="number">14</span>, <span class="number">25</span> ) [<span class="number">2</span>] = <span class="number">25</span>; <span class="comment">/* R通道 */</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/23/Qt应用示例/Qt向导设置/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/Qt应用示例/Qt向导设置/" itemprop="url">Qt向导设置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-23T16:15:54+08:00">
                2019-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt应用示例/" itemprop="url" rel="index">
                    <span itemprop="name">Qt应用示例</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>ClassWizard.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> CLASSWIZARD_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CLASSWIZARD_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QWizard&gt;</span></span></span><br><span class="line">​</span><br><span class="line">QT_BEGIN_NAMESPACE</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QCheckBox</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QGroupBox</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QLabel</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QLineEdit</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QRadioButton</span>;</span></span><br><span class="line">QT_END_NAMESPACE</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassWizard</span> :</span> <span class="keyword">public</span> QWizard&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ClassWizard( QWidget *parent = <span class="number">0</span> );</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntroPage</span> :</span> <span class="keyword">public</span> QWizardPage &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    IntroPage ( QWidget *parent = <span class="number">0</span> );</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QLabel *label;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassInfoPage</span> :</span> <span class="keyword">public</span> QWizardPage &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ClassInfoPage ( QWidget *parent = <span class="number">0</span> );</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QLabel *classNameLabel;</span><br><span class="line">    QLabel *baseClassLabel;</span><br><span class="line">    QLineEdit *classNameLineEdit;</span><br><span class="line">    QLineEdit *baseClassLineEdit;</span><br><span class="line">    QCheckBox *qobjectMacroCheckBox;</span><br><span class="line">    QGroupBox *groupBox;</span><br><span class="line">    QRadioButton *qobjectCtorRadioButton;</span><br><span class="line">    QRadioButton *qwidgetCtorRadioButton;</span><br><span class="line">    QRadioButton *defaultCtorRadioButton;</span><br><span class="line">    QCheckBox *copyCtorCheckBox;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CodeStylePage</span> :</span> <span class="keyword">public</span> QWizardPage &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    CodeStylePage ( QWidget *parent = <span class="number">0</span> );</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">initializePage</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QCheckBox *commentCheckBox;</span><br><span class="line">    QCheckBox *protectCheckBox;</span><br><span class="line">    QCheckBox *includeBaseCheckBox;</span><br><span class="line">    QLabel *macroNameLabel;</span><br><span class="line">    QLabel *baseIncludeLabel;</span><br><span class="line">    QLineEdit *macroNameLineEdit;</span><br><span class="line">    QLineEdit *baseIncludeLineEdit;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OutputFilesPage</span> :</span> <span class="keyword">public</span> QWizardPage &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    OutputFilesPage ( QWidget *parent = <span class="number">0</span> );</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">initializePage</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QLabel *outputDirLabel;</span><br><span class="line">    QLabel *headerLabel;</span><br><span class="line">    QLabel *implementationLabel;</span><br><span class="line">    QLineEdit *outputDirLineEdit;</span><br><span class="line">    QLineEdit *headerLineEdit;</span><br><span class="line">    QLineEdit *implementationLineEdit;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConclusionPage</span> :</span> <span class="keyword">public</span> QWizardPage &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ConclusionPage ( QWidget *parent = <span class="number">0</span> );</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">initializePage</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QLabel *label;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// CLASSWIZARD_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>classwizard.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QtGui&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"classwizard.h"</span></span></span><br><span class="line">​</span><br><span class="line">ClassWizard::ClassWizard ( QWidget *parent ) : QWizard ( parent ) &#123;</span><br><span class="line">    addPage ( <span class="keyword">new</span> IntroPage );</span><br><span class="line">    addPage ( <span class="keyword">new</span> ClassInfoPage );</span><br><span class="line">    addPage ( <span class="keyword">new</span> CodeStylePage );</span><br><span class="line">    addPage ( <span class="keyword">new</span> OutputFilesPage );</span><br><span class="line">    addPage ( <span class="keyword">new</span> ConclusionPage );</span><br><span class="line">    setPixmap ( QWizard::BannerPixmap, QPixmap ( <span class="string">":/images/banner.png"</span> ) );</span><br><span class="line">    setPixmap ( QWizard::BackgroundPixmap, QPixmap ( <span class="string">":/images/background.png"</span> ) );</span><br><span class="line">    setWindowTitle ( tr ( <span class="string">"Class Wizard"</span> ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> ClassWizard::accept() &#123;</span><br><span class="line">    QByteArray className = field ( <span class="string">"className"</span> ).toByteArray();</span><br><span class="line">    QByteArray baseClass = field ( <span class="string">"baseClass"</span> ).toByteArray();</span><br><span class="line">    QByteArray macroName = field ( <span class="string">"macroName"</span> ).toByteArray();</span><br><span class="line">    QByteArray baseInclude = field ( <span class="string">"baseInclude"</span> ).toByteArray();</span><br><span class="line">    QString outputDir = field ( <span class="string">"outputDir"</span> ).toString();</span><br><span class="line">    QString header = field ( <span class="string">"header"</span> ).toString();</span><br><span class="line">    QString implementation = field ( <span class="string">"implementation"</span> ).toString();</span><br><span class="line">    QByteArray block;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( field ( <span class="string">"comment"</span> ).toBool() ) &#123;</span><br><span class="line">        block += <span class="string">"/*\n"</span>;</span><br><span class="line">        block += <span class="string">"    "</span> + header.toAscii() + <span class="string">"\n"</span>;</span><br><span class="line">        block += <span class="string">"*/\n"</span>;</span><br><span class="line">        block += <span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( field ( <span class="string">"protect"</span> ).toBool() ) &#123;</span><br><span class="line">        block += <span class="string">"#ifndef "</span> + macroName + <span class="string">"\n"</span>;</span><br><span class="line">        block += <span class="string">"#define "</span> + macroName + <span class="string">"\n"</span>;</span><br><span class="line">        block += <span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( field ( <span class="string">"includeBase"</span> ).toBool() ) &#123;</span><br><span class="line">        block += <span class="string">"#include "</span> + baseInclude + <span class="string">"\n"</span>;</span><br><span class="line">        block += <span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    block += <span class="string">"class "</span> + className;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( !baseClass.isEmpty() ) &#123;</span><br><span class="line">        block += <span class="string">" : public "</span> + baseClass;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    block += <span class="string">"\n"</span>;</span><br><span class="line">    block += <span class="string">"&#123;\n"</span>;</span><br><span class="line">​</span><br><span class="line">    <span class="comment">/* qmake ignore Q_OBJECT */</span></span><br><span class="line">    <span class="keyword">if</span> ( field ( <span class="string">"qobjectMacro"</span> ).toBool() ) &#123;</span><br><span class="line">        block += <span class="string">"    Q_OBJECT\n"</span>;</span><br><span class="line">        block += <span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    block += <span class="string">"public:\n"</span>;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( field ( <span class="string">"qobjectCtor"</span> ).toBool() ) &#123;</span><br><span class="line">        block += <span class="string">"    "</span> + className + <span class="string">"(QObject *parent = 0);\n"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( field ( <span class="string">"qwidgetCtor"</span> ).toBool() ) &#123;</span><br><span class="line">        block += <span class="string">"    "</span> + className + <span class="string">"(QWidget *parent = 0);\n"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( field ( <span class="string">"defaultCtor"</span> ).toBool() ) &#123;</span><br><span class="line">        block += <span class="string">"    "</span> + className + <span class="string">"();\n"</span>;</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">if</span> ( field ( <span class="string">"copyCtor"</span> ).toBool() ) &#123;</span><br><span class="line">            block += <span class="string">"    "</span> + className + <span class="string">"(const "</span> + className + <span class="string">" &amp;other);\n"</span>;</span><br><span class="line">            block += <span class="string">"\n"</span>;</span><br><span class="line">            block += <span class="string">"    "</span> + className + <span class="string">" &amp;operator="</span> + <span class="string">"(const "</span> + className + <span class="string">" &amp;other);\n"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    block += <span class="string">"&#125;;\n"</span>;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( field ( <span class="string">"protect"</span> ).toBool() ) &#123;</span><br><span class="line">        block += <span class="string">"\n"</span>;</span><br><span class="line">        block += <span class="string">"#endif\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="function">QFile <span class="title">headerFile</span> <span class="params">( outputDir + <span class="string">"/"</span> + header )</span></span>;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( !headerFile.open ( QFile::WriteOnly | QFile::Text ) ) &#123;</span><br><span class="line">        QMessageBox::warning (</span><br><span class="line">            <span class="number">0</span>, QObject::tr ( <span class="string">"Simple Wizard"</span> ),</span><br><span class="line">            QObject::tr ( <span class="string">"Cannot write file %1:\n%2"</span> )</span><br><span class="line">                .arg ( headerFile.fileName() ).arg ( headerFile.errorString() ) );</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    headerFile.write ( block );</span><br><span class="line">    block.clear();</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( field ( <span class="string">"comment"</span> ).toBool() ) &#123;</span><br><span class="line">        block += <span class="string">"/*\n"</span>;</span><br><span class="line">        block += <span class="string">"    "</span> + implementation.toAscii() + <span class="string">"\n"</span>;</span><br><span class="line">        block += <span class="string">"*/\n"</span>;</span><br><span class="line">        block += <span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    block += <span class="string">"#include \""</span> + header.toAscii() + <span class="string">"\"\n"</span>;</span><br><span class="line">    block += <span class="string">"\n"</span>;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( field ( <span class="string">"qobjectCtor"</span> ).toBool() ) &#123;</span><br><span class="line">        block += className + <span class="string">"::"</span> + className + <span class="string">"(QObject *parent)\n"</span>;</span><br><span class="line">        block += <span class="string">"    : "</span> + baseClass + <span class="string">"(parent)\n"</span>;</span><br><span class="line">        block += <span class="string">"&#123;\n"</span>;</span><br><span class="line">        block += <span class="string">"&#125;\n"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( field ( <span class="string">"qwidgetCtor"</span> ).toBool() ) &#123;</span><br><span class="line">        block += className + <span class="string">"::"</span> + className + <span class="string">"(QWidget *parent)\n"</span>;</span><br><span class="line">        block += <span class="string">"    : "</span> + baseClass + <span class="string">"(parent)\n"</span>;</span><br><span class="line">        block += <span class="string">"&#123;\n"</span>;</span><br><span class="line">        block += <span class="string">"&#125;\n"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( field ( <span class="string">"defaultCtor"</span> ).toBool() ) &#123;</span><br><span class="line">        block += className + <span class="string">"::"</span> + className + <span class="string">"()\n"</span>;</span><br><span class="line">        block += <span class="string">"&#123;\n"</span>;</span><br><span class="line">        block += <span class="string">"    // missing code\n"</span>;</span><br><span class="line">        block += <span class="string">"&#125;\n"</span>;</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">if</span> ( field ( <span class="string">"copyCtor"</span> ).toBool() ) &#123;</span><br><span class="line">            block += <span class="string">"\n"</span>;</span><br><span class="line">            block += className + <span class="string">"::"</span> + className + <span class="string">"(const "</span> + className + <span class="string">" &amp;other)\n"</span>;</span><br><span class="line">            block += <span class="string">"&#123;\n"</span>;</span><br><span class="line">            block += <span class="string">"    *this = other;\n"</span>;</span><br><span class="line">            block += <span class="string">"&#125;\n"</span>;</span><br><span class="line">            block += <span class="string">"\n"</span>;</span><br><span class="line">            block += className + <span class="string">" &amp;"</span> + className + <span class="string">"::operator=(const "</span> + className + <span class="string">" &amp;other)\n"</span>;</span><br><span class="line">            block += <span class="string">"&#123;\n"</span>;</span><br><span class="line">​</span><br><span class="line">            <span class="keyword">if</span> ( !baseClass.isEmpty() ) &#123;</span><br><span class="line">                block += <span class="string">"    "</span> + baseClass + <span class="string">"::operator=(other);\n"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">​</span><br><span class="line">            block += <span class="string">"    // missing code\n"</span>;</span><br><span class="line">            block += <span class="string">"    return *this;\n"</span>;</span><br><span class="line">            block += <span class="string">"&#125;\n"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="function">QFile <span class="title">implementationFile</span> <span class="params">( outputDir + <span class="string">"/"</span> + implementation )</span></span>;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( !implementationFile.open ( QFile::WriteOnly | QFile::Text ) ) &#123;</span><br><span class="line">        QMessageBox::warning ( <span class="number">0</span>, QObject::tr ( <span class="string">"Simple Wizard"</span> ),</span><br><span class="line">                               QObject::tr ( <span class="string">"Cannot write file %1:\n%2"</span> )</span><br><span class="line">                               .arg ( implementationFile.fileName() )</span><br><span class="line">                               .arg ( implementationFile.errorString() ) );</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    implementationFile.write ( block );</span><br><span class="line">    QDialog::accept();</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">IntroPage::IntroPage ( QWidget *parent ) : QWizardPage ( parent ) &#123;</span><br><span class="line">    setTitle ( tr ( <span class="string">"Introduction"</span> ) );</span><br><span class="line">    setPixmap ( QWizard::WatermarkPixmap, QPixmap ( <span class="string">":/images/watermark1.png"</span> ) );</span><br><span class="line">    label = <span class="keyword">new</span> QLabel ( tr ( <span class="string">"This wizard will generate a skeleton C++ class "</span></span><br><span class="line">                              <span class="string">"definition, including a few functions. You simply "</span></span><br><span class="line">                              <span class="string">"need to specify the class name and set a few "</span></span><br><span class="line">                              <span class="string">"options to produce a header file and an "</span></span><br><span class="line">                              <span class="string">"implementation file for your new C++ class."</span> ) );</span><br><span class="line">    label-&gt;setWordWrap ( <span class="literal">true</span> );</span><br><span class="line">    QVBoxLayout *layout = <span class="keyword">new</span> QVBoxLayout;</span><br><span class="line">    layout-&gt;addWidget ( label );</span><br><span class="line">    setLayout ( layout );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">ClassInfoPage::ClassInfoPage ( QWidget *parent ) : QWizardPage ( parent ) &#123;</span><br><span class="line">    setTitle ( tr ( <span class="string">"Class Information"</span> ) );</span><br><span class="line">    setSubTitle ( tr ( <span class="string">"Specify basic information about the class for which you "</span></span><br><span class="line">                       <span class="string">"want to generate skeleton source code files."</span> ) );</span><br><span class="line">    setPixmap ( QWizard::LogoPixmap, QPixmap ( <span class="string">":/images/logo1.png"</span> ) );</span><br><span class="line">    classNameLabel = <span class="keyword">new</span> QLabel ( tr ( <span class="string">"&amp;Class name:"</span> ) );</span><br><span class="line">    classNameLineEdit = <span class="keyword">new</span> QLineEdit;</span><br><span class="line">    classNameLabel-&gt;setBuddy ( classNameLineEdit );</span><br><span class="line">    baseClassLabel = <span class="keyword">new</span> QLabel ( tr ( <span class="string">"B&amp;ase class:"</span> ) );</span><br><span class="line">    baseClassLineEdit = <span class="keyword">new</span> QLineEdit;</span><br><span class="line">    baseClassLabel-&gt;setBuddy ( baseClassLineEdit );</span><br><span class="line">    qobjectMacroCheckBox = <span class="keyword">new</span> QCheckBox ( tr ( <span class="string">"Generate Q_OBJECT &amp;macro"</span> ) );</span><br><span class="line">    groupBox = <span class="keyword">new</span> QGroupBox ( tr ( <span class="string">"C&amp;onstructor"</span> ) );</span><br><span class="line">    qobjectCtorRadioButton = <span class="keyword">new</span> QRadioButton ( tr ( <span class="string">"&amp;QObject-style constructor"</span> ) );</span><br><span class="line">    qwidgetCtorRadioButton = <span class="keyword">new</span> QRadioButton ( tr ( <span class="string">"Q&amp;Widget-style constructor"</span> ) );</span><br><span class="line">    defaultCtorRadioButton = <span class="keyword">new</span> QRadioButton ( tr ( <span class="string">"&amp;Default constructor"</span> ) );</span><br><span class="line">    copyCtorCheckBox = <span class="keyword">new</span> QCheckBox ( tr ( <span class="string">"&amp;Generate copy constructor and "</span> <span class="string">"operator="</span> ) );</span><br><span class="line">    defaultCtorRadioButton-&gt;setChecked ( <span class="literal">true</span> );</span><br><span class="line">    connect ( defaultCtorRadioButton, SIGNAL ( toggled ( <span class="keyword">bool</span> ) ), copyCtorCheckBox, SLOT ( setEnabled ( <span class="keyword">bool</span> ) ) );</span><br><span class="line">    registerField ( <span class="string">"className*"</span>, classNameLineEdit );</span><br><span class="line">    registerField ( <span class="string">"baseClass"</span>, baseClassLineEdit );</span><br><span class="line">    registerField ( <span class="string">"qobjectMacro"</span>, qobjectMacroCheckBox );</span><br><span class="line">    registerField ( <span class="string">"qobjectCtor"</span>, qobjectCtorRadioButton );</span><br><span class="line">    registerField ( <span class="string">"qwidgetCtor"</span>, qwidgetCtorRadioButton );</span><br><span class="line">    registerField ( <span class="string">"defaultCtor"</span>, defaultCtorRadioButton );</span><br><span class="line">    registerField ( <span class="string">"copyCtor"</span>, copyCtorCheckBox );</span><br><span class="line">    QVBoxLayout *groupBoxLayout = <span class="keyword">new</span> QVBoxLayout;</span><br><span class="line">    groupBoxLayout-&gt;addWidget ( qobjectCtorRadioButton );</span><br><span class="line">    groupBoxLayout-&gt;addWidget ( qwidgetCtorRadioButton );</span><br><span class="line">    groupBoxLayout-&gt;addWidget ( defaultCtorRadioButton );</span><br><span class="line">    groupBoxLayout-&gt;addWidget ( copyCtorCheckBox );</span><br><span class="line">    groupBox-&gt;setLayout ( groupBoxLayout );</span><br><span class="line">    QGridLayout *layout = <span class="keyword">new</span> QGridLayout;</span><br><span class="line">    layout-&gt;addWidget ( classNameLabel, <span class="number">0</span>, <span class="number">0</span> );</span><br><span class="line">    layout-&gt;addWidget ( classNameLineEdit, <span class="number">0</span>, <span class="number">1</span> );</span><br><span class="line">    layout-&gt;addWidget ( baseClassLabel, <span class="number">1</span>, <span class="number">0</span> );</span><br><span class="line">    layout-&gt;addWidget ( baseClassLineEdit, <span class="number">1</span>, <span class="number">1</span> );</span><br><span class="line">    layout-&gt;addWidget ( qobjectMacroCheckBox, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span> );</span><br><span class="line">    layout-&gt;addWidget ( groupBox, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span> );</span><br><span class="line">    setLayout ( layout );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">CodeStylePage::CodeStylePage ( QWidget *parent ) : QWizardPage ( parent ) &#123;</span><br><span class="line">    setTitle ( tr ( <span class="string">"Code Style Options"</span> ) );</span><br><span class="line">    setSubTitle ( tr ( <span class="string">"Choose the formatting of the generated code."</span> ) );</span><br><span class="line">    setPixmap ( QWizard::LogoPixmap, QPixmap ( <span class="string">":/images/logo2.png"</span> ) );</span><br><span class="line">    commentCheckBox = <span class="keyword">new</span> QCheckBox ( tr ( <span class="string">"&amp;Start generated files with a "</span> <span class="string">"comment"</span> ) );</span><br><span class="line">    commentCheckBox-&gt;setChecked ( <span class="literal">true</span> );</span><br><span class="line">    protectCheckBox = <span class="keyword">new</span> QCheckBox ( tr ( <span class="string">"&amp;Protect header file against multiple "</span> <span class="string">"inclusions"</span> ) );</span><br><span class="line">    protectCheckBox-&gt;setChecked ( <span class="literal">true</span> );</span><br><span class="line">    macroNameLabel = <span class="keyword">new</span> QLabel ( tr ( <span class="string">"&amp;Macro name:"</span> ) );</span><br><span class="line">    macroNameLineEdit = <span class="keyword">new</span> QLineEdit;</span><br><span class="line">    macroNameLabel-&gt;setBuddy ( macroNameLineEdit );</span><br><span class="line">    includeBaseCheckBox = <span class="keyword">new</span> QCheckBox ( tr ( <span class="string">"&amp;Include base class definition"</span> ) );</span><br><span class="line">    baseIncludeLabel = <span class="keyword">new</span> QLabel ( tr ( <span class="string">"Base class include:"</span> ) );</span><br><span class="line">    baseIncludeLineEdit = <span class="keyword">new</span> QLineEdit;</span><br><span class="line">    baseIncludeLabel-&gt;setBuddy ( baseIncludeLineEdit );</span><br><span class="line">    connect ( protectCheckBox, SIGNAL ( toggled ( <span class="keyword">bool</span> ) ), macroNameLabel, SLOT ( setEnabled ( <span class="keyword">bool</span> ) ) );</span><br><span class="line">    connect ( protectCheckBox, SIGNAL ( toggled ( <span class="keyword">bool</span> ) ), macroNameLineEdit, SLOT ( setEnabled ( <span class="keyword">bool</span> ) ) );</span><br><span class="line">    connect ( includeBaseCheckBox, SIGNAL ( toggled ( <span class="keyword">bool</span> ) ), baseIncludeLabel, SLOT ( setEnabled ( <span class="keyword">bool</span> ) ) );</span><br><span class="line">    connect ( includeBaseCheckBox, SIGNAL ( toggled ( <span class="keyword">bool</span> ) ), baseIncludeLineEdit, SLOT ( setEnabled ( <span class="keyword">bool</span> ) ) );</span><br><span class="line">    registerField ( <span class="string">"comment"</span>, commentCheckBox );</span><br><span class="line">    registerField ( <span class="string">"protect"</span>, protectCheckBox );</span><br><span class="line">    registerField ( <span class="string">"macroName"</span>, macroNameLineEdit );</span><br><span class="line">    registerField ( <span class="string">"includeBase"</span>, includeBaseCheckBox );</span><br><span class="line">    registerField ( <span class="string">"baseInclude"</span>, baseIncludeLineEdit );</span><br><span class="line">    QGridLayout *layout = <span class="keyword">new</span> QGridLayout;</span><br><span class="line">    layout-&gt;setColumnMinimumWidth ( <span class="number">0</span>, <span class="number">20</span> );</span><br><span class="line">    layout-&gt;addWidget ( commentCheckBox, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span> );</span><br><span class="line">    layout-&gt;addWidget ( protectCheckBox, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span> );</span><br><span class="line">    layout-&gt;addWidget ( macroNameLabel, <span class="number">2</span>, <span class="number">1</span> );</span><br><span class="line">    layout-&gt;addWidget ( macroNameLineEdit, <span class="number">2</span>, <span class="number">2</span> );</span><br><span class="line">    layout-&gt;addWidget ( includeBaseCheckBox, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span> );</span><br><span class="line">    layout-&gt;addWidget ( baseIncludeLabel, <span class="number">4</span>, <span class="number">1</span> );</span><br><span class="line">    layout-&gt;addWidget ( baseIncludeLineEdit, <span class="number">4</span>, <span class="number">2</span> );</span><br><span class="line">    setLayout ( layout );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> CodeStylePage::initializePage() &#123;</span><br><span class="line">    QString className = field ( <span class="string">"className"</span> ).toString();</span><br><span class="line">    macroNameLineEdit-&gt;setText ( className.toUpper() + <span class="string">"_H"</span> );</span><br><span class="line">    QString baseClass = field ( <span class="string">"baseClass"</span> ).toString();</span><br><span class="line">    includeBaseCheckBox-&gt;setChecked ( !baseClass.isEmpty() );</span><br><span class="line">    includeBaseCheckBox-&gt;setEnabled ( !baseClass.isEmpty() );</span><br><span class="line">    baseIncludeLabel-&gt;setEnabled ( !baseClass.isEmpty() );</span><br><span class="line">    baseIncludeLineEdit-&gt;setEnabled ( !baseClass.isEmpty() );</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( baseClass.isEmpty() ) &#123;</span><br><span class="line">        baseIncludeLineEdit-&gt;clear();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( QRegExp ( <span class="string">"Q[A-Z].*"</span> ).exactMatch ( baseClass ) ) &#123;</span><br><span class="line">        baseIncludeLineEdit-&gt;setText ( <span class="string">"&lt;"</span> + baseClass + <span class="string">"&gt;"</span> );</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        baseIncludeLineEdit-&gt;setText ( <span class="string">"\""</span> + baseClass.toLower() + <span class="string">".h\""</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">OutputFilesPage::OutputFilesPage ( QWidget *parent ) : QWizardPage ( parent ) &#123;</span><br><span class="line">    setTitle ( tr ( <span class="string">"Output Files"</span> ) );</span><br><span class="line">    setSubTitle ( tr ( <span class="string">"Specify where you want the wizard to put the generated "</span></span><br><span class="line">                       <span class="string">"skeleton code."</span> ) );</span><br><span class="line">    setPixmap ( QWizard::LogoPixmap, QPixmap ( <span class="string">":/images/logo3.png"</span> ) );</span><br><span class="line">    outputDirLabel = <span class="keyword">new</span> QLabel ( tr ( <span class="string">"&amp;Output directory:"</span> ) );</span><br><span class="line">    outputDirLineEdit = <span class="keyword">new</span> QLineEdit;</span><br><span class="line">    outputDirLabel-&gt;setBuddy ( outputDirLineEdit );</span><br><span class="line">    headerLabel = <span class="keyword">new</span> QLabel ( tr ( <span class="string">"&amp;Header file name:"</span> ) );</span><br><span class="line">    headerLineEdit = <span class="keyword">new</span> QLineEdit;</span><br><span class="line">    headerLabel-&gt;setBuddy ( headerLineEdit );</span><br><span class="line">    implementationLabel = <span class="keyword">new</span> QLabel ( tr ( <span class="string">"&amp;Implementation file name:"</span> ) );</span><br><span class="line">    implementationLineEdit = <span class="keyword">new</span> QLineEdit;</span><br><span class="line">    implementationLabel-&gt;setBuddy ( implementationLineEdit );</span><br><span class="line">    registerField ( <span class="string">"outputDir*"</span>, outputDirLineEdit );</span><br><span class="line">    registerField ( <span class="string">"header*"</span>, headerLineEdit );</span><br><span class="line">    registerField ( <span class="string">"implementation*"</span>, implementationLineEdit );</span><br><span class="line">    QGridLayout *layout = <span class="keyword">new</span> QGridLayout;</span><br><span class="line">    layout-&gt;addWidget ( outputDirLabel, <span class="number">0</span>, <span class="number">0</span> );</span><br><span class="line">    layout-&gt;addWidget ( outputDirLineEdit, <span class="number">0</span>, <span class="number">1</span> );</span><br><span class="line">    layout-&gt;addWidget ( headerLabel, <span class="number">1</span>, <span class="number">0</span> );</span><br><span class="line">    layout-&gt;addWidget ( headerLineEdit, <span class="number">1</span>, <span class="number">1</span> );</span><br><span class="line">    layout-&gt;addWidget ( implementationLabel, <span class="number">2</span>, <span class="number">0</span> );</span><br><span class="line">    layout-&gt;addWidget ( implementationLineEdit, <span class="number">2</span>, <span class="number">1</span> );</span><br><span class="line">    setLayout ( layout );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> OutputFilesPage::initializePage() &#123;</span><br><span class="line">    QString className = field ( <span class="string">"className"</span> ).toString();</span><br><span class="line">    headerLineEdit-&gt;setText ( className.toLower() + <span class="string">".h"</span> );</span><br><span class="line">    implementationLineEdit-&gt;setText ( className.toLower() + <span class="string">".cpp"</span> );</span><br><span class="line">    outputDirLineEdit-&gt;setText ( QDir::convertSeparators ( QDir::tempPath() ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">ConclusionPage::ConclusionPage ( QWidget *parent )</span><br><span class="line">    : QWizardPage ( parent ) &#123;</span><br><span class="line">    setTitle ( tr ( <span class="string">"Conclusion"</span> ) );</span><br><span class="line">    setPixmap ( QWizard::WatermarkPixmap, QPixmap ( <span class="string">":/images/watermark2.png"</span> ) );</span><br><span class="line">    label = <span class="keyword">new</span> QLabel;</span><br><span class="line">    label-&gt;setWordWrap ( <span class="literal">true</span> );</span><br><span class="line">    QVBoxLayout *layout = <span class="keyword">new</span> QVBoxLayout;</span><br><span class="line">    layout-&gt;addWidget ( label );</span><br><span class="line">    setLayout ( layout );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> ConclusionPage::initializePage() &#123;</span><br><span class="line">    QString finishText = wizard()-&gt;buttonText ( QWizard::FinishButton );</span><br><span class="line">    finishText.remove ( <span class="string">'&amp;'</span> );</span><br><span class="line">    label-&gt;setText ( tr ( <span class="string">"Click %1 to generate the class skeleton."</span> )</span><br><span class="line">                     .arg ( finishText ) );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>main.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QTranslator&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QLocale&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QLibraryInfo&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"classwizard.h"</span></span></span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[] )</span> </span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">app</span> <span class="params">( argc, argv )</span></span>;</span><br><span class="line">    QString translatorFileName = QLatin1String ( <span class="string">"qt_"</span> );</span><br><span class="line">    translatorFileName += QLocale::system().name();</span><br><span class="line">    QTranslator *translator = <span class="keyword">new</span> QTranslator ( &amp;app );</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( translator-&gt;load (</span><br><span class="line">            translatorFileName,</span><br><span class="line">            QLibraryInfo::location ( QLibraryInfo::TranslationsPath ) ) ) &#123;</span><br><span class="line">        app.installTranslator ( translator );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    ClassWizard wizard;</span><br><span class="line">    wizard.show();</span><br><span class="line">    <span class="keyword">return</span> app.exec();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2019/02/23/Qt应用示例/Qt向导设置/1.png" height="279" width="657"></p>
<p><img src="/2019/02/23/Qt应用示例/Qt向导设置/2.png" height="280" width="653"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/16/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><span class="page-number current">17</span><a class="page-number" href="/page/18/">18</a><span class="space">&hellip;</span><a class="page-number" href="/page/95/">95</a><a class="extend next" rel="next" href="/page/18/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">付康为</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">943</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">付康为</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
