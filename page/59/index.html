<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="泥腿子出身">
<meta property="og:url" content="http://fukangwei.gitee.io/page/59/index.html">
<meta property="og:site_name" content="泥腿子出身">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="泥腿子出身">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '561O3H1PZB',
      apiKey: '7631d3cf19ac49bd39ada7163ec937a7',
      indexName: 'fuxinzi',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="http://fukangwei.gitee.io/page/59/">





  <title>泥腿子出身</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">泥腿子出身</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/12/Python语法/sqlite3模块/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/12/Python语法/sqlite3模块/" itemprop="url">sqlite3模块</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-12T10:15:33+08:00">
                2019-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>SQLite3</code>可使用<code>sqlite3</code>模块与<code>Python</code>进行集成。它提供了一个与<code>PEP 249</code>描述的<code>DB-API 2.0</code>规范兼容的<code>SQL</code>接口。不需要单独安装该模块，因为<code>Python 2.5</code>以上版本默认自带了该模块。为了使用<code>sqlite3</code>模块，首先必须创建一个表示数据库的连接对象，然后可以有选择地创建光标对象，这将帮助你执行所有的<code>SQL</code>语句。</p>
<h3 id="sqlite3模块API"><a href="#sqlite3模块API" class="headerlink" title="sqlite3模块API"></a>sqlite3模块API</h3><p>&emsp;&emsp;以下是重要的<code>sqlite3</code>模块<code>API</code>，可以满足你在<code>Python</code>程序中使用<code>SQLite</code>数据库的需求。</p>
<h4 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite3.connect(database [, timeout, other optional arguments])</span><br></pre></td></tr></table></figure>
<p>该<code>API</code>打开一个到<code>SQLite</code>数据库文件<code>database</code>的链接。你可以使用<code>:memory:</code>来在<code>RAM</code>中打开一个到<code>database</code>的数据库连接，而不是在磁盘上打开。如果数据库成功打开，则返回一个连接对象。<br>&emsp;&emsp;当一个数据库被多个连接访问，且其中一个修改了数据库，此时<code>SQLite</code>数据库被锁定，直到事务提交。<code>timeout</code>参数表示连接等待锁定的持续时间，直到发生异常断开连接。<code>timeout</code>参数默认是<code>5.0</code>(<code>5</code>秒)。<br>&emsp;&emsp;如果给定的数据库名称<code>filename</code>不存在，则该调用将创建一个数据库。如果不想在当前目录中创建数据库，可以指定带有路径的文件名，这样就能在任意地方创建数据库。</p>
<h4 id="cursor"><a href="#cursor" class="headerlink" title="cursor"></a>cursor</h4><p>&emsp;&emsp;该方法用于创建一个<code>cursor</code>，将在<code>Python</code>数据库编程中用到。该方法接受一个单一的可选的参数<code>cursorClass</code>。如果提供了该参数，则它必须是一个扩展自<code>sqlite3.Cursor</code>的自定义<code>cursor</code>类。</p>
<h4 id="cursor-execute"><a href="#cursor-execute" class="headerlink" title="cursor.execute"></a>cursor.execute</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cursor.execute(sql [, optional parameters])</span><br></pre></td></tr></table></figure>
<p>该例程执行一个<code>SQL</code>语句。该<code>SQL</code>语句可以被参数化(也就是使用占位符代替<code>SQL</code>文本)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cursor.execute(<span class="string">"insert into people values (?, ?)"</span>, (who, age))</span><br></pre></td></tr></table></figure>
<h4 id="connection-execute"><a href="#connection-execute" class="headerlink" title="connection.execute"></a>connection.execute</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.execute(sql [, optional parameters])</span><br></pre></td></tr></table></figure>
<p>该例程是上面执行的由光标(<code>cursor</code>)对象提供的方法的快捷方式，它通过调用光标(<code>cursor</code>)方法创建了一个中间的光标对象，然后通过给定的参数调用光标的<code>execute</code>方法。</p>
<h4 id="cursor-executemany"><a href="#cursor-executemany" class="headerlink" title="cursor.executemany"></a>cursor.executemany</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cursor.executemany(sql, seq_of_parameters)</span><br></pre></td></tr></table></figure>
<p>该例程对<code>seq_of_parameters</code>中的所有参数或映射执行一个<code>SQL</code>命令。</p>
<h4 id="connection-executemany"><a href="#connection-executemany" class="headerlink" title="connection.executemany"></a>connection.executemany</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.executemany(sql[, parameters])</span><br></pre></td></tr></table></figure>
<p>该例程是一个由调用光标(<code>cursor</code>)方法创建的中间的光标对象的快捷方式，然后通过给定的参数调用光标的<code>executemany</code>方法。</p>
<h4 id="cursor-executescript"><a href="#cursor-executescript" class="headerlink" title="cursor.executescript"></a>cursor.executescript</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cursor.executescript(sql_script)</span><br></pre></td></tr></table></figure>
<p>该例程一旦接收到脚本，会执行多个<code>SQL</code>语句。它首先执行<code>COMMIT</code>语句，然后执行作为参数传入的<code>SQL</code>脚本。所有的<code>SQL</code>语句应该用分号<code>;</code>分隔。</p>
<h4 id="connection-executescript"><a href="#connection-executescript" class="headerlink" title="connection.executescript"></a>connection.executescript</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.executescript(sql_script)</span><br></pre></td></tr></table></figure>
<p>该例程是一个由调用光标(<code>cursor</code>)方法创建的中间的光标对象的快捷方式，然后通过给定的参数调用光标的<code>executescript</code>方法。</p>
<h4 id="total-changes"><a href="#total-changes" class="headerlink" title="total_changes"></a>total_changes</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.total_changes()</span><br></pre></td></tr></table></figure>
<p>该例程返回自数据库连接打开以来被修改、插入或删除的数据库总行数。</p>
<h4 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.commit()</span><br></pre></td></tr></table></figure>
<p>该方法提交当前的事务。如果未调用该方法，那么自上一次调用<code>commit</code>以来所做的任何动作对其他数据库连接来说是不可见的。</p>
<h4 id="rollback"><a href="#rollback" class="headerlink" title="rollback"></a>rollback</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.rollback()</span><br></pre></td></tr></table></figure>
<p>该方法回滚自上一次调用<code>commit</code>以来对数据库所做的更改。</p>
<h4 id="close"><a href="#close" class="headerlink" title="close"></a>close</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connection.close()</span><br></pre></td></tr></table></figure>
<p>该方法关闭数据库连接。请注意，这不会自动调用<code>commit</code>。如果之前未调用<code>commit</code>方法，就直接关闭数据库连接，你所做的所有更改将全部丢失！</p>
<h4 id="fetchone"><a href="#fetchone" class="headerlink" title="fetchone"></a>fetchone</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cursor.fetchone()</span><br></pre></td></tr></table></figure>
<p>该方法获取查询结果集中的下一行，返回一个单一的序列，当没有更多可用的数据时，则返回<code>None</code>。</p>
<h4 id="fetchmany"><a href="#fetchmany" class="headerlink" title="fetchmany"></a>fetchmany</h4><p>&emsp;&emsp;函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cursor.fetchmany([size=cursor.arraysize])</span><br></pre></td></tr></table></figure>
<p>该方法获取查询结果集中的下一行组，返回一个列表。当没有更多的可用的行时，则返回一个空的列表。该方法尝试获取由<code>size</code>参数指定的尽可能多的行。</p>
<h3 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h3><p>&emsp;&emsp;下面的<code>Python</code>代码显示了如何连接到一个现有的数据库。如果数据库不存在，那么它就会被创建，最后将返回一个数据库对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line">​</span><br><span class="line">conn = sqlite3.connect(<span class="string">'test.db'</span>)</span><br><span class="line">print(<span class="string">"Opened database successfully"</span>)</span><br></pre></td></tr></table></figure>
<p>在这里，您也可以把数据库名称赋值为特定的名称<code>:memory:</code>，这样就会在<code>RAM</code>中创建一个数据库。现在来运行上面的程序，在当前目录中创建数据库<code>test.db</code>。</p>
<h3 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3><p>&emsp;&emsp;下面的<code>Python</code>代码段将用于在先前创建的数据库中创建一个表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line">​</span><br><span class="line">conn = sqlite3.connect(<span class="string">'test.db'</span>)</span><br><span class="line">print(<span class="string">"Opened database successfully"</span>)</span><br><span class="line">c = conn.cursor()</span><br><span class="line">c.execute(<span class="string">'''CREATE TABLE COMPANY</span></span><br><span class="line"><span class="string">       (ID INT PRIMARY KEY     NOT NULL,</span></span><br><span class="line"><span class="string">        NAME           TEXT    NOT NULL,</span></span><br><span class="line"><span class="string">        AGE            INT     NOT NULL,</span></span><br><span class="line"><span class="string">        ADDRESS        CHAR(50),</span></span><br><span class="line"><span class="string">        SALARY         REAL);'''</span>)</span><br><span class="line">print(<span class="string">"Table created successfully"</span>)</span><br><span class="line">conn.commit()</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<p>上述程序执行时，它会在<code>test.db</code>中创建<code>COMPANY</code>表，并显示如下消息：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Opened database successfully</span><br><span class="line">Table created successfully</span><br></pre></td></tr></table></figure>
<h3 id="INSERT操作"><a href="#INSERT操作" class="headerlink" title="INSERT操作"></a>INSERT操作</h3><p>&emsp;&emsp;下面显示了如何在上面创建的<code>COMPANY</code>表中创建记录：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line">​</span><br><span class="line">conn = sqlite3.connect(<span class="string">'test.db'</span>)</span><br><span class="line">c = conn.cursor()</span><br><span class="line">print(<span class="string">"Opened database successfully"</span>)</span><br><span class="line">c.execute(<span class="string">"INSERT INTO COMPANY (ID, NAME, AGE, ADDRESS, SALARY) \</span></span><br><span class="line"><span class="string">           VALUES (1, 'Paul', 32, 'California', 20000.00)"</span>)</span><br><span class="line">c.execute(<span class="string">"INSERT INTO COMPANY (ID, NAME, AGE, ADDRESS, SALARY) \</span></span><br><span class="line"><span class="string">           VALUES (2, 'Allen', 25, 'Texas', 15000.00)"</span>)</span><br><span class="line">c.execute(<span class="string">"INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY) \</span></span><br><span class="line"><span class="string">           VALUES (3, 'Teddy', 23, 'Norway', 20000.00)"</span>)</span><br><span class="line">c.execute(<span class="string">"INSERT INTO COMPANY (ID, NAME, AGE, ADDRESS, SALARY) \</span></span><br><span class="line"><span class="string">           VALUES (4, 'Mark', 25, 'Rich-Mond', 65000.00)"</span>)</span><br><span class="line">conn.commit()</span><br><span class="line">print(<span class="string">"Records created successfully"</span>)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<p>上述程序执行时，它会在COMPANY表中创建给定记录，并会显示如下信息：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Opened database successfully</span><br><span class="line">Records created successfully</span><br></pre></td></tr></table></figure>
<h3 id="SELECT操作"><a href="#SELECT操作" class="headerlink" title="SELECT操作"></a>SELECT操作</h3><p>&emsp;&emsp;下面显示了如何从前面创建的<code>COMPANY</code>表中获取并显示记录：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line">​</span><br><span class="line">conn = sqlite3.connect(<span class="string">'test.db'</span>)</span><br><span class="line">c = conn.cursor()</span><br><span class="line">print(<span class="string">"Opened database successfully"</span>)</span><br><span class="line">​</span><br><span class="line">cursor = c.execute(<span class="string">"SELECT id, name, address, salary  from COMPANY"</span>)</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">    print(<span class="string">"ID ="</span>, row[<span class="number">0</span>])</span><br><span class="line">    print(<span class="string">"NAME ="</span>, row[<span class="number">1</span>])</span><br><span class="line">    print(<span class="string">"ADDRESS ="</span>, row[<span class="number">2</span>])</span><br><span class="line">    print(<span class="string">"SALARY ="</span>, row[<span class="number">3</span>])</span><br><span class="line">    print(<span class="string">"----------"</span>)</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"Operation done successfully"</span>)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Opened database successfully</span><br><span class="line">ID = <span class="number">1</span></span><br><span class="line">NAME = Paul</span><br><span class="line">ADDRESS = California</span><br><span class="line">SALARY = <span class="number">20000.0</span></span><br><span class="line">----------</span><br><span class="line">ID = <span class="number">2</span></span><br><span class="line">NAME = Allen</span><br><span class="line">ADDRESS = Texas</span><br><span class="line">SALARY = <span class="number">15000.0</span></span><br><span class="line">----------</span><br><span class="line">ID = <span class="number">3</span></span><br><span class="line">NAME = Teddy</span><br><span class="line">ADDRESS = Norway</span><br><span class="line">SALARY = <span class="number">20000.0</span></span><br><span class="line">----------</span><br><span class="line">ID = <span class="number">4</span></span><br><span class="line">NAME = Mark</span><br><span class="line">ADDRESS = Rich-Mond</span><br><span class="line">SALARY = <span class="number">65000.0</span></span><br><span class="line">----------</span><br><span class="line">Operation done successfully</span><br></pre></td></tr></table></figure>
<h3 id="UPDATE操作"><a href="#UPDATE操作" class="headerlink" title="UPDATE操作"></a>UPDATE操作</h3><p>&emsp;&emsp;下面显示了如何使用<code>UPDATE</code>语句来更新任何记录，然后从<code>COMPANY</code>表中获取并显示更新的记录：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line">​</span><br><span class="line">conn = sqlite3.connect(<span class="string">'test.db'</span>)</span><br><span class="line">c = conn.cursor()</span><br><span class="line">print(<span class="string">"Opened database successfully"</span>)</span><br><span class="line">​</span><br><span class="line">c.execute(<span class="string">"UPDATE COMPANY set SALARY = 25000.00 where ID=1"</span>)</span><br><span class="line">conn.commit()</span><br><span class="line">print(<span class="string">"Total number of rows updated :"</span>, conn.total_changes)</span><br><span class="line">​</span><br><span class="line">cursor = conn.execute(<span class="string">"SELECT id, name, address, salary from COMPANY"</span>)</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">    print(<span class="string">"ID ="</span>, row[<span class="number">0</span>])</span><br><span class="line">    print(<span class="string">"NAME = "</span>, row[<span class="number">1</span>])</span><br><span class="line">    print(<span class="string">"ADDRESS = "</span>, row[<span class="number">2</span>])</span><br><span class="line">    print(<span class="string">"SALARY = "</span>, row[<span class="number">3</span>], <span class="string">"\n"</span>)</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"Operation done successfully"</span>)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
<h3 id="DELETE操作"><a href="#DELETE操作" class="headerlink" title="DELETE操作"></a>DELETE操作</h3><p>&emsp;&emsp;下面显示了如何使用<code>DELETE</code>语句删除任何记录，然后从<code>COMPANY</code>表中获取并显示剩余的记录：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line">​</span><br><span class="line">conn = sqlite3.connect(<span class="string">'test.db'</span>)</span><br><span class="line">c = conn.cursor()</span><br><span class="line">print(<span class="string">"Opened database successfully"</span>)</span><br><span class="line">​</span><br><span class="line">c.execute(<span class="string">"DELETE from COMPANY where ID=2;"</span>)</span><br><span class="line">conn.commit()</span><br><span class="line">print(<span class="string">"Total number of rows deleted :"</span>, conn.total_changes)</span><br><span class="line">​</span><br><span class="line">cursor = conn.execute(<span class="string">"SELECT id, name, address, salary  from COMPANY"</span>)</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">    print(<span class="string">"ID ="</span>, row[<span class="number">0</span>])</span><br><span class="line">    print(<span class="string">"NAME ="</span>, row[<span class="number">1</span>])</span><br><span class="line">    print(<span class="string">"ADDRESS ="</span>, row[<span class="number">2</span>])</span><br><span class="line">    print(<span class="string">"SALARY = "</span>, row[<span class="number">3</span>], <span class="string">"\n"</span>)</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"Operation done successfully"</span>)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/12/Python语法/模块和包/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/12/Python语法/模块和包/" itemprop="url">模块和包</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-12T09:24:26+08:00">
                2019-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h3><p>&emsp;&emsp;容器是数据的封装，函数是语句的封装，类是方法和属性的封装，模块是模块就是程序。<br>&emsp;&emsp;在使用模块时，要注意命名空间。在<code>hi.py</code>中输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"hello"</span>)</span><br></pre></td></tr></table></figure>
<p>在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hi</span><br><span class="line">hi()  <span class="comment"># 结果将会报错</span></span><br><span class="line">hi.hello()  <span class="comment"># 结果为“hello”</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;导入模块的三个方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> 模块名</span><br><span class="line"><span class="keyword">from</span> 模块名 <span class="keyword">import</span> 函数名</span><br><span class="line"><span class="keyword">import</span> 模块名 <span class="keyword">as</span> 新名字</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在<code>Temp.py</code>中输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c2f</span><span class="params">(cel)</span>:</span></span><br><span class="line">    fah = cel * <span class="number">1.8</span> + <span class="number">32</span></span><br><span class="line">    <span class="keyword">return</span> fah</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f2c</span><span class="params">(fah)</span>:</span></span><br><span class="line">    cel = (fah - <span class="number">32</span>) / <span class="number">1.8</span></span><br><span class="line">    <span class="keyword">return</span> cel</span><br></pre></td></tr></table></figure>
<p>在<code>clac.py</code>中输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Temp</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"32摄氏度 = %.2f华氏度"</span> % Temp.c2f(<span class="number">32</span>))</span><br><span class="line">print(<span class="string">"99华氏度 = %.2f摄氏度"</span> % Temp.f2c(<span class="number">99</span>))</span><br><span class="line"><span class="comment"># --------------------------</span></span><br><span class="line"><span class="keyword">from</span> Temp <span class="keyword">import</span> c2f, f2c  <span class="comment"># 写成“from Temp import *”也是可以的，但不推荐</span></span><br><span class="line">​</span><br><span class="line">print(<span class="string">"32摄氏度 = %.2f华氏度"</span> % c2f(<span class="number">32</span>))</span><br><span class="line">print(<span class="string">"99华氏度 = %.2f摄氏度"</span> % f2c(<span class="number">99</span>))</span><br><span class="line"><span class="comment"># --------------------------</span></span><br><span class="line"><span class="keyword">import</span> Temp <span class="keyword">as</span> tc</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"32摄氏度 = %.2f华氏度"</span> % tc.c2f(<span class="number">32</span>))</span><br><span class="line">print(<span class="string">"99华氏度 = %.2f摄氏度"</span> % tc.f2c(<span class="number">99</span>))</span><br></pre></td></tr></table></figure>
<p>注意，模块文件要放在与源文件一样的路径下！</p>
<h3 id="if-name-‘main‘"><a href="#if-name-‘main‘" class="headerlink" title="if __name__ == ‘main‘"></a>if __name__ == ‘<strong>main</strong>‘</h3><p>&emsp;&emsp;在<code>Temp.py</code>中输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c2f</span><span class="params">(cel)</span>:</span></span><br><span class="line">    fah = cel * <span class="number">1.8</span> + <span class="number">32</span></span><br><span class="line">    <span class="keyword">return</span> fah</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f2c</span><span class="params">(fah)</span>:</span></span><br><span class="line">    cel = (fah - <span class="number">32</span>) / <span class="number">1.8</span></span><br><span class="line">    <span class="keyword">return</span> cel</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"0摄氏度 = %.2f华氏度"</span> % c2f(<span class="number">0</span>))</span><br><span class="line">    print(<span class="string">"0华氏度 = %.2f摄氏度"</span> % f2c(<span class="number">0</span>))</span><br><span class="line">​</span><br><span class="line">test()</span><br></pre></td></tr></table></figure>
<p>在<code>calc.py</code>中输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Temp <span class="keyword">as</span> tc</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"32摄氏度 = %.2f华氏度"</span> % tc.c2f(<span class="number">32</span>))</span><br><span class="line">print(<span class="string">"99华氏度 = %.2f摄氏度"</span> % tc.f2c(<span class="number">99</span>))</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>摄氏度 = <span class="number">32.00</span>华氏度</span><br><span class="line"><span class="number">0</span>华氏度 = <span class="number">-17.78</span>摄氏度</span><br><span class="line"><span class="number">32</span>摄氏度 = <span class="number">89.60</span>华氏度</span><br><span class="line"><span class="number">99</span>华氏度 = <span class="number">37.22</span>摄氏度</span><br></pre></td></tr></table></figure>
<p>有时候我们希望模块中的测试程序只有在测试模块时被执行，在模块加载进执行应用程序时不被执行，可以加上：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br></pre></td></tr></table></figure>
<p>于是模块文件可以改为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    test()</span><br></pre></td></tr></table></figure>
<p>在执行应用程序时，在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__name__  <span class="comment"># 结果为“__main__”</span></span><br><span class="line">tc.__name__  <span class="comment"># 结果为“Temp”</span></span><br></pre></td></tr></table></figure>
<p>在执行模块程序时，在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__name__  <span class="comment"># 结果为'__main__'</span></span><br></pre></td></tr></table></figure>
<p>即执行哪个程序，那一个程序的<code>name</code>为<code>main</code>。</p>
<h3 id="包"><a href="#包" class="headerlink" title="包"></a>包</h3><p>&emsp;&emsp;创建<code>包</code>(<code>package</code>)的方法：创建一个文件夹，用于存放相关的模块，文件夹的名字就是包的名字；在文件夹中创建一个<code>__init__.py</code>的模块文件，内容可以为空。<br>&emsp;&emsp;具体使用方法：在当前文件夹下创建一个文件夹<code>M1</code>，把<code>Temp.py</code>放入<code>M1</code>文件夹，并在<code>M1</code>文件夹中创建一个空文件<code>__init__.py</code>。把应用程序改为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> M1.Temp <span class="keyword">as</span> tc</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"32摄氏度 = %.2f华氏度"</span> % tc.c2f(<span class="number">32</span>))</span><br><span class="line">print(<span class="string">"99华氏度 = %.2f摄氏度"</span> % tc.f2c(<span class="number">99</span>))</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/11/Python语法/运算符重载/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/11/Python语法/运算符重载/" itemprop="url">运算符重载</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-11T22:01:32+08:00">
                2019-01-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>Python</code>的对象天生拥有一些神奇的方法，这些方法总被双下划线所包围，是面向对象的<code>Python</code>的一切。它们是可以给你的类增加魔力的特殊方法，如果你的对象实现(<code>重载</code>)了这些方法中的某一个，那么这个方法就会在特殊的情况下被<code>Python</code>所调用，你可以定义自己想要的行为，而这一切都是自动发生的。<br>&emsp;&emsp;基本的魔法方法如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__new__(cls[, ...])</code></td>
<td>1. <code>__new__</code>是在一个对象实例化的时候所调用的第一个方法<br>2.它的第一个参数是这个类，其他的参数是用来直接传递给<code>__init__</code>方法<br>3. <code>__new__</code>决定是否要使用该<code>__init__</code>方法，因为<code>__new__</code>可以调用其他类的构造方法或者直接返回别的实例对象来作为本类的实例，如果<code>__new__</code>没有返回实例对象，则<code>__init__</code>不会被调用<br>4. <code>__new__</code>主要是用于继承一个不可变的类型，比如一个<code>tuple</code>或者<code>string</code></td>
</tr>
<tr>
<td><code>__init__(self[, ...])</code></td>
<td>构造器，当一个实例被创建的时候调用的初始化方法</td>
</tr>
<tr>
<td><code>__del__(self)</code></td>
<td>析构器，当一个实例被销毁的时候调用的方法</td>
</tr>
<tr>
<td><code>__call__(self[, args...])</code></td>
<td>允许一个类的实例像函数一样被调用：<code>x(a, b)</code>调用<code>x.__call__(a, b)</code></td>
</tr>
<tr>
<td><code>__len__(self)</code></td>
<td>定义当被<code>len</code>调用时的行为</td>
</tr>
<tr>
<td><code>__repr__(self)</code></td>
<td>定义当被<code>repr</code>调用时的行为</td>
</tr>
<tr>
<td><code>__str__(self)</code></td>
<td>定义当被<code>str</code>调用时的行为</td>
</tr>
<tr>
<td><code>__bytes__(self)</code></td>
<td>定义当被<code>bytes</code>调用时的行为</td>
</tr>
<tr>
<td><code>__hash__(self)</code></td>
<td>定义当被<code>hash</code>调用时的行为</td>
</tr>
<tr>
<td><code>__bool__(self)</code></td>
<td>定义当被<code>bool</code>调用时的行为，应该返回<code>True</code>或<code>False</code></td>
</tr>
<tr>
<td><code>__format__(self, format_spec)</code></td>
<td>定义当被<code>format</code>调用时的行为</td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;有关属性的方法如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__getattr__(self, name)</code></td>
<td>定义当用户试图获取一个不存在的属性时的行为</td>
</tr>
<tr>
<td><code>__getattribute__(self, name)</code></td>
<td>定义当该类的属性被访问时的行为</td>
</tr>
<tr>
<td><code>__setattr__(self, name, value)</code></td>
<td>定义当一个属性被设置时的行为</td>
</tr>
<tr>
<td><code>__delattr__(self, name)</code></td>
<td>定义当一个属性被删除时的行为</td>
</tr>
<tr>
<td><code>__dir__(self)</code></td>
<td>定义当<code>dir</code>被调用时的行为</td>
</tr>
<tr>
<td><code>__get__(self, instance, owner)</code></td>
<td>定义当描述符的值被取得时的行为</td>
</tr>
<tr>
<td><code>__set__(self, instance, value)</code></td>
<td>定义当描述符的值被改变时的行为</td>
</tr>
<tr>
<td><code>__delete__(self, instance)</code></td>
<td>定义当描述符的值被删除时的行为</td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;比较操作符如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__lt__(self, other)</code></td>
<td>定义小于号的行为：<code>x &lt; y</code>调用<code>x.__lt__(y)</code></td>
</tr>
<tr>
<td><code>__le__(self, other)</code></td>
<td>定义小于等于号的行为：<code>x &lt;= y</code>调用<code>x.__le__(y)</code></td>
</tr>
<tr>
<td><code>__eq__(self, other)</code></td>
<td>定义等于号的行为：<code>x == y</code>调用<code>x.__eq__(y)</code></td>
</tr>
<tr>
<td><code>__ne__(self, other)</code></td>
<td>定义不等号的行为：<code>x != y</code>调用<code>x.__ne__(y)</code></td>
</tr>
<tr>
<td><code>__gt__(self, other)</code></td>
<td>定义大于号的行为：<code>x &gt; y</code>调用<code>x.__gt__(y)</code></td>
</tr>
<tr>
<td><code>__ge__(self, other)</code></td>
<td>定义大于等于号的行为：<code>x &gt;= y</code>调用<code>x.__ge__(y)</code></td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;算数运算符如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__add__(self, other)</code></td>
<td>定义加法的行为<code>+</code></td>
</tr>
<tr>
<td><code>__sub__(self, other)</code></td>
<td>定义减法的行为<code>-</code></td>
</tr>
<tr>
<td><code>__mul__(self, other)</code></td>
<td>定义乘法的行为<code>*</code></td>
</tr>
<tr>
<td><code>__truediv__(self, other)</code></td>
<td>定义真除法的行为<code>/</code></td>
</tr>
<tr>
<td><code>__floordiv__(self, other)</code></td>
<td>定义整数除法的行为<code>//</code></td>
</tr>
<tr>
<td><code>__mod__(self, other)</code></td>
<td>定义取模算法的行为<code>%</code></td>
</tr>
<tr>
<td><code>__divmod__(self, other)</code></td>
<td>定义当被<code>divmod</code>调用时的行为</td>
</tr>
<tr>
<td><code>__pow__(self, other[, modulo])</code></td>
<td>定义当被<code>power</code>调用或<code>**</code>运算时的行为</td>
</tr>
<tr>
<td><code>__lshift__(self, other)</code></td>
<td>定义按位左移位的行为<code>&lt;&lt;</code></td>
</tr>
<tr>
<td><code>__rshift__(self, other)</code></td>
<td>定义按位右移位的行为<code>&gt;&gt;</code></td>
</tr>
<tr>
<td><code>__and__(self, other)</code></td>
<td>定义按位与操作的行为<code>&amp;</code></td>
</tr>
<tr>
<td><code>__xor__(self, other)</code></td>
<td>定义按位异或操作的行为<code>^</code></td>
</tr>
<tr>
<td><code>__or__(self, other)</code></td>
<td>定义按位或操作的行为<code>&#124;</code></td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;反运算如下所示：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__radd__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__rsub__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__rmul__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__rtruediv__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__rfloordiv__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__rmod__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__rdivmod__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__rpow__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__rlshift__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__rrshift__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__rand__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__rxor__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
<tr>
<td><code>__ror__(self, other)</code></td>
<td>与上方相同，当左操作数不支持相应的操作时被调用</td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;增量赋值运算如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__iadd__(self, other)</code></td>
<td>定义赋值加法的行为<code>+=</code></td>
</tr>
<tr>
<td><code>__isub__(self, other)</code></td>
<td>定义赋值减法的行为<code>-=</code></td>
</tr>
<tr>
<td><code>__imul__(self, other)</code></td>
<td>定义赋值乘法的行为<code>*=</code></td>
</tr>
<tr>
<td><code>__itruediv__(self, other)</code></td>
<td>定义赋值真除法的行为<code>/=</code></td>
</tr>
<tr>
<td><code>__ifloordiv__(self, other)</code></td>
<td>定义赋值整数除法的行为<code>//=</code></td>
</tr>
<tr>
<td><code>__imod__(self, other)</code></td>
<td>定义赋值取模算法的行为<code>%=</code></td>
</tr>
<tr>
<td><code>__ipow__(self, other[, modulo])</code></td>
<td>定义赋值幂运算的行为<code>**=</code></td>
</tr>
<tr>
<td><code>__ilshift__(self, other)</code></td>
<td>定义赋值按位左移位的行为<code>&lt;&lt;=</code></td>
</tr>
<tr>
<td><code>__irshift__(self, other)</code></td>
<td>定义赋值按位右移位的行为<code>&gt;&gt;=</code></td>
</tr>
<tr>
<td><code>__iand__(self, other)</code></td>
<td>定义赋值按位与操作的行为<code>&amp;=</code></td>
</tr>
<tr>
<td><code>__ixor__(self, other)</code></td>
<td>定义赋值按位异或操作的行为<code>^=</code></td>
</tr>
<tr>
<td><code>__ior__(self, other)</code></td>
<td>定义赋值按位或操作的行为<code>&#124;=</code></td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;一元操作符如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__pos__(self)</code></td>
<td>定义正号的行为<code>+x</code></td>
</tr>
<tr>
<td><code>__neg__(self)</code></td>
<td>定义负号的行为<code>-x</code></td>
</tr>
<tr>
<td><code>__abs__(self)</code></td>
<td>定义当被<code>abs</code>调用时的行为</td>
</tr>
<tr>
<td><code>__invert__(self)</code></td>
<td>定义按位求反的行为<code>~x</code></td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;类型转换如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__complex__(self)</code></td>
<td>定义当被<code>complex</code>调用时的行为(需要返回恰当的值)</td>
</tr>
<tr>
<td><code>__int__(self)</code></td>
<td>定义当被<code>int</code>调用时的行为(需要返回恰当的值)</td>
</tr>
<tr>
<td><code>__float__(self)</code></td>
<td>定义当被<code>float</code>调用时的行为(需要返回恰当的值)</td>
</tr>
<tr>
<td><code>__round__(self[, n])</code></td>
<td>定义当被<code>round</code>调用时的行为(需要返回恰当的值)</td>
</tr>
<tr>
<td><code>__index__(self)</code></td>
<td>1. 当对象是被应用在切片表达式中时，实现整形强制转换<br>2. 如果你定义了一个可能在切片时用到的定制的数值型，你应该定义<code>__index__</code><br>3. 如果<code>__index__</code>被定义，则<code>__int__</code>也需要被定义，且返回相同的值</td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;上下文管理(<code>with</code>语句)如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__enter__(self)</code></td>
<td>1. 定义当使用<code>with</code>语句时的初始化行为<br>2. <code>__enter__</code>的返回值被<code>with</code>语句的目标或者<code>as</code>后的名字绑定</td>
</tr>
<tr>
<td><code>__exit__(self, exc_type, exc_value, traceback)</code></td>
<td>1. 定义当一个代码块被执行或者终止后上下文管理器应该做什么<br>2. 一般被用来处理异常，清除工作或者做一些代码块执行完毕之后的日常工作</td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;容器类型如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>魔法方法</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__len__(self)</code></td>
<td>定义当被<code>len</code>调用时的行为(返回容器中元素的个数)</td>
</tr>
<tr>
<td><code>__getitem__(self, key)</code></td>
<td>定义获取容器中指定元素的行为，相当于<code>self[key]</code></td>
</tr>
<tr>
<td><code>__setitem__(self, key, value)</code></td>
<td>定义设置容器中指定元素的行为，相当于<code>self[key] = value</code></td>
</tr>
<tr>
<td><code>__delitem__(self, key)</code></td>
<td>定义删除容器中指定元素的行为，相当于<code>del self[key]</code></td>
</tr>
<tr>
<td><code>__iter__(self)</code></td>
<td>定义当迭代容器中的元素的行为</td>
</tr>
<tr>
<td><code>__reversed__(self)</code></td>
<td>定义当被<code>reversed</code>调用时的行为</td>
</tr>
<tr>
<td><code>__contains__(self, item)</code></td>
<td>定义当使用成员测试运算符(<code>in</code>或<code>not in</code>)时的行为</td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Try_int</span><span class="params">(int)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self + other</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__sub__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self - other</span><br><span class="line"></span><br><span class="line">a = Try_int(<span class="number">3</span>)</span><br><span class="line">a  <span class="comment"># 结果为3</span></span><br><span class="line">b = Try_int(<span class="number">5</span>)</span><br><span class="line">b  <span class="comment"># 结果为5</span></span><br><span class="line">a + b  <span class="comment"># 结果为“出错”，因为会进入无限递归</span></span><br></pre></td></tr></table></figure>
<p>解决方法是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Try_int</span><span class="params">(int)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> int(self) + int(other)</span><br><span class="line">​</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__sub__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> int(self) - int(other)</span><br><span class="line">​</span><br><span class="line">a = Try_int(<span class="number">3</span>)</span><br><span class="line">b = Try_int(<span class="number">5</span>)</span><br><span class="line">a + b  <span class="comment"># 结果为8</span></span><br><span class="line">a - b  <span class="comment"># 结果为“-2”</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">int</span><span class="params">(int)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__add__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> int.__sub__(self, other)</span><br><span class="line">​</span><br><span class="line">a = int(<span class="string">"3"</span>)</span><br><span class="line">a  <span class="comment"># 结果为3</span></span><br><span class="line">b = int(<span class="string">"5"</span>)</span><br><span class="line">b  <span class="comment"># 结果为5</span></span><br><span class="line">a + b  <span class="comment"># 结果为“-2”</span></span><br><span class="line"><span class="comment"># ----------------</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Nint</span><span class="params">(int)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__radd__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> int.__sub__(self, other)</span><br><span class="line">​</span><br><span class="line">a = Nint(<span class="number">5</span>)</span><br><span class="line">a  <span class="comment"># 结果为5</span></span><br><span class="line">b = Nint(<span class="number">3</span>)</span><br><span class="line">b  <span class="comment"># 结果为3</span></span><br><span class="line">a + b  <span class="comment"># 结果为8</span></span><br><span class="line"><span class="number">1</span> + b  <span class="comment"># 结果为2(计算过程是“b - 1”)</span></span><br><span class="line"><span class="comment"># ----------------</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Nint</span><span class="params">(int)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__rsub__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> int.__sub__(self, other)</span><br><span class="line">​</span><br><span class="line">a = Nint(<span class="number">5</span>)</span><br><span class="line"><span class="number">3</span> - a  <span class="comment"># 结果为2(计算过程是“a - 3”)</span></span><br><span class="line"><span class="comment"># ---------------</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Nint</span><span class="params">(int)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__rsub__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> int.__sub__(other, self)</span><br><span class="line">​</span><br><span class="line">a = Nint(<span class="number">5</span>)</span><br><span class="line"><span class="number">3</span> - a  <span class="comment"># 结果为“-2”(计算过程是“3 - a”)</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>__str__</code>方法会告诉<code>Python</code>打印(<code>print</code>)一个对象时具体显示什么内容。<code>Python</code>会默认显示以下内容：</p>
<ul>
<li>实例在哪里定义。</li>
<li>类名。</li>
<li>存储实例的内存位置。</li>
</ul>
<p>如果你希望<code>print</code>为对象显示其他的内容，可以定义自己的<code>__str__</code>方法，这会覆盖内置的<code>__str__</code>方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">strtest</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"init: this is only test"</span>)</span><br><span class="line">​</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"str: this is only test"</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    st = strtest()</span><br><span class="line">    print(st)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/11/Python语法/Python编程注意/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/11/Python语法/Python编程注意/" itemprop="url">Python编程注意</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-11T19:41:59+08:00">
                2019-01-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>由于<code>Python</code>没有变量的检查，在程序中可能会出现变量名近似的错误，例如将<code>girl</code>误写为<code>gril</code>。</li>
<li><code>python</code>打印序列前几个数据可以采取分片的方式，例如<code>for index in suit_list[0:5]</code>。</li>
<li>编写<code>python</code>的函数时，一定要注意<code>return</code>关键字的位置。</li>
<li><code>python</code>中还是有部分函数无法在<code>Linux</code>和<code>Windows</code>上通用，例如<code>os</code>模块中和文件或目录有关的函数。</li>
<li><code>python</code>的<code>16</code>进制示例<code>0xAF</code>，第二个字母是<code>x</code>，大小写都可以；<code>8</code>进制示例<code>0o10</code>，第二个字母是<code>o</code>，大小写都可以。</li>
<li><code>python 3</code>中没有<code>cStringIO</code>，要改为<code>io</code>；没有<code>xrange</code>，要改为<code>range</code>。</li>
<li>对于序列，序号<code>-1</code>代表最后一个元素的位置，<code>-2</code>代表倒数第二个元素的位置。</li>
<li><code>python</code>的<code>import</code>类似于<code>C</code>语言的<code>include</code>，可以把一个文件的内容引入源代码中。</li>
<li>对函数进行注释时，最好把注释的内容写到函数中，这样可以通过<code>__doc__</code>进行显示。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/11/Python语法/sys模块/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/11/Python语法/sys模块/" itemprop="url">sys模块</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-11T19:09:18+08:00">
                2019-01-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>sys</code>模块提供了一系列有关<code>Python</code>运行环境的变量和函数。</p>
<h3 id="sys-argv"><a href="#sys-argv" class="headerlink" title="sys.argv"></a>sys.argv</h3><p>&emsp;&emsp;可以用<code>sys.argv</code>获取当前正在执行的命令行参数的列表：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>变量</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sys.argv[0]</code></td>
<td>当前程序名</td>
</tr>
<tr>
<td><code>sys.argv[1]</code></td>
<td>第一个参数</td>
</tr>
<tr>
<td><code>sys.argv[2]</code></td>
<td>第二个参数</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">​</span><br><span class="line"><span class="comment"># 获取脚本名字</span></span><br><span class="line">print(<span class="string">'The name of this program is: %s'</span> % (sys.argv[<span class="number">0</span>]))</span><br><span class="line">print(<span class="string">'The command line arguments are:'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> sys.argv:  <span class="comment"># 获取参数列表</span></span><br><span class="line">    print(i)</span><br><span class="line">​</span><br><span class="line"><span class="comment"># 统计参数个数</span></span><br><span class="line">print(<span class="string">'There are %s arguments.'</span> % (len(sys.argv) - <span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<h3 id="sys-platform"><a href="#sys-platform" class="headerlink" title="sys.platform"></a>sys.platform</h3><p>&emsp;&emsp;用于获取当前执行环境的平台，例如<code>win32</code>表示<code>Windows</code>系统，<code>linux2</code>表示是<code>linux</code>系统：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># linux</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.platform</span><br><span class="line"><span class="string">'linux2'</span></span><br><span class="line"><span class="comment"># windows</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.platform</span><br><span class="line"><span class="string">'win32'</span></span><br></pre></td></tr></table></figure>
<p>使用该方法可以写出跨平台的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, os</span><br><span class="line">​</span><br><span class="line">osType = sys.platform</span><br><span class="line"><span class="keyword">if</span> osType == <span class="string">'linux'</span> <span class="keyword">or</span> osType == <span class="string">'linux2'</span>:</span><br><span class="line">    command = <span class="string">'clear'</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    command = <span class="string">'cls'</span></span><br><span class="line">​</span><br><span class="line">os.system(command)</span><br></pre></td></tr></table></figure>
<h3 id="sys-path"><a href="#sys-path" class="headerlink" title="sys.path"></a>sys.path</h3><p>&emsp;&emsp;<code>path</code>是一个目录列表，供<code>Python</code>从中查找第三方扩展模块。在<code>python</code>启动时，<code>sys.path</code>根据内建规则、<code>PYTHONPATH</code>变量进行初始化。当我们导入一个模块时(<code>import xxx</code>)，默认情况下<code>python</code>解析器会搜索当前目录、已安装的内置模块和第三方模块，搜索路径存放在<code>sys</code>模块的<code>path</code>中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.path</span><br></pre></td></tr></table></figure>
<p>当我们要添加自己的搜索目录时，可以使用列表的<code>append</code>方法。如果模块和自己写的脚本不在同一个目录下，可以在脚本开头加上<code>sys.path.append(xxx)</code>。注意这种方法是在运行脚本时有效的，运行结束后就会失效：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">'引用模块的地址'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="sys-builtin-module-names"><a href="#sys-builtin-module-names" class="headerlink" title="sys.builtin_module_names"></a>sys.builtin_module_names</h3><p>&emsp;&emsp;<code>sys.builtin_module_names</code>返回一个列表，包含内建模块的名字。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_module</span><span class="params">(module)</span>:</span>  <span class="comment"># print sys.builtin_module_names</span></span><br><span class="line">    <span class="keyword">if</span> module <span class="keyword">in</span> sys.builtin_module_names:</span><br><span class="line">        print(module, <span class="string">"=&gt;"</span>, <span class="string">"__builtin__"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(module, <span class="string">"=&gt;"</span>, __import__(module).__file__)</span><br><span class="line">​</span><br><span class="line">find_module(<span class="string">'os'</span>)</span><br><span class="line">find_module(<span class="string">'sys'</span>)</span><br><span class="line">find_module(<span class="string">'zlib'</span>)</span><br><span class="line">find_module(<span class="string">'string'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="sys-exit"><a href="#sys-exit" class="headerlink" title="sys.exit"></a>sys.exit</h3><p>&emsp;&emsp;调用<code>sys.exit(n)</code>可以中途退出程序，当参数非<code>0</code>时，会引发一个<code>SystemExit</code>异常。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">​</span><br><span class="line">print(<span class="string">'running...'</span>)</span><br><span class="line">​</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">except</span> SystemExit:</span><br><span class="line">    print(<span class="string">'SystemExit exit 1'</span>)</span><br><span class="line">​</span><br><span class="line">print(<span class="string">'exited'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="sys-modules"><a href="#sys-modules" class="headerlink" title="sys.modules"></a>sys.modules</h3><p>&emsp;&emsp;使用<code>sys.modules</code>模块查找已导入的模块，<code>This is a dictionary that maps module names to modules which have already been loaded. This can be manipulated to force reloading of modules and other tricks</code>。<code>modules</code>字典包含所有加载的模块，<code>import</code>语句在从磁盘导入内容之前会先检查这个字典。</p>
<h3 id="sys-exc-info"><a href="#sys-exc-info" class="headerlink" title="sys.exc_info"></a>sys.exc_info</h3><p>&emsp;&emsp;This function returns a <code>tuple</code> of three values that give information about the exception that is currently being handled. The information returned is specific both to the current thread and to the current stack frame. If the current stack frame is not handling an exception, the information is taken from the calling stack frame, or its caller, and so on until a stack frame is found that is handling an exception. Here, <code>handling an exception</code> is defined as <code>executing an except clause</code>. For any stack frame, only information about the exception being currently handled is accessible.<br>&emsp;&emsp;If no exception is being handled anywhere on the stack, a tuple containing three <code>None</code> values is returned. Otherwise, the values returned are <code>(type, value, traceback)</code>. Their meaning is: <code>type</code> gets the <code>type</code> of the exception being handled (a subclass of <code>BaseException</code>); <code>value</code> gets the exception <code>instance</code> (an instance of the exception type); <code>traceback</code> gets a <code>traceback</code> object which encapsulates the call stack at the point where the exception originally occurred.</p>
<h3 id="sys-version"><a href="#sys-version" class="headerlink" title="sys.version"></a>sys.version</h3><p>&emsp;&emsp;A string containing the version number of the <code>Python</code> interpreter plus additional information on the build number and compiler used. This string is displayed when the interactive interpreter is started. Do not extract version information out of it, rather, use <code>version_info</code> and the functions provided by the platform module.</p>
<h3 id="sys-version-info"><a href="#sys-version-info" class="headerlink" title="sys.version_info"></a>sys.version_info</h3><p>&emsp;&emsp;A tuple containing the five components of the version number: <code>major</code>, <code>minor</code>, <code>micro</code>, <code>releaselevel</code>, and <code>serial</code>. All values except releaselevel are <code>integers</code>; the release level is <code>alpha</code>, <code>beta</code>, <code>candidate</code>, or <code>final</code>. The <code>version_info</code> value corresponding to the <code>Python version 2.0</code> is <code>(2, 0, 0, &#39;final&#39;, 0)</code>. The components can also be accessed by name, so <code>sys.version_info[0]</code> is equivalent to <code>sys.version_info.major</code> and so on.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.version</span><br><span class="line"><span class="string">'3.6.3 (v3.6.3:2c5fed8, Oct  3 2017, 18:11:49) [MSC v.1900 64 bit (AMD64)]'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.version_info</span><br><span class="line">sys.version_info(major=<span class="number">3</span>, minor=<span class="number">6</span>, micro=<span class="number">3</span>, releaselevel=<span class="string">'final'</span>, serial=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/11/Python语法/os模块/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/11/Python语法/os模块/" itemprop="url">os模块</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-11T09:54:42+08:00">
                2019-01-11
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>os</code>模块提供了很多方法用来处理文件和目录。</p>
<h3 id="os-chdir"><a href="#os-chdir" class="headerlink" title="os.chdir"></a>os.chdir</h3><p>&emsp;&emsp;<code>os.chdir</code>用于改变当前工作目录到指定的路径。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.chdir(path)</span><br></pre></td></tr></table></figure>
<p>参数<code>path</code>是要切换到的新路径。如果该路径允许访问，则返回<code>True</code>，否则返回<code>False</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">path = <span class="string">"/tmp"</span></span><br><span class="line">retval = os.getcwd()</span><br><span class="line">print(<span class="string">"当前工作目录为 %s"</span> % retval)  <span class="comment"># 输出“当前工作目录为 /www”</span></span><br><span class="line">os.chdir(path)</span><br><span class="line">retval = os.getcwd()</span><br><span class="line">print(<span class="string">"目录修改成功 %s"</span> % retval)  <span class="comment"># 输出“目录修改成功 /tmp”</span></span><br></pre></td></tr></table></figure>
<h3 id="os-close"><a href="#os-close" class="headerlink" title="os.close"></a>os.close</h3><p>&emsp;&emsp;<code>os.close</code>关闭指定的文件描述符<code>fd</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">os.write(fd, <span class="string">b"This is test"</span>)  <span class="comment"># 写入字符串</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-closerange"><a href="#os-closerange" class="headerlink" title="os.closerange"></a>os.closerange</h3><p>&emsp;&emsp;<code>os.closerange</code>方法用于关闭所有文件描述符<code>fd</code>，从<code>fd_low</code>(包含)到<code>fd_high</code>(不包含)，错误会忽略。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.closerange(fd_low, fd_high)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fd_low</code>：最小文件描述符。</li>
<li><code>fd_high</code>：最大文件描述符。</li>
</ul>
<p>该方法类似于：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> fd <span class="keyword">in</span> range(fd_low, fd_high):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        os.close(fd)</span><br><span class="line">    <span class="keyword">except</span> OSError:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">os.write(fd, <span class="string">b"This is test"</span>)</span><br><span class="line">os.closerange(fd, fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-dup"><a href="#os-dup" class="headerlink" title="os.dup"></a>os.dup</h3><p>&emsp;&emsp;<code>os.dup</code>用于复制文件描述符<code>fd</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.dup(fd)</span><br></pre></td></tr></table></figure>
<p>参数<code>fd</code>是文件描述符。该方法返回复制的文件描述符。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">d_fd = os.dup(fd)  <span class="comment"># 复制文件描述符</span></span><br><span class="line">os.write(d_fd, <span class="string">b"This is test"</span>)  <span class="comment"># 使用复制的文件描述符写入文件</span></span><br><span class="line">os.closerange(fd, d_fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-dup2"><a href="#os-dup2" class="headerlink" title="os.dup2"></a>os.dup2</h3><p>&emsp;&emsp;<code>os.dup2</code>用于将一个文件描述符<code>fd</code>复制到<code>fd2</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.dup2(fd, fd2)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fd</code>：要被复制的文件描述符。</li>
<li><code>fd2</code>：复制的文件描述符。</li>
</ul>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">os.write(fd, <span class="string">"This is test"</span>.encode())</span><br><span class="line">fd2 = <span class="number">1000</span>  <span class="comment"># 文件描述符为1000</span></span><br><span class="line">os.dup2(fd, fd2)</span><br><span class="line"><span class="comment"># 在新的文件描述符上插入数据</span></span><br><span class="line">os.lseek(fd2, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">str = os.read(fd2, <span class="number">100</span>)</span><br><span class="line">print(<span class="string">"读取的字符串是:"</span>, str.decode())  <span class="comment"># 输出“读取的字符串是: This is test”</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-fchdir"><a href="#os-fchdir" class="headerlink" title="os.fchdir"></a>os.fchdir</h3><p>&emsp;&emsp;<code>os.fchdir</code>通过文件描述符改变当前工作目录。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.fchdir(fd)</span><br></pre></td></tr></table></figure>
<p>参数<code>fd</code>是文件描述符。该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">os.chdir(<span class="string">"/var/www/html"</span>)  <span class="comment"># 首先到目录“/var/www/html”</span></span><br><span class="line">print(<span class="string">"当前工作目录为: %s"</span> % os.getcwd())  <span class="comment"># 输出“当前工作目录为: /var/www/html”</span></span><br><span class="line">fd = os.open(<span class="string">"/tmp"</span>, os.O_RDONLY)  <span class="comment"># 打开新目录“/tmp”</span></span><br><span class="line">os.fchdir(fd)  <span class="comment"># 使用os.fchdir方法修改到新目录</span></span><br><span class="line">print(<span class="string">"当前工作目录为: %s"</span> % os.getcwd())  <span class="comment"># 输出“当前工作目录为: /tmp”</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-fdatasync"><a href="#os-fdatasync" class="headerlink" title="os.fdatasync"></a>os.fdatasync</h3><p>&emsp;&emsp;<code>os.fdatasync</code>强制将文件写入磁盘，但是不强制更新文件的状态信息。如果你需要刷新缓冲区，可以使用该方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.fdatasync(fd)</span><br></pre></td></tr></table></figure>
<p>参数<code>fd</code>是文件描述符。该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, sys</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">os.write(fd, <span class="string">"This is test"</span>.encode())  <span class="comment"># 写入字符串</span></span><br><span class="line">os.fdatasync(fd)  <span class="comment"># 使用fdatasync方法</span></span><br><span class="line">os.lseek(fd, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">str = os.read(fd, <span class="number">100</span>)</span><br><span class="line">print(<span class="string">"读取的字符是:"</span>, str.decode())  <span class="comment"># 输出“读取的字符是: This is test”</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-fdopen"><a href="#os-fdopen" class="headerlink" title="os.fdopen"></a>os.fdopen</h3><p>&emsp;&emsp;<code>os.fdopen</code>通过文件描述符<code>fd</code>创建一个文件对象，并返回这个文件对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.fdopen(fd, [, mode[, bufsize]])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fd</code>：文件描述符。</li>
<li><code>mode</code>：可选项。和<code>Python</code>内建的<code>open</code>函数一样，<code>mode</code>参数可以指定为<code>r</code>、<code>w</code>、<code>a</code>、<code>r+</code>、<code>w+</code>、<code>a+</code>、<code>b</code>等。</li>
<li><code>bufsize</code>：可选项，指定返回的文件对象是否带缓冲。如果这个参数没有指定，则使用系统默认的缓冲设定。</li>
</ul>
<ol>
<li><code>bufsize = 0</code>表示没有带缓冲。</li>
<li><code>bufsize = 1</code>表示该文件对象是行缓冲的。</li>
<li><code>bufsize = 正数</code>表示使用一个指定大小的缓冲，单位为<code>byte</code>，但是这个大小不是精确的。</li>
<li><code>bufsize = 负数</code>表示使用一个系统默认大小的缓冲。对于<code>tty</code>等字符设备，一般是行缓冲；而对于其他文件，一般是全缓冲。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">fo = os.fdopen(fd, <span class="string">"w+"</span>)  <span class="comment"># 获取以上文件的对象</span></span><br><span class="line">print(<span class="string">"Current I/O pointer position: %d"</span> % fo.tell())  <span class="comment"># 获取当前位置</span></span><br><span class="line">fo.write(<span class="string">"Python is a great language.\nYeah its great!"</span>)  <span class="comment"># 写入字符串</span></span><br><span class="line">fo.seek(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">str = os.read(fd, <span class="number">100</span>)  <span class="comment"># 读取内容</span></span><br><span class="line">print(<span class="string">"Read String is:"</span>, str.decode())</span><br><span class="line">print(<span class="string">"Current I/O pointer position: %d"</span> % fo.tell())  <span class="comment"># 获取当前位置</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Current I/O pointer position: <span class="number">0</span></span><br><span class="line">Read String <span class="keyword">is</span>: Python <span class="keyword">is</span> a great language.</span><br><span class="line">Yeah its great!</span><br><span class="line">Current I/O pointer position: <span class="number">44</span></span><br></pre></td></tr></table></figure>
<h3 id="os-fstat"><a href="#os-fstat" class="headerlink" title="os.fstat"></a>os.fstat</h3><p>&emsp;&emsp;<code>os.fstat</code>返回文件描述符<code>fd</code>的状态，类似于<code>stat</code>。<code>fstat</code>返回的结构如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>结构成员</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>st_dev</code></td>
<td>设备信息</td>
</tr>
<tr>
<td><code>st_ino</code></td>
<td>文件的<code>i_node</code>值</td>
</tr>
<tr>
<td><code>st_mode</code></td>
<td>文件信息的掩码，包含了文件的权限信息、类型信息(是普通文件还是管道文件，或者其他类型的文件)</td>
</tr>
<tr>
<td><code>st_nlink</code></td>
<td>硬连接数</td>
</tr>
<tr>
<td><code>st_uid</code></td>
<td>用户<code>ID</code></td>
</tr>
<tr>
<td><code>st_gid</code></td>
<td>用户组<code>ID</code></td>
</tr>
<tr>
<td><code>st_rdev</code></td>
<td>设备<code>ID</code></td>
</tr>
<tr>
<td><code>st_size</code></td>
<td>文件大小，以<code>byte</code>为单位</td>
</tr>
<tr>
<td><code>st_blksize</code></td>
<td>系统<code>I/O</code>块大小</td>
</tr>
<tr>
<td><code>st_blocks</code></td>
<td>文件的是由多少个<code>512 byte</code>块构成的</td>
</tr>
<tr>
<td><code>st_atime</code></td>
<td>文件最近的访问时间</td>
</tr>
<tr>
<td><code>st_mtime</code></td>
<td>文件最近的修改时间</td>
</tr>
<tr>
<td><code>st_ctime</code></td>
<td>文件状态信息的修改时间(不是文件内容的修改时间)</td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;<code>os.fstat</code>语法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.fstat(fd)</span><br></pre></td></tr></table></figure>
<p>实例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">info = os.fstat(fd)  <span class="comment"># 获取元组</span></span><br><span class="line">print(<span class="string">"文件信息:"</span>, info)</span><br><span class="line">print(<span class="string">"文件UID: %d"</span> % info.st_uid)  <span class="comment"># 获取文件uid</span></span><br><span class="line">print(<span class="string">"文件GID: %d"</span> % info.st_gid)  <span class="comment"># 获取文件gid</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">文件信息: os.stat_result(st_mode=<span class="number">33206</span>, st_ino=<span class="number">39406496739494228</span>, \</span><br><span class="line">    st_dev=<span class="number">853940426</span>, st_nlink=<span class="number">1</span>, st_uid=<span class="number">0</span>, st_gid=<span class="number">0</span>, \</span><br><span class="line">    st_size=<span class="number">44</span>, st_atime=<span class="number">1509690521</span>, st_mtime=<span class="number">1509690819</span>, st_ctime=<span class="number">1509682525</span>)</span><br><span class="line">文件UID: <span class="number">0</span></span><br><span class="line">文件GID: <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h3 id="os-fsync"><a href="#os-fsync" class="headerlink" title="os.fsync"></a>os.fsync</h3><p>&emsp;&emsp;<code>os.fsync</code>方法强制将文件描述符为<code>fd</code>的文件写入硬盘。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.fsync(fd)</span><br></pre></td></tr></table></figure>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">os.write(fd, <span class="string">"This is test"</span>.encode())  <span class="comment"># 写入字符串</span></span><br><span class="line">os.fsync(fd)  <span class="comment"># 使用fsync方法</span></span><br><span class="line">os.lseek(fd, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">str = os.read(fd, <span class="number">100</span>)</span><br><span class="line">print(<span class="string">"读取的字符串为:"</span>, str.decode())  <span class="comment"># 输出“读取的字符串为: This is test”</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-ftruncate"><a href="#os-ftruncate" class="headerlink" title="os.ftruncate"></a>os.ftruncate</h3><p>&emsp;&emsp;<code>os.ftruncate</code>裁剪文件描述符<code>fd</code>对应的文件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.ftruncate(fd, length)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fd</code>：文件的描述符。</li>
<li><code>length</code>：需要裁剪的大小，其值不能超过文件大小。</li>
</ul>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">os.write(fd, <span class="string">"This is test - This is test"</span>.encode())  <span class="comment"># 写入字符串</span></span><br><span class="line">os.ftruncate(fd, <span class="number">10</span>)  <span class="comment"># 使用ftruncate方法</span></span><br><span class="line">os.lseek(fd, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">str = os.read(fd, <span class="number">100</span>)</span><br><span class="line">print(<span class="string">"读取的字符串是:"</span>, str.decode())  <span class="comment"># 输出“读取的字符串是: This is te”</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-getcwd"><a href="#os-getcwd" class="headerlink" title="os.getcwd"></a>os.getcwd</h3><p>&emsp;&emsp;<code>os.getcwd</code>返回当前工作目录。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.getcwd()</span><br></pre></td></tr></table></figure>
<p>实例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">os.chdir(<span class="string">"/var/www/html"</span>)  <span class="comment"># 切换到“/var/www/html”目录</span></span><br><span class="line">print(<span class="string">"当前工作目录: %s"</span> % os.getcwd())  <span class="comment"># 输出“当前工作目录: /var/www/html”</span></span><br><span class="line">fd = os.open(<span class="string">"/tmp"</span>, os.O_RDONLY)  <span class="comment"># 打开“/tmp”</span></span><br><span class="line">os.fchdir(fd)  <span class="comment"># 使用os.fchdir方法修改目录</span></span><br><span class="line">print(<span class="string">"当前工作目录: %s"</span> % os.getcwd())  <span class="comment"># 输出“当前工作目录: /tmp”</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-listdir"><a href="#os-listdir" class="headerlink" title="os.listdir"></a>os.listdir</h3><p>&emsp;&emsp;<code>os.listdir</code>返回指定路径包含的文件和文件夹列表，这个列表是按照字母顺序排列，并且不包括<code>.</code>和<code>..</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.listdir(path)</span><br></pre></td></tr></table></figure>
<p>参数<code>path</code>是指定路径。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">path = <span class="string">"./"</span></span><br><span class="line">dirs = os.listdir(path)</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> dirs:  <span class="comment"># 输出所有文件和文件夹</span></span><br><span class="line">    print(file)</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.idea</span><br><span class="line">foo.txt</span><br><span class="line">hello.py</span><br></pre></td></tr></table></figure>
<h3 id="os-lseek"><a href="#os-lseek" class="headerlink" title="os.lseek"></a>os.lseek</h3><p>&emsp;&emsp;<code>os.lseek</code>设置文件描述符<code>fd</code>的当前位置。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.lseek(fd, pos, how)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>fd</code>：文件描述符。</li>
<li><code>pos</code>：这是相对于参数<code>how</code>的位置。</li>
<li><code>how</code>：文件内部的参考位置：</li>
</ul>
<ol>
<li><code>SEEK_SET</code>(或者<code>0</code>)设置从文件开始的计算的<code>pos</code>。</li>
<li><code>SEEK_CUR</code>(或者<code>1</code>)从当前位置计算。</li>
<li><code>SEEK_END</code>(或者<code>2</code>)从文件尾部开始。</li>
</ol>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">os.write(fd, <span class="string">"This is test"</span>.encode())</span><br><span class="line">os.fsync(fd)</span><br><span class="line">os.lseek(fd, <span class="number">0</span>, os.SEEK_SET)</span><br><span class="line">str = os.read(fd, <span class="number">100</span>)</span><br><span class="line">print(<span class="string">"Read String is:"</span>, str.decode())  <span class="comment"># 输出“Read String is: This is test”</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-mkdir"><a href="#os-mkdir" class="headerlink" title="os.mkdir"></a>os.mkdir</h3><p>&emsp;&emsp;<code>os.mkdir</code>使用数字权限创建目录，默认的模式为<code>0777</code>(八进制)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.mkdir(path [, mode])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>path</code>：创建的目录。</li>
<li><code>mode</code>：为目录设置的权限。</li>
</ul>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">path = <span class="string">"./tmp/monthly"</span></span><br><span class="line">os.mkdir(path, <span class="number">0o755</span>)</span><br></pre></td></tr></table></figure>
<h3 id="os-makedirs"><a href="#os-makedirs" class="headerlink" title="os.makedirs"></a>os.makedirs</h3><p>&emsp;&emsp;<code>os.makedirs</code>递归地创建目录。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.makedirs(path, mode=<span class="number">0o777</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>path</code>：需要递归创建的目录。</li>
<li><code>mode</code>：权限模式。</li>
</ul>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">path = <span class="string">"./tmp/daily"</span>  <span class="comment"># 创建的目录</span></span><br><span class="line">os.makedirs(path, <span class="number">0o755</span>)</span><br></pre></td></tr></table></figure>
<h3 id="os-open"><a href="#os-open" class="headerlink" title="os.open"></a>os.open</h3><p>&emsp;&emsp;<code>os.open</code>打开一个文件，并且设置打开选项。参数<code>mode</code>是可选的，默认为<code>0777</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.open(file, flags [, mode])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>file</code>：要打开的文件。</li>
<li><code>flags</code>：该参数有以下选项，多个则使用<code>|</code>隔开：</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>os.O_RDONLY</code></td>
<td>以只读的方式打开</td>
</tr>
<tr>
<td><code>os.O_WRONLY</code></td>
<td>以只写的方式打开</td>
</tr>
<tr>
<td><code>os.O_RDWR</code></td>
<td>以读写的方式打开</td>
</tr>
<tr>
<td><code>os.O_NONBLOCK</code></td>
<td>打开时不阻塞</td>
</tr>
<tr>
<td><code>os.O_APPEND</code></td>
<td>以追加的方式打开</td>
</tr>
<tr>
<td><code>os.O_CREAT</code></td>
<td>创建并打开一个新文件</td>
</tr>
<tr>
<td><code>os.O_TRUNC</code></td>
<td>打开一个文件，并截断它的长度为零(必须有写权限)</td>
</tr>
<tr>
<td><code>os.O_EXCL</code></td>
<td>如果指定的文件存在，就返回错误</td>
</tr>
<tr>
<td><code>os.O_SHLOCK</code></td>
<td>自动获取共享锁</td>
</tr>
<tr>
<td><code>os.O_EXLOCK</code></td>
<td>自动获取独立锁</td>
</tr>
<tr>
<td><code>os.O_DIRECT</code></td>
<td>消除或减少缓存效果</td>
</tr>
<tr>
<td><code>os.O_FSYNC</code></td>
<td>同步写入</td>
</tr>
<tr>
<td><code>os.O_NOFOLLOW</code></td>
<td>不追踪软链接</td>
</tr>
</tbody>
</table>
</div>
<p>该方法返回新打开的文件描述符。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">os.write(fd, <span class="string">"This is test"</span>.encode())  <span class="comment"># 写入字符串</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-read"><a href="#os-read" class="headerlink" title="os.read"></a>os.read</h3><p>&emsp;&emsp;<code>os.read</code>从文件描述符<code>fd</code>中读取最多<code>n</code>个字节，并返回包含读取字节的字符串。如果文件指针达到文件尾，则返回一个空字符串。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.read(fd, n)</span><br></pre></td></tr></table></figure>
<p>参数<code>fd</code>是文件描述符，<code>n</code>是读取的字节。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"foo.txt"</span>, os.O_RDWR)</span><br><span class="line">ret = os.read(fd, <span class="number">12</span>)</span><br><span class="line">print(ret.decode())  <span class="comment"># 输出“This is test”</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-remove"><a href="#os-remove" class="headerlink" title="os.remove"></a>os.remove</h3><p>&emsp;&emsp;<code>os.remove</code>删除指定路径的文件。如果指定路径是一个目录，将抛出<code>OSError</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.remove(path)</span><br></pre></td></tr></table></figure>
<p>参数<code>path</code>是文件路径。该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"目录为: %s"</span> % os.listdir(os.getcwd()))</span><br><span class="line">os.remove(<span class="string">"foo.txt"</span>)  <span class="comment"># 移除</span></span><br><span class="line">print(<span class="string">"移除后: %s"</span> % os.listdir(os.getcwd()))</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">目录为: [<span class="string">'.idea'</span>, <span class="string">'foo.txt'</span>, <span class="string">'hello.py'</span>]</span><br><span class="line">移除后: [<span class="string">'.idea'</span>, <span class="string">'hello.py'</span>]</span><br></pre></td></tr></table></figure>
<h3 id="os-removedirs"><a href="#os-removedirs" class="headerlink" title="os.removedirs"></a>os.removedirs</h3><p>&emsp;&emsp;<code>os.removedirs</code>递归删除目录。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.removedirs(path)</span><br></pre></td></tr></table></figure>
<p>参数<code>path</code>是目录路径。该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"目录为: %s"</span> % os.listdir(os.getcwd()))</span><br><span class="line">os.removedirs(<span class="string">"./test"</span>)</span><br><span class="line">print(<span class="string">"移除后目录为: %s"</span> % os.listdir(os.getcwd()))</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">目录为: [ <span class="string">'a1.txt'</span>,<span class="string">'resume.doc'</span>,<span class="string">'a3.py'</span>,<span class="string">'test'</span> ]</span><br><span class="line">移除后目录为: [ <span class="string">'a1.txt'</span>,<span class="string">'resume.doc'</span>,<span class="string">'a3.py'</span> ]</span><br></pre></td></tr></table></figure>
<h3 id="os-rename"><a href="#os-rename" class="headerlink" title="os.rename"></a>os.rename</h3><p>&emsp;&emsp;<code>os.rename</code>重命名文件或目录，从<code>src</code>到<code>dst</code>。如果<code>dst</code>是一个存在的目录，将抛出<code>OSError</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.rename(src, dst)</span><br></pre></td></tr></table></figure>
<p>参数<code>src</code>是要修改的目录名，<code>dst</code>是修改后的目录名。该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"目录为: %s"</span> % os.listdir(os.getcwd()))</span><br><span class="line">os.rename(<span class="string">"test"</span>, <span class="string">"test2"</span>)  <span class="comment"># 重命名</span></span><br><span class="line">print(<span class="string">"重命名成功。"</span>)</span><br><span class="line">print(<span class="string">"目录为: %s"</span> % os.listdir(os.getcwd()))</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">目录为: [ <span class="string">'a1.txt'</span>,<span class="string">'resume.doc'</span>,<span class="string">'a3.py'</span>,<span class="string">'test'</span> ]</span><br><span class="line">重命名成功。</span><br><span class="line">目录为: [ <span class="string">'a1.txt'</span>,<span class="string">'resume.doc'</span>,<span class="string">'a3.py'</span>,<span class="string">'test2'</span> ]</span><br></pre></td></tr></table></figure>
<h3 id="os-renames"><a href="#os-renames" class="headerlink" title="os.renames"></a>os.renames</h3><p>&emsp;&emsp;<code>os.renames</code>递归地重命名目录或文件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.renames(old, new)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>old</code>：要重命名的目录</li>
<li><code>new</code>：文件或目录的新名字，甚至可以是包含在目录中的文件，或者完整的目录树。</li>
</ul>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"当前目录为: %s"</span> % os.getcwd())</span><br><span class="line">print(<span class="string">"目录为: %s"</span> % os.listdir(os.getcwd()))</span><br><span class="line">os.renames(<span class="string">"aa1.txt"</span>, <span class="string">"newdir/aanew.txt"</span>)  <span class="comment"># 重命名为“aa1.txt”</span></span><br><span class="line">print(<span class="string">"重命名成功。"</span>)</span><br><span class="line">print(<span class="string">"目录为: %s"</span> % os.listdir(os.getcwd()))</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">当前目录为: /tmp</span><br><span class="line">目录为: [ <span class="string">'a1.txt'</span>,<span class="string">'resume.doc'</span>,<span class="string">'a3.py'</span>,<span class="string">'aa1.txt'</span>,<span class="string">'Administrator'</span>,<span class="string">'amrood.admin'</span> ]</span><br><span class="line">重命名成功。</span><br><span class="line">目录为:[ <span class="string">'a1.txt'</span>,<span class="string">'resume.doc'</span>,<span class="string">'a3.py'</span>,<span class="string">'Administrator'</span>,<span class="string">'amrood.admin'</span> ]</span><br></pre></td></tr></table></figure>
<h3 id="os-rmdir"><a href="#os-rmdir" class="headerlink" title="os.rmdir"></a>os.rmdir</h3><p>&emsp;&emsp;<code>os.rmdir</code>删除指定路径的目录，条件是这文件夹为空的，否则抛出<code>OSError</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.rmdir(path)</span><br></pre></td></tr></table></figure>
<p>参数<code>path</code>是目录路径。该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"目录为: %s"</span> % os.listdir(os.getcwd()))</span><br><span class="line">os.rmdir(<span class="string">"mydir"</span>)  <span class="comment"># 删除路径</span></span><br><span class="line">print(<span class="string">"目录为: %s"</span> % os.listdir(os.getcwd()))</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">目录为: [ <span class="string">'a1.txt'</span>,<span class="string">'resume.doc'</span>,<span class="string">'a3.py'</span>,<span class="string">'mydir'</span> ]</span><br><span class="line">目录为: [ <span class="string">'a1.txt'</span>,<span class="string">'resume.doc'</span>,<span class="string">'a3.py'</span> ]</span><br></pre></td></tr></table></figure>
<h3 id="os-unlink"><a href="#os-unlink" class="headerlink" title="os.unlink"></a>os.unlink</h3><p>&emsp;&emsp;<code>os.unlink</code>删除文件，如果文件是一个目录，则返回一个错误。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.unlink(path)</span><br></pre></td></tr></table></figure>
<p>参数<code>path</code>是文件路径。该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">print(<span class="string">"目录为: %s"</span> % os.listdir(os.getcwd()))</span><br><span class="line">os.unlink(<span class="string">"aa.txt"</span>)</span><br><span class="line">print(<span class="string">"删除后的目录为: %s"</span> % os.listdir(os.getcwd()))</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">目录为: [ <span class="string">'a1.txt'</span>,<span class="string">'aa.txt'</span>,<span class="string">'resume.doc'</span> ]</span><br><span class="line">删除后的目录为: [ <span class="string">'a1.txt'</span>,<span class="string">'resume.doc'</span> ]</span><br></pre></td></tr></table></figure>
<h3 id="os-walk"><a href="#os-walk" class="headerlink" title="os.walk"></a>os.walk</h3><p>&emsp;&emsp;<code>os.walk</code>通过在目录树中游走，输出目录中的文件名(包含设置的根目录<code>top</code>)。该函数将产生<code>3</code>元组<code>(dirpath, dirnames, filenames)</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.walk(top[, topdown=<span class="keyword">True</span> [, onerror=<span class="keyword">None</span> [, followlinks=<span class="keyword">False</span>]]])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>top</code>：设置的根目录。</li>
<li><code>topdown</code>：可选项，如果为<code>True</code>或者没有指定，一个目录的<code>3</code>元组将比它的任何子文件夹的<code>3</code>元组先产生(即目录<code>自上而下</code>)；如果<code>topdown</code>为<code>False</code>，一个目录的<code>3</code>元组将比它的任何子文件夹的<code>3</code>元组后产生(即目录<code>自下而上</code>)。</li>
<li><code>onerror</code>：可选项，它是一个函数，一般不设置。</li>
<li><code>followlinks</code>：如果设置为<code>True</code>，则通过软链接访问目录。</li>
</ul>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(<span class="string">"."</span>, topdown=<span class="keyword">False</span>):</span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> files:</span><br><span class="line">        print(os.path.join(root, name))</span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> dirs:</span><br><span class="line">        print(os.path.join(root, name))</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.\.idea\scopes\scope_settings.xml</span><br><span class="line">.\.idea\.name</span><br><span class="line">.\.idea\encodings.xml</span><br><span class="line">.\.idea\misc.xml</span><br><span class="line">.\.idea\modules.xml</span><br><span class="line">.\.idea\untitled1.iml</span><br><span class="line">.\.idea\vcs.xml</span><br><span class="line">.\.idea\workspace.xml</span><br><span class="line">.\.idea\scopes</span><br><span class="line">.\hello.py</span><br><span class="line">.\.idea</span><br></pre></td></tr></table></figure>
<h3 id="os-write"><a href="#os-write" class="headerlink" title="os.write"></a>os.write</h3><p>&emsp;&emsp;<code>os.write</code>写入字符串到文件描述符<code>fd</code>中，返回实际写入的字符串长度。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os.write(fd, str)</span><br></pre></td></tr></table></figure>
<p>参数<code>fd</code>是文件描述符，<code>str</code>是写入的字符串。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">fd = os.open(<span class="string">"f1.txt"</span>, os.O_RDWR | os.O_CREAT)</span><br><span class="line">str = <span class="string">"This is runoob.com site"</span></span><br><span class="line">ret = os.write(fd, str.encode())</span><br><span class="line">print(<span class="string">"写入的位数为:"</span>, ret)  <span class="comment"># 输出“写入的位数为: 23”</span></span><br><span class="line">os.close(fd)</span><br></pre></td></tr></table></figure>
<h3 id="os-urandom"><a href="#os-urandom" class="headerlink" title="os.urandom"></a>os.urandom</h3><p>&emsp;&emsp;随机产生<code>n</code>个字节(<code>0-255</code>)的字符串，可以作为随机加密<code>key</code>使用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.urandom(<span class="number">2</span>)</span><br><span class="line"><span class="string">b'5\xcb'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.urandom(<span class="number">2</span>)</span><br><span class="line"><span class="string">b'2\\'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.urandom(<span class="number">2</span>)</span><br><span class="line"><span class="string">b'\xbe2'</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h3><p>&emsp;&emsp;获取所有环境变量的名字：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> os.environ.keys():</span><br><span class="line">    print(key)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;获取指定名字的环境变量对应的值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line"><span class="comment"># 参数“path”可以换成任意存在的环境变量名。如果不存在，则输出None</span></span><br><span class="line">dir = os.environ.get(<span class="string">'path'</span>)</span><br><span class="line">print(dir)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;设置环境变量(注意，当前设置的环境变量只是在本程序中生效，并不是永久更新)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">dir = <span class="string">"D:\LearnTool"</span></span><br><span class="line">os.environ[<span class="string">'datapath'</span>] = dir</span><br><span class="line">print(os.environ.get(<span class="string">'datapath'</span>))</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="os模块中的常量"><a href="#os模块中的常量" class="headerlink" title="os模块中的常量"></a>os模块中的常量</h3><p>&emsp;&emsp;如下所示：</p>
<ul>
<li><code>os.curdir</code>：指代当前目录(<code>.</code>)。</li>
<li><code>os.pardir</code>：指代上一级目录(<code>..</code>)。</li>
<li><code>os.sep</code>：输出操作系统特定的路径分隔符(<code>Win</code>下为<code>\\</code>，<code>Linux</code>下为<code>/</code>)。</li>
<li><code>os.linesep</code>：当前平台使用的行终止符(<code>Win</code>下为<code>\r\n</code>，<code>Linux</code>下为<code>\n</code>)。</li>
<li><code>os.name</code>：指代当前使用的操作系统(包括<code>posix</code>、<code>nt</code>、<code>mac</code>、<code>java</code>)。</li>
</ul>
<hr>
<h3 id="os-path模块"><a href="#os-path模块" class="headerlink" title="os.path模块"></a>os.path模块</h3><p>&emsp;&emsp;相关函数如下：</p>
<ul>
<li><code>os.path.abspath(path)</code>：返回绝对路径。</li>
<li><code>os.path.basename(path)</code>：返回文件名。</li>
<li><code>os.path.commonprefix(list)</code>：返回<code>list</code>(多个路径)中，所有<code>path</code>共有的最长路径。</li>
<li><code>os.path.dirname(path)</code>：返回文件路径。</li>
<li><code>os.path.exists(path)</code>：路径存在则返回<code>True</code>，路径损坏返回<code>False</code>。</li>
<li><code>os.path.expanduser(path)</code>：把<code>path</code>中包含的<code>~</code>转换成用户目录。</li>
<li><code>os.path.expandvars(path)</code>：根据环境变量的值替换<code>path</code>中包含的<code>$name</code>和<code>${name}</code>。</li>
<li><code>os.path.getatime(path)</code>：返回最后一次进入此<code>path</code>的时间。</li>
<li><code>os.path.getmtime(path)</code>：返回在此<code>path</code>下最后一次修改的时间。</li>
<li><code>os.path.getsize(path)</code>：返回文件大小，如果文件不存在，就返回错误。</li>
<li><code>os.path.isabs(path)</code>：判断是否为绝对路径。</li>
<li><code>os.path.isfile(path)</code>：判断路径是否为文件。</li>
<li><code>os.path.isdir(path)</code>：判断路径是否为目录。</li>
<li><code>os.path.islink(path)</code>：判断路径是否为链接。</li>
<li><code>os.path.ismount(path)</code>：判断路径是否为挂载点。</li>
<li><code>os.path.join(path1[, path2[, ...]])</code>：把目录和文件名合成一个路径。</li>
<li><code>os.path.normcase(path)</code>：转换<code>path</code>的大小写和斜杠。</li>
<li><code>os.path.normpath(path)</code>：规范<code>path</code>字符串形式。</li>
<li><code>os.path.realpath(path)</code>：返回<code>path</code>的真实路径。</li>
<li><code>os.path.relpath(path[, start])</code>：从<code>start</code>开始计算相对路径。</li>
<li><code>os.path.samefile(path1, path2)</code>：判断目录或文件是否相同。</li>
<li><code>os.path.sameopenfile(fp1, fp2)</code>：判断<code>fp1</code>和<code>fp2</code>是否指向同一文件</li>
<li><code>os.path.samestat(stat1, stat2)</code>：判断<code>stat1</code>和<code>stat2</code>是否指向同一个文件。</li>
<li><code>os.path.split(path)</code>：把路径分割成<code>dirname</code>和<code>basename</code>，返回一个元组。</li>
<li><code>os.path.splitdrive(path)</code>：一般用在<code>Windows</code>下，返回驱动器名和路径组成的元组。</li>
<li><code>os.path.splitext(path)</code>：分割路径，返回路径名和文件扩展名的元组。</li>
<li><code>os.path.splitunc(path)</code>：把路径分割为加载点与文件。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/10/软件与硬件问题/Python问题总结/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/10/软件与硬件问题/Python问题总结/" itemprop="url">Python问题总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-10T16:01:38+08:00">
                2019-01-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="HTTP-Error-403-Forbidden"><a href="#HTTP-Error-403-Forbidden" class="headerlink" title="HTTP Error 403: Forbidden"></a>HTTP Error 403: Forbidden</h3><p>&emsp;&emsp;<code>urllib.request.urlopen</code>经常会被用来打开一个网页的源代码，然后会去分析这个页面源代码。但是对于有的网站使用这种方法时，会抛出<code>HTTP Error 403: Forbidden</code>异常。例如执行下面的语句：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">urllib.request.urlopen(<span class="string">"http://blog.csdn.net/eric_sunah/article/details/11099295"</span>)</span><br></pre></td></tr></table></figure>
<p>会出现以下异常：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"D:\Python\lib\urllib\request.py"</span>, <span class="keyword">in</span> open response = meth(req, response)</span><br><span class="line"><span class="string">"D:\Python\lib\urllib\request.py"</span>, <span class="keyword">in</span> http_response <span class="string">'http'</span>, request, response, code, msg, hdrs)</span><br><span class="line"><span class="string">"D:\Python\lib\urllib\request.py"</span>, <span class="keyword">in</span> error <span class="keyword">return</span> self._call_chain(*args)</span><br><span class="line"><span class="string">"D:\Python\lib\urllib\request.py"</span>, <span class="keyword">in</span> _call_chain result = func(*args)</span><br><span class="line"><span class="string">"D:\Python\lib\urllib\request.py"</span>, <span class="keyword">in</span> http_error_default <span class="keyword">raise</span> HTTPError(req.full_url, code, msg, hdrs, fp)</span><br><span class="line">urllib.error.HTTPError: HTTP Error <span class="number">403</span>: Forbidden</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;之所以出现上面的异常，是因为如果用<code>urllib.request.urlopen</code>方式打开一个<code>URL</code>，服务器端只会收到一个单纯的对于该页面访问的请求，但是服务器并不知道发送这个请求使用的浏览器、操作系统、硬件平台等信息，而缺失这些信息的请求往往都是非正常的访问，例如爬虫。有些网站为了防止这种非正常的访问，会验证请求信息中的<code>UserAgent</code>(它的信息包括硬件平台、系统软件、应用软件和用户个人偏好)。如果<code>UserAgent</code>存在异常或者是不存在，那么这次请求将会被拒绝(例如上面的错误信息所示)，所以可以尝试在请求中加入<code>UserAgent</code>的信息。<br>&emsp;&emsp;对于<code>Python 3</code>来说，在请求中添加<code>UserAgent</code>的信息非常简单：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果不加上下面的这行，出现会出现“urllib2.HTTPError: HTTP Error 403: Forbidden”错误</span></span><br><span class="line"><span class="comment"># 主要是由于该网站禁止爬虫导致的，可以在请求加上头信息，伪装成浏览器访问“User-Agent”，</span></span><br><span class="line"><span class="comment"># 具体的信息可以通过火狐的FireBug插件查询</span></span><br><span class="line">headers = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:23.0) Gecko/20100101 Firefox/23.0'</span>&#125;</span><br><span class="line">req = urllib.request.Request(url=chaper_url, headers=headers)</span><br><span class="line">urllib.request.urlopen(req).read()</span><br></pre></td></tr></table></figure>
<p>将<code>urllib.request.urlopen.read</code>替换成上面的代码后，对于出现问题的页面就可以就正常访问。如果加上这个<code>UserAgent</code>还是不行的话，那就换一个<code>UserAgent</code>吧。</p>
<h3 id="serial-serialutil-SerialException-could-not-open-port"><a href="#serial-serialutil-SerialException-could-not-open-port" class="headerlink" title="serial.serialutil.SerialException: could not open port"></a>serial.serialutil.SerialException: could not open port</h3><p>&emsp;&emsp;<code>Question</code>：I tried to communicate <code>Python</code> and <code>Arduino</code> with <code>pyserial</code> on Win8, but it had error like this：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"C:\Users\Fon\Desktop\x.py"</span>, line <span class="number">7</span>, <span class="keyword">in</span> &lt;module&gt; ser.open() <span class="comment"># open serial port</span></span><br><span class="line">File <span class="string">"C:\Python27\lib\site-packages\serial\serialwin32.py"</span>, line <span class="number">66</span>, \</span><br><span class="line"><span class="keyword">in</span> open <span class="keyword">raise</span> SerialException(<span class="string">"could not open port %r: %r"</span> % (self.portstr, ctypes.WinError())) \</span><br><span class="line">serial.serialutil.SerialException: could <span class="keyword">not</span> open port <span class="string">'COM4'</span>: \</span><br><span class="line">WindowsError(<span class="number">2</span>, <span class="string">'The system cannot find the file specified.'</span>)</span><br></pre></td></tr></table></figure>
<p>this is my code：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> serial</span><br><span class="line">​</span><br><span class="line">ser = serial.Serial()</span><br><span class="line">ser.port = <span class="number">3</span>  <span class="comment"># serial port</span></span><br><span class="line">ser.baudrate = <span class="number">115200</span>  <span class="comment"># set baudrate 115200</span></span><br><span class="line">ser.timeout = <span class="number">60</span>  <span class="comment"># timeout 60 second</span></span><br><span class="line">ser.open()  <span class="comment"># open serial port</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    ser.write(<span class="string">'l'</span>)  <span class="comment"># send '1' to port to get light</span></span><br><span class="line">    light = ser.read(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"light"</span>, light</span><br></pre></td></tr></table></figure>
<p>in this code，I tried to open port <code>COM4</code>，I already check this port is available and I already tried another port but it not worked any port. Am I using wrong port？or something？<br>&emsp;&emsp;<code>Answer</code>：Does the port even exist? Maybe there is something already connected to it. If you ran the program before and the serial port didn’t close correctly that old program may still be connected to it. If it doesn’t exist then you will have to use a program to create a virtual serial port.</p>
<h3 id="TypeError-a-bytes-like-object-is-required-not-str"><a href="#TypeError-a-bytes-like-object-is-required-not-str" class="headerlink" title="TypeError: a bytes-like object is required, not str"></a>TypeError: a bytes-like object is required, not str</h3><p>&emsp;&emsp;解决方法将字符串通过<code>encode</code>方法转换为<code>bytes</code>。如果从网络或磁盘上读取了字节流，那么读到的数据就是<code>bytes</code>，要把<code>bytes</code>变为<code>str</code>，就需要用<code>decode</code>方法。<br>&emsp;&emsp;有时是在处理文件中发生该错误，例如使用<code>open</code>函数打开文本文件时，使用了<code>rb</code>属性。解决方法是在<code>open</code>函数中使用<code>r</code>属性，即文本方式读取，而不是<code>rb</code>以二进制文件方式读取。</p>
<h3 id="color-cpp-7456-error-215-scn-3-scn-4-in-function-cv-ipp-cvtColor"><a href="#color-cpp-7456-error-215-scn-3-scn-4-in-function-cv-ipp-cvtColor" class="headerlink" title="color.cpp:7456: error: (-215) scn == 3 || scn == 4 in function cv::ipp_cvtColor"></a>color.cpp:7456: error: (-215) scn == 3 || scn == 4 in function cv::ipp_cvtColor</h3><p>&emsp;&emsp;原因是代码中没有对视频是否处理完成做判断，解决方法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (cap.isOpened()):</span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> ret:  <span class="comment"># 如果不能抓取到一帧，说明我们到了视频的结尾</span></span><br><span class="line">        print(<span class="string">"over!"</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cv2.imshow(<span class="string">'frame'</span>, frame)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cv2.waitKey(<span class="number">1</span>) &amp; <span class="number">0xFF</span> == <span class="number">27</span>:  <span class="comment"># 按下ESC键则退出</span></span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h3 id="dict-object-has-no-attribute-iteritems"><a href="#dict-object-has-no-attribute-iteritems" class="headerlink" title="dict object has no attribute iteritems"></a>dict object has no attribute iteritems</h3><p>&emsp;&emsp;在<code>Python 3.5</code>以后，<code>iteritems</code>变为<code>items</code>。</p>
<h3 id="使用pickle读取文件提示TypeError或者UnicodeDecodeError"><a href="#使用pickle读取文件提示TypeError或者UnicodeDecodeError" class="headerlink" title="使用pickle读取文件提示TypeError或者UnicodeDecodeError"></a>使用pickle读取文件提示TypeError或者UnicodeDecodeError</h3><p>&emsp;&emsp;使用<code>python 3</code>读取<code>pkl</code>文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">train, test, dicts = pickle.load(open(<span class="string">"./dataset/atis.pkl"</span>))</span><br></pre></td></tr></table></figure>
<p>执行该代码，出现如下错误：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnicodeDecodeError: <span class="string">'ascii'</span> codec can<span class="string">'t decode byte 0xe8 in position 0: ordinal not in range(128)</span></span><br></pre></td></tr></table></figure>
<p>我们需要告诉<code>pickle</code>：<code>how to convert Python bytestring data to Python 3 strings, The default is to try and decode all string data as ASCII</code>，所以代码改为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">train, test, dicts = pickle.load(open(<span class="string">"./dataset/atis.pkl"</span>, <span class="string">"rb"</span>), encoding=<span class="string">'iso-8859-1'</span>)</span><br></pre></td></tr></table></figure>
<p><code>utf-8</code>编码出现错误也可以使用该方法进行解决。<br>&emsp;&emsp;或者使用<code>ignore</code>对该错误进行忽略：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">train, test, dicts = pickle.load(open(<span class="string">"./dataset/atis.pkl"</span>, <span class="string">"rb"</span>), encoding=<span class="string">'iso-8859-1'</span>, errors=<span class="string">'ignore'</span>)</span><br></pre></td></tr></table></figure>
<p>如果这些方法还是解决不了，则考虑修改系统的默认文件编码。<code>Windows</code>系统修改文件默认编码的方法：在<code>设置</code>中输入<code>Region</code>，点击<code>管理语言设置</code> -&gt; <code>更改系统区域设置</code>，勾选<code>Beta版：使用Unicode UTF-8提供全球语言支持</code>。</p>
<h3 id="AttributeError-csv-reader-object-has-no-attribute-next"><a href="#AttributeError-csv-reader-object-has-no-attribute-next" class="headerlink" title="AttributeError: _csv.reader object has no attribute next"></a>AttributeError: _csv.reader object has no attribute next</h3><p>&emsp;&emsp;原来的代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">allElectronicsData = open(<span class="string">'test.csv'</span>, <span class="string">'rb'</span>)</span><br><span class="line">reader = csv.reader(allElectronicsData)</span><br><span class="line">headers = reader.next()</span><br></pre></td></tr></table></figure>
<p>运行代码就会出现该错误。原因是<code>python 3</code>中的<code>reader</code>没有了<code>next</code>属性，修改如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">allElectronicsData = open(<span class="string">r'AllElectronics.csv'</span>, <span class="string">'rb'</span>)</span><br><span class="line">reader = csv.reader(allElectronicsData)</span><br><span class="line">headers = next(reader)</span><br></pre></td></tr></table></figure>
<p>但运行该代码就会出现<code>iterator should return strings, not bytes (did you open the file in text mode?)</code>的错误，解决方法是把<code>rb</code>换为<code>rt</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">allElectronicsData = open(<span class="string">r'test.csv'</span>, <span class="string">'rt'</span>)</span><br><span class="line">reader = csv.reader(allElectronicsData)</span><br><span class="line">headers = next(reader)</span><br></pre></td></tr></table></figure>
<h3 id="ValueError-Expected-2D-array-got-1D-array-instead"><a href="#ValueError-Expected-2D-array-got-1D-array-instead" class="headerlink" title="ValueError: Expected 2D array, got 1D array instead"></a>ValueError: Expected 2D array, got 1D array instead</h3><p>&emsp;&emsp;主要是由工具包版本更新造成的，找出出错的两行代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y_train = ss_y.fit_transform(y_train)</span><br><span class="line">y_test = ss_y.transform(y_test)</span><br></pre></td></tr></table></figure>
<p>如果数据格式为<code>[1, 2, 3, 4]</code>，就会出错；如果把这些数据转换成<code>[[1], [2], [3], [4]]</code>，就不会出错了。修改后的代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y_train = ss_y.fit_transform(y_train.reshape(<span class="number">1</span>, <span class="number">-1</span>))</span><br><span class="line">y_test = ss_y.transform(y_test.reshape(<span class="number">1</span>, <span class="number">-1</span>))</span><br></pre></td></tr></table></figure>
<p>如果上述方法出现警告，则采用如下的解决方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y_test = ss_y.transform(numpy.array(y_test).reshape(<span class="number">1</span>, <span class="number">-1</span>))</span><br></pre></td></tr></table></figure>
<h3 id="AttributeError或者DeprecationWarning-This-module-was-deprecated"><a href="#AttributeError或者DeprecationWarning-This-module-was-deprecated" class="headerlink" title="AttributeError或者DeprecationWarning: This module was deprecated"></a>AttributeError或者DeprecationWarning: This module was deprecated</h3><p>&emsp;&emsp;在使用<code>Python</code>的<code>sklearn</code>库时，发现<code>sklearn</code>的<code>cross_validation</code>不能使用。运行如下程序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sklearn</span><br><span class="line">X, Xt, y, yt = sklearn.cross_validation.train_test_split(X, y)</span><br></pre></td></tr></table></figure>
<p>报出如下错误：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AttributeError: <span class="string">'module'</span> object has no attribute <span class="string">'cross_validation'</span></span><br></pre></td></tr></table></figure>
<p>这里尝试修改为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.cross_validation <span class="keyword">import</span> train_test_split</span><br><span class="line">X, Xt, y, yt = train_test_split(X, y)</span><br></pre></td></tr></table></figure>
<p>发现不再报错，而是提示警告信息：<code>DeprecationWarning</code>: This module was deprecated in version <code>0.18</code> in favor of the <code>model_selection</code> module into which all the refactored classes and functions are moved. Also note that the interface of the new <code>CV</code> iterators are different from that of this module. This module will be removed in <code>0.20</code>。注意看提示信息，实际上是说<code>cross_validation</code>模块被弃用了，改为支持<code>model_selection</code>这个模块，因此将程序改为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">X, Xt, y, yt = train_test_split(X, y)</span><br></pre></td></tr></table></figure>
<h3 id="打印array全部元素"><a href="#打印array全部元素" class="headerlink" title="打印array全部元素"></a>打印array全部元素</h3><p>&emsp;&emsp;方法如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.set_printoptions(threshold=np.inf)</span><br></pre></td></tr></table></figure>
<h3 id="TypeError-object-of-type-zip-has-no-len"><a href="#TypeError-object-of-type-zip-has-no-len" class="headerlink" title="TypeError: object of type zip has no len()"></a>TypeError: object of type zip has no len()</h3><p>&emsp;&emsp;解决方法是：Try using <code>list(zip(...))</code> where you have <code>zip(...)</code>。</p>
<h3 id="AttributeError-module-cv2-has-no-attribute-SIFT"><a href="#AttributeError-module-cv2-has-no-attribute-SIFT" class="headerlink" title="AttributeError: module cv2 has no attribute SIFT"></a>AttributeError: module cv2 has no attribute SIFT</h3><p>&emsp;&emsp;出错的代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sift = cv2.SIFT()</span><br></pre></td></tr></table></figure>
<p>原因是<code>opencv</code>将<code>SIFT</code>等算法整合到<code>xfeatures2d</code>里面了，代码修改如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sift = cv2.xfeatures2d.SIFT_create()</span><br></pre></td></tr></table></figure>
<p>同时要注意，安装的<code>whl</code>包是<code>opencv+contrib</code>。</p>
<h3 id="Retrying-Retry-total-2-connect-None-read-None-redirect-None"><a href="#Retrying-Retry-total-2-connect-None-read-None-redirect-None" class="headerlink" title="Retrying (Retry(total=2, connect=None, read=None, redirect=None))"></a>Retrying (Retry(total=2, connect=None, read=None, redirect=None))</h3><p>&emsp;&emsp;通过<code>pip</code>安装<code>scipy</code>、<code>scikit-learn</code>等<code>python</code>库时，可能会报出上面的错误，原因是<code>pip</code>客户端长时间连接不到<code>pip</code>服务器。解决方法是需要将<code>pip</code>客户端连接到国内的服务器，以下载<code>pandas</code>为例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pandas --index https://pypi.mirrors.ustc.edu.cn/simple/</span><br></pre></td></tr></table></figure>
<p>注意，<code>--index</code>后面也可以换成别的镜像，比如<code>http://mirrors.sohu.com/python/</code>。</p>
<h3 id="Your-CPU-supports-instructions-that-this-TensorFlow…"><a href="#Your-CPU-supports-instructions-that-this-TensorFlow…" class="headerlink" title="Your CPU supports instructions that this TensorFlow…"></a>Your CPU supports instructions that this TensorFlow…</h3><p>&emsp;&emsp;解决方法是加入下面的代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.environ[<span class="string">'TF_CPP_MIN_LOG_LEVEL'</span>] = <span class="string">'2'</span></span><br></pre></td></tr></table></figure>
<h3 id="No-module-named-tkinter"><a href="#No-module-named-tkinter" class="headerlink" title="No module named _tkinter"></a>No module named _tkinter</h3><p>&emsp;&emsp;解决方法是使用如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python3-tk</span><br></pre></td></tr></table></figure>
<h3 id="pandas的read-csv报错“IOError-Initializing-from-file-failed”"><a href="#pandas的read-csv报错“IOError-Initializing-from-file-failed”" class="headerlink" title="pandas的read_csv报错“IOError: Initializing from file failed”"></a>pandas的read_csv报错“IOError: Initializing from file failed”</h3><p>&emsp;&emsp;在<code>python 3</code>中使用<code>read_csv</code>的时候，如果传入的参数不是文件名而是文件的路径，就会报这个错。解决方法是：先切换到这个目录，然后传文件名作为参数。<br>&emsp;&emsp;出错代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">​</span><br><span class="line">trainFile = <span class="string">"F:/Projects/Python/coursera/train.csv"</span></span><br><span class="line">trainData = pd.read_csv(trainFile)</span><br></pre></td></tr></table></figure>
<p>改进的代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">​</span><br><span class="line">trainFile = <span class="string">"F:/Projects/Python/coursera/train.csv"</span></span><br><span class="line">​</span><br><span class="line">pwd = os.getcwd()</span><br><span class="line">os.chdir(os.path.dirname(trainFile))</span><br><span class="line">trainData = pd.read_csv(os.path.basename(trainFile))</span><br><span class="line">os.chdir(pwd)</span><br></pre></td></tr></table></figure>
<h3 id="AttributeError-module-object-has-no-attribute-imread"><a href="#AttributeError-module-object-has-no-attribute-imread" class="headerlink" title="AttributeError: module object has no attribute imread"></a>AttributeError: module object has no attribute imread</h3><p>&emsp;&emsp;解决方法如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install --upgrade Pillow</span><br></pre></td></tr></table></figure>
<h3 id="No-module-named-apt-pkg"><a href="#No-module-named-apt-pkg" class="headerlink" title="No module named apt_pkg"></a>No module named apt_pkg</h3><p>&emsp;&emsp;解决方法如下所示：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get remove --purge python-apt</span><br><span class="line">sudo apt-get install python-apt -f</span><br><span class="line">sudo find / -name <span class="string">"apt_pkg.cpython-35m-x86_64-linux-gnu.so"</span></span><br><span class="line"><span class="built_in">cd</span> /usr/lib/python3/dist-packages/</span><br><span class="line">sudo cp apt_pkg.cpython-35m-x86_64-linux-gnu.so apt_pkg.cpython-36m-x86_64-linux-gnu.so</span><br></pre></td></tr></table></figure>
<h3 id="XXX-missing-X-required-positional-argument-self"><a href="#XXX-missing-X-required-positional-argument-self" class="headerlink" title="XXX missing X required positional argument: self"></a>XXX missing X required positional argument: self</h3><p>&emsp;&emsp;在<code>Python</code>中，类应该先实例化，然后再使用类中的成员。</p>
<h3 id="Fatal-error-in-launcher-Unable-to-create-process-using"><a href="#Fatal-error-in-launcher-Unable-to-create-process-using" class="headerlink" title="Fatal error in launcher: Unable to create process using"></a>Fatal error in launcher: Unable to create process using</h3><p>&emsp;&emsp;更新<code>pip</code>至最新版本即可解决问题：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install --upgrade pip</span><br></pre></td></tr></table></figure>
<h3 id="OSError-WinError-XXX-找不到指定的模块-Could-not-find-cudart64-90-dll"><a href="#OSError-WinError-XXX-找不到指定的模块-Could-not-find-cudart64-90-dll" class="headerlink" title="OSError: [WinError XXX] 找不到指定的模块/Could not find cudart64_90.dll"></a>OSError: [WinError XXX] 找不到指定的模块/Could not find cudart64_90.dll</h3><p>&emsp;&emsp;这是因为安装的<code>TensorFlow</code>版本和<code>CUDA</code>是不是配套的，需要重新安装配套的<code>TensorFlow</code>。</p>
<h3 id="struct-error-argument-for-XX-must-be-a-bytes-object"><a href="#struct-error-argument-for-XX-must-be-a-bytes-object" class="headerlink" title="struct.error: argument for XX must be a bytes object"></a>struct.error: argument for XX must be a bytes object</h3><p>&emsp;&emsp;格式化字符串的值在<code>Python</code>中的类型是<code>bytes</code>，所以在<code>bytes</code>类型前面加上一个<code>b</code>就可以解决这个问题：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line">​</span><br><span class="line">a = struct.pack(<span class="string">"2I3sI"</span>, <span class="number">12</span>, <span class="number">34</span>, <span class="string">b"abc"</span>, <span class="number">56</span>)</span><br><span class="line">b = struct.unpack(<span class="string">"2I3sI"</span>, a)</span><br><span class="line">print(b)  <span class="comment"># 结果为(12, 34, b'abc', 56)</span></span><br></pre></td></tr></table></figure>
<h3 id="TypeError-must-be-str-not-bytes"><a href="#TypeError-must-be-str-not-bytes" class="headerlink" title="TypeError: must be str, not bytes"></a>TypeError: must be str, not bytes</h3><p>&emsp;&emsp;写文件的代码<code>open(filename, &#39;w&#39;).write</code>应该写为<code>open(filename, &#39;wb&#39;).write</code>。</p>
<h3 id="pycocotools的安装"><a href="#pycocotools的安装" class="headerlink" title="pycocotools的安装"></a>pycocotools的安装</h3><p>&emsp;&emsp;<code>Windows</code>使用如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install git+https://github.com/philferriere/cocoapi.git<span class="comment">#subdirectory=PythonAPI</span></span><br></pre></td></tr></table></figure>
<p><code>linux</code>使用如下命令：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install <span class="string">"git+https://github.com/philferriere/cocoapi.git#egg=pycocotools&amp;subdirectory=PythonAPI"</span></span><br></pre></td></tr></table></figure>
<p>然后使用如下命令进行测试：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pycocotools.coco <span class="keyword">import</span> COCO</span><br></pre></td></tr></table></figure>
<h3 id="IndexError-list-index-out-of-range"><a href="#IndexError-list-index-out-of-range" class="headerlink" title="IndexError: list index out of range"></a>IndexError: list index out of range</h3><p>&emsp;&emsp;这个错误的出现可能有两种情况：</p>
<ul>
<li><code>list[index]</code>的<code>index</code>超出范围。</li>
<li><code>list</code>是空的，访问<code>list[0]</code>就会出现该错误。</li>
</ul>
<h3 id="libcudnn-so-6-cannot-open-shared-object-file-no-such-file-or-directory"><a href="#libcudnn-so-6-cannot-open-shared-object-file-no-such-file-or-directory" class="headerlink" title="libcudnn.so.6 cannot open shared object file no such file or directory"></a>libcudnn.so.6 cannot open shared object file no such file or directory</h3><p>&emsp;&emsp;使用如下命令即可解决：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="string">"<span class="variable">$LD_LIBRARY_PATH</span>:/usr/local/cuda/lib64"</span></span><br></pre></td></tr></table></figure>
<h3 id="Data-loss-not-an-sstable-bad-magic-number-perhaps-your-file-is-in-a-different-file"><a href="#Data-loss-not-an-sstable-bad-magic-number-perhaps-your-file-is-in-a-different-file" class="headerlink" title="Data loss: not an sstable (bad magic number): perhaps your file is in a different file"></a>Data loss: not an sstable (bad magic number): perhaps your file is in a different file</h3><p>&emsp;&emsp;旧版本的<code>TensorFlow</code>在加载模型时，<code>restore</code>使用的是模型的路径名，而新版本的<code>restore</code>采用的是模型所在的文件夹名称。</p>
<h3 id="Invalid-DISPLAY-variable"><a href="#Invalid-DISPLAY-variable" class="headerlink" title="Invalid DISPLAY variable"></a>Invalid DISPLAY variable</h3><p>&emsp;&emsp;I had the same problem and I solved it by adding <code>plt.switch_backend(&#39;agg&#39;)</code> after <code>import matplotlib.pyplot as plt</code>.</p>
<h3 id="Need-ffmpeg-exe-NeedDownloadError-Need-ffmpeg-exe"><a href="#Need-ffmpeg-exe-NeedDownloadError-Need-ffmpeg-exe" class="headerlink" title="Need ffmpeg exe, NeedDownloadError: Need ffmpeg exe"></a>Need ffmpeg exe, NeedDownloadError: Need ffmpeg exe</h3><p>&emsp;&emsp;First, pip install <code>imageio</code>, if necessary; then <code>import imageio</code> and <code>imageio.plugins.ffmpeg.download()</code>.</p>
<h3 id="from-torch-C-import-ImportError-DLL-load-failed-The-specified-module-could-not-be-found"><a href="#from-torch-C-import-ImportError-DLL-load-failed-The-specified-module-could-not-be-found" class="headerlink" title="from torch._C import * (ImportError: DLL load failed: The specified module could not be found)"></a>from torch._C import * (ImportError: DLL load failed: The specified module could not be found)</h3><p>&emsp;&emsp;I solved this problem by follow step:</p>
<ul>
<li>pip3 uninstall <code>numpy</code></li>
<li>pip3 install <code>numpy-1.14.3+mkl-cp36-cp36m-win_amd64.whl</code> (download from <code>http://www.lfd.uci.edu/~gohlke/pythonlibs</code>)</li>
</ul>
<h3 id="TypeError-slice-indices-must-be-integers-or-None-or-have-an-index-method"><a href="#TypeError-slice-indices-must-be-integers-or-None-or-have-an-index-method" class="headerlink" title="TypeError: slice indices must be integers or None or have an _index_ method"></a>TypeError: slice indices must be integers or None or have an _index_ method</h3><p>&emsp;&emsp;<code>python 3</code>除号<code>/</code>的结果是浮点型，而<code>//</code>的结果是整型，这一点和<code>python 2</code>不一样。</p>
<h3 id="float-object-cannot-be-interpreted-as-an-integer"><a href="#float-object-cannot-be-interpreted-as-an-integer" class="headerlink" title="float object cannot be interpreted as an integer"></a>float object cannot be interpreted as an integer</h3><p>解决方法同<code>TypeError: slice indices must be integers or None or have an index method</code>。</p>
<h3 id="module-object-has-no-attribute-xfeatures2d"><a href="#module-object-has-no-attribute-xfeatures2d" class="headerlink" title="module object has no attribute xfeatures2d"></a>module object has no attribute xfeatures2d</h3><p>&emsp;&emsp;使用如下命令解决：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install opencv-contrib-python</span><br></pre></td></tr></table></figure>
<h3 id="TypeError-unsupported-operand-type-s-for-map-and-int"><a href="#TypeError-unsupported-operand-type-s-for-map-and-int" class="headerlink" title="TypeError: unsupported operand type(s) for /: map and int"></a>TypeError: unsupported operand type(s) for /: map and int</h3><p>&emsp;&emsp;<code>python 2</code>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">datArr = [map(float, line) <span class="keyword">for</span> line <span class="keyword">in</span> stringArr]</span><br></pre></td></tr></table></figure>
<p>改为<code>python 3</code>版本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">datArr = [list(map(float, line)) <span class="keyword">for</span> line <span class="keyword">in</span> stringArr]</span><br></pre></td></tr></table></figure>
<h3 id="OSError-WinError-10048-通常每个套接字地址-协议-网络地址-端口-只允许使用一次"><a href="#OSError-WinError-10048-通常每个套接字地址-协议-网络地址-端口-只允许使用一次" class="headerlink" title="OSError: [WinError 10048] 通常每个套接字地址(协议/网络地址/端口)只允许使用一次"></a>OSError: [WinError 10048] 通常每个套接字地址(协议/网络地址/端口)只允许使用一次</h3><p>&emsp;&emsp;在使用<code>socket</code>模块进行服务端和客户端之间的连接时，经常出现如上错误。这是因为进程实际上还未结束，它还占用一个网络端口。解决方法是使用资源管理器将该进程<code>kill</code>。</p>
<h3 id="TypeError-str-object-is-not-callable"><a href="#TypeError-str-object-is-not-callable" class="headerlink" title="TypeError: str object is not callable"></a>TypeError: str object is not callable</h3><p>&emsp;&emsp;<code>str</code>是系统自带的函数，你不能在使用它的同时，定义一个叫做<code>str</code>的变量，这样就会冲突。</p>
<h3 id="AttributeError-module-pandas-has-no-attribute-Factor"><a href="#AttributeError-module-pandas-has-no-attribute-Factor" class="headerlink" title="AttributeError: module pandas has no attribute Factor"></a>AttributeError: module pandas has no attribute Factor</h3><p>&emsp;&emsp;In newer versions of pandas, the <code>Factor</code> is called <code>Categorical</code> instead. Change your line to:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">'species'</span>] = pd.Categorical.from_codes(iris.target, iris.target_names)</span><br></pre></td></tr></table></figure>
<h3 id="Python-h：No-such-file-or-directory"><a href="#Python-h：No-such-file-or-directory" class="headerlink" title="Python.h：No such file or directory"></a>Python.h：No such file or directory</h3><p>&emsp;&emsp;如果使用的是<code>python 3</code>，输入如下命令即可解决：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python3-dev</span><br></pre></td></tr></table></figure>
<h3 id="ImportError-No-module-named-ConfigParser"><a href="#ImportError-No-module-named-ConfigParser" class="headerlink" title="ImportError: No module named ConfigParser"></a>ImportError: No module named ConfigParser</h3><p>&emsp;&emsp;I found the problem. I had manually installed a newer version of python (version <code>3.2</code> but the version installed through packages is <code>2.7</code>) and I just redirected <code>/usr/bin/python</code> to <code>python3.2</code>. Apparently in <code>3.2</code> some syntax used in <code>/usr/bin/pyclean</code> is not valid anymore. Restoring the original link of <code>/usr/bin/python</code> to <code>/usr/bin/python2</code> solved the problem. Now the scripts could be run without any issues.</p>
<h3 id="unexpected-keyword-argument-keepdims"><a href="#unexpected-keyword-argument-keepdims" class="headerlink" title="unexpected keyword argument keepdims"></a>unexpected keyword argument keepdims</h3><p>&emsp;&emsp;I got the same error, and I found that according to the TensorFlow docs, the option has to be <code>keep_dims</code> instead of <code>keepdims</code> in the latest version, and Tensorflow <code>1.4.1</code> also.</p>
<h3 id="unexpected-keyword-argument-serialized-options"><a href="#unexpected-keyword-argument-serialized-options" class="headerlink" title="unexpected keyword argument serialized_options"></a>unexpected keyword argument serialized_options</h3><p>&emsp;&emsp;使用如下命令即可解决：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -U protobuf</span><br></pre></td></tr></table></figure>
<h3 id="关于“axis-1”"><a href="#关于“axis-1”" class="headerlink" title="关于“axis = -1”"></a>关于“axis = -1”</h3><p>&emsp;&emsp;The <code>axis = -1</code> in numpy corresponds to the last dimension:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A = np.array([[[<span class="number">1</span>, <span class="number">56</span>, <span class="number">0</span>, <span class="number">6</span>], [<span class="number">5</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">3</span>], [<span class="number">50</span>, <span class="number">51</span>, <span class="number">59</span>, <span class="number">64</span>]],</span><br><span class="line">                  [[<span class="number">2</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">3</span>], [<span class="number">10</span>, <span class="number">80</span>, <span class="number">53</span>, <span class="number">6</span>], [<span class="number">12</span>, <span class="number">5</span>, <span class="number">36</span>, <span class="number">15</span>]]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>A.shape</span><br><span class="line">(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>B = A.argmin(axis = <span class="number">-1</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>B.shape</span><br><span class="line">(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>B</span><br><span class="line">array([[<span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>],</span><br><span class="line">       [<span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>]], dtype=int64)</span><br></pre></td></tr></table></figure>
<h3 id="got-an-unexpected-keyword-argument-include-top"><a href="#got-an-unexpected-keyword-argument-include-top" class="headerlink" title="got an unexpected keyword argument include_top"></a>got an unexpected keyword argument include_top</h3><p>&emsp;&emsp;Change <code>include_top</code> to <code>require_flatten</code>, and the issue will be resolved.</p>
<h3 id="TypeError-softmax-got-an-unexpected-keyword-argument-axis"><a href="#TypeError-softmax-got-an-unexpected-keyword-argument-axis" class="headerlink" title="TypeError: softmax() got an unexpected keyword argument axis"></a>TypeError: softmax() got an unexpected keyword argument axis</h3><p>&emsp;&emsp;将<code>keras</code>的版本改为<code>2.1.3</code>即可，使用如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install keras==2.1.3</span><br></pre></td></tr></table></figure>
<p>或者修改文件<code>anaconda3/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py</code>，将<code>return tf.nn.softmax(x, axis=axis)</code>改为<code>return tf.nn.softmax(x)</code>。</p>
<h3 id="tensorboard之“ImportError-cannot-import-name-main”"><a href="#tensorboard之“ImportError-cannot-import-name-main”" class="headerlink" title="tensorboard之“ImportError: cannot import name main”"></a>tensorboard之“ImportError: cannot import name main”</h3><p>&emsp;&emsp;使用<code>tensorboard</code>的时候，可能会出现<code>ImportError: cannot import name &#39;main&#39;</code>的错误，解决方法是将<code>tensorboard</code>进行更新。</p>
<h3 id="dict-object-has-no-attribute-has-key"><a href="#dict-object-has-no-attribute-has-key" class="headerlink" title="dict object has no attribute has_key"></a>dict object has no attribute has_key</h3><p>&emsp;&emsp;将代码<code>adict.has_key(key):</code>改为<code>key in adict:</code>。</p>
<h3 id="运行Pytorch代码时报错“BrokenPipeError-Errno-32-Broken-pipe”"><a href="#运行Pytorch代码时报错“BrokenPipeError-Errno-32-Broken-pipe”" class="headerlink" title="运行Pytorch代码时报错“BrokenPipeError: [Errno 32] Broken pipe”"></a>运行Pytorch代码时报错“BrokenPipeError: [Errno 32] Broken pipe”</h3><p>&emsp;&emsp;该问题的产生是由于<code>Windows</code>下的多线程问题，和<code>DataLoader</code>类有关。解决方案是修改调用<code>torch.utils.data.DataLoader</code>函数时的<code>num_workers</code>参数，它是指在进行数据集加载时，启用的线程数目。将其修改为<code>0</code>，表示只启用一个主进程加载数据集。</p>
<h3 id="UserWarning-invalid-index-of-a-0-dim-tensor-This-will-be-an-error-in-PyTorch-0-5"><a href="#UserWarning-invalid-index-of-a-0-dim-tensor-This-will-be-an-error-in-PyTorch-0-5" class="headerlink" title="UserWarning: invalid index of a 0-dim tensor, This will be an error in PyTorch 0.5"></a>UserWarning: invalid index of a 0-dim tensor, This will be an error in PyTorch 0.5</h3><p>&emsp;&emsp;使用<code>pytorch</code>进行训练时会出现上述问题，解决方法是将<code>.data[0]</code>换成<code>.item()</code>，例如将<code>train_loss += loss.data[0]</code>变成<code>train_loss += loss.item()</code>。</p>
<h3 id="UserWarning-volatile-was-removed-and-now-has-no-effect-Use-with-torch-no-grad-instead"><a href="#UserWarning-volatile-was-removed-and-now-has-no-effect-Use-with-torch-no-grad-instead" class="headerlink" title="UserWarning: volatile was removed and now has no effect. Use with torch.no_grad() instead"></a>UserWarning: volatile was removed and now has no effect. Use with torch.no_grad() instead</h3><p>&emsp;&emsp;解决方法是去掉<code>Variable</code>函数中的<code>volatile=True</code>，例如将<code>label = Variable(label.cuda(), volatile=True)</code>变为<code>label = Variable(label.cuda())</code>。</p>
<h3 id="locale-Error-unsupported-locale-setting"><a href="#locale-Error-unsupported-locale-setting" class="headerlink" title="locale.Error: unsupported locale setting"></a>locale.Error: unsupported locale setting</h3><p>&emsp;&emsp;在使用<code>tensorboard</code>时，可能会出现上述错误，解决方法是在终端输入如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> LANGUAGE=en_US.UTF-8</span><br><span class="line"><span class="built_in">export</span> LC_ALL=en_US.UTF-8</span><br></pre></td></tr></table></figure>
<h3 id="LookupError-unknown-encoding-cp65001"><a href="#LookupError-unknown-encoding-cp65001" class="headerlink" title="LookupError: unknown encoding: cp65001"></a>LookupError: unknown encoding: cp65001</h3><p>&emsp;&emsp;在使用<code>Conda</code>时可能会碰到上述错误，解决方法是使用如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> PYTHONIOENCODING=UTF-8</span><br></pre></td></tr></table></figure>
<h3 id="UnicodeEncodeError-ascii-codec-can’t-encode-characters-in-ordinal-not-in-range-128"><a href="#UnicodeEncodeError-ascii-codec-can’t-encode-characters-in-ordinal-not-in-range-128" class="headerlink" title="UnicodeEncodeError: ascii codec can’t encode characters in ordinal not in range(128)"></a>UnicodeEncodeError: ascii codec can’t encode characters in ordinal not in range(128)</h3><p>&emsp;&emsp;解决方法是设置环境变量<code>LANG</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> LANG=<span class="string">"en_US.UTF-8"</span></span><br></pre></td></tr></table></figure>
<h3 id="Implicit-dimension-choice-for-softmax-has-been-deprecated-Change-the-call-to-include-dim-X"><a href="#Implicit-dimension-choice-for-softmax-has-been-deprecated-Change-the-call-to-include-dim-X" class="headerlink" title="Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X"></a>Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X</h3><p>&emsp;&emsp;原始代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">softmax = F.softmax(enout_att.squeeze(<span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<p>需要进行如下修改：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">softmax = F.softmax(enout_att.squeeze(<span class="number">2</span>), dim=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h3 id="避免KeyError的几种方法"><a href="#避免KeyError的几种方法" class="headerlink" title="避免KeyError的几种方法"></a>避免KeyError的几种方法</h3><p>&emsp;&emsp;在读取<code>dict</code>的<code>key</code>和<code>value</code>时，如果<code>key</code>不存在，就会触发<code>KeyError</code>错误：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">t = &#123;<span class="string">'a'</span>: <span class="string">'1'</span>, <span class="string">'b'</span>: <span class="string">'2'</span>, <span class="string">'c'</span>: <span class="string">'3'</span> &#125;</span><br><span class="line">print(t[<span class="string">'d'</span>])</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;第一种解决方法：首先测试<code>key</code>是否存在，然后才进行下一步操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">t = &#123;<span class="string">'a'</span>: <span class="string">'1'</span>, <span class="string">'b'</span>: <span class="string">'2'</span>, <span class="string">'c'</span>: <span class="string">'3'</span>&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="string">'d'</span> <span class="keyword">in</span> t:</span><br><span class="line">    print(t[<span class="string">'d'</span>])</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'not exist'</span>)  <span class="comment"># 输出“not exist”</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;第二种解决方法：利用<code>dict</code>内置的<code>get(key[, default])</code>方法，如果<code>key</code>存在，返回其<code>value</code>，否则返回<code>default</code>。使用这个方法永远不会触发<code>KeyError</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">t = &#123;<span class="string">'a'</span>: <span class="string">'1'</span>, <span class="string">'b'</span>: <span class="string">'2'</span>, <span class="string">'c'</span>: <span class="string">'3'</span>&#125;</span><br><span class="line">print(t.get(<span class="string">'d'</span>, <span class="string">'not exist'</span>))  <span class="comment"># 输出“not exist”</span></span><br><span class="line">print(t)  <span class="comment"># 输出“&#123;'a': '1', 'b': '2', 'c': '3'&#125;”</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;第三种解决方法：利用<code>dict</code>内置的<code>setdefault(key[, default])</code>方法，如果<code>key</code>存在，返回其<code>value</code>，否则插入此<code>key</code>，其<code>value</code>为<code>default</code>，并返回<code>default</code>。使用这个方法也永远不会触发<code>KeyError</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">t = &#123;<span class="string">'a'</span>: <span class="string">'1'</span>, <span class="string">'b'</span>: <span class="string">'2'</span>, <span class="string">'c'</span>: <span class="string">'3'</span>&#125;</span><br><span class="line">print(t.setdefault(<span class="string">'d'</span>))  <span class="comment"># 输出“None”</span></span><br><span class="line">print(t)  <span class="comment"># 输出“&#123;'a': '1', 'b': '2', 'c': '3', 'd': None&#125;”</span></span><br></pre></td></tr></table></figure>
<h3 id="ValueError-The-truth-value-of-an-array-with-more-than-one-element-is-ambiguous-Use-a-any-or-a-all"><a href="#ValueError-The-truth-value-of-an-array-with-more-than-one-element-is-ambiguous-Use-a-any-or-a-all" class="headerlink" title="ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()"></a>ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</h3><p>&emsp;&emsp;原来的代码如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">​</span><br><span class="line">a = np.zeros(<span class="number">3</span>)</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">a[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">a[<span class="number">2</span>] = <span class="number">2</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">if</span> a == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]:</span><br><span class="line">    print(<span class="string">"OK"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"NOT OK"</span>)</span><br></pre></td></tr></table></figure>
<p><code>Numpy</code>可以认为等号两边两个式子是数值不相等，返回<code>False</code>；也可以认为等号两边两个式子是逻辑相等，返回<code>True</code>。它觉得这是模棱两可的，因此放弃做判断。最好统一用<code>any</code>进行<code>或比较</code>，或者用<code>all</code>进行<code>与比较</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">​</span><br><span class="line">a = np.zeros(<span class="number">3</span>)</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">a[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">a[<span class="number">2</span>] = <span class="number">2</span></span><br><span class="line">print((a == [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]).any())  <span class="comment"># True</span></span><br><span class="line">print((a == [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]).all())  <span class="comment"># True</span></span><br><span class="line">print((a == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]).any())  <span class="comment"># False</span></span><br><span class="line">print((a == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]).all())  <span class="comment"># False</span></span><br><span class="line">print((a == [<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>]).any())  <span class="comment"># True</span></span><br><span class="line">print((a == [<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>]).all())  <span class="comment"># False</span></span><br></pre></td></tr></table></figure>
<h3 id="添加PYTHONPATH"><a href="#添加PYTHONPATH" class="headerlink" title="添加PYTHONPATH"></a>添加PYTHONPATH</h3><p>&emsp;&emsp;<code>Linux</code>或<code>Mac</code>系统添加<code>PYTHONPATH</code>的方法：在<code>.bashrc</code>(或<code>.bash_profile</code>)中添加如下内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PYTHONPATH=<span class="string">"待加入路径:&#123;<span class="variable">$PYTHONPATH</span>&#125;"</span></span><br></pre></td></tr></table></figure>
<p>然后使用命令<code>source .bashrc</code>。</p>
<h3 id="Default-value-of-block-norm-L1-is-deprecated-and-will-be-changed-to-L2-Hys-in-v0-15"><a href="#Default-value-of-block-norm-L1-is-deprecated-and-will-be-changed-to-L2-Hys-in-v0-15" class="headerlink" title="Default value of block_norm == L1 is deprecated and will be changed to L2-Hys in v0.15"></a>Default value of block_norm == L1 is deprecated and will be changed to L2-Hys in v0.15</h3><p>&emsp;&emsp;需要对代码进行如下修改：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hog(..., block_norm=<span class="string">'L2-Hys'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ValueError-Selected-block-normalization-method-is-invalid"><a href="#ValueError-Selected-block-normalization-method-is-invalid" class="headerlink" title="ValueError: Selected block normalization method is invalid"></a>ValueError: Selected block normalization method is invalid</h3><p>&emsp;&emsp;The definition of function hog is as follows:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hog</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    image, orientations=<span class="number">9</span>, pixels_per_cell=<span class="params">(<span class="number">8</span>, <span class="number">8</span>)</span>, cells_per_block=<span class="params">(<span class="number">3</span>, <span class="number">3</span>)</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">    block_norm=<span class="string">'L1'</span>, visualise=False, transform_sqrt=False,</span></span></span><br><span class="line"><span class="function"><span class="params">    feature_vector=True, normalise=None)</span></span></span><br></pre></td></tr></table></figure>
<p>so removing <code>normalize</code> and <code>visualise</code> will works.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/10/Python语法/文件操作/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/10/Python语法/文件操作/" itemprop="url">文件操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-10T15:12:50+08:00">
                2019-01-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h3><p>&emsp;&emsp;文件打开模式如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>打开模式</th>
<th>执行操作</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>r</code></td>
<td>以只读方式打开文件(默认)</td>
</tr>
<tr>
<td><code>w</code></td>
<td>以写入的方式打开文件，会覆盖已存在的文件</td>
</tr>
<tr>
<td><code>x</code></td>
<td>如果文件已经存在，使用此模式打开将引发异常</td>
</tr>
<tr>
<td><code>a</code></td>
<td>以写入模式打开，如果文件存在，则在末尾追加写入</td>
</tr>
<tr>
<td><code>b</code></td>
<td>以二进制模式打开文件</td>
</tr>
<tr>
<td><code>t</code></td>
<td>以文本模式打开(默认)</td>
</tr>
<tr>
<td><code>+</code></td>
<td>可读写模式(可添加到其他模式中使用)</td>
</tr>
<tr>
<td><code>U</code></td>
<td>通用换行符支持</td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;文件对象方法如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>文件对象方法</th>
<th>执行操作</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>f.close()</code></td>
<td>关闭文件</td>
</tr>
<tr>
<td><code>f.read([size=-1])</code></td>
<td>从文件中读取<code>size</code>个字符，当未给定<code>size</code>或给定负值时，读取剩余的所有字符，然后作为字符串返回</td>
</tr>
<tr>
<td><code>f.readline([size=-1])</code></td>
<td>从文件中读取并返回一行(包括行结束符)，如果<code>size</code>有定义，则返回<code>size</code>个字符</td>
</tr>
<tr>
<td><code>f.write(str)</code></td>
<td>将字符串<code>str</code>写入文件</td>
</tr>
<tr>
<td><code>f.writelines(seq)</code></td>
<td>向文件写入字符串序列<code>seq</code>，<code>seq</code>应该是一个返回字符串的可迭代对象</td>
</tr>
<tr>
<td><code>f.seek(offset, from)</code></td>
<td>在文件中移动文件指针，从<code>from</code>(<code>0</code>代表文件起始位置，<code>1</code>代表当前位置，<code>2</code>代表文件末尾)偏移<code>offset</code>个字节</td>
</tr>
<tr>
<td><code>f.tell()</code></td>
<td>返回当前文件指针在文件中的位置</td>
</tr>
<tr>
<td><code>f.truncate([size=file.tell()])</code></td>
<td>截取文件到<code>size</code>个字节，默认是截取到文件指针当前位置</td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;在<code>C</code>盘下有一个文件<code>test.txt</code>，其内容为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0123456789</span></span><br><span class="line">abcdefghij</span><br><span class="line">ABCDEFGHIJ</span><br></pre></td></tr></table></figure>
<p>在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">f = open(<span class="string">"C:\\test.txt"</span>)</span><br><span class="line">f  <span class="comment"># 结果为&lt;_io.TextIOWrapper name='C:\\test.txt' mode='r' encoding='cp936'&gt;</span></span><br><span class="line">f.read()  <span class="comment"># 结果为“0123456789\nabcdefghij\nABCDEFGHIJ\n”</span></span><br><span class="line">f.read()  <span class="comment"># 结果为“”</span></span><br><span class="line">f.close()  <span class="comment"># 关闭文件</span></span><br><span class="line"><span class="comment">#-----------------------</span></span><br><span class="line">f = open(<span class="string">"C:\\test.txt"</span>)</span><br><span class="line">f.read(<span class="number">5</span>)  <span class="comment"># 结果为“01234”</span></span><br><span class="line">f.tell()  <span class="comment"># 结果为5</span></span><br><span class="line">f.seek(<span class="number">8</span>, <span class="number">0</span>)  <span class="comment"># 结果为8</span></span><br><span class="line">f.readline()  <span class="comment"># 结果为“89\n”</span></span><br><span class="line">list(f)  <span class="comment"># 结果为['abcdefghij\n', 'ABCDEFGHIJ\n']</span></span><br><span class="line">f.seek(<span class="number">0</span>, <span class="number">0</span>)  <span class="comment"># 结果为0</span></span><br><span class="line">lines = list(f)</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> each_line <span class="keyword">in</span> lines:  <span class="comment"># 效率低的打印文本每一行文本的程序</span></span><br><span class="line">    print(each_line)</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> each_line <span class="keyword">in</span> f:  <span class="comment"># 效率高的打印文本每一行的语句</span></span><br><span class="line">    print(each_line)</span><br><span class="line">​</span><br><span class="line">f.close()</span><br><span class="line">​</span><br><span class="line">f = open(<span class="string">"C:\\test_1.txt"</span>, <span class="string">"w"</span>)  <span class="comment"># 创建并向文件中写入数据</span></span><br><span class="line">f.write(<span class="string">"I love xinzi"</span>)  <span class="comment"># 结果为12</span></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<h3 id="close"><a href="#close" class="headerlink" title="close"></a>close</h3><p>&emsp;&emsp;<code>close</code>方法用于关闭一个已打开的文件。关闭后的文件不能再进行读写操作，否则会触发<code>ValueError</code>错误。<code>close</code>方法允许调用多次。<br>&emsp;&emsp;当<code>file</code>对象被引用到操作另外一个文件时，<code>Python</code>会自动关闭之前的<code>file</code>对象。使用<code>close</code>方法关闭文件是一个好的习惯。<code>close</code>语法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fileObject.close()</span><br></pre></td></tr></table></figure>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fo = open(<span class="string">"runoob.txt"</span>, <span class="string">"wb"</span>)</span><br><span class="line">print(<span class="string">"文件名为:"</span>, fo.name)</span><br><span class="line">fo.close()</span><br></pre></td></tr></table></figure>
<h3 id="flush"><a href="#flush" class="headerlink" title="flush"></a>flush</h3><p>&emsp;&emsp;<code>flush</code>方法用来刷新缓冲区，就是将缓冲区中的数据立刻写入文件，同时清空缓冲区。一般情况下，文件关闭后会自动刷新缓冲区，但有时需要在关闭前刷新它，这时就可以使用<code>flush</code>方法。<code>flush</code>语法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fileObject.flush()</span><br></pre></td></tr></table></figure>
<p>该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fo = open(<span class="string">"runoob.txt"</span>, <span class="string">"wb"</span>)</span><br><span class="line">print(<span class="string">"文件名为:"</span>, fo.name)</span><br><span class="line">fo.flush()  <span class="comment"># 刷新缓冲区</span></span><br><span class="line">fo.close()</span><br></pre></td></tr></table></figure>
<h3 id="fileno"><a href="#fileno" class="headerlink" title="fileno"></a>fileno</h3><p>&emsp;&emsp;<code>fileno</code>方法返回一个整型的文件描述符，可用于底层操作系统的<code>I/O</code>操作。<code>fileno</code>语法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fileObject.fileno()</span><br></pre></td></tr></table></figure>
<p>实例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fo = open(<span class="string">"runoob.txt"</span>, <span class="string">"wb"</span>)</span><br><span class="line">fd = fo.fileno()</span><br><span class="line">print(<span class="string">"文件描述符为:"</span>, fd)  <span class="comment"># 输出“文件描述符为: 3”</span></span><br><span class="line">fo.close()</span><br></pre></td></tr></table></figure>
<h3 id="isatty"><a href="#isatty" class="headerlink" title="isatty"></a>isatty</h3><p>&emsp;&emsp;<code>isatty</code>方法检测文件是否连接到一个终端设备，如果是则返回<code>True</code>，否则返回<code>False</code>。<code>isatty</code>语法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fileObject.isatty()</span><br></pre></td></tr></table></figure>
<p>实例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fo = open(<span class="string">"runoob.txt"</span>, <span class="string">"wb"</span>)</span><br><span class="line">ret = fo.isatty()</span><br><span class="line">print(<span class="string">"返回值:"</span>, ret)  <span class="comment"># 输出“返回值: False”</span></span><br><span class="line">fo.close()</span><br></pre></td></tr></table></figure>
<h3 id="truncate"><a href="#truncate" class="headerlink" title="truncate"></a>truncate</h3><p>&emsp;&emsp;<code>truncate</code>方法用于从文件的首行首字符开始截断，截断文件为<code>size</code>个字符。<code>truncate</code>语法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fileObject.truncate([size])</span><br></pre></td></tr></table></figure>
<p>该方法没有返回值。假设文件<code>runoob.txt</code>的内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>:www.runoob.com</span><br><span class="line"><span class="number">2</span>:www.runoob.com</span><br></pre></td></tr></table></figure>
<p>实例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fo = open(<span class="string">"runoob.txt"</span>, <span class="string">"r+"</span>)</span><br><span class="line">fo.truncate(<span class="number">10</span>)  <span class="comment"># 截取10个字节</span></span><br><span class="line">str = fo.read()</span><br><span class="line">print(<span class="string">"读取数据: %s"</span> % str)  <span class="comment"># 输出“读取数据: 1:www.runo”</span></span><br><span class="line">fo.close()</span><br></pre></td></tr></table></figure>
<h3 id="writelines"><a href="#writelines" class="headerlink" title="writelines"></a>writelines</h3><p>&emsp;&emsp;<code>writelines</code>方法用于向文件中写入一序列的字符串，这一序列字符串可以是由迭代对象产生的，例如一个字符串列表。如果需要换行，则加上换行符<code>\n</code>。<code>writelines</code>语法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fileObject.writelines([str])</span><br></pre></td></tr></table></figure>
<p>参数<code>str</code>是要写入文件的字符串序列。该方法没有返回值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fo = open(<span class="string">"test.txt"</span>, <span class="string">"w"</span>)</span><br><span class="line">seq = [<span class="string">"first line\n"</span>, <span class="string">"second line"</span>]</span><br><span class="line">fo.writelines(seq)</span><br><span class="line">fo.close()</span><br></pre></td></tr></table></figure>
<p>执行上述代码，文件<code>test.txt</code>的内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">first line</span><br><span class="line">second line</span><br></pre></td></tr></table></figure>
<h3 id="pickle"><a href="#pickle" class="headerlink" title="pickle"></a>pickle</h3><p>&emsp;&emsp;<code>Python</code>提供了一种更简便的方法来存储列表和对象，名为<code>pickle</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">​</span><br><span class="line">my_list = [<span class="number">123</span>, <span class="number">3.14</span>, <span class="string">"小甲鱼"</span>, [<span class="string">"another list"</span>]]</span><br><span class="line">​</span><br><span class="line">pickle_file = open(<span class="string">"my_list.pkl"</span>, <span class="string">"wb"</span>)</span><br><span class="line">pickle.dump(my_list, pickle_file)  <span class="comment"># 将数据放进“pickle_file”中</span></span><br><span class="line">pickle_file.close()</span><br><span class="line">​</span><br><span class="line">pickle_file = open(<span class="string">"my_list.pkl"</span>, <span class="string">"rb"</span>)</span><br><span class="line">my_list2 = pickle.load(pickle_file)  <span class="comment"># 将数据从“pickle_file”中取出</span></span><br><span class="line">print(my_list2)</span><br></pre></td></tr></table></figure>
<h3 id="with"><a href="#with" class="headerlink" title="with"></a>with</h3><p>&emsp;&emsp;一些对象定义了标准的清理行为，一旦不需要该对象了，那么就需要执行这个标准的清理行为。示例如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> open(<span class="string">"myfile.txt"</span>):</span><br><span class="line">    print(line, end=<span class="string">""</span>)</span><br></pre></td></tr></table></figure>
<p>以上这段代码的问题是，当执行完毕后，文件会保持打开状态，并没有被关闭。关键词<code>with</code>就可以保证诸如文件之类的对象在使用完之后，一定会正确地执行它的清理方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">"myfile.txt"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">        print(line, end=<span class="string">""</span>)</span><br></pre></td></tr></table></figure>
<p>以上代码执行完毕后，文件<code>f</code>总是会关闭。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/10/opencv和图像处理/播放视频文件/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/10/opencv和图像处理/播放视频文件/" itemprop="url">播放视频文件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-10T14:09:26+08:00">
                2019-01-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/opencv和图像处理/" itemprop="url" rel="index">
                    <span itemprop="name">opencv和图像处理</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;我们知道视频是由一系列图像构成的，这些构成视频的图像称为<code>帧</code>(<code>frame</code>)。此外，在视频文件里还有个参数叫做<code>帧率</code>(<code>frame rate</code>)，用来表示两帧之间的间隔时间，帧率的单位是<code>帧/秒</code>。这个参数只和视频的播放速度有关，对于单独的一帧图像来说没有任何用途。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;highgui.h&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">void</span> )</span> </span>&#123;</span><br><span class="line">    <span class="function">VideoCapture <span class="title">capture</span> <span class="params">( <span class="string">"mm4_op.avi"</span> )</span></span>; <span class="comment">/* 打开视频文件 */</span></span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( !capture.isOpened() ) &#123; <span class="comment">/* isOpened判断视频是否打开成功 */</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"Movie open Error"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">double</span> rate = capture.get ( CV_CAP_PROP_FPS ); <span class="comment">/* 获取视频帧频 */</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"帧率为: "</span> &lt;&lt; rate &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"总帧数为: "</span> &lt;&lt; capture.get ( CV_CAP_PROP_FRAME_COUNT ) &lt;&lt; <span class="built_in">endl</span>; <span class="comment">/* 输出帧总数 */</span></span><br><span class="line">    Mat frame;</span><br><span class="line">    <span class="keyword">double</span> position = <span class="number">0.0</span>;</span><br><span class="line">    capture.<span class="built_in">set</span> ( CV_CAP_PROP_POS_FRAMES, position ); <span class="comment">/* 视频播放的位置，这里设置为第0帧 */</span></span><br><span class="line">​</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !capture.read ( frame ) ) &#123; <span class="comment">/* 读取视频帧 */</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        imshow ( <span class="string">"Movie Player"</span>, frame );</span><br><span class="line">        <span class="keyword">char</span> c = waitKey ( <span class="number">33</span> ); <span class="comment">/* 获取按键值 */</span></span><br><span class="line">​</span><br><span class="line">        <span class="keyword">if</span> ( c == <span class="number">27</span> ) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    capture.release();</span><br><span class="line">    destroyWindow ( <span class="string">"Movie Player"</span> );</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;1. 打开和读取视频流<code>VideoCapture</code><br>&emsp;&emsp;视频捕获需要的所有函数都集成在<code>VideoCapture</code>这个类里面。虽然它底层依赖另一个<code>FFmpeg</code>开源库，但是它已经被集成在<code>opencv</code>里。既然<code>VideoCapture</code>是一个类，那么在使用时候，需要先定义一个<code>VideoCapture</code>类的对象来打开和读取视频流。有两种方法，一种如上述代码所示，另一种可通过<code>open</code>函数来完成：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">VideoCapture capture;</span><br><span class="line">capture.open ( <span class="string">"mm4_op.avi"</span> );</span><br></pre></td></tr></table></figure>
<p>从<code>OpenCV</code>源码中可以查看<code>VideoCapture</code>的定义，在它的构造函数中，如果使用整型数当参数的话，就可以将这个对象绑定到一个摄像机，将系统指派的<code>ID</code>号当作参数传入即可。例如可以传入<code>0</code>来打开第一个摄像机，传入<code>1</code>打开第二个摄像机，以此类推。如果使用字符串当做参数，就会打开由这个字符串(文件名)指定的视频文件。<br>&emsp;&emsp;2. 是否成功打开视频<code>isOpened</code>、视频关闭<code>release</code>以及视频解码<code>read</code><br>&emsp;&emsp;<code>isOpened</code>的函数原型如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bool VideoCapture::isOpened();</span><br></pre></td></tr></table></figure>
<p>当析构函数调用时，会自动关闭视频。如果希望提前关闭的话，可以调用<code>release</code>函数，例如<code>capture.release</code>。视频的每一帧都是一幅普通的图像，因此仅仅需要从<code>VideoCapture</code>对象里释放出每一帧图像，并保存成<code>Mat</code>格式。<br>&emsp;&emsp;<code>read</code>的函数原型如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> VideoCapture::read ( Mat &amp;image );</span><br></pre></td></tr></table></figure>
<p>读取视频帧的时候也会自动进行解码操作，其实这个方法包含了<code>VideoCapture::grab</code>和<code>VideoCapture::retrieve</code>两个操作。<code>read</code>方法很方便，当获取不到视频帧时，就返回<code>false</code>。<br>&emsp;&emsp;3. 获取视频属性<code>get</code>和设置属性<code>set</code><br>&emsp;&emsp;<code>get</code>函数返回特定的视频属性：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> VideoCapture::get ( <span class="keyword">int</span> propId );</span><br></pre></td></tr></table></figure>
<p><code>get</code>函数返回一个<code>double</code>(<code>8</code>个字节)类型的数据来表示这些属性。然后你可以使用位操作符来操作这个返回值，从而得到想要的整型数据。这个函数有一个参数<code>propId</code>，代表着试图查询的属性<code>ID</code>。参数的值可以有很多种，这里只用到了两种，分别是<code>CV_CAP_PROP_FPS</code>和<code>CV_CAP_PROP_FRAME_COUNT</code>，它们分别表示要返回的值为帧速率和视频文件的总帧数。还有其他的数值可以查看<code>highgui_c.h</code>。当需要设置这些值的时候，可以调用<code>set</code>函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> VideoCapture::<span class="built_in">set</span> ( <span class="keyword">int</span> propId, <span class="keyword">double</span> value );</span><br></pre></td></tr></table></figure>
<p>函数的第一个参数是需要设置的属性<code>ID</code>，第二个参数是需要设定的值，如果返回<code>true</code>，就表示成功设定，否则就是<code>false</code>。代码使用<code>set</code>函数设置了视频播放的位置，其实不用设置也可以，<code>opencv</code>会默认从开始<code>0</code>位置开始执行。<br>&emsp;&emsp;再看下面的代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> c = waitKey ( <span class="number">33</span> );</span><br><span class="line">​</span><br><span class="line"><span class="keyword">if</span> ( c == <span class="number">27</span> ) &#123;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是当帧被显示后，系统会等待<code>33</code>毫秒，如果用户这时候触发了一个按键，<code>c</code>就会被设置成这个按键的<code>ASCII</code>码，否则<code>c</code>会被设置成<code>-1</code>；如果触发了<code>ESC</code>键(<code>ASCII</code>码为<code>27</code>)，则退出循环。<br>&emsp;&emsp;下面讲解如何在<code>OpenCV</code>中用<code>createTrackbar</code>函数创建和使用轨迹条，以视频进度的调整。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;highgui.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/imgproc/imgproc.hpp&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">onTrackbarSlide</span> <span class="params">( <span class="keyword">int</span> pos, <span class="keyword">void</span> *capture )</span> </span>&#123; <span class="comment">/* 进度条控制 */</span></span><br><span class="line">    ( * ( ( VideoCapture * ) capture ) ).<span class="built_in">set</span> ( CV_CAP_PROP_POS_FRAMES, pos );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">void</span> )</span> </span>&#123;</span><br><span class="line">    <span class="function">VideoCapture <span class="title">capture</span> <span class="params">( <span class="string">"mm4_op.avi"</span> )</span></span>; <span class="comment">/* 打开视频文件 */</span></span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( !capture.isOpened() ) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"Movie open Error"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">double</span> rate = capture.get ( CV_CAP_PROP_FPS ); <span class="comment">/* 获取视频帧频 */</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"帧率为:"</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; rate &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">int</span> total_rate = capture.get ( CV_CAP_PROP_FRAME_COUNT ); <span class="comment">/* 获取总帧数 */</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"总帧数为:"</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; total_rate &lt;&lt; <span class="built_in">endl</span>; <span class="comment">/* 输出帧总数 */</span></span><br><span class="line">    Mat frame;</span><br><span class="line">    namedWindow ( <span class="string">"Movie Player"</span> );</span><br><span class="line">    <span class="keyword">int</span> slider_position = <span class="number">0</span>;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( total_rate != <span class="number">0</span> ) &#123; <span class="comment">/* 创建进度条 */</span></span><br><span class="line">        createTrackbar (</span><br><span class="line">            <span class="string">"position"</span>, <span class="string">"Movie Player"</span>, &amp;slider_position,</span><br><span class="line">            total_rate, onTrackbarSlide, &amp;capture );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !capture.read ( frame ) ) &#123; <span class="comment">/* 读取视频帧 */</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        imshow ( <span class="string">"Movie Player"</span>, frame );</span><br><span class="line">        <span class="keyword">char</span> c = waitKey ( <span class="number">33</span> ); <span class="comment">/* 获取按键值 */</span></span><br><span class="line">​</span><br><span class="line">        <span class="keyword">if</span> ( c == <span class="number">27</span> ) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    capture.release();</span><br><span class="line">    destroyWindow ( <span class="string">"Movie Player"</span> );</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>新界面比原来的增加了一个进度条，通过进度条可以调节播放的的进度。先看看<code>createTrackbar</code>函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">createTrackbar</span> <span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> <span class="built_in">string</span> &amp;trackbarname, <span class="keyword">const</span> <span class="built_in">string</span> &amp;winname, <span class="keyword">int</span> *value,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">int</span> count, TrackbarCallback onChange = <span class="number">0</span>, <span class="keyword">void</span> *userdata = <span class="number">0</span> )</span></span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>trackbarname</code>：进度条的名字，用来代表创建的轨迹条。</li>
<li><code>winname</code>：窗口的名字，表示这个进度条会依附到哪个窗口上，即对应<code>namedWindow</code>创建窗口时填的那个窗口名，滑动条不会遮挡图像。</li>
<li><code>value</code>：滑块的位置，在创建时滑块的初始位置就是该变量当前的值，当滑动条被拖动时，<code>OpenCV</code>会自动将进度条当前位置所代表的值传给指针指向的整数。</li>
<li><code>count</code>：滑块可以达到的最大位置的值，注意滑块最小的位置的值始终为<code>0</code>。</li>
<li><code>onChange</code>是一个指向回调函数的指针，每次滑块位置改变时，这个函数都会进行回调，并且这个函数的原型必须为<code>void XXXX(int, void*);</code>，其中第一个参数是轨迹条的位置，第二个参数是用户数据(看下面的参数)，如果回调是<code>NULL</code>指针，表示没有回调函数的调用，仅第三个参数<code>value</code>有变化。</li>
<li><code>userdata</code>是用户传给回调函数的数据，用来处理进度条事件，上述代码就是使用该参数传递一个<code>VideoCapture</code>变量，以至于进度条能控制视频帧。</li>
</ul>
<p>&emsp;&emsp;<code>createTrackbar</code>函数为我们创建一个具有特定名称和范围的进度条，并且指定一个和进度条位置同步的变量，而且要指定回调函数<code>onChange</code>，在轨迹条位置改变的时候来调用这个回调函数。可能有些朋友看完上述解释还是有点模糊，还是搞不懂进度条怎么和视频联系到一块呢？首先是进度条通过窗口的名字(第二个参数)绑定到了指定的窗口上，再通过一个整形变量(第三个参数)记录进度条所滑动到达的位置。当进度条滑动时候，会触发回调函数(第五个参数)，而第六个参数是正是回调函数的一个参数。回调函数<code>onTrackbarSlide(int pos,void* capture)</code>的作用就是当进度条被触发时候，设置读取视频帧的位置。<br>&emsp;&emsp;但是当移动进度条时，该进度条总是定位不准，比如想滑动进度条到<code>500</code>帧，结果很难滑到该帧处的，会出现跳跃的现象。我用的是<code>opencv 2.0</code>版本，同样的代码在<code>opencv 1.0</code>里完全没错，可是这是为什么？原因在于<code>opencv 2.0</code>以后采用<code>ffmpeg</code>采集视频，而<code>opencv 1.0</code>采用<code>vfw</code>采集视频。当<code>opencv</code>在定位时，调用了<code>ffmpeg</code>的<code>av_seek_frame</code>函数：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">av_seek_frame</span> <span class="params">( AVFormatContext *s, <span class="keyword">int</span> stream_index, <span class="keyword">int64_t</span> timestamp, <span class="keyword">int</span> flags )</span></span>;</span><br></pre></td></tr></table></figure>
<p>参数<code>flags</code>有如下选项：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AVSEEK_FLAG_BACKWARD = <span class="number">1</span>;</span><br><span class="line">AVSEEK_FLAG_BYTE = <span class="number">2</span>;</span><br><span class="line">AVSEEK_FLAG_ANY = <span class="number">4</span>;</span><br></pre></td></tr></table></figure>
<p><code>ffmpeg</code>默认的是选取关键帧(这个概念需要具体定义)，<code>opencv</code>里面这个函数的参数<code>flags</code>是<code>0</code>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> ret = av_seek_frame ( ic, video_stream, timestamp, <span class="number">0</span> );</span><br></pre></td></tr></table></figure>
<p>也就是按照默认的读取关键帧，因此视频跳跃就出现了。解决这个问题方法是将<code>0</code>改为<code>AVSEEK_FLAG_ANY</code>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> ret = av_seek_frame ( ic, video_stream, timestamp, AVSEEK_FLAG_ANY );</span><br></pre></td></tr></table></figure>
<p>之后重新编译<code>opencv</code>库，就可以了。<br>&emsp;&emsp;还有几个函数也是经常用到的，例如获取当前进度条的位置<code>getTrackbarPos</code>函数，以及设置当前进度条的位置<code>setTrackbarPos</code>函数等，这些函数都定义在<code>opencv2/highgui/highgui.hpp</code>文件中。</p>
<hr>
<p>&emsp;&emsp;<code>python</code>播放视频代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line">​</span><br><span class="line">cap = cv2.VideoCapture(<span class="string">'mm4_op.avi'</span>)</span><br><span class="line">​</span><br><span class="line"><span class="keyword">while</span> (cap.isOpened()):</span><br><span class="line">    ret, frame = cap.read()</span><br><span class="line">    cv2.imshow(<span class="string">'frame'</span>, frame)</span><br><span class="line">    <span class="keyword">if</span> cv2.waitKey(<span class="number">1</span>) &amp; <span class="number">0xFF</span> == ord(<span class="string">'q'</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">​</span><br><span class="line">cap.release()</span><br><span class="line">cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure>
<p><code>cap.read</code>函数返回一个二元组，元组的第一个值是<code>ret</code>，表明是否成功从缓冲中读取了<code>frame</code>；元组的第二个值<code>frame</code>就是视频本身。</p>
<hr>
<h3 id="滑动条的使用"><a href="#滑动条的使用" class="headerlink" title="滑动条的使用"></a>滑动条的使用</h3><p>&emsp;&emsp;首先需要创建一个滑动条，例如<code>cv2.createTrackbar(&#39;R&#39;, &#39;image&#39;, 0, 255, call_back)</code>，其中参数<code>R</code>是滑动条的名称，<code>image</code>是所在窗口的名称，<code>0</code>是当前的值，<code>255</code>是最大值，<code>call_back</code>是回调函数名称，回调函数默认有一个表示当前值的参数。<br>&emsp;&emsp;创建好之后，可以在回调函数中获取滑动条的值，也可以用<code>cv2.getTrackbarPos</code>得到，其中<code>参数一</code>是滑动条的名称，<code>参数二</code>是窗口的名称。下面实现一个<code>RGB</code>的调色板：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nothing</span><span class="params">(x)</span>:</span>  <span class="comment"># 回调函数，“x”表示滑块的位置，本例暂不使用</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">​</span><br><span class="line">img = np.zeros((<span class="number">300</span>, <span class="number">512</span>, <span class="number">3</span>), np.uint8)</span><br><span class="line">cv2.namedWindow(<span class="string">'image'</span>)</span><br><span class="line">​</span><br><span class="line"><span class="comment"># 创建RGB三个滑动条</span></span><br><span class="line">cv2.createTrackbar(<span class="string">'R'</span>, <span class="string">'image'</span>, <span class="number">0</span>, <span class="number">255</span>, nothing)</span><br><span class="line">cv2.createTrackbar(<span class="string">'G'</span>, <span class="string">'image'</span>, <span class="number">0</span>, <span class="number">255</span>, nothing)</span><br><span class="line">cv2.createTrackbar(<span class="string">'B'</span>, <span class="string">'image'</span>, <span class="number">0</span>, <span class="number">255</span>, nothing)</span><br><span class="line">​</span><br><span class="line"><span class="keyword">while</span> (<span class="keyword">True</span>):</span><br><span class="line">    cv2.imshow(<span class="string">'image'</span>, img)</span><br><span class="line">    <span class="keyword">if</span> cv2.waitKey(<span class="number">1</span>) == <span class="number">27</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># 获取滑块的值</span></span><br><span class="line">    r = cv2.getTrackbarPos(<span class="string">'R'</span>, <span class="string">'image'</span>)</span><br><span class="line">    g = cv2.getTrackbarPos(<span class="string">'G'</span>, <span class="string">'image'</span>)</span><br><span class="line">    b = cv2.getTrackbarPos(<span class="string">'B'</span>, <span class="string">'image'</span>)</span><br><span class="line">    img[:] = [b, g, r]  <span class="comment"># 设定img的颜色</span></span><br></pre></td></tr></table></figure>
<p><img src="/2019/01/10/opencv和图像处理/播放视频文件/1.png" height="278" width="385"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/10/Python语法/列表/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/10/Python语法/列表/" itemprop="url">列表</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-10T12:48:07+08:00">
                2019-01-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>Python</code>的列表比<code>C</code>语言的数组更加强大。</p>
<h3 id="创建列表"><a href="#创建列表" class="headerlink" title="创建列表"></a>创建列表</h3><p>&emsp;&emsp;创建<code>普通列表</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">member = [<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>]</span><br></pre></td></tr></table></figure>
<p>创建<code>混合列表</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mix = [<span class="number">1</span>, <span class="string">'hello'</span>, <span class="number">3.14</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]]</span><br></pre></td></tr></table></figure>
<p>创建<code>空列表</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">empty = []</span><br></pre></td></tr></table></figure>
<p>创建<code>嵌套列表</code>：嵌套列表是在列表里创建其它列表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line">n = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">x = [a, n]</span><br><span class="line">x  <span class="comment"># 结果为[['a', 'b', 'c'], [1, 2, 3]]</span></span><br><span class="line">x[<span class="number">0</span>]  <span class="comment"># 结果为['a', 'b', 'c']</span></span><br><span class="line">x[<span class="number">0</span>][<span class="number">1</span>]  <span class="comment"># 结果为“b”</span></span><br></pre></td></tr></table></figure>
<h3 id="添加元素"><a href="#添加元素" class="headerlink" title="添加元素"></a>添加元素</h3><p>&emsp;&emsp;向列表添加元素，使用<code>append</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">member.append(<span class="string">'five'</span>)  <span class="comment"># 结果为['one', 'two', 'three', 'four', 'five']</span></span><br></pre></td></tr></table></figure>
<p><code>append</code>是对象<code>member</code>的一个方法，它不能同时添加两个元素到列表中，例如<code>member.append(&#39;six&#39;, &#39;seven&#39;)</code>。如果想同时添加两个元素到列表中，需要用到<code>extend</code>方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 结果为['one', 'two', 'three', 'four', 'five', 'six', 'seven']</span></span><br><span class="line">member.extend([<span class="string">'six'</span>, <span class="string">'seven'</span>])</span><br></pre></td></tr></table></figure>
<p><code>append</code>和<code>extend</code>都是默认把元素添加到列表的末尾。要想把元素插到列表的指定位置，需要<code>insert</code>方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把“zero”插到列表的第0位，结果为['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven']</span></span><br><span class="line">member.insert(<span class="number">0</span>, <span class="string">'zero'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="获取元素"><a href="#获取元素" class="headerlink" title="获取元素"></a>获取元素</h3><p>&emsp;&emsp;和数组一样，我们可以通过元素的索引值(<code>index</code>)从列表获取单个元素，注意列表索引值是从`0开始的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">member[<span class="number">0</span>]  <span class="comment"># 结果为“zero”</span></span><br><span class="line">member[<span class="number">1</span>]  <span class="comment"># 结果为“one”</span></span><br><span class="line"><span class="comment"># 数组元素交换</span></span><br><span class="line">temp = member[<span class="number">0</span>]</span><br><span class="line">member[<span class="number">0</span>] = member[<span class="number">1</span>]</span><br><span class="line">member[<span class="number">1</span>] = temp</span><br><span class="line">member  <span class="comment"># 结果为['one', 'zero', 'two', 'three', 'four', 'five', 'six', 'seven']</span></span><br></pre></td></tr></table></figure>
<h3 id="删除元素"><a href="#删除元素" class="headerlink" title="删除元素"></a>删除元素</h3><p>&emsp;&emsp;从列表中删除元素，使用<code>remove</code>方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">member.remove(<span class="string">'zero'</span>)  <span class="comment"># 结果为['one', 'two', 'three', 'four', 'five', 'six', 'seven']</span></span><br></pre></td></tr></table></figure>
<p>或者使用<code>del</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> member[<span class="number">0</span>]  <span class="comment"># 删除列表的第0个元素</span></span><br><span class="line"><span class="keyword">del</span> member[<span class="number">1</span>]  <span class="comment"># 删除列表的第1个元素</span></span><br><span class="line"><span class="keyword">del</span> member  <span class="comment"># 删除整个列表</span></span><br></pre></td></tr></table></figure>
<p>或者使用<code>pop</code>，该方法可以从列表尾弹出一个元素：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">member = [<span class="string">'zero'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>, <span class="string">'five'</span>, <span class="string">'six'</span>, <span class="string">'seven'</span>]</span><br><span class="line">member.pop()  <span class="comment"># 把“seven”从列表中弹出</span></span><br><span class="line">name = member.pop()  <span class="comment"># 把“six”从列表中弹出，并赋值给name</span></span><br><span class="line">member.pop(<span class="number">1</span>)  <span class="comment"># 把member列表中第1个元素即“one”从列表中弹出</span></span><br><span class="line">member  <span class="comment"># 结果为['zero', 'two', 'three', 'four', 'five']</span></span><br></pre></td></tr></table></figure>
<h3 id="列表分片"><a href="#列表分片" class="headerlink" title="列表分片"></a>列表分片</h3><p>&emsp;&emsp;如果一次性需要从列表中获取多个元素，可以利用列表分片：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">member  <span class="comment"># 结果为['zero', 'two', 'three', 'four', 'five']</span></span><br><span class="line">member[<span class="number">1</span>:<span class="number">3</span>]  <span class="comment"># 结果为['two', 'three']</span></span><br><span class="line">member[:<span class="number">3</span>]  <span class="comment"># 结果为['zero', 'two', 'three']</span></span><br><span class="line">member[<span class="number">1</span>:]  <span class="comment"># 结果为['two', 'three', 'four', 'five']</span></span><br><span class="line">member[:]  <span class="comment"># 结果为['zero', 'two', 'three', 'four', 'five']</span></span><br><span class="line">member2 = member[:]</span><br><span class="line">member2  <span class="comment"># 结果为['zero', 'two', 'three', 'four', 'five']</span></span><br></pre></td></tr></table></figure>
<p>注意，<code>list[1:3]</code>其实只输出两个变量，即<code>list</code>中第二个元素到第三个元素，并不是第<code>1</code>、第<code>2</code>和第<code>3</code>三个元素。</p>
<h3 id="列表操作符"><a href="#列表操作符" class="headerlink" title="列表操作符"></a>列表操作符</h3><p>&emsp;&emsp;列表的一些常用操作符：比较操作符、逻辑操作符、连接操作符、重复操作符、成员关系操作符。具体应用如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">list1 = [<span class="number">123</span>]</span><br><span class="line">list2 = [<span class="number">234</span>]</span><br><span class="line">list1 &gt; list2  <span class="comment"># 结果为False</span></span><br><span class="line">list1 = [<span class="number">123</span>, <span class="number">456</span>]</span><br><span class="line">list2 = [<span class="number">234</span>, <span class="number">123</span>]</span><br><span class="line">list1 &gt; list2  <span class="comment"># 结果为False。我们发现，比较是从第0个元素开始的</span></span><br><span class="line">list3 = [<span class="number">123</span>, <span class="number">456</span>]</span><br><span class="line">(list1 &lt; list2) <span class="keyword">and</span> (list1 == list3)  <span class="comment"># 结果为True</span></span><br><span class="line">list4 = list1 + list2</span><br><span class="line">list4  <span class="comment"># 结果为[123, 456, 234, 123]</span></span><br><span class="line">list1 + <span class="string">'hello'</span>  <span class="comment"># 结果为“出错”</span></span><br><span class="line">list3  <span class="comment"># 结果为[123, 456]</span></span><br><span class="line">list3 * <span class="number">3</span>  <span class="comment"># 结果为[123, 456, 123, 456, 123, 456]，list3并未改变</span></span><br><span class="line">list3 *= <span class="number">3</span></span><br><span class="line">list3  <span class="comment"># 结果为[123, 456, 123, 456, 123, 456]，list3被改变</span></span><br></pre></td></tr></table></figure>
<p>注意，向列表中添加元素不推荐使用<code>+</code>号！<br>&emsp;&emsp;成员关系操作符的应用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">list3  <span class="comment"># 结果为[123, 456, 123, 456, 123, 456]</span></span><br><span class="line"><span class="number">123</span> <span class="keyword">in</span> list3  <span class="comment"># 结果为True</span></span><br><span class="line"><span class="string">"hello"</span> <span class="keyword">in</span> list3  <span class="comment"># 结果为False</span></span><br><span class="line"><span class="number">123</span> <span class="keyword">not</span> <span class="keyword">in</span> list3  <span class="comment"># 结果为False</span></span><br><span class="line">list5 = [<span class="number">123</span>, [<span class="string">"one"</span>, <span class="string">"two"</span>], <span class="number">456</span>]</span><br><span class="line"><span class="string">"one"</span> <span class="keyword">in</span> list5  <span class="comment"># 结果为False</span></span><br><span class="line"><span class="string">"one"</span> <span class="keyword">in</span> list5[<span class="number">1</span>]  <span class="comment"># 结果为True</span></span><br><span class="line">list5[<span class="number">1</span>][<span class="number">1</span>]  <span class="comment"># 结果为“two”，列表中的列表可以与C语言的二维数组联系起来</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;在终端输入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">list3  <span class="comment"># 得到[123, 456, 123, 456, 123, 456]</span></span><br><span class="line">list3.count(<span class="number">123</span>)  <span class="comment"># 得到3，作用为找出123在列表中的数目</span></span><br><span class="line">list3.index(<span class="number">123</span>)  <span class="comment"># 得到0，作用为找到123在列表中的第1个索引</span></span><br><span class="line">list3.index(<span class="number">123</span>, <span class="number">3</span>, <span class="number">7</span>)  <span class="comment"># 得到4，作用为找到123在列表中范围是4到7的索引</span></span><br><span class="line">list3.reverse()  <span class="comment"># 列表反序，结果为[456, 123, 456, 123, 456, 123]</span></span><br><span class="line">list4 = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>]</span><br><span class="line">list4.sort()  <span class="comment"># 对列表按默认的顺序(从小到大)进行排序</span></span><br><span class="line">list4  <span class="comment"># 得到[0, 1, 3, 4, 5, 7, 8, 9]</span></span><br><span class="line">list4.sort(reverse=<span class="keyword">True</span>)  <span class="comment"># 对列表按反序进行排序</span></span><br><span class="line">list4  <span class="comment"># 结果为[9, 8, 7, 5, 4, 3, 1, 0]</span></span><br><span class="line"><span class="comment"># ------------------------------</span></span><br><span class="line">list4 = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>]</span><br><span class="line">list4  <span class="comment"># 得到[4, 5, 7, 1, 3, 8, 9, 0]</span></span><br><span class="line">list5 = list4[:]</span><br><span class="line">list5.sort()  <span class="comment"># 对list5正向排序</span></span><br><span class="line">list5  <span class="comment"># 得到[0, 1, 3, 4, 5, 7, 8, 9]</span></span><br><span class="line">list6 = list4</span><br><span class="line">list6  <span class="comment"># 得到[4, 5, 7, 1, 3, 8, 9, 0]</span></span><br><span class="line">list4.sort(reverse=<span class="keyword">True</span>)  <span class="comment"># 对list4反序排序</span></span><br><span class="line">list4  <span class="comment"># 得到[9, 8, 7, 5, 4, 3, 1, 0]</span></span><br><span class="line">list6  <span class="comment"># 得到[9, 8, 7, 5, 4, 3, 1, 0]</span></span><br></pre></td></tr></table></figure>
<p><code>list5</code>是对<code>list4</code>的复制；<code>list6</code>是指向<code>list4</code>，与<code>list4</code>共享数据。<br>&emsp;&emsp;如果列表中的元素是元祖，则排序可以使用<code>key</code>关键字：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = [(<span class="string">'b'</span>, <span class="number">2</span>), (<span class="string">'a'</span>, <span class="number">1</span>), (<span class="string">'c'</span>, <span class="number">0</span>)]</span><br><span class="line">b = sorted(a, key=<span class="keyword">lambda</span> a_tuple: a_tuple[<span class="number">0</span>])</span><br><span class="line">c = sorted(a, key=<span class="keyword">lambda</span> a_tuple: a_tuple[<span class="number">1</span>])</span><br><span class="line">print(b)  <span class="comment"># 结果为[('a', 1), ('b', 2), ('c', 0)]</span></span><br><span class="line">print(c)  <span class="comment"># 结果为[('c', 0), ('a', 1), ('b', 2)]</span></span><br></pre></td></tr></table></figure>
<h3 id="Python列表函数和方法"><a href="#Python列表函数和方法" class="headerlink" title="Python列表函数和方法"></a>Python列表函数和方法</h3><p>&emsp;&emsp;针对列表，可以使用如下<code>Python</code>内置函数进行处理：</p>
<ul>
<li><code>len(list)</code>：列表元素个数。</li>
<li><code>max(list)</code>：返回列表元素最大值。</li>
<li><code>min(list)</code>：返回列表元素最小值。</li>
<li><code>list(seq)</code>：将元组转换为列表。</li>
</ul>
<p><code>list</code>包含以下方法：</p>
<ul>
<li><code>list.append(obj)</code>：在列表末尾添加新的对象。</li>
<li><code>list.count(obj)</code>：统计某个元素在列表中出现的次数。</li>
<li><code>list.extend(seq)</code>：在列表末尾一次性追加另一个序列中的多个值(用新列表扩展原来的列表)。</li>
<li><code>list.index(obj)</code>：从列表中找出某个值第一个匹配项的索引位置。</li>
<li><code>list.insert(index, obj)</code>：将对象插入列表。</li>
<li><code>list.pop(obj=list[-1])</code>：移除列表中的一个元素(默认最后一个元素)，并且返回该元素的值。</li>
<li><code>list.remove(obj)</code>：移除列表中某个值的第一个匹配项。</li>
<li><code>list.reverse()</code>：反转列表中元素。</li>
<li><code>list.sort([func])</code>：对原列表进行排序。</li>
<li><code>list.clear()</code>：清空列表。</li>
<li><code>list.copy()</code>：复制列表。</li>
</ul>
<h3 id="列表推导式"><a href="#列表推导式" class="headerlink" title="列表推导式"></a>列表推导式</h3><p>&emsp;&emsp;列表推导式提供了从序列创建列表的简单途径。通常应用程序将一些操作应用于某个序列的每个元素，用其获得的结果作为生成新列表的元素，或者根据确定的判定条件创建子序列。<br>&emsp;&emsp;每个列表推导式都在<code>for</code>之后跟一个表达式，然后有零至多个<code>for</code>或<code>if</code>子句。返回结果是一个根据表达从其后的<code>for</code>和<code>if</code>上下文环境中生成出来的列表。如果希望表达式推导出一个元组，就必须使用括号。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vec = [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line">[<span class="number">3</span> * x <span class="keyword">for</span> x <span class="keyword">in</span> vec]  <span class="comment"># 结果为[6, 12, 18]</span></span><br><span class="line">[[x, x ** <span class="number">2</span>] <span class="keyword">for</span> x <span class="keyword">in</span> vec]  <span class="comment"># 结果为[[2, 4], [4, 16], [6, 36]]</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;下列是对序列里每一个元素逐个调用某种方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">freshfruit = [<span class="string">'  banana'</span>, <span class="string">'  loganberry '</span>, <span class="string">'passion fruit  '</span>]</span><br><span class="line"><span class="comment"># 结果为['banana', 'loganberry', 'passion fruit']</span></span><br><span class="line">[weapon.strip() <span class="keyword">for</span> weapon <span class="keyword">in</span> freshfruit]</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;可以用<code>if</code>子句作为过滤器：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">3</span> * x <span class="keyword">for</span> x <span class="keyword">in</span> vec <span class="keyword">if</span> x &gt; <span class="number">3</span>]  <span class="comment"># 结果为[12, 18]</span></span><br><span class="line">[<span class="number">3</span> * x <span class="keyword">for</span> x <span class="keyword">in</span> vec <span class="keyword">if</span> x &lt; <span class="number">2</span>]  <span class="comment"># 结果为[]</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;以下是一些关于循环和其它技巧的演示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vec1 = [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line">vec2 = [<span class="number">4</span>, <span class="number">3</span>, <span class="number">-9</span>]</span><br><span class="line">[x * y <span class="keyword">for</span> x <span class="keyword">in</span> vec1 <span class="keyword">for</span> y <span class="keyword">in</span> vec2]  <span class="comment"># 结果为[8, 6, -18, 16, 12, -36, 24, 18, -54]</span></span><br><span class="line">[x + y <span class="keyword">for</span> x <span class="keyword">in</span> vec1 <span class="keyword">for</span> y <span class="keyword">in</span> vec2]  <span class="comment"># 结果为[6, 5, -7, 8, 7, -5, 10, 9, -3]</span></span><br><span class="line">[vec1[i] * vec2[i] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(vec1))]  <span class="comment"># 结果为[8, 12, -54]</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;列表推导式可以使用复杂表达式或嵌套函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 结果为['3.1', '3.14', '3.142', '3.1416', '3.14159']</span></span><br><span class="line">[str(round(<span class="number">355</span> / <span class="number">113</span>, i)) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">6</span>)]</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;列表推导式的执行顺序：各语句之间是嵌套关系，左边第二个语句是最外层，依次往右进一层，左边第一条语句是最后一层。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[x * y <span class="keyword">for</span> x <span class="keyword">in</span> range[<span class="number">1</span>, <span class="number">5</span>] <span class="keyword">if</span> x &gt; <span class="number">2</span> <span class="keyword">for</span> y <span class="keyword">in</span> range[<span class="number">1</span>, <span class="number">4</span>] <span class="keyword">if</span> x &lt; <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<p>它的执行顺序如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range[<span class="number">1</span>, <span class="number">5</span>]:</span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> range[<span class="number">1</span>, <span class="number">4</span>]:</span><br><span class="line">            <span class="keyword">if</span> x &lt; <span class="number">3</span>:</span><br><span class="line">                x * y</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="嵌套列表解析"><a href="#嵌套列表解析" class="headerlink" title="嵌套列表解析"></a>嵌套列表解析</h3><p>&emsp;&emsp;以下实例展示了<code>3 * 4</code>的矩阵列表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">matrix = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>],</span><br><span class="line">    [<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>],</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>以下实例将<code>3 * 4</code>的矩阵列表转换为<code>4 * 3</code>列表：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 结果为[[1, 5, 9], [2, 6, 10], [3, 7, 11], [4, 8, 12]]</span></span><br><span class="line">[[row[i] <span class="keyword">for</span> row <span class="keyword">in</span> matrix] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>)]</span><br></pre></td></tr></table></figure>
<p>也可以使用以下方法来实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">transposed = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    transposed.append([row[i] <span class="keyword">for</span> row <span class="keyword">in</span> matrix])</span><br><span class="line"></span><br><span class="line">transposed  <span class="comment"># 结果为[[1, 5, 9], [2, 6, 10], [3, 7, 11], [4, 8, 12]]</span></span><br></pre></td></tr></table></figure>
<p>另外一种实现方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">transposed = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    <span class="comment"># the following 3 lines implement the nested listcomp</span></span><br><span class="line">    transposed_row = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> matrix:</span><br><span class="line">        transposed_row.append(row[i])</span><br><span class="line">    transposed.append(transposed_row)</span><br><span class="line">​</span><br><span class="line">transposed  <span class="comment"># 结果为[[1, 5, 9], [2, 6, 10], [3, 7, 11], [4, 8, 12]]</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/58/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/58/">58</a><span class="page-number current">59</span><a class="page-number" href="/page/60/">60</a><span class="space">&hellip;</span><a class="page-number" href="/page/95/">95</a><a class="extend next" rel="next" href="/page/60/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">付康为</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">949</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">付康为</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
