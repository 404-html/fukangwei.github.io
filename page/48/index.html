<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="泥腿子出身">
<meta property="og:url" content="http://fukangwei.gitee.io/page/48/index.html">
<meta property="og:site_name" content="泥腿子出身">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="泥腿子出身">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '561O3H1PZB',
      apiKey: '7631d3cf19ac49bd39ada7163ec937a7',
      indexName: 'fuxinzi',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="http://fukangwei.gitee.io/page/48/">





  <title>泥腿子出身</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">泥腿子出身</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/25/Qt语法详解/Qt之iterator/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/25/Qt语法详解/Qt之iterator/" itemprop="url">Qt之iterator</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-25T11:41:26+08:00">
                2019-01-25
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;The <code>QList::iterator</code> class provides an <code>STL-style</code> <code>non-const</code> iterator for <code>QList</code> and <code>QQueue</code>. The header file is <code>iterator</code>.</p>
<h3 id="Public-Functions"><a href="#Public-Functions" class="headerlink" title="Public Functions"></a>Public Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><code>iterator()</code></td>
</tr>
<tr>
<td></td>
<td><code>iterator(const iterator &amp; other)</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator!=(const iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator!=(const const_iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>T &amp;</code></td>
<td><code>operator*() const</code></td>
</tr>
<tr>
<td><code>iterator</code></td>
<td><code>operator+(int j) const</code></td>
</tr>
<tr>
<td><code>iterator &amp;</code></td>
<td><code>operator++()</code></td>
</tr>
<tr>
<td><code>iterator</code></td>
<td><code>operator++(int)</code></td>
</tr>
<tr>
<td><code>iterator &amp;</code></td>
<td><code>operator+=(int j)</code></td>
</tr>
<tr>
<td><code>iterator</code></td>
<td><code>operator-(int j) const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>operator-(iterator other) const</code></td>
</tr>
<tr>
<td><code>iterator &amp;</code></td>
<td><code>operator--()</code></td>
</tr>
<tr>
<td><code>iterator</code></td>
<td><code>operator--(int)</code></td>
</tr>
<tr>
<td><code>iterator &amp;</code></td>
<td><code>operator-=(int j)</code></td>
</tr>
<tr>
<td><code>T *</code></td>
<td><code>operator-&gt;() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator&lt;(const iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator&lt;(const const_iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator&lt;=(const iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator&lt;=(const const_iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator==(const iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator==(const const_iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator&gt;(const iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator&gt;(const const_iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator&gt;=(const iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>operator&gt;=(const const_iterator &amp; other) const</code></td>
</tr>
<tr>
<td><code>T &amp;</code></td>
<td><code>operator[](int j) const</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Detailed-Description"><a href="#Detailed-Description" class="headerlink" title="Detailed Description"></a>Detailed Description</h3><p>&emsp;&emsp;The <code>QList::iterator</code> class provides an <code>STL-style</code> <code>non-const</code> iterator for <code>QList</code> and <code>QQueue</code>.<br>&emsp;&emsp;<code>QList</code> features both <code>STL-style</code> iterators and <code>Java-style</code> iterators. The <code>STL-style</code> iterators are more <code>low-level</code> and more cumbersome to use; on the other hand, they are slightly faster and, for developers who already know <code>STL</code>, have the advantage of familiarity.<br>&emsp;&emsp;<code>QList&lt;T&gt;::iterator</code> allows you to iterate over a <code>QList&lt;T&gt;</code> (or <code>QQueue&lt;T&gt;</code>) and to modify the list item associated with the iterator. If you want to iterate over a const <code>QList</code>, use <code>QList::const_iterator</code> instead. It is generally good practice to use <code>QList::const_iterator</code> on a <code>non-const</code> <code>QList</code> as well, unless you need to change the <code>QList</code> through the iterator. Const iterators are slightly faster, and can improve code readability.<br>&emsp;&emsp;The default <code>QList::iterator</code> constructor creates an uninitialized iterator. You must initialize it using a <code>QList</code> function like <code>QList::begin()</code>, <code>QList::end()</code>, or <code>QList::insert()</code> before you can start iterating. Here’s a typical loop that prints all the items stored in a list:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;QString&gt; <span class="built_in">list</span>;</span><br><span class="line"><span class="built_in">list</span>.append ( <span class="string">"January"</span> );</span><br><span class="line"><span class="built_in">list</span>.append ( <span class="string">"February"</span> );</span><br><span class="line"><span class="built_in">list</span>.append ( <span class="string">"December"</span> );</span><br><span class="line">​</span><br><span class="line">QList&lt;QString&gt;::iterator i;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> ( i = <span class="built_in">list</span>.begin(); i != <span class="built_in">list</span>.end(); ++i ) &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; *i &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;Let’s see a few examples of things we can do with a <code>QList::iterator</code> that we cannot do with a <code>QList::const_iterator</code>. Here’s an example that increments every value stored in a <code>QList&lt;int&gt;</code> by <code>2</code>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;<span class="keyword">int</span>&gt;::iterator i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = <span class="built_in">list</span>.begin(); i != <span class="built_in">list</span>.end(); ++i)</span><br><span class="line">    *i += <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;Most <code>QList</code> functions accept an integer index rather than an iterator. For that reason, iterators are rarely useful in connection with <code>QList</code>. One place where <code>STL-style</code> iterators do make sense is as arguments to generic algorithms.<br>&emsp;&emsp;For example, here’s how to delete all the widgets stored in a <code>QList&lt;QWidget *&gt;</code>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;QWidget *&gt; <span class="built_in">list</span>;​</span><br><span class="line">qDeleteAll ( <span class="built_in">list</span>.begin(), <span class="built_in">list</span>.end() );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;Multiple iterators can be used on the same list. However, be aware that any <code>non-const</code> function call performed on the <code>QList</code> will render all existing iterators undefined. If you need to keep iterators over a long period of time, we recommend that you use <code>QLinkedList</code> rather than <code>QList</code>.</p>
<h3 id="Member-Function-Documentation"><a href="#Member-Function-Documentation" class="headerlink" title="Member Function Documentation"></a>Member Function Documentation</h3><ul>
<li><code>iterator::iterator()</code>: Constructs an uninitialized iterator. Functions like <code>operator*()</code> and <code>operator++()</code> should not be called on an uninitialized iterator. Use <code>operator=()</code> to assign a value to it before using it.</li>
<li><code>iterator::iterator(const iterator &amp; other)</code>: Constructs a copy of <code>other</code>.</li>
<li><code>bool iterator::operator!=(const iterator &amp; other) const</code>: Returns <code>true</code> if <code>other</code> points to a different item than this iterator; otherwise returns <code>false</code>.</li>
<li><code>bool iterator::operator!=(const const_iterator &amp; other) const</code>:  Returns <code>true</code> if <code>other</code> points to a different item than this iterator; otherwise returns <code>false</code>.</li>
<li><code>T &amp; iterator::operator*() const</code>: Returns a modifiable reference to the current item. You can change the value of an item by using <code>operator*()</code> on the left side of an assignment, for example:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( *it == <span class="string">"Hello"</span> ) &#123;</span><br><span class="line">    *it = <span class="string">"Bonjour"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>iterator iterator::operator+(int j) const</code>: Returns an iterator to the item at <code>j</code> positions forward from this iterator (If <code>j</code> is negative, the iterator goes backward).</li>
<li><code>iterator &amp; iterator::operator++()</code>: The prefix <code>++</code> operator (<code>++it</code>) advances the iterator to the next item in the list and returns an iterator to the new current item. Calling this function on <code>QList::end()</code> leads to undefined results.</li>
<li><code>iterator iterator::operator++(int)</code>: This is an overloaded function. The postfix <code>++</code> operator (<code>it++</code>) advances the iterator to the next item in the list and returns an iterator to the previously current item.</li>
<li><code>iterator &amp; iterator::operator+=(int j)</code>: Advances the iterator by <code>j</code> items (If <code>j</code> is negative, the iterator goes backward).</li>
<li><code>iterator iterator::operator-(int j) const</code>: Returns an iterator to the item at <code>j</code> positions backward from this iterator (If <code>j</code> is negative, the iterator goes forward).</li>
<li><code>int iterator::operator-(iterator other) const</code>: Returns the number of items between the item pointed to by <code>other</code> and the item pointed to by this iterator.</li>
<li><code>iterator &amp; iterator::operator--()</code>: The prefix <code>--</code> operator (<code>--it</code>) makes the preceding item current and returns an iterator to the new current item. Calling this function on <code>QList::begin()</code> leads to undefined results.</li>
<li><code>iterator iterator::operator--(int)</code>: This is an overloaded function. The postfix <code>--</code> operator (<code>it--</code>) makes the preceding item current and returns an iterator to the previously current item.</li>
<li><code>iterator &amp; iterator::operator-=(int j)</code>: Makes the iterator go back by <code>j</code> items (If <code>j</code> is negative, the iterator goes forward).</li>
<li><code>T * iterator::operator-&gt;() const</code>: Returns a pointer to the current item.</li>
<li><code>bool iterator::operator&lt;(const iterator &amp; other) const</code>: Returns <code>true</code> if the item pointed to by this iterator is less than the item pointed to by the <code>other</code> iterator.</li>
<li><code>bool iterator::operator&lt;(const const_iterator &amp; other) const</code>: Returns <code>true</code> if the item pointed to by this iterator is less than the item pointed to by the <code>other</code> iterator.</li>
<li><code>bool iterator::operator&lt;=(const iterator &amp; other) const</code>: Returns <code>true</code> if the item pointed to by this iterator is less than or equal to the item pointed to by the <code>other</code> iterator.</li>
<li><code>bool iterator::operator&lt;=(const const_iterator &amp; other) const</code>: Returns <code>true</code> if the item pointed to by this iterator is less than or equal to the item pointed to by the <code>other</code> iterator.</li>
<li><code>bool iterator::operator==(const iterator &amp; other) const</code>: Returns true if <code>other</code> points to the same item as this iterator; otherwise returns <code>false</code>.</li>
<li><code>bool iterator::operator==(const const_iterator &amp; other) const</code>: Returns <code>true</code> if <code>other</code> points to the same item as this iterator; otherwise returns <code>false</code>.</li>
<li><code>bool iterator::operator&gt;(const iterator &amp; other) const</code>: Returns <code>true</code> if the item pointed to by this iterator is greater than the item pointed to by the <code>other</code> iterator.</li>
<li><code>bool iterator::operator&gt;(const const_iterator &amp; other) const</code>: Returns <code>true</code> if the item pointed to by this iterator is greater than the item pointed to by the <code>other</code> iterator.</li>
<li><code>bool iterator::operator&gt;=(const iterator &amp; other) const</code>: Returns <code>true</code> if the item pointed to by this iterator is greater than or equal to the item pointed to by the <code>other</code> iterator.</li>
<li><code>bool iterator::operator&gt;=(const const_iterator &amp; other) const</code>: Returns <code>true</code> if the item pointed to by this iterator is greater than or equal to the item pointed to by the <code>other</code> iterator.</li>
<li><code>T &amp; iterator::operator[](int j) const</code>: Returns a modifiable reference to the item at position <code>*this + j</code>. This function is provided to make <code>QList</code> iterators behave like <code>C++</code> pointers.</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/24/Qt语法详解/Qt之QDir/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Qt语法详解/Qt之QDir/" itemprop="url">Qt之QDir</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T19:36:49+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;类<code>QDir</code>提供了对目录结构和其内容的访问方式。<code>QDir</code>用来操作路径名、访问关于路径和文件的信息、操作基础的文件系统，还可以用来访问<code>Qt</code>的资源系统。<br>&emsp;&emsp;<code>Qt</code>可以使用相对路径和绝对路径指向一个文件，<code>isRelative</code>和<code>isAbsolute</code>函数可以判断<code>QDir</code>对象使用的是相对路径还是绝对路径。将相对路径转换为绝对路径使用<code>makeAbsolute</code>函数。目录路径可以通过<code>path</code>函数返回，通过<code>setPath</code>函数设置新路径，绝对路径使用<code>absolutePath</code>返回。目录名可以使用<code>dirName</code>返回。目录的路径可以通过<code>cd</code>、<code>cdUp</code>改变，可以使<code>mkdir</code>创建目录，<code>rename</code>改变目录名。判断目录是否存在可以使用<code>exists</code>，目录的属性可以使用<code>isReadable</code>、<code>isAbsolute</code>、<code>isRelative</code>和<code>isRoot</code>。目录下有很多条目，包括文件、目录和符号链接，总的条目数可以使用<code>count</code>来统计。<code>entryList</code>可以返回目录下所有条目组成的字符串链表，文件可以使用<code>remove</code>函数删除，<code>rmdir</code>删除目录。在这里简单说一下几个类似的方法的区别：</p>
<ul>
<li><code>entryInfoList</code>与<code>entryList</code>：第一个函数会返回此文件加下所有文件及目录的完整信息，包括用户组、大小、访问时间、权限等等所有与文件有关的信息；而第二个方法只是返回此目录下的所有文件及目录的名字。</li>
<li><code>absoluteFilePath</code>与<code>absolutePath</code>：<code>absoluteFilePath</code>返回带本文件名的路径信息，<code>absolutePath</code>返回不带本文件名的路径信息。</li>
</ul>
<p>&emsp;&emsp;<code>Qt</code>使用<code>/</code>来作为通用的目录分隔符，这一点和在<code>URLs</code>中的路径分割符的用法一致。如果你使用<code>/</code>作为文件分隔符，<code>Qt</code>会自动地转换你的路径来匹配你的基础的操作系统。<br>&emsp;&emsp;绝对路径的用法：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QDir ( <span class="string">"/home/user/Documents"</span> );</span><br><span class="line">QDir ( <span class="string">"C:/Documents and Settings"</span> );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;相对路径的用法：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QDir ( <span class="string">"images/landscape.png"</span> );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;使用示例如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QtCore&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDebug&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[] )</span> </span>&#123;</span><br><span class="line">    <span class="function">QCoreApplication <span class="title">a</span> <span class="params">( argc, argv )</span></span>;</span><br><span class="line">    <span class="function">QDir <span class="title">mDir</span> <span class="params">( <span class="string">"D:/qttest"</span> )</span></span>; <span class="comment">/* 或者用“D:\\qttest”来代替 */</span></span><br><span class="line">    QDir nDir;</span><br><span class="line">    qDebug() &lt;&lt; mDir.exists(); <span class="comment">/* 测试路径是否存在 */</span></span><br><span class="line">    <span class="comment">/* 返回指定目录下指定文件的绝对路径 */</span></span><br><span class="line">    qDebug() &lt;&lt; mDir.absoluteFilePath ( <span class="string">"main.cpp"</span> );</span><br><span class="line">    qDebug() &lt;&lt; mDir.dirName(); <span class="comment">/* 剥离掉路径，只返回目录的名字 */</span></span><br><span class="line">    <span class="function">QFileInfo <span class="title">fi</span> <span class="params">( <span class="string">"C:/Documents and Settings/Administrator/pcmscan.cfg"</span> )</span></span>;</span><br><span class="line">    qDebug() &lt;&lt; fi.absoluteFilePath(); <span class="comment">/* 返回文件的绝对路径 */</span></span><br><span class="line">    qDebug() &lt;&lt; fi.filePath(); <span class="comment">/* 返回文件的路径 */</span></span><br><span class="line">    qDebug() &lt;&lt; fi.fileName(); <span class="comment">/* 剥离掉路径，只返回文件的名字 */</span></span><br><span class="line">​</span><br><span class="line">    <span class="comment">/* driver返回系统根目录下的目录列表 */</span></span><br><span class="line">    foreach ( QFileInfo mItem, nDir.drives() ) &#123;</span><br><span class="line">        qDebug() &lt;&lt; mItem.absolutePath();</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="comment">/* entryInfoList根据名字或属性顺序返回指定目录下所有的文件和目录的QFileInfo对象 */</span></span><br><span class="line">    foreach ( QFileInfo nItem, nDir.entryInfoList() ) &#123;</span><br><span class="line">        qDebug() &lt;&lt; nItem.absoluteFilePath();</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    QString mPath = <span class="string">"D:/test/ZZZ"</span>;</span><br><span class="line">    QDir kDir;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( !kDir.exists ( mPath ) ) &#123; <span class="comment">/* 判断指定目录下是否存在指定目录 */</span></span><br><span class="line">        kDir.mkpath ( mPath ); <span class="comment">/* 生成指定目录 */</span></span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"Create"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"Already exits"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">return</span> a.exec();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">true</span></span><br><span class="line"><span class="string">"D:/qttest/main.cpp"</span></span><br><span class="line"><span class="string">"qttest"</span></span><br><span class="line"><span class="string">"C:/Documents and Settings/Administrator/pcmscan.cfg"</span></span><br><span class="line"><span class="string">"C:/Documents and Settings/Administrator/pcmscan.cfg"</span></span><br><span class="line"><span class="string">"pcmscan.cfg"</span></span><br><span class="line"><span class="string">"C:/"</span></span><br><span class="line"><span class="string">"D:/"</span></span><br><span class="line"><span class="string">"E:/"</span></span><br><span class="line"><span class="string">"F:/"</span></span><br><span class="line"><span class="string">"G:/"</span></span><br><span class="line"><span class="string">"H:/"</span></span><br><span class="line"><span class="string">"D:/qttest/QtDir-build-desktop"</span></span><br><span class="line"><span class="string">"D:/qttest"</span></span><br><span class="line"><span class="string">"D:/qttest/QtDir-build-desktop/debug"</span></span><br><span class="line"><span class="string">"D:/qttest/QtDir-build-desktop/Makefile"</span></span><br><span class="line"><span class="string">"D:/qttest/QtDir-build-desktop/Makefile.Debug"</span></span><br><span class="line"><span class="string">"D:/qttest/QtDir-build-desktop/Makefile.Release"</span></span><br><span class="line"><span class="string">"D:/qttest/QtDir-build-desktop/release"</span></span><br><span class="line">Already exits</span><br></pre></td></tr></table></figure>
<hr>
<ul>
<li><code>QString QDir::homePath() [static]</code>: Returns the absolute path of the user’s home directory. Under <code>Windows</code>, this function will return the directory of the current user’s profile. Typically, this is:</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:/Documents <span class="keyword">and</span> Settings/Username</span><br></pre></td></tr></table></figure>
<p>Use the <code>toNativeSeparators()</code> function to convert the separators to the ones that are appropriate for the underlying operating system.<br>&emsp;&emsp;If the directory of the current user’s profile does not exist or cannot be retrieved, the following alternatives will be checked (in the given order) until an existing and available path is found:</p>
<ul>
<li>The path specified by the <code>USERPROFILE</code> environment variable.</li>
<li>The path formed by concatenating the <code>HOMEDRIVE</code> and <code>HOMEPATH</code> environment variables.</li>
<li>The path specified by the <code>HOME</code> environment variable.</li>
<li>The path returned by the <code>rootPath()</code> function (which uses the <code>SystemDrive</code> environment variable)</li>
<li>The <code>C:/</code> directory.</li>
</ul>
<p>Under <code>non-Windows</code> operating systems the <code>HOME</code> environment variable is used if it exists, otherwise the path returned by the <code>rootPath()</code>.</p>
<ul>
<li><code>QString QDir::rootPath() [static]</code>: Returns the absolute path of the root directory. For <code>Unix</code> operating systems, this returns <code>/</code>. For <code>Windows</code>, this normally returns <code>c:/</code>. I.E. the root of the system drive.</li>
<li><code>QString QDir::tempPath()</code>: Returns the absolute path of the system’s temporary directory. On <code>Unix/Linux</code> systems, this is the path in the <code>TMPDIR</code> environment variable or <code>/tmp</code> if <code>TMPDIR</code> is not defined. On <code>Windows</code>, this is usually the path in the <code>TEMP</code> or <code>TMP</code> environment variable. Whether a directory separator is added to the end or not, depends on the operating system.</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/24/Qt语法详解/Qt之QProcess/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Qt语法详解/Qt之QProcess/" itemprop="url">Qt之QProcess</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T16:31:18+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="QProcess进程类"><a href="#QProcess进程类" class="headerlink" title="QProcess进程类"></a>QProcess进程类</h3><p>&emsp;&emsp;<code>Qt</code>提供了<code>QProcess</code>类用于启动外部程序并与之通信。启动一个新的进程的操作非常简单，只需要将待启动的程序名称和启动参数传递给<code>start</code>函数即可：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QObject *parent;</span><br><span class="line">QString program = <span class="string">"tar"</span>;</span><br><span class="line">QStringList arguments;</span><br><span class="line">arguments &lt;&lt; <span class="string">"czvf"</span> &lt;&lt; <span class="string">"backup.tar.gz"</span> &lt;&lt; <span class="string">"/home"</span>;</span><br><span class="line">QProcess *myProcess = <span class="keyword">new</span> QProcess ( parent );</span><br><span class="line">QProcess-&gt;start ( program, arguments );</span><br></pre></td></tr></table></figure>
<p>当调用<code>start</code>函数后，<code>myProcess</code>进程立即进入启动状态，但<code>tar</code>程序尚未被调用，不能读写标准输入输出设备。当进程完成启动后就进入<code>运行状态</code>，并向外发出<code>started</code>信号。<br>&emsp;&emsp;在输入输出方面，<code>QProcess</code>将一个进程看做一个流类型的<code>I/O</code>设备，可以像使用<code>QTcpSocket</code>读写流类型的网络连接一样来读写一个进程。可以通过<code>QIODevice::write</code>函数向所启动进程的标准输入写数据，也可以通过<code>QIODevice::read</code>、<code>QIODevice::readLine</code>和<code>QIODevice::getChar</code>函数从这个进程的标准输出读数据。由于<code>QProcess</code>是从<code>QIODevice</code>类继承而来的，因此它也可以作<code>QXmlReader</code>的数据来源，或者为<code>QFtp</code>产生上传数据。最后当进程退出时，<code>QProcess</code>进入起始状态(即<code>非运行状态</code>)，并发出<code>finished</code>信号。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">finished</span> <span class="params">( <span class="keyword">int</span> exitCode, QProcess::ExitStatus exitStatus )</span></span>;</span><br></pre></td></tr></table></figure>
<p>信号在参数中返回了进程退出的退出码和退出状态，可以调用<code>exitCode</code>函数和<code>exitStatus</code>函数分别获取最后退出进程的这两个值。<code>Qt</code>定义的进程<code>退出状态</code>只有正常退出和进程崩溃两种，分别对应值<code>QProcess::NormalExit</code>(值为<code>0</code>)和<code>QProcess::CrashExit</code>(值为<code>1</code>)。当进程在运行中产生错误时，<code>QProcess</code>将发出<code>error</code>信号，可以通过调用<code>error</code>函数返回最后一次产生错误的类型，并通过<code>state</code>找出此时进程所处的状态。<code>Qt</code>定义了如下的进程错误代码：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>错误常量</th>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QProcess::FailedToStart</code></td>
<td><code>0</code></td>
<td>进程启动失败</td>
</tr>
<tr>
<td><code>QProcess::Crashed</code></td>
<td><code>1</code></td>
<td>进程成功启动后崩溃</td>
</tr>
<tr>
<td><code>QProcess::Timedout</code></td>
<td><code>2</code></td>
<td>最后一次调用<code>waitFor</code>函数超时，此时<code>QProcess</code>状态不变，并可以再次调用<code>waitFor</code>类型的函数</td>
</tr>
<tr>
<td><code>QProcess::WriteError</code></td>
<td><code>3</code></td>
<td>向进程写入时出错，例如进程尚未启动或者输入通道被关闭时</td>
</tr>
<tr>
<td><code>QProcess::ReadError</code></td>
<td><code>4</code></td>
<td>从进程中读取数据时出错，例如进程尚未启动时</td>
</tr>
<tr>
<td><code>QProcess::UnknownError</code></td>
<td><code>5</code></td>
<td>未知错误，这也是<code>error</code>函数返回的默认值</td>
</tr>
</tbody>
</table>
</div>
<p>&emsp;&emsp;可以通过调用<code>setReadChanned</code>函数设置当前的读通道，当有可读数据时，<code>Qt</code>将发出<code>readyRead</code>信号；如果是从标准输出和标准错误通道中读取数据，还会发出<code>readyReadStandardOutput</code>信号；如果是从标准错误读取，也会发出<code>readyReadStandardError</code>信号。<code>readAllStandardOutput</code>函数从标准输出通道中读取数据，<code>readAllStandardErrot</code>函数从标准错误通道中读取数据。在进程启动以前，以<code>MergedChannels</code>为参数调用<code>setReadChannelMode</code>函数，可以把标准输出通道和标准输错误通道合并。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QApplication&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QProcess&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QString&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[] )</span> </span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">app</span> <span class="params">( argc, argv )</span></span>;</span><br><span class="line">    QProcess proc;</span><br><span class="line">    QStringList arguments;</span><br><span class="line">    arguments &lt;&lt; <span class="string">"-na"</span>;</span><br><span class="line">    proc.start ( <span class="string">"netstat"</span>, arguments );</span><br><span class="line">​</span><br><span class="line">    <span class="comment">/* 等待进程启动 */</span></span><br><span class="line">    <span class="keyword">if</span> ( !proc.waitForStarted() ) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"启动失败\n"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    proc.closeWriteChannel(); <span class="comment">/* 关闭写通道，因为没有向进程写数据 */</span></span><br><span class="line">    QByteArray procOutput; <span class="comment">/* 用于保存进程的控制台输出 */</span></span><br><span class="line">​</span><br><span class="line">    <span class="comment">/* 等待进程结束 */</span></span><br><span class="line">    <span class="keyword">while</span> ( <span class="literal">false</span> == proc.waitForFinished() ) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"结束失败\n"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    procOutput = proc.readAll(); <span class="comment">/* 读取进程输出到控制台的数据 */</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; procOutput.data() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">/* 输出读到的数据 */</span></span><br><span class="line">    <span class="keyword">return</span> EXIT_SUCCESS; <span class="comment">/* 返回EXIT_SUCCESS */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Qt之进程间交互"><a href="#Qt之进程间交互" class="headerlink" title="Qt之进程间交互"></a>Qt之进程间交互</h3><p>&emsp;&emsp;<code>mainwindow.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MAINWINDOW_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAINWINDOW_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QtGui&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span> :</span> <span class="keyword">public</span> QMainWindow &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    MainWindow ( QWidget *parent = <span class="number">0</span> );</span><br><span class="line">    ~MainWindow();</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">openProcess</span><span class="params">()</span></span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QProcess *p;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MAINWINDOW_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mainwindow.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mainwindow.h"</span></span></span><br><span class="line">​</span><br><span class="line">MainWindow::MainWindow ( QWidget *parent ) : QMainWindow ( parent ) &#123;</span><br><span class="line">    p = <span class="keyword">new</span> QProcess ( <span class="keyword">this</span> );</span><br><span class="line">    QPushButton *bt = <span class="keyword">new</span> QPushButton ( <span class="string">"execute notepad"</span>, <span class="keyword">this</span> );</span><br><span class="line">    connect ( bt, SIGNAL ( clicked() ), <span class="keyword">this</span>, SLOT ( openProcess() ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">MainWindow::~MainWindow() &#123;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::openProcess() &#123;</span><br><span class="line">    p-&gt;start ( <span class="string">"notepad.exe"</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个窗口只有一个按钮，当你点击按钮之后，程序会调用<code>Windows</code>的记事本。<code>QProcess::start</code>接收两个参数，第一个是要执行的命令或者程序，这里就是<code>notepad.exe</code>；第二个是<code>QStringList</code>类型的数据，也就是需要传递给这个程序的运行参数。注意，这个程序能够被系统找到。<br>&emsp;&emsp;调用一个系统命令，这里使用的是<code>Windows</code>，因此需要调用<code>dir</code>；如果你是在<code>Linux</code>进行编译，就需要改成<code>ls</code>。<br>&emsp;&emsp;<code>mainwindow.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MAINWINDOW_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAINWINDOW_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QtGui&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWindow</span> :</span> <span class="keyword">public</span> QMainWindow &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    MainWindow ( QWidget *parent = <span class="number">0</span> );</span><br><span class="line">    ~MainWindow();</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">openProcess</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">readResult</span> <span class="params">( <span class="keyword">int</span> exitCode )</span></span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    QProcess *p;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MAINWINDOW_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>mainwindow.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"mainwindow.h"</span></span></span><br><span class="line">​</span><br><span class="line">MainWindow::MainWindow ( QWidget *parent ) : QMainWindow ( parent ) &#123;</span><br><span class="line">    p = <span class="keyword">new</span> QProcess ( <span class="keyword">this</span> );</span><br><span class="line">    QPushButton *bt = <span class="keyword">new</span> QPushButton ( <span class="string">"execute notepad"</span>, <span class="keyword">this</span> );</span><br><span class="line">    connect ( bt, SIGNAL ( clicked() ), <span class="keyword">this</span>, SLOT ( openProcess() ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">MainWindow::~MainWindow() &#123;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::openProcess() &#123;</span><br><span class="line">    p-&gt;start ( <span class="string">"cmd.exe"</span>, QStringList() &lt;&lt; <span class="string">"/c"</span> &lt;&lt; <span class="string">"dir"</span> );</span><br><span class="line">    connect ( p, SIGNAL ( finished ( <span class="keyword">int</span> ) ), <span class="keyword">this</span>, SLOT ( readResult ( <span class="keyword">int</span> ) ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> MainWindow::readResult ( <span class="keyword">int</span> exitCode ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( exitCode == <span class="number">0</span> ) &#123;</span><br><span class="line">        QTextCodec *gbkCodec = QTextCodec::codecForName ( <span class="string">"GBK"</span> );</span><br><span class="line">        QString result = gbkCodec-&gt;toUnicode ( p-&gt;readAll() );</span><br><span class="line">        QMessageBox::information ( <span class="keyword">this</span>, <span class="string">"dir"</span>, result );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在按钮点击的<code>slot</code>函数中，通过<code>QProcess::start</code>函数运行了指令<code>cmd.exe /c dir</code>，意思是打开系统的<code>cmd</code>程序，然后运行<code>dir</code>指令。然后将<code>process</code>的<code>finished</code>信号连接到新增加的<code>slot</code>函数。<code>signal</code>函数有一个<code>int</code>型参数，我们知道，对于<code>C/C++</code>程序而言，<code>main</code>函数总是返回一个<code>int</code>，也就是退出代码，用于指示程序是否正常退出，这里的<code>int</code>参数就是这个退出代码。<code>slot</code>函数首先检查退出代码是否为<code>0</code>，如果退出代码为<code>0</code>，说明是正常退出。然后把结果显示在<code>QMessageBox</code>中。<code>QProcess::readAll</code>函数可以读出程序输出内容，由于它的返回结果是<code>QByteArray</code>型，所以再转换成<code>QString</code>显示出来。中文版<code>Windows</code>使用的是<code>GBK</code>编码，而<code>Qt</code>使用的是<code>Unicode</code>编码，因此需要做一下转换，否则会出现乱码。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/24/Qt语法详解/Qt开发注意事项/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Qt语法详解/Qt开发注意事项/" itemprop="url">Qt开发注意事项</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T16:12:55+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>如果出现<code>&#39;tr&#39; was not declared in this scope</code>的问题，将<code>tr</code>替换为<code>QObject::tr</code>即可。</li>
<li><code>Qt</code>设置控件随窗口大小变化的方法：拖一个控件到窗体上(任何控件都可以)；在窗体空白处<code>右键 -&gt; 布局 -&gt; 栅格布局</code>即可。</li>
<li>显示的界面其父类要么统一为<code>QWidget</code>，要么统一为<code>QDialog</code>，如果混用的话，会出现界面混乱的<code>BUG</code>。</li>
<li>新版<code>Qt Designer</code>查看窗体代码的地方是<code>窗体 -&gt; 查看代码</code>。</li>
<li><code>Qt::QSplashScreen</code>是欢迎窗口类型，通常用于制作软件的启动动画；<code>Qt::Dialog</code>则是对话框类型。</li>
<li><code>Qt</code>包含路径信息的代码应该用<code>/</code>符号，例如<code>C:/logo.png</code>。</li>
<li>对于<code>QLineEdit</code>中的验证器，只有输入行被正确地输入时才能触发相应的槽。</li>
<li>如果出现<code>Qt</code>工程打不开的情况，可以尝试把后缀名为<code>.pro.user</code>的文件删除掉，然后再打开工程。</li>
<li>如果<code>Qt Creator</code>中的源文件或头文件出现乱码的情况，可以将文件的编码格式转换为<code>System</code>。</li>
<li>如果出现窗口拒绝拖拽打开文件的情况，可以在窗口的构造函数中加入代码<code>setAcceptDrops(true);</code>。</li>
<li><code>Qt</code>界面类(例如<code>Dialog</code>和<code>widget</code>)的变量不能定义为全局变量，否则会出现重大<code>BUG</code>。</li>
<li><code>connect</code>函数的参数分别为信号发射的对象、发射的信号、接收信号的对象、对信号进行处理的槽。发射信号的对象和信号是在同一个类中，接收信号的对象和槽是在同一个类中，这两个类也可以是同一个类。</li>
<li><code>connect</code>函数中信号的参数和槽的参数是一一对应的，即信号会把自己的参数传递给槽的参数。</li>
<li><code>qDebug</code>函数无法直接输出<code>string</code>类型的变量，但可以输出<code>QString</code>类型的变量。如果需要输出<code>string</code>变量，则需要在其后面加上<code>.c_str()</code>。</li>
<li><code>QString</code>类型的数据不是以<code>\0</code>结尾的，这要和<code>C</code>语言的字符串进行区分，访问<code>QString</code>中的单个字符使用<code>at</code>函数。</li>
<li>在<code>Qt</code>中使用图片时，最好将图片添加到资源文件中，这样可以避免由于图片路径的错误而带来的麻烦。使用资源文件中的图片的方法是<code>:图片的资源文件路径</code>。</li>
<li><code>Qt</code>判断字符串是否为空应该使用成员函数<code>isEmpty()</code>，而不应该用<code>null</code>。</li>
<li>Qt的<code>find</code>函数返回的迭代器的类型为<code>const_iterator</code>，因此要将相应的迭代器变量设置为<code>const_iterator</code>型。</li>
<li>当使用<code>Qt</code>的网络功能时，需要在<code>.pro</code>文件中增加语句<code>QT += network</code>。</li>
<li>关于<code>Qt</code>中<code>emit</code>的作用：在程序中应该能找到类似这样的语句<code>connect ( obj, SIGNAL ( changeCurrentShape ( * ) ), anotherobj, SLOG ( FUN ( * ) ) );</code>，当执行到<code>emit changeCurrentShape(Shape::Triangle)</code>时，<code>Qt</code>的信号槽机制会自动触发<code>FUN</code>函数。</li>
<li>如果需要为窗口上的控件设置加速键，例如按住<code>Alt + N</code>即可跳到某个控件上，可以类似这样做：<code>pushbotton-&gt;setText(tr(&quot;&amp;nihao&quot;));</code>是设置<code>Alt + N</code>为加速键。如果需要在控件上显示<code>&amp;</code>，需要使用<code>&amp;&amp;</code>。</li>
<li><code>Qt::CaseSensitivity</code>为枚举类型，可取值<code>Qt::CaseSensitive</code>(大小写敏感)和<code>Qt::CaseInsensitive</code>(大小写不敏感)，表示匹配的灵敏度。</li>
<li>在<code>Qt</code>中，窗口的标题可以随时被改变，要使用<code>setWindowTitle</code>函数。</li>
<li><code>Qt</code>的<code>setGeometry (9, 9, 50, 25)</code>四个参数是指从屏幕上<code>(9,9)</code>位置开始(即为最左上角的点)，显示一个<code>50 * 25</code>的界面(宽<code>50</code>，高<code>25</code>)。</li>
<li><code>Qt</code>中的<code>void QApplication::beep () [static]</code>可以让系统发出蜂鸣声，但是该操作目前不支持嵌入式<code>linux</code>。</li>
<li>在<code>ui</code>上迅速设置槽函数的方法：在控件上右击，选择<code>转到槽</code>，再点击相应的时间，即可在相应的文件中增加其槽函数。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/24/Qt语法详解/Qt之QHostAddress/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Qt语法详解/Qt之QHostAddress/" itemprop="url">Qt之QHostAddress</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T14:57:19+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h3><p>&emsp;&emsp;<code>QHostAddress</code>类提供一个<code>IP</code>地址。这个类提供一种独立于平台和协议的方式来保存<code>IPv4</code>和<code>IPv6</code>地址。<code>QHostAddress</code>通常与<code>QTcpSocket</code>、QTcpServer、QUdpSocket一起使用，来连接到主机或建立一个服务器。<br>&emsp;&emsp;可以通过<code>setAddress</code>来设置一个主机地址，使用<code>toIPv4Address</code>、<code>toIPv6Address</code>或<code>toString</code>来检索主机地址，你可以通过<code>protocol</code>来检查协议类型。注意，<code>QHostAddress</code>不做<code>DNS</code>查询，而<code>QHostInfo</code>是有必要的。这个类还支持通用的预定义地址：<code>Null</code>、<code>LocalHost</code>、<code>LocalHostIPv6</code>、<code>Broadcast</code>和<code>Any</code>。</p>
<h3 id="常用接口"><a href="#常用接口" class="headerlink" title="常用接口"></a>常用接口</h3><p>&emsp;&emsp;枚举变量为<code>QHostAddress::SpecialAddress</code>，取值范围如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>常量</th>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QHostAddress::Null</code></td>
<td><code>0</code></td>
<td>空地址对象，相当于<code>QHostAddress</code></td>
</tr>
<tr>
<td><code>QHostAddress::LocalHost</code></td>
<td><code>2</code></td>
<td><code>IPv4</code>本地主机地址，相当于<code>QHostAddress(&quot;127.0.0.1&quot;)</code></td>
</tr>
<tr>
<td><code>QHostAddress::LocalHostIPv6</code></td>
<td><code>3</code></td>
<td><code>IPv6</code>本地主机地址，相当于<code>QHostAddress(&quot;::1&quot;)</code></td>
</tr>
<tr>
<td><code>QHostAddress::Broadcast</code></td>
<td><code>1</code></td>
<td><code>Pv4</code>广播地址，相当于<code>QHostAddress(&quot;255.255.255.255&quot;)</code></td>
</tr>
<tr>
<td><code>QHostAddress::AnyIPv4</code></td>
<td><code>6</code></td>
<td>意思是<code>IPv4 any-address</code>，相当于<code>QHostAddress(&quot;0.0.0.0&quot;)</code>，与该地址绑定的<code>socket</code>将只监听<code>IPv4</code>接口</td>
</tr>
<tr>
<td><code>QHostAddress::AnyIPv6</code></td>
<td><code>5</code></td>
<td>意思是<code>IPv6 any-address</code>，相当于<code>QHostAddress(&quot;::&quot;)</code>，与该地址绑定的<code>socket</code>将只监听<code>IPv6</code>接口</td>
</tr>
<tr>
<td><code>QHostAddress::Any</code></td>
<td><code>4</code></td>
<td>双<code>any-address</code>栈，与该地址绑定的<code>socket</code>将侦听<code>IPv4</code>和<code>IPv6</code>接口</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><code>bool isLoopback() const</code>：如果地址是<code>IPv6</code>的环回地址，或者<code>IPv4</code>的环回地址，则返回<code>true</code>。</li>
<li><code>bool isNull() const</code>：如果主机地址为空(<code>INADDR_ANY</code>或<code>in6addr_any</code>)，返回<code>true</code>。默认的构造函数创建一个空的地址，这个地址对于任何主机或接口是无效的。</li>
<li><code>QAbstractSocket::NetworkLayerProtocol protocol() const</code>：返回主机地址的网络层协议。</li>
<li><code>QString scopeId() const</code>：返回<code>IPv6</code>地址的范围<code>ID</code>。对于<code>IPv4</code>地址，如果该地址不包含范围<code>ID</code>，则返回一个空字符串。</li>
</ul>
<p>&emsp;&emsp;<code>IPv6</code>的范围<code>ID</code>指定非全球<code>IPv6</code>地址范围的可达性，限制地址可以被使用的区域。所有<code>IPv6</code>地址与这种可达范围相关联。范围<code>ID</code>用于消除那些不能保证是全局唯一性的地址。<br>&emsp;&emsp;当使用<code>链路本地</code>或<code>本地站点</code>地址的<code>IPv6</code>连接，必须指定范围<code>ID</code>。对<code>链路本地</code>地址来说，范围<code>ID</code>通常与接口名称(例如<code>eth0</code>、<code>en1</code>)或者数目(例如<code>1</code>、<code>2</code>)相同。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">quint32 <span class="title">toIPv4Address</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">quint32 <span class="title">toIPv4Address</span> <span class="params">( <span class="keyword">bool</span> *ok )</span> <span class="keyword">const</span></span></span><br></pre></td></tr></table></figure>
<p>返回<code>IPv4</code>地址为一个数字。如果地址是<code>127.0.0.1</code>，返回值为<code>2130706433</code>(即<code>0x7f000001</code>)。如果<code>protocol</code>是<code>IPv4Protocol</code>，该值是有效的；如果是<code>IPv6Protocol</code>，并且<code>IPv6</code>地址是一个<code>IPv4</code>映射的地址，在这种情况下，<code>ok</code>将被设置为<code>true</code>，否则它将被设置为<code>false</code>。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Q_IPV6ADDR <span class="title">toIPv6Address</span><span class="params">()</span> <span class="keyword">const</span></span></span><br></pre></td></tr></table></figure>
<p>返回的<code>IPv6</code>地址为<code>Q_IPV6ADDR</code>结构，该结构由<code>16</code>位无符号字符组成。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Q_IPV6ADDR addr = hostAddr.toIPv6Address(); <span class="comment">/* 该地址包含16位无符号字符 */</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i ) &#123;</span><br><span class="line">    <span class="comment">/* 处理addr[i] */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果<code>protocol</code>是<code>IPv6Protocol</code>，该值是有效的；如果是<code>IPv4Protocol</code>，返回地址将是<code>IPv4</code>地址映射的<code>IPv6</code>地址。</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>&emsp;&emsp;简单应用：构造一个<code>QHostAddress</code>，通过<code>toString</code>来获取对应的<code>IP</code>地址：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QHostAddress address = QHostAddress ( QHostAddress::LocalHost );</span><br><span class="line">QString strIPAddress = address.toString();</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;获取所有主机地址：<code>QNetworkInterface</code>类中提供了一个静态函数<code>allAddresses</code>，用于返回一个<code>QHostAddress</code>主机地址列表：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">QList&lt;QHostAddress&gt; <span class="built_in">list</span> = QNetworkInterface::allAddresses();</span><br><span class="line">​</span><br><span class="line">foreach ( QHostAddress address, <span class="built_in">list</span> ) &#123;</span><br><span class="line">    <span class="keyword">if</span> ( address.isNull() ) &#123; <span class="comment">/* 主机地址为空 */</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    QAbstractSocket::NetworkLayerProtocol nProtocol = address.protocol();</span><br><span class="line">    QString strScopeId = address.scopeId();</span><br><span class="line">    QString strAddress = address.toString();</span><br><span class="line">    <span class="keyword">bool</span> bLoopback = address.isLoopback();</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( nProtocol == QAbstractSocket::IPv4Protocol ) &#123; <span class="comment">/* 如果是IPv4 */</span></span><br><span class="line">        <span class="keyword">bool</span> bOk = <span class="literal">false</span>;</span><br><span class="line">        quint32 nIPV4 = address.toIPv4Address ( &amp;bOk );</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">if</span> ( bOk ) &#123;</span><br><span class="line">            qDebug() &lt;&lt; <span class="string">"IPV4 : "</span> &lt;&lt; nIPV4;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( nProtocol == QAbstractSocket::IPv6Protocol ) &#123; <span class="comment">/* 如果是IPv6 */</span></span><br><span class="line">        QStringList IPV6List ( <span class="string">""</span> );</span><br><span class="line">        Q_IPV6ADDR IPV6 = address.toIPv6Address();</span><br><span class="line">​</span><br><span class="line">        <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i ) &#123;</span><br><span class="line">            quint8 nC = IPV6[i];</span><br><span class="line">            IPV6List &lt;&lt; QString::number ( nC );</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"IPV6: "</span> &lt;&lt; IPV6List.join ( <span class="string">" "</span> );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">"Protocol: "</span> &lt;&lt; nProtocol;</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">"ScopeId: "</span> &lt;&lt; strScopeId;</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">"Address: "</span> &lt;&lt; strAddress;</span><br><span class="line">    qDebug() &lt;&lt; <span class="string">"IsLoopback: "</span> &lt;&lt; bLoopback;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">IPV6: <span class="string">" 254 128 0 0 0 0 0 0 89 150 39 163 131 181 42 231"</span></span><br><span class="line">Protocol: QAbstractSocket::NetworkLayerProtocol(IPv6Protocol)</span><br><span class="line">ScopeId: <span class="string">"18"</span></span><br><span class="line">Address: <span class="string">"fe80::5996:27a3:83b5:2ae7%18"</span></span><br><span class="line">IsLoopback: <span class="literal">false</span></span><br><span class="line">​</span><br><span class="line">IPV4: <span class="number">3232249857</span></span><br><span class="line">Protocol: QAbstractSocket::NetworkLayerProtocol(IPv4Protocol)</span><br><span class="line">ScopeId: <span class="string">""</span></span><br><span class="line">Address: <span class="string">"192.168.56.1"</span></span><br><span class="line">IsLoopback: <span class="literal">false</span></span><br><span class="line">​</span><br><span class="line">IPV6: <span class="string">" 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1"</span></span><br><span class="line">Protocol: QAbstractSocket::NetworkLayerProtocol(IPv6Protocol)</span><br><span class="line">ScopeId: <span class="string">""</span></span><br><span class="line">Address: <span class="string">"::1"</span></span><br><span class="line">IsLoopback: <span class="literal">true</span></span><br><span class="line">​</span><br><span class="line">IPV4: <span class="number">2130706433</span></span><br><span class="line">Protocol: QAbstractSocket::NetworkLayerProtocol(IPv4Protocol)</span><br><span class="line">ScopeId: <span class="string">""</span></span><br><span class="line">Address: <span class="string">"127.0.0.1"</span></span><br><span class="line">IsLoopback: <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h3><p>&emsp;&emsp;例如限制本地链路地址范围为<code>169.254.1.0</code>至<code>169.254.254.255</code>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isLinkLocalAddress</span> <span class="params">( QHostAddress addr )</span> </span>&#123;</span><br><span class="line">    quint32 nIPv4 = addr.toIPv4Address();</span><br><span class="line">    quint32 nMinRange = QHostAddress ( <span class="string">"169.254.1.0"</span> ).toIPv4Address();</span><br><span class="line">    quint32 nMaxRange = QHostAddress ( <span class="string">"169.254.254.255"</span> ).toIPv4Address();</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( ( nIPv4 &gt;= nMinRange ) &amp;&amp; ( nIPv4 &lt;= nMaxRange ) ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/24/Qt语法详解/Qt之QFileDialog/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Qt语法详解/Qt之QFileDialog/" itemprop="url">Qt之QFileDialog</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T14:05:36+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>QFileDialog</code>是<code>Qt</code>中的文件对话框，以下资料来源于<code>Qt</code>官方文档。使用QFileDialog可以调用当前系统的文件对话框，需要包含头文件<code>QFileDialog</code>。最简单的方法是调用静态函数来对话框获取文件：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QString file = QFileDialog::getOpenFileName ( <span class="string">"/home/foxman"</span>, <span class="string">"Images (*.png *.xpm *.jpg)"</span>, <span class="keyword">this</span> );</span><br></pre></td></tr></table></figure>
<p>这段代码可以建立一个取文件对话框，选择<code>OK</code>后将文件路径返回给<code>file</code>。可以一次性打开多个文件，使用<code>QStringList</code>来保存打开的文件的路径，例如打开一些音乐文件：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QStringList files = QFileDialog::getOpenFileNames (</span><br><span class="line">    <span class="keyword">this</span>, tr ( <span class="string">"Select Music Files"</span> ),</span><br><span class="line">    QDesktopServices::storageLocation ( QDesktopServices::MusicLocation ) );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;常见的用法如下所示：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 指定父窗口、设置对话框标题、指定默认打开的目录路径、设置文件类型过滤器 */</span></span><br><span class="line">QStringList fileNames = QFileDialog::getOpenFileNames ( <span class="keyword">this</span>, tr ( <span class="string">"文件对话框"</span> ), \</span><br><span class="line">                                                        <span class="string">"F:"</span>, tr ( <span class="string">"图片文件(*png *jpg)"</span> ) );</span><br><span class="line">qDebug() &lt;&lt; <span class="string">"fileNames:"</span> &lt;&lt; fileNames;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;一般的文件对话框的使用：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QFileDialog *fd = <span class="keyword">new</span> QFileDialog ( <span class="keyword">this</span>, <span class="string">"file dlg"</span>, TRUE );</span><br><span class="line">​</span><br><span class="line"><span class="keyword">if</span> ( fd-&gt;exec() == QFileDialog::Accepted ) &#123; <span class="comment">/* ok */</span></span><br><span class="line">    QString file = fd-&gt;selectedFile();</span><br><span class="line">    qWarning ( s );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;设定选项如下：<br>&emsp;&emsp;1. 设定显示模式：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Detail显示文件详细的日期大小，List为一般情况 */</span></span><br><span class="line">fd-&gt;setViewMode ( QFileDialog::Detail );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;2. 设定过滤器：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fd-&gt;setFilter ( <span class="string">"Images (*.png *.xpm *.jpg)"</span> );</span><br></pre></td></tr></table></figure>
<p>下面是设定多个过滤器，一定要以<code>;;</code>隔开：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QString filters = <span class="string">"C file(*.c *.cpp *.h);;pic(*.png *.xpm)"</span>;</span><br><span class="line">fd-&gt;setFilters ( filters );</span><br></pre></td></tr></table></figure>
<p>设定对话框返回值类型：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fd-&gt;setMode ( QFileDialog::ExistingFile );</span><br></pre></td></tr></table></figure>
<ul>
<li><code>AnyFile</code>：一般用于<code>save as</code>对话框。</li>
<li><code>ExistingFile</code>：存在的一个文件。</li>
<li><code>ExistingFiles</code>：存在的<code>0</code>个或多个文件(可用于选择多个文件)。</li>
<li><code>Directory</code>：返回目录。</li>
<li><code>DirectoryOnly</code>：返回目录(选取文件的时候只选中目录)。</li>
</ul>
<p>&emsp;&emsp;读取<code>QFileDialog</code>返回值：</p>
<ul>
<li>返回选择中的一个文件(夹)名字：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QString s = fd-&gt;selectedFile();</span><br></pre></td></tr></table></figure>
<ul>
<li>选取多个文件(一定要设定<code>ExistingFiles</code>模式)：</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QStringList slist = fd-&gt;selectedFiles();</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> ( QStringList::Iterator it = slist.begin(); it != slist.end(); it++ ) &#123;</span><br><span class="line">    qWarning ( *it );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="文件打开对话框"><a href="#文件打开对话框" class="headerlink" title="文件打开对话框"></a>文件打开对话框</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QString <span class="title">getOpenFileName</span> <span class="params">( QWidget *parent = <span class="number">0</span>, <span class="keyword">const</span> QString &amp;caption = QString(), \</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">const</span> QString &amp;dir = QString(), <span class="keyword">const</span> QString &amp;filter = QString(), \</span></span></span><br><span class="line"><span class="function"><span class="params">                          QString *selectedFilter = <span class="number">0</span>, Options options = <span class="number">0</span> )</span></span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>parent</code>：用于指定父组件。注意，很多<code>Qt</code>组件的构造函数都会有这么一个parent参数，并提供一个默认值0。</li>
<li><code>caption</code>：对话框的标题。</li>
<li><code>dir</code>：对话框显示时默认打开的目录，<code>.</code>代表程序运行目录，<code>/</code>代表当前盘符的根目录。也可以是平台相关的目录，例如<code>C:\\</code>。</li>
<li><code>filter</code>：对话框的后缀名过滤器。多个文件使用空格分隔，例如使用<code>Image Files(*.jpg *.png)</code>就让它只能显示后缀名是<code>jpg</code>或者<code>png</code>的文件；多个过滤使用两个分号分隔，如果需要使用多个过滤器，使用<code>;;</code>分割，例如<code>JPEG Files(*.jpg);;PNG Files(*.png)</code>。</li>
<li><code>selectedFilter</code>：默认选择的过滤器。</li>
<li><code>options</code>：对话框的一些参数设定，例如只显示文件夹等，它的取值是<code>enum QFileDialog::Option</code>，每个选项可以使用<code>|</code>运算组合起来。</li>
</ul>
<h3 id="文件保存对话框"><a href="#文件保存对话框" class="headerlink" title="文件保存对话框"></a>文件保存对话框</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">QString <span class="title">getSaveFileName</span> <span class="params">( QWidget *parent = <span class="number">0</span>, <span class="keyword">const</span> QString &amp;caption = QString(), \</span></span></span><br><span class="line"><span class="function"><span class="params">                          <span class="keyword">const</span> QString &amp;dir = QString(), <span class="keyword">const</span> QString &amp;filter = QString(), \</span></span></span><br><span class="line"><span class="function"><span class="params">                          QString *selectedFilter = <span class="number">0</span>, Options options = <span class="number">0</span> )</span></span>;</span><br></pre></td></tr></table></figure>
<p>代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">QString fileName = QFileDialog::getSaveFileName ( <span class="keyword">this</span>, tr ( <span class="string">"Open Config"</span> ), \</span><br><span class="line">                                                  <span class="string">""</span>, tr ( <span class="string">"Config Files (*.ifg)"</span> ) );</span><br><span class="line">​</span><br><span class="line"><span class="keyword">if</span> ( !fileName.isNull() ) &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="comment">/* 点击取消按钮 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/24/Qt语法详解/Qt之QFileSystemWatcher/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Qt语法详解/Qt之QFileSystemWatcher/" itemprop="url">Qt之QFileSystemWatcher</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T13:40:43+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h3><p>&emsp;&emsp;<code>QFileSystemWatcher</code>类用于提供监视文件和目录修改的接口。它通过监控指定路径的列表，监视文件系统中文件和目录的变更。调用<code>addPath</code>函数可以监控一个特定的文件或目录。如果需要监控多个路径，可以使用<code>addPaths</code>。通过使用<code>removePath</code>和<code>removePaths</code>函数来移除现有路径。<br>&emsp;&emsp;<code>QFileSystemWatcher</code>检查添加到它的每个路径，已添加到<code>QFileSystemWatcher</code>的文件可以使用的<code>files</code>函数进行访问，目录则使用<code>directories</code>函数进行访问。当一个文件被修改、重命名或从磁盘上删除时，会发出<code>fileChanged</code>信号。同样，当一个目录或它的内容被修改或删除时，会发射<code>directoryChanged</code>信号。需要注意，文件一旦被重命名或从硬盘删除，目录从磁盘上删除时，<code>QFileSystemWatcher</code>将停止监控。监控文件和目录进行修改的行为会消耗系统资源，这意味着进程同时监控的文件数量是有限制的。一些系统限制打开的文件描述符的数量默认为<code>256</code>，也就是说如果进程使用<code>addPath</code>和<code>addPaths</code>函数添加超过<code>256</code>个文件或目录到文件系统将会失败。</p>
<h3 id="公共函数"><a href="#公共函数" class="headerlink" title="公共函数"></a>公共函数</h3><ul>
<li><code>bool addPath(const QString &amp; path)</code>：如果路径存在，则添加至文件系统监控；如果路径不存在或者已经被监控了，那么不添加。如果路径是一个目录，内容被修改或删除时，会发射<code>directoryChanged</code>信号；否则当文件被修改、重命名或从磁盘上删除时，会发出<code>fileChanged</code>信号。如果监控成功，返回<code>true</code>，否则返回<code>false</code>。监控失败的原因通常依赖于系统，但也包括资源不存在、接入失败、或总的监控数量限制等原因。</li>
<li><code>QStringList addPaths(const QStringList &amp; paths)</code>：添加每一个路径至文件系统监控，如果路径不存在或者已经被监控了，那么不添加。返回值是不能被监控的路径列表。</li>
<li><code>QStringList directories() const</code>：返回一个被监控的目录路径列表。</li>
<li><code>QStringList files() const</code>：返回一个被监控的文件路径列表。</li>
<li><code>bool removePath(const QString &amp; path)</code>：从文件系统监控中删除指定的路径。如果监控被成功移除，返回<code>true</code>。删除失败的原因通常是与系统相关，但可能是由于路径已经被删除。</li>
<li><code>QStringList removePaths(const QStringList &amp; paths)</code>：从文件系统监控中删除指定的路径。返回值是一个无法删除成功的路径列表。</li>
</ul>
<h3 id="信号"><a href="#信号" class="headerlink" title="信号"></a>信号</h3><ul>
<li><code>void directoryChanged(const QString &amp; path)</code>：当目录被修改(例如在指定的路径中添加或删除一个文件)或从磁盘删除时，这个信号将被发射。注意，如果在短时间内有几种变化，可能有些变化不会发出这个信号。然而，在变化的序列中，最后的变化总会发射这个信号。这是一个私有信号，可以用于信号连接但不能由用户发出。</li>
<li><code>void fileChanged(const QString &amp; path)</code>：当在指定路径中的文件被修改、重命名或从磁盘上删除时，这个信号将被发射。这是一个私有信号，可以用于信号连接但不能由用户发出。</li>
</ul>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>&emsp;&emsp;下面来实现一个<code>文件/目录</code>监控的类。<code>FileSystemWatcher.h</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> FILE_SYSTEM_WATCHER_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FILE_SYSTEM_WATCHER_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QObject&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QMap&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFileSystemWatcher&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileSystemWatcher</span> :</span> <span class="keyword">public</span> QObject &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addWatchPath</span> <span class="params">( QString path )</span></span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="comment">/* 目录更新时调用，path是监控的路径 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">directoryUpdated</span> <span class="params">( <span class="keyword">const</span> QString &amp;path )</span></span>;</span><br><span class="line">    <span class="comment">/* 文件被修改时调用，path是监控的路径 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fileUpdated</span> <span class="params">( <span class="keyword">const</span> QString &amp;path )</span></span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">FileSystemWatcher</span> <span class="params">( QObject *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">static</span> FileSystemWatcher *m_pInstance;</span><br><span class="line">    QFileSystemWatcher *m_pSystemWatcher;</span><br><span class="line">    <span class="comment">/* 当前每个监控的内容目录列表 */</span></span><br><span class="line">    QMap&lt;QString, QStringList&gt; m_currentContentsMap;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>FileSystemWatcher.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDir&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QFileInfo&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;qDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"FileSystemWatcher.h"</span></span></span><br><span class="line">​</span><br><span class="line">FileSystemWatcher *FileSystemWatcher::m_pInstance = <span class="literal">NULL</span>;</span><br><span class="line">​</span><br><span class="line">FileSystemWatcher::FileSystemWatcher ( QObject *parent ) : QObject ( parent ) &#123;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> FileSystemWatcher::addWatchPath ( QString path ) &#123; <span class="comment">/* 监控文件或目录 */</span></span><br><span class="line">    qDebug() &lt;&lt; QString ( <span class="string">"Add to watch: %1"</span> ).arg ( path );</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( m_pInstance == <span class="literal">NULL</span> ) &#123;</span><br><span class="line">        m_pInstance = <span class="keyword">new</span> FileSystemWatcher();</span><br><span class="line">        m_pInstance-&gt;m_pSystemWatcher = <span class="keyword">new</span> QFileSystemWatcher();</span><br><span class="line">        <span class="comment">/* 连接QFileSystemWatcher的directoryChanged和fileChanged信号到相应的槽 */</span></span><br><span class="line">        connect ( m_pInstance-&gt;m_pSystemWatcher, SIGNAL ( directoryChanged ( QString ) ), \</span><br><span class="line">                  m_pInstance, SLOT ( directoryUpdated ( QString ) ) );</span><br><span class="line">        connect ( m_pInstance-&gt;m_pSystemWatcher, SIGNAL ( fileChanged ( QString ) ), \</span><br><span class="line">                  m_pInstance, SLOT ( fileUpdated ( QString ) ) );</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    m_pInstance-&gt;m_pSystemWatcher-&gt;addPath ( path ); <span class="comment">/* 添加监控路径 */</span></span><br><span class="line">    <span class="function">QFileInfo <span class="title">file</span> <span class="params">( path )</span></span>; <span class="comment">/* 如果添加路径是一个目录，保存当前内容列表 */</span></span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( file.isDir() ) &#123;</span><br><span class="line">        <span class="function"><span class="keyword">const</span> QDir <span class="title">dirw</span> <span class="params">( path )</span></span>;</span><br><span class="line">        m_pInstance-&gt;m_currentContentsMap[path] = \</span><br><span class="line">            dirw.entryList ( QDir::NoDotAndDotDot | QDir::AllDirs | QDir::Files, QDir::DirsFirst );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="comment">/* 只要任何监控的目录更新(添加、删除、重命名)，就会调用 */</span></span><br><span class="line"><span class="keyword">void</span> FileSystemWatcher::directoryUpdated ( <span class="keyword">const</span> QString &amp;path ) &#123;</span><br><span class="line">    qDebug() &lt;&lt; QString ( <span class="string">"Directory updated: %1"</span> ).arg ( path );</span><br><span class="line">    <span class="comment">/* 比较最新的内容和保存的内容找出区别(变化) */</span></span><br><span class="line">    QStringList currEntryList = m_currentContentsMap[path];</span><br><span class="line">    <span class="function"><span class="keyword">const</span> QDir <span class="title">dir</span> <span class="params">( path )</span></span>;</span><br><span class="line">    QStringList newEntryList = \</span><br><span class="line">        dir.entryList ( QDir::NoDotAndDotDot  | QDir::AllDirs | QDir::Files, QDir::DirsFirst );</span><br><span class="line">    QSet&lt;QString&gt; newDirSet = QSet&lt;QString&gt;::fromList ( newEntryList );</span><br><span class="line">    QSet&lt;QString&gt; currentDirSet = QSet&lt;QString&gt;::fromList ( currEntryList );</span><br><span class="line">    <span class="comment">/* 添加了文件 */</span></span><br><span class="line">    QSet&lt;QString&gt; newFiles = newDirSet - currentDirSet;</span><br><span class="line">    QStringList newFile = newFiles.toList();</span><br><span class="line">    <span class="comment">/* 文件已被移除 */</span></span><br><span class="line">    QSet&lt;QString&gt; deletedFiles = currentDirSet - newDirSet;</span><br><span class="line">    QStringList deleteFile = deletedFiles.toList();</span><br><span class="line">    <span class="comment">/* 更新当前设置 */</span></span><br><span class="line">    m_currentContentsMap[path] = newEntryList;</span><br><span class="line">​</span><br><span class="line">    <span class="keyword">if</span> ( !newFile.isEmpty() &amp;&amp; !deleteFile.isEmpty() ) &#123;</span><br><span class="line">        <span class="comment">/* 文件/目录重命名 */</span></span><br><span class="line">        <span class="keyword">if</span> ( ( newFile.count() == <span class="number">1</span> ) &amp;&amp; ( deleteFile.count() == <span class="number">1</span> ) ) &#123;</span><br><span class="line">            qDebug() &lt;&lt; QString ( <span class="string">"File Renamed from %1 to %2"</span> ).arg (</span><br><span class="line">                deleteFile.first() ).arg ( newFile.first() );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">/* 添加新文件/目录至Dir */</span></span><br><span class="line">        <span class="keyword">if</span> ( !newFile.isEmpty() ) &#123;</span><br><span class="line">            qDebug() &lt;&lt; <span class="string">"New Files/Dirs added: "</span> &lt;&lt; newFile;</span><br><span class="line">​</span><br><span class="line">            foreach ( QString file, newFile ) &#123;</span><br><span class="line">                <span class="comment">/* 处理操作每个新文件 */</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">​</span><br><span class="line">        <span class="comment">/* 从Dir中删除文件/目录 */</span></span><br><span class="line">        <span class="keyword">if</span> ( !deleteFile.isEmpty() ) &#123;</span><br><span class="line">            qDebug() &lt;&lt; <span class="string">"Files/Dirs deleted: "</span> &lt;&lt; deleteFile;</span><br><span class="line">​</span><br><span class="line">            foreach ( QString file, deleteFile ) &#123;</span><br><span class="line">                <span class="comment">/* 处理操作每个被删除的文件 */</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> FileSystemWatcher::fileUpdated ( <span class="keyword">const</span> QString &amp;path ) &#123; <span class="comment">/* 文件修改时调用 */</span></span><br><span class="line">    <span class="function">QFileInfo <span class="title">file</span> <span class="params">( path )</span></span>;</span><br><span class="line">    QString strPath = file.absolutePath();</span><br><span class="line">    QString strName = file.fileName();</span><br><span class="line">    qDebug() &lt;&lt; QString ( <span class="string">"The file %1 at path %2 is updated"</span> ).arg ( strName ).arg ( strPath );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"FileSystemWatcher.h"</span></span></span><br><span class="line">​</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[] )</span> </span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span> <span class="params">( argc, argv )</span></span>;</span><br><span class="line">    FileSystemWatcher::addWatchPath ( <span class="string">"E:/Test"</span> );</span><br><span class="line">    <span class="keyword">return</span> a.exec();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/24/Qt语法详解/QStringList用法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/24/Qt语法详解/QStringList用法/" itemprop="url">QStringList用法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-24T13:25:08+08:00">
                2019-01-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>QStringList</code>类提供了一个字符串列表，从<code>QList &lt;QString&gt;</code>继承而来，它提供快速索引为基础的接入以及快速插入和清除。其成员函数用于操作这个字符串列表，例如<code>append</code>、<code>insert</code>、<code>replace</code>、<code>removeAll</code>、<code>removeAt</code>、<code>removeFirst</code>、<code>removeLast</code>和<code>removeOne</code>(这些函数只能用来清除<code>QStringList</code>中的某一个元素)等。<br>&emsp;&emsp;增加字符串可以使用<code>append</code>或者<code>&lt;&lt;</code>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QStringList fonts;</span><br><span class="line"><span class="comment">/* fonts is ["Arial", "Helvetica", "Times", "Courier"] */</span></span><br><span class="line">fonts &lt;&lt; <span class="string">"Arial"</span> &lt;&lt; <span class="string">"Helvetica"</span> &lt;&lt; <span class="string">"Times"</span> &lt;&lt; <span class="string">"Courier"</span>;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;合并字符串使用<code>join</code>：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* str is "Arial,Helvetica,Times,Courier" */</span></span><br><span class="line">QString str = fonts.join ( <span class="string">","</span> );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;拆分字符串：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QString str = <span class="string">"Arial,Helvetica,Times,Courier"</span>;</span><br><span class="line"><span class="comment">/* list is ["Arial", "Helvetica", "Times", "Courier"] */</span></span><br><span class="line">QStringList <span class="built_in">list</span> = str.split ( <span class="string">","</span> );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>IndexOf</code>函数返回给定字符串的第一个出现的索引，而<code>lastIndexOf</code>函数返回字符串的最后一次出现的索引。<br>&emsp;&emsp;替换字符串：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">QStringList files;</span><br><span class="line">files &lt;&lt; <span class="string">"$QTDIR/src/moc/moc.y"</span></span><br><span class="line">      &lt;&lt; <span class="string">"$QTDIR/src/moc/moc.l"</span></span><br><span class="line">      &lt;&lt; <span class="string">"$QTDIR/include/qconfig.h"</span>;</span><br><span class="line"><span class="comment">/* files is ["/usr/lib/qt/src/moc/moc.y", ...] */</span></span><br><span class="line">files.replaceInStrings ( <span class="string">"$QTDIR"</span>, <span class="string">"/usr/lib/qt"</span> );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;过滤字符串：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QStringList <span class="built_in">list</span>;</span><br><span class="line"><span class="built_in">list</span> &lt;&lt; "Bill Murray" &lt;&lt; "John Doe" &lt;&lt; "Bill Clinton";</span><br><span class="line">QStringList result;</span><br><span class="line">/* result is ["Bill Murray", "Bill Clinton"] */</span><br><span class="line">result = <span class="built_in">list</span>.filter ( "Bill" );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;打印<code>QStringList</code>每一个元素的方法：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">QString str = <span class="string">"1,2,3,4,5,6,7,8,9"</span>;</span><br><span class="line">QStringList strList;</span><br><span class="line">​</span><br><span class="line">strList = str.split ( <span class="string">","</span> );</span><br><span class="line">​</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"String list item count: "</span> &lt;&lt; strList.size() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; strList.size(); i++ ) &#123;</span><br><span class="line">    <span class="comment">/* 或者“cout &lt;&lt; strList[i] &lt;&lt; endl;” */</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; strList.at ( i ).toLocal8Bit().constData() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;清空<code>QStringList</code>变量中所有元素的方法：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QStringList <span class="built_in">list</span>;</span><br><span class="line"><span class="built_in">list</span> &lt;&lt; "a" &lt;&lt; "b";</span><br><span class="line"><span class="built_in">list</span>.clear(); /* 清空 */</span><br><span class="line"><span class="built_in">list</span> = QStringList(); /* 清空 */</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/23/Qt语法详解/Qt之QTableWidgetItem/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/23/Qt语法详解/Qt之QTableWidgetItem/" itemprop="url">Qt之QTableWidgetItem</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-23T20:59:30+08:00">
                2019-01-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;The <code>QTableWidgetItem</code> class provides an item for use with the <code>QTableWidget</code> class. The header file is <code>QTableWidgetItem</code>.</p>
<h3 id="Public-Functions"><a href="#Public-Functions" class="headerlink" title="Public Functions"></a>Public Functions</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Return</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><code>QTableWidgetItem(int type = Type)</code></td>
</tr>
<tr>
<td></td>
<td><code>QTableWidgetItem(const QString &amp; text, int type = Type)</code></td>
</tr>
<tr>
<td></td>
<td><code>QTableWidgetItem(const QIcon &amp; icon, const QString &amp; text, int type = Type)</code></td>
</tr>
<tr>
<td></td>
<td><code>QTableWidgetItem(const QTableWidgetItem &amp; other)</code></td>
</tr>
<tr>
<td><code>virtual</code></td>
<td><code>~QTableWidgetItem()</code></td>
</tr>
<tr>
<td><code>QBrush</code></td>
<td><code>background() const</code></td>
</tr>
<tr>
<td><code>Qt::CheckState</code></td>
<td><code>checkState() const</code></td>
</tr>
<tr>
<td><code>virtual QTableWidgetItem *</code></td>
<td><code>clone() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>column() const</code></td>
</tr>
<tr>
<td><code>virtual QVariant</code></td>
<td><code>data(int role) const</code></td>
</tr>
<tr>
<td><code>Qt::ItemFlags</code></td>
<td><code>flags() const</code></td>
</tr>
<tr>
<td><code>QFont</code></td>
<td><code>font() const</code></td>
</tr>
<tr>
<td><code>QBrush</code></td>
<td><code>foreground() const</code></td>
</tr>
<tr>
<td><code>QIcon</code></td>
<td><code>icon() const</code></td>
</tr>
<tr>
<td><code>bool</code></td>
<td><code>isSelected() const</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>read(QDataStream &amp; in)</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>row() const</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setBackground(const QBrush &amp; brush)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setCheckState(Qt::CheckState state)</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>setData(int role, const QVariant &amp; value)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setFlags(Qt::ItemFlags flags)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setFont(const QFont &amp; font)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setForeground(const QBrush &amp; brush)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setIcon(const QIcon &amp; icon)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setSelected(bool select)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setSizeHint(const QSize &amp; size)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setStatusTip(const QString &amp; statusTip)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setText(const QString &amp; text)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setTextAlignment(int alignment)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setToolTip(const QString &amp; toolTip)</code></td>
</tr>
<tr>
<td><code>void</code></td>
<td><code>setWhatsThis(const QString &amp; whatsThis)</code></td>
</tr>
<tr>
<td><code>QSize</code></td>
<td><code>sizeHint() const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>statusTip() const</code></td>
</tr>
<tr>
<td><code>QTableWidget *</code></td>
<td><code>tableWidget() const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>text() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>textAlignment() const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>toolTip() const</code></td>
</tr>
<tr>
<td><code>int</code></td>
<td><code>type() const</code></td>
</tr>
<tr>
<td><code>QString</code></td>
<td><code>whatsThis() const</code></td>
</tr>
<tr>
<td><code>virtual void</code></td>
<td><code>write(QDataStream &amp; out) const</code></td>
</tr>
<tr>
<td><code>virtual bool</code></td>
<td><code>operator&lt;(const QTableWidgetItem &amp; other) const</code></td>
</tr>
<tr>
<td><code>QTableWidgetItem &amp;</code></td>
<td><code>operator=(const QTableWidgetItem &amp; other)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Related-Non-Members"><a href="#Related-Non-Members" class="headerlink" title="Related Non-Members"></a>Related Non-Members</h3><ul>
<li><code>QDataStream &amp; operator&lt;&lt;(QDataStream &amp; out, const QTableWidgetItem &amp; item)</code></li>
<li><code>QDataStream &amp; operator&gt;&gt;(QDataStream &amp; in, QTableWidgetItem &amp; item)</code></li>
</ul>
<h3 id="Detailed-Description"><a href="#Detailed-Description" class="headerlink" title="Detailed Description"></a>Detailed Description</h3><p>&emsp;&emsp;The <code>QTableWidgetItem</code> class provides an item for use with the <code>QTableWidget</code> class.<br>&emsp;&emsp;Table items are used to hold pieces of information for table widgets. Items usually contain <code>text</code>, <code>icons</code>, or <code>checkboxes</code>.<br>&emsp;&emsp;The <code>QTableWidgetItem</code> class is a convenience class that replaces the <code>QTableItem</code> class in <code>Qt 3</code>. It provides an item for use with the <code>QTableWidget</code> class.<br>&emsp;&emsp;<code>Top-level</code> items are constructed without a parent then inserted at the position specified by a pair of row and column numbers:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QTableWidgetItem *newItem = <span class="keyword">new</span> QTableWidgetItem (</span><br><span class="line">    tr ( <span class="string">"%1"</span> ).arg ( <span class="built_in">pow</span> ( row, column + <span class="number">1</span> ) ) );</span><br><span class="line">tableWidget-&gt;setItem ( row, column, newItem );</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;Each item can have its own background brush which is set with the <code>setBackground()</code> function. The current background brush can be found with <code>background()</code>. The text label for each item can be rendered with its own font and brush. These are specified with the <code>setFont()</code> and <code>setForeground()</code> functions, and read with <code>font()</code> and <code>foreground()</code>.<br>&emsp;&emsp;By default, items are enabled, editable, selectable, checkable, and can be used both as the source of a drag and drop operation and as a drop target. Each item’s flags can be changed by calling <code>setFlags()</code> with the appropriate value. Checkable items can be checked and unchecked with the <code>setCheckState()</code> function. The corresponding <code>checkState()</code> function indicates whether the item is currently checked.</p>
<h3 id="Subclassing"><a href="#Subclassing" class="headerlink" title="Subclassing"></a>Subclassing</h3><p>&emsp;&emsp;When subclassing <code>QTableWidgetItem</code> to provide custom items, it is possible to define new types for them so that they can be distinguished from standard items. The constructors for subclasses that require this feature need to call the base class constructor with a new type value equal to or greater than <code>UserType</code>.</p>
<h3 id="Member-Type-Documentation"><a href="#Member-Type-Documentation" class="headerlink" title="Member Type Documentation"></a>Member Type Documentation</h3><ul>
<li>enum <code>QTableWidgetItem::ItemType</code>: This enum describes the types that are used to describe table widget items.</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>Constant</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>QTableWidgetItem::Type</code></td>
<td><code>0</code></td>
<td>The default type for table widget items.</td>
</tr>
<tr>
<td><code>QTableWidgetItem::UserType</code></td>
<td><code>1000</code></td>
<td>The minimum value for custom types. Values below <code>UserType</code> are reserved by <code>Qt</code>.</td>
</tr>
</tbody>
</table>
</div>
<p>You can define new user types in <code>QTableWidgetItem</code> subclasses to ensure that custom items are treated specially.</p>
<h3 id="Member-Function-Documentation"><a href="#Member-Function-Documentation" class="headerlink" title="Member Function Documentation"></a>Member Function Documentation</h3><ul>
<li><code>QTableWidgetItem::QTableWidgetItem(int type = Type)</code>: Constructs a table item of the specified <code>type</code> that does not belong to any table.</li>
<li><code>QTableWidgetItem::QTableWidgetItem(const QString &amp; text, int type = Type)</code>: Constructs a table item with the given <code>text</code>.</li>
<li><code>QTableWidgetItem::QTableWidgetItem(const QIcon &amp; icon, const QString &amp; text, int type = Type)</code>: Constructs a table item with the given <code>icon</code> and <code>text</code>.</li>
<li><code>QTableWidgetItem::QTableWidgetItem(const QTableWidgetItem &amp; other)</code>: Constructs a copy of <code>other</code>. Note that <code>type()</code> and <code>tableWidget()</code> are not copied. This function is useful when reimplementing <code>clone()</code>.</li>
<li><code>QTableWidgetItem::~QTableWidgetItem() [virtual]</code>: Destroys the table item.</li>
<li><code>QBrush QTableWidgetItem::background() const</code>: Returns the brush used to render the item’s background.</li>
<li><code>Qt::CheckState QTableWidgetItem::checkState() const</code>: Returns the checked state of the table item.</li>
<li><code>QTableWidgetItem * QTableWidgetItem::clone() const [virtual]</code>: Creates a copy of the item.</li>
<li><code>int QTableWidgetItem::column() const</code>: Returns the column of the item in the table. If the item is not in a table, this function will return <code>-1</code>.</li>
<li><code>QVariant QTableWidgetItem::data(int role) const [virtual]</code> — Returns the item’s data for the given <code>role</code>.</li>
<li><code>Qt::ItemFlags QTableWidgetItem::flags() const</code>: Returns the flags used to describe the item. These determine whether the item can be checked, edited, and selected.</li>
<li><code>QFont QTableWidgetItem::font() const</code>: Returns the font used to render the item’s text.</li>
<li><code>QBrush QTableWidgetItem::foreground() const</code>: Returns the brush used to render the item’s foreground (e.g. text).</li>
<li><code>QIcon QTableWidgetItem::icon() const</code>: Returns the item’s icon.</li>
<li><code>bool QTableWidgetItem::isSelected() const</code>: Returns <code>true</code> if the item is selected, otherwise returns <code>false</code>.</li>
<li><code>void QTableWidgetItem::read(QDataStream &amp; in) [virtual]</code>: Reads the item from stream <code>in</code>.</li>
<li><code>int QTableWidgetItem::row() const</code>: Returns the row of the item in the table. If the item is not in a table, this function will return <code>-1</code>.</li>
<li><code>void QTableWidgetItem::setBackground(const QBrush &amp; brush)</code>: Sets the item’s background <code>brush</code> to the specified <code>brush</code>.</li>
<li><code>void QTableWidgetItem::setCheckState(Qt::CheckState state)</code>: Sets the check <code>state</code> of the table item to be <code>state</code>.</li>
<li><code>void QTableWidgetItem::setData(int role, const QVariant &amp; value) [virtual]</code>: Sets the item’s data for the given role to the specified <code>value</code>.</li>
<li><code>void QTableWidgetItem::setFlags(Qt::ItemFlags flags)</code>: Sets the <code>flags</code> for the item to the given <code>flags</code>. These determine whether the item can be selected or modified.</li>
<li><code>void QTableWidgetItem::setFont(const QFont &amp; font)</code>: Sets the <code>font</code> used to display the item’s text to the given <code>font</code>.</li>
<li><code>void QTableWidgetItem::setForeground(const QBrush &amp; brush)</code>: Sets the item’s foreground <code>brush</code> to the specified <code>brush</code>.</li>
<li><code>void QTableWidgetItem::setIcon(const QIcon &amp; icon)</code>: Sets the item’s <code>icon</code> to the <code>icon</code> specified.</li>
<li><code>void QTableWidgetItem::setSelected(bool select)</code>: Sets the selected state of the item to <code>select</code>.</li>
<li><code>void QTableWidgetItem::setSizeHint(const QSize &amp; size)</code> — Sets the <code>size</code> hint for the table item to be size. If no <code>size</code> hint is set, the item delegate will compute the <code>size</code> hint based on the item data.</li>
<li><code>void QTableWidgetItem::setStatusTip(const QString &amp; statusTip)</code>: Sets the status tip for the table item to the text specified by <code>statusTip</code>. <code>QTableWidget</code> mouse tracking needs to be enabled for this feature to work.</li>
<li><code>void QTableWidgetItem::setText(const QString &amp; text)</code>: Sets the item’s <code>text</code> to the <code>text</code> specified.</li>
<li><code>void QTableWidgetItem::setTextAlignment(int alignment)</code>: Sets the text <code>alignment</code> for the item’s text to the alignment specified.</li>
<li><code>void QTableWidgetItem::setToolTip(const QString &amp; toolTip)</code>: Sets the item’s tooltip to the string specified by <code>toolTip</code>.</li>
<li><code>void QTableWidgetItem::setWhatsThis(const QString &amp; whatsThis)</code>: Sets the item’s <code>What&#39;s This?</code> help to the string specified by <code>whatsThis</code>.</li>
<li><code>QSize QTableWidgetItem::sizeHint() const</code>: Returns the size hint set for the table item.</li>
<li><code>QString QTableWidgetItem::statusTip() const</code>: Returns the item’s status tip.</li>
<li><code>QTableWidget * QTableWidgetItem::tableWidget() const</code>: Returns the table widget that contains the item.</li>
<li><code>QString QTableWidgetItem::text() const</code>: Returns the item’s text.</li>
<li><code>int QTableWidgetItem::textAlignment() const</code>: Returns the text alignment for the item’s text.</li>
<li><code>QString QTableWidgetItem::toolTip() const</code>: Returns the item’s tooltip.</li>
<li><code>int QTableWidgetItem::type() const</code>: Returns the type passed to the <code>QTableWidgetItem</code> constructor.</li>
<li><code>QString QTableWidgetItem::whatsThis() const</code>: Returns the item’s <code>What&#39;s This?</code> help.</li>
<li><code>void QTableWidgetItem::write(QDataStream &amp; out) const [virtual]</code>: Writes the item to stream <code>out</code>.</li>
<li><code>bool QTableWidgetItem::operator&lt;(const QTableWidgetItem &amp; other) const [virtual]</code>: Returns <code>true</code> if the item is less than the <code>other</code> item; otherwise returns <code>false</code>.</li>
<li><code>QTableWidgetItem &amp; QTableWidgetItem::operator=(const QTableWidgetItem &amp; other)</code>: Assigns <code>other&#39;s</code> data and flags to this item. Note that <code>type()</code> and <code>tableWidget()</code> are not copied. This function is useful when reimplementing <code>clone()</code>.</li>
</ul>
<h3 id="Related-Non-Members-1"><a href="#Related-Non-Members-1" class="headerlink" title="Related Non-Members"></a>Related Non-Members</h3><ul>
<li><code>QDataStream &amp; operator&lt;&lt;(QDataStream &amp; out, const QTableWidgetItem &amp; item)</code>: Writes the table widget item item to stream out. This operator uses <code>QTableWidgetItem::write()</code>.</li>
<li><code>QDataStream &amp; operator&gt;&gt;(QDataStream &amp; in, QTableWidgetItem &amp; item)</code>: Reads a table widget item from stream in into item. This operator uses <code>QTableWidgetItem::read()</code>.</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/01/23/Qt语法详解/Qt之定时器/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/23/Qt语法详解/Qt之定时器/" itemprop="url">Qt之定时器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-23T20:44:20+08:00">
                2019-01-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt语法详解/" itemprop="url" rel="index">
                    <span itemprop="name">Qt语法详解</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&emsp;&emsp;<code>Qt</code>使用定时器有两种方法，一种是使用<code>QObiect</code>类的定时器，一种是使用<code>QTimer</code>类。定时器的精确性依赖于操作系统和硬件，大多数平台支持<code>20ms</code>的精确度。</p>
<h3 id="QObject类的定时器"><a href="#QObject类的定时器" class="headerlink" title="QObject类的定时器"></a>QObject类的定时器</h3><p>&emsp;&emsp;<code>QObject</code>是所有<code>Qt</code>对象的基类，它提供了一个基本的定时器。通过<code>QObject::startTimer</code>，可以把一个一毫秒为单位的时间间隔作为参数来开始定时器，这个函数返回一个唯一的整数定时器的标识符。这个定时器开始就会在每一个时间间隔<code>触发</code>，直到明确地使用这个定时器的标识符来调用<code>QObject::killTimer</code>结束。当定时器触发时，应用程序会发送一个<code>QTimerEvent</code>。在事件循环中，处理器按照事件队列的顺序来处理定时器事件。当处理器正忙于其它事件处理时，定时器就不能立即处理。<br>&emsp;&emsp;<code>QObject</code>类还提供定时期的功能。与定时器相关的成员函数有<code>startTimer</code>、<code>timeEvent</code>、<code>killTimer</code>。<code>startTimer</code>原型如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">intQObject::startTimer ( <span class="keyword">int</span> interval );</span><br></pre></td></tr></table></figure>
<p>开始一个定时器并返回定时器<code>ID</code>，如果不能开始一个定时器，将返回<code>0</code>。定时器开始后，每隔<code>interval</code>毫秒间隔将触发一次超时事件，直到<code>killTimer</code>被调用来删除定时器。如果<code>interval</code>为<code>0</code>，那么定时器事件每次发生时没有窗口系统事件处理。<br>&emsp;&emsp;虚函数<code>timerEvent</code>被重载来实现用户的超时事件处理函数。如果有多个定时器在运行，<code>QTimerEvent::timerId</code>被用来查找指定定时器，对其进行操作。当定时器事件发生时，虚函数<code>timerEvent</code>随着<code>QTimerEvent</code>事件参数类一起被调用，重载这个函数可以获得定时器事件。定时器的用法如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 头文件 */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QNewObject</span> :</span> publicQObject &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    QNewObject ( QObject *parent = <span class="number">0</span> );</span><br><span class="line">    <span class="keyword">virtual</span> ~QNewObject();</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">timerEvent</span> <span class="params">( QTimerEvent *event )</span></span>;</span><br><span class="line">    <span class="keyword">int</span> m_nTimerId;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="comment">/* 源文件 */</span></span><br><span class="line">QNewObject::QNewObject ( QObject *parent ) : QNewObject ( parent ) &#123;</span><br><span class="line">    m_nTimerId = startTimer ( <span class="number">1000</span> );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">QNewObject::~QNewObject() &#123;</span><br><span class="line">    <span class="keyword">if</span> ( m_nTimerId != <span class="number">0</span> ) &#123;</span><br><span class="line">        killTimer ( m_nTimerId );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">voidQNewObject::timerEvent ( QTimerEvent *event ) &#123;</span><br><span class="line">    qDebug ( <span class="string">"timer event, id %d"</span>, event-&gt;timerId() );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="定时器类QTimer"><a href="#定时器类QTimer" class="headerlink" title="定时器类QTimer"></a>定时器类QTimer</h3><p>&emsp;&emsp;定时器类<code>QTimer</code>提供当定时器触发的时候发射一个信号的定时器，它提供只触发一次的超时事件，通常的使用方法如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">QTimer *testTimer = newQTimer ( <span class="keyword">this</span> ); <span class="comment">/* 创建定时器 */</span></span><br><span class="line"><span class="comment">/* 将定时器超时信号与槽(功能函数)联系起来 */</span></span><br><span class="line">connect ( testTimer, SIGNAL ( timeout() ), <span class="keyword">this</span>, SLOT ( testFunction() ) );</span><br><span class="line">testTimer-&gt;start ( <span class="number">1000</span> ); <span class="comment">/* 开始运行定时器，定时时间间隔为1000ms */</span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">if</span> ( testTimer-&gt;isActive() ) &#123; <span class="comment">/* 停止运行定时器 */</span></span><br><span class="line">    testTimer-&gt;stop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>QTimer</code>还提供了一个简单的只有一次定时的函数<code>singleShot</code>。 一个定时器在<code>100ms</code>后触发处理函数<code>animateTimeout</code>并且只触发一次。代码如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QTimer::singleShot ( <span class="number">100</span>, <span class="keyword">this</span>, SLOT ( animateTimeout() ) );</span><br></pre></td></tr></table></figure>
<pre><code>widget.h如下所示：
</code></pre><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> WIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WIDGET_H</span></span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QWidget&gt;</span></span></span><br><span class="line">​</span><br><span class="line"><span class="keyword">namespace</span> Ui &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Widget</span>;</span></span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> :</span> <span class="keyword">public</span> QWidget &#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line">​</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Widget</span> <span class="params">( QWidget *parent = <span class="number">0</span> )</span></span>;</span><br><span class="line">    ~Widget();</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">timerEvent</span> <span class="params">( QTimerEvent *event )</span></span>;</span><br><span class="line"><span class="keyword">private</span> slots:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">timerUpdate</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Ui::Widget *ui;</span><br><span class="line">    <span class="keyword">int</span> id1, id2, id3;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// WIDGET_H</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>widget.cpp</code>如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"widget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"ui_widget.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QTimer&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;QTime&gt;</span></span></span><br><span class="line">​</span><br><span class="line">Widget::Widget ( QWidget *parent ) : QWidget ( parent ), ui ( <span class="keyword">new</span> Ui::Widget ) &#123;</span><br><span class="line">    ui-&gt;setupUi ( <span class="keyword">this</span> );</span><br><span class="line">    <span class="comment">/* 开启一个1秒定时器，返回其ID */</span></span><br><span class="line">    id1 = startTimer ( <span class="number">1000</span> );</span><br><span class="line">    id2 = startTimer ( <span class="number">2000</span> );</span><br><span class="line">    id3 = startTimer ( <span class="number">3000</span> );</span><br><span class="line">    QTimer *timer = <span class="keyword">new</span> QTimer ( <span class="keyword">this</span> ); <span class="comment">/* 创建一个新的定时器 */</span></span><br><span class="line">    <span class="comment">/* 关联定时器的溢出信号到我们的槽函数上 */</span></span><br><span class="line">    connect ( timer, SIGNAL ( timeout() ), <span class="keyword">this</span>, SLOT ( timerUpdate() ) );</span><br><span class="line">    timer-&gt;start ( <span class="number">1000</span> ); <span class="comment">/* 设置溢出时间为1秒，并启动定时器 */</span></span><br><span class="line">    <span class="comment">/* 为随机数设置初值 */</span></span><br><span class="line">    qsrand ( QTime ( <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span> ).secsTo ( QTime::currentTime() ) );</span><br><span class="line">    <span class="comment">/* singleShot函数用来开启一个只运行一次的定时器。该代码的作用是让程序运行10秒后自动关闭。*/</span></span><br><span class="line">    QTimer::singleShot ( <span class="number">10000</span>, <span class="keyword">this</span>, SLOT ( close() ) );</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line">Widget::~Widget() &#123;</span><br><span class="line">    <span class="keyword">delete</span> ui;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="keyword">void</span> Widget::timerEvent ( QTimerEvent *event ) &#123;</span><br><span class="line">    <span class="comment">/* 判断是哪个定时器 */</span></span><br><span class="line">    <span class="keyword">if</span> ( event-&gt;timerId() == id1 ) &#123;</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"timer1"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( event-&gt;timerId() == id2 ) &#123;</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"timer2"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        qDebug() &lt;&lt; <span class="string">"timer3"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">​</span><br><span class="line"><span class="comment">/* 定时器溢出处理 */</span></span><br><span class="line"><span class="keyword">void</span> Widget::timerUpdate() &#123;</span><br><span class="line">    QTime time = QTime::currentTime(); <span class="comment">/* 获取当前时间 */</span></span><br><span class="line">    QString text = time.toString ( <span class="string">"hh:mm"</span> ); <span class="comment">/* 转换为字符串 */</span></span><br><span class="line">​</span><br><span class="line">    <span class="comment">/* 注意单引号间要输入一个空格。每隔一秒就将“:”显示为空格 */</span></span><br><span class="line">    <span class="keyword">if</span> ( ( time.second() % <span class="number">2</span> ) == <span class="number">0</span> ) &#123;</span><br><span class="line">        text[<span class="number">2</span>] = <span class="string">' '</span>;</span><br><span class="line">    &#125;</span><br><span class="line">​</span><br><span class="line">    ui-&gt;lcdNumber-&gt;display ( text );</span><br><span class="line">    <span class="keyword">int</span> rand = qrand() % <span class="number">300</span>; <span class="comment">/* 产生300以内的正整数 */</span></span><br><span class="line">    ui-&gt;lcdNumber-&gt;move ( rand, rand );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/47/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/47/">47</a><span class="page-number current">48</span><a class="page-number" href="/page/49/">49</a><span class="space">&hellip;</span><a class="page-number" href="/page/94/">94</a><a class="extend next" rel="next" href="/page/49/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">付康为</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">939</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">付康为</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
