<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="&amp;emsp;&amp;emsp;逗号分隔值(Comma Separated Values，有时也称为字符分隔值，因为分隔字符也可以不是逗号)，其文件以纯文本形式存储表格数据(数字和文本)。CSV文件由任意数目的记录组成，记录间以某种换行符分隔；每条记录由字段组成，字段间的分隔符是其它字符或字符串，最常见的是逗号或制表符。通常，所有记录都有完全相同的字段序列。&amp;emsp;&amp;emsp;每条记录占一行，以逗号为">
<meta property="og:type" content="article">
<meta property="og:title" content="csv模块">
<meta property="og:url" content="http://fukangwei.gitee.io/2019/02/24/Python语法/csv模块/index.html">
<meta property="og:site_name" content="暴徒">
<meta property="og:description" content="&amp;emsp;&amp;emsp;逗号分隔值(Comma Separated Values，有时也称为字符分隔值，因为分隔字符也可以不是逗号)，其文件以纯文本形式存储表格数据(数字和文本)。CSV文件由任意数目的记录组成，记录间以某种换行符分隔；每条记录由字段组成，字段间的分隔符是其它字符或字符串，最常见的是逗号或制表符。通常，所有记录都有完全相同的字段序列。&amp;emsp;&amp;emsp;每条记录占一行，以逗号为">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-03-30T00:49:15.928Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="csv模块">
<meta name="twitter:description" content="&amp;emsp;&amp;emsp;逗号分隔值(Comma Separated Values，有时也称为字符分隔值，因为分隔字符也可以不是逗号)，其文件以纯文本形式存储表格数据(数字和文本)。CSV文件由任意数目的记录组成，记录间以某种换行符分隔；每条记录由字段组成，字段间的分隔符是其它字符或字符串，最常见的是逗号或制表符。通常，所有记录都有完全相同的字段序列。&amp;emsp;&amp;emsp;每条记录占一行，以逗号为">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '561O3H1PZB',
      apiKey: '7631d3cf19ac49bd39ada7163ec937a7',
      indexName: 'fuxinzi',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="http://fukangwei.gitee.io/2019/02/24/Python语法/csv模块/">





  <title>csv模块 | 暴徒</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">暴徒</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/24/Python语法/csv模块/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="暴徒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">csv模块</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-24T13:21:56+08:00">
                2019-02-24
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>&emsp;&emsp;逗号分隔值(<code>Comma Separated Values</code>，有时也称为<code>字符分隔值</code>，因为分隔字符也可以不是逗号)，其文件以纯文本形式存储表格数据(数字和文本)。<code>CSV</code>文件由任意数目的记录组成，记录间以某种换行符分隔；每条记录由字段组成，字段间的分隔符是其它字符或字符串，最常见的是逗号或制表符。通常，所有记录都有完全相同的字段序列。<br>&emsp;&emsp;每条记录占一行，以逗号为分隔符，逗号前后的空格会被忽略。如果字段中包含有逗号、换行符，该字段必须用双引号括起来；如果字段前后包含有空格，该字段必须用双引号括起来；字段中的双引号用两个双引号表示。第一条记录，可以是字段名。<br>&emsp;&emsp;有以下表格：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>年</th>
<th>制造商</th>
<th>型号</th>
<th>说明</th>
<th>价值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>1997</code></td>
<td><code>Ford</code></td>
<td><code>E350</code></td>
<td><code>ac, abs, moon</code></td>
<td><code>3000.00</code></td>
</tr>
<tr>
<td><code>1999</code></td>
<td><code>Chevy</code></td>
<td><code>Venture &quot;Extended Edition&quot;</code></td>
<td></td>
<td><code>4900.00</code></td>
</tr>
<tr>
<td><code>1999</code></td>
<td><code>Chevy</code></td>
<td><code>Venture &quot;Extended Edition, Very Large&quot;</code></td>
<td></td>
<td><code>5000.00</code></td>
</tr>
<tr>
<td><code>1996</code></td>
<td><code>Jeep</code></td>
<td><code>Grand Cherokee</code></td>
<td><code>MUST SELL!</code></td>
<td><code>4799.00</code></td>
</tr>
</tbody>
</table>
</div>
<p>上面表格内容若以<code>CSV</code>格式表示，就会像下列：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">年,制造商,型号,说明,价值</span><br><span class="line"><span class="number">1997</span>,Ford,E350,<span class="string">"ac, abs, moon"</span>,<span class="number">3000.00</span></span><br><span class="line"><span class="number">1999</span>,Chevy,<span class="string">"Venture "</span><span class="string">"Extended Edition"</span><span class="string">""</span>,<span class="string">""</span>,<span class="number">4900.00</span></span><br><span class="line"><span class="number">1999</span>,Chevy,<span class="string">"Venture "</span><span class="string">"Extended Edition, Very Large"</span><span class="string">""</span>,<span class="string">""</span>,<span class="number">5000.00</span></span><br><span class="line"><span class="number">1996</span>,Jeep,Grand Cherokee,<span class="string">"MUST SELL!"</span>,<span class="number">4799.00</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;The <code>so-called</code> <code>CSV</code> (<code>Comma Separated Values</code>) format is the most common import and export format for spreadsheets and databases. <code>CSV</code> format was used for many years prior to attempts to describe the format in a standardized way in <code>RFC 4180</code>. The lack of a <code>well-defined</code> standard means that subtle differences often exist in the data produced and consumed by different applications. These differences can make it annoying to process <code>CSV</code> files from multiple sources. Still, while the delimiters and quoting characters vary, the overall format is similar enough that it is possible to write a single module which can efficiently manipulate such data, hiding the details of reading and writing the data from the programmer.<br>&emsp;&emsp;The csv module implements classes to read and write tabular data in <code>CSV</code> format. It allows programmers to say, <code>write this data in the format preferred by Excel,</code> or <code>read data from this file which was generated by Excel,</code> without knowing the precise details of the <code>CSV</code> format used by <code>Excel</code>. Programmers can also describe the <code>CSV</code> formats understood by other applications or define their own <code>special-purpose</code> <code>CSV</code> formats.<br>&emsp;&emsp;The csv module’s reader and writer objects read and write sequences. Programmers can also read and write data in dictionary form using the <code>DictReader</code> and <code>DictWriter</code> classes.</p>
<h3 id="Module-Contents"><a href="#Module-Contents" class="headerlink" title="Module Contents"></a>Module Contents</h3><p>&emsp;&emsp;The csv module defines the following functions:</p>
<ul>
<li><code>csv.reader(csvfile, dialect=&#39;excel&#39;, **fmtparams)</code>: Return a reader object which will iterate over lines in the given <code>csvfile</code>. <code>csvfile</code> can be any object which supports the iterator protocol and returns a string each time its <code>__next__()</code> method is called: file objects and list objects are both suitable. If <code>csvfile</code> is a file object, it should be opened with <code>newline=&#39;&#39;</code>. An optional <code>dialect</code> parameter can be given which is used to define a set of parameters specific to a particular <code>CSV</code> <code>dialect</code>. It may be an instance of a subclass of the Dialect class or one of the strings returned by the <code>list_dialects()</code> function. The other optional <code>fmtparams</code> keyword arguments can be given to override individual formatting parameters in the current <code>dialect</code>.</li>
</ul>
<p>&emsp;&emsp;Each row read from the csv file is returned as a list of strings. No automatic data type conversion is performed unless the <code>QUOTE_NONNUMERIC</code> format option is specified (in which case unquoted fields are transformed into floats).<br>&emsp;&emsp;A short usage example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> csv</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> open(<span class="string">'eggs.csv'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line"><span class="meta">... </span>    spamreader = csv.reader(csvfile, delimiter=<span class="string">' '</span>, quotechar=<span class="string">'|'</span>)</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">for</span> row <span class="keyword">in</span> spamreader:</span><br><span class="line"><span class="meta">... </span>        print(<span class="string">', '</span>.join(row))</span><br><span class="line">Spam, Spam, Spam, Spam, Spam, Baked Beans</span><br><span class="line">Spam, Lovely Spam, Wonderful Spam</span><br></pre></td></tr></table></figure>
<ul>
<li><code>csv.writer(csvfile, dialect=&#39;excel&#39;, **fmtparams)</code>: Return a writer object responsible for converting the user’s data into delimited strings on the given <code>file-like</code> object. <code>csvfile</code> can be any object with a <code>write()</code> method. If <code>csvfile</code> is a file object, it should be opened with <code>newline=&#39;&#39;</code>. An optional <code>dialect</code> parameter can be given which is used to define a set of parameters specific to a particular <code>CSV</code> <code>dialect</code>. It may be an instance of a subclass of the <code>Dialect</code> class or one of the strings returned by the <code>list_dialects()</code> function. The other optional <code>fmtparams</code> keyword arguments can be given to override individual formatting parameters in the current <code>dialect</code>. To make it as easy as possible to interface with modules which implement the <code>DB API</code>, the value <code>None</code> is written as the empty string. While this isn’t a reversible transformation, it makes it easier to dump <code>SQL NULL</code> data values to <code>CSV</code> files without preprocessing the data returned from a <code>cursor.fetch*</code> call. All other <code>non-string</code> data are stringified with <code>str()</code> before being written.</li>
</ul>
<p>&emsp;&emsp;A short usage example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'eggs.csv'</span>, <span class="string">'w'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">    spamwriter = csv.writer(csvfile, delimiter=<span class="string">' '</span>, quotechar=<span class="string">'|'</span>, quoting=csv.QUOTE_MINIMAL)</span><br><span class="line">    spamwriter.writerow([<span class="string">'Spam'</span>] * <span class="number">5</span> + [<span class="string">'Baked Beans'</span>])</span><br><span class="line">    spamwriter.writerow([<span class="string">'Spam'</span>, <span class="string">'Lovely Spam'</span>, <span class="string">'Wonderful Spam'</span>])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>csv.register_dialect(name[, dialect[, **fmtparams]])</code>: Associate <code>dialect</code> with <code>name</code>. <code>name</code> must be a string. The <code>dialect</code> can be specified either by passing a <code>sub-class</code> of <code>Dialect</code>, or by <code>fmtparams</code> keyword arguments, or both, with keyword arguments overriding parameters of the <code>dialect</code>.</li>
<li><code>csv.unregister_dialect(name)</code>: Delete the dialect associated with <code>name</code> from the dialect registry. An <code>Error</code> is raised if <code>name</code> is not a registered dialect name.</li>
<li><code>csv.get_dialect(name)</code>: Return the dialect associated with <code>name</code>. An <code>Error</code> is raised if <code>name</code> is not a registered dialect name. This function returns an immutable <code>Dialect</code>.</li>
<li><code>csv.list_dialects()</code>: Return the names of all registered dialects.</li>
<li><code>csv.field_size_limit([new_limit])</code>: Returns the current maximum field size allowed by the parser. If <code>new_limit</code> is given, this becomes the new limit.</li>
</ul>
<p>&emsp;&emsp;The csv module defines the following classes:</p>
<ul>
<li><code>csv.DictReader(f, fieldnames=None, restkey=None, restval=None, dialect=&#39;excel&#39;, *args, **kwds):</code> Create an object that operates like a regular reader but maps the information in each row to an <code>OrderedDict</code> whose keys are given by the optional <code>fieldnames</code> parameter.</li>
</ul>
<p>&emsp;&emsp;The <code>fieldnames</code> parameter is a sequence. If <code>fieldnames</code> is omitted, the values in the first row of file <code>f</code> will be used as the <code>fieldnames</code>. Regardless of how the <code>fieldnames</code> are determined, the ordered dictionary preserves their original ordering.<br>&emsp;&emsp;If a row has more fields than <code>fieldnames</code>, the remaining data is put in a list and stored with the fieldname specified by <code>restkey</code> (which defaults to <code>None</code>). If a <code>non-blank</code> row has fewer fields than <code>fieldnames</code>, the missing values are <code>filled-in</code> with <code>None</code>.<br>&emsp;&emsp;All other optional or keyword arguments are passed to the underlying reader instance.<br>&emsp;&emsp;A short usage example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> csv</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> open(<span class="string">'names.csv'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line"><span class="meta">... </span>    reader = csv.DictReader(csvfile)</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line"><span class="meta">... </span>        print(row[<span class="string">'first_name'</span>], row[<span class="string">'last_name'</span>])</span><br><span class="line">...</span><br><span class="line">Eric Idle</span><br><span class="line">John Cleese</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(row)</span><br><span class="line">OrderedDict([(<span class="string">'first_name'</span>, <span class="string">'John'</span>), (<span class="string">'last_name'</span>, <span class="string">'Cleese'</span>)])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>class csv.DictWriter(f, fieldnames, restval=&#39;&#39;, extrasaction=&#39;raise&#39;, dialect=&#39;excel&#39;, *args, **kwds)</code>: Create an object which operates like a regular writer but maps dictionaries onto output rows. The <code>fieldnames</code> parameter is a sequence of keys that identify the order in which values in the dictionary passed to the <code>writerow()</code> method are written to file <code>f</code>. The optional <code>restval</code> parameter specifies the value to be written if the dictionary is missing a key in <code>fieldnames</code>. If the dictionary passed to the <code>writerow()</code> method contains a key not found in <code>fieldnames</code>, the optional <code>extrasaction</code> parameter indicates what action to take. If it is set to <code>raise</code>, the default value, a <code>ValueError</code> is raised. If it is set to <code>ignore</code>, extra values in the dictionary are ignored. Any other optional or keyword arguments are passed to the underlying writer instance.</li>
</ul>
<p>&emsp;&emsp;Note that unlike the <code>DictReader</code> class, the <code>fieldnames</code> parameter of the <code>DictWriter</code> is not optional. Since <code>Python&#39;s</code> dict objects are not ordered, there is not enough information available to deduce the order in which the row should be written to file <code>f</code>.<br>&emsp;&emsp;A short usage example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'names.csv'</span>, <span class="string">'w'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">    fieldnames = [<span class="string">'first_name'</span>, <span class="string">'last_name'</span>]</span><br><span class="line">    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)</span><br><span class="line">    writer.writeheader()</span><br><span class="line">    writer.writerow(&#123;<span class="string">'first_name'</span>: <span class="string">'Baked'</span>, <span class="string">'last_name'</span>: <span class="string">'Beans'</span>&#125;)</span><br><span class="line">    writer.writerow(&#123;<span class="string">'first_name'</span>: <span class="string">'Lovely'</span>, <span class="string">'last_name'</span>: <span class="string">'Spam'</span>&#125;)</span><br><span class="line">    writer.writerow(&#123;<span class="string">'first_name'</span>: <span class="string">'Wonderful'</span>, <span class="string">'last_name'</span>: <span class="string">'Spam'</span>&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>class csv.Dialect</code>: The <code>Dialect</code> class is a container class relied on primarily for its attributes, which are used to define the parameters for a specific reader or writer instance.</li>
<li><code>class csv.excel</code>: The excel class defines the usual properties of an <code>Excel-generated</code> <code>CSV</code> file. It is registered with the dialect name <code>excel</code>.</li>
<li><code>class csv.excel_tab</code>: The <code>excel_tab</code> class defines the usual properties of an <code>Excel-generated</code> <code>TAB-delimited</code> file. It is registered with the dialect name <code>excel-tab</code>.</li>
<li><code>class csv.unix_dialect</code>: The <code>unix_dialect</code> class defines the usual properties of a <code>CSV</code> file generated on <code>UNIX</code> systems, i.e. using <code>\n</code> as line terminator and quoting all fields. It is registered with the dialect name <code>unix</code>.</li>
<li><code>class csv.Sniffer</code>: The <code>Sniffer</code> class is used to deduce the format of a <code>CSV</code> file.</li>
</ul>
<p>&emsp;&emsp;The <code>Sniffer</code> class provides two methods:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sniff(sample, delimiters=<span class="keyword">None</span>)</span><br></pre></td></tr></table></figure>
<p>Analyze the given <code>sample</code> and return a <code>Dialect</code> subclass reflecting the parameters found. If the optional <code>delimiters</code> parameter is given, it is interpreted as a string containing possible valid delimiter characters.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">has_header(sample)</span><br></pre></td></tr></table></figure>
<p>Analyze the <code>sample</code> text (presumed to be in <code>CSV</code> format) and return <code>True</code> if the first row appears to be a series of column headers.<br>&emsp;&emsp;An example for <code>Sniffer</code> use:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">'example.csv'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">    dialect = csv.Sniffer().sniff(csvfile.read(<span class="number">1024</span>))</span><br><span class="line">    csvfile.seek(<span class="number">0</span>)</span><br><span class="line">    reader = csv.reader(csvfile, dialect)</span><br><span class="line">    <span class="comment"># process CSV file contents here</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;The csv module defines the following constants:</p>
<ul>
<li><code>csv.QUOTE_ALL</code>: Instructs writer objects to quote all fields.</li>
<li><code>csv.QUOTE_MINIMAL</code>: Instructs writer objects to only quote those fields which contain special characters such as delimiter, quotechar or any of the characters in lineterminator.</li>
<li><code>csv.QUOTE_NONNUMERIC</code>: Instructs writer objects to quote all <code>non-numeric</code> fields. Instructs the reader to convert all <code>non-quoted</code> fields to type float.</li>
<li><code>csv.QUOTE_NONE</code>: Instructs writer objects to never quote fields. When the current delimiter occurs in output data it is preceded by the current escapechar character. If escapechar is not set, the writer will raise <code>Error</code> if any characters that require escaping are encountered.</li>
</ul>
<p>&emsp;&emsp;Instructs reader to perform no special processing of quote characters.<br>&emsp;&emsp;The csv module defines the following exception:</p>
<ul>
<li><code>exception csv.Error</code>: Raised by any of the functions when an error is detected.</li>
</ul>
<h3 id="Dialects-and-Formatting-Parameters"><a href="#Dialects-and-Formatting-Parameters" class="headerlink" title="Dialects and Formatting Parameters"></a>Dialects and Formatting Parameters</h3><p>&emsp;&emsp;To make it easier to specify the format of input and output records, specific formatting parameters are grouped together into dialects. A dialect is a subclass of the <code>Dialect</code> class having a set of specific methods and a single <code>validate()</code> method. When creating reader or writer objects, the programmer can specify a string or a subclass of the <code>Dialect</code> class as the dialect parameter. In addition to, or instead of, the dialect parameter, the programmer can also specify individual formatting parameters, which have the same names as the attributes defined below for the <code>Dialect</code> class.<br>&emsp;&emsp;Dialects support the following attributes:</p>
<ul>
<li><code>Dialect.delimiter</code>: A <code>one-character</code> string used to separate fields. It defaults to <code>,</code>.</li>
<li><code>Dialect.doublequote</code>: Controls how instances of quotechar appearing inside a field should themselves be quoted. When <code>True</code>, the character is doubled. When <code>False</code>, the escapechar is used as a prefix to the quotechar. It defaults to <code>True</code>.</li>
</ul>
<p>&emsp;&emsp;On output, if doublequote is <code>False</code> and no escapechar is set, Error is raised if a quotechar is found in a field.</p>
<ul>
<li><code>Dialect.escapechar</code>: A <code>one-character</code> string used by the writer to escape the delimiter if quoting is set to <code>QUOTE_NONE</code> and the quotechar if doublequote is <code>False</code>. On reading, the escapechar removes any special meaning from the following character. It defaults to <code>None</code>, which disables escaping.</li>
<li><code>Dialect.lineterminator</code>: The string used to terminate lines produced by the writer. It defaults to <code>\r\n</code>.</li>
</ul>
<p>&emsp;&emsp;<strong>Note</strong>: The reader is <code>hard-coded</code> to recognise either <code>\r</code> or <code>\n</code> as <code>end-of-line</code>, and ignores lineterminator. This behavior may change in the future.</p>
<ul>
<li><code>Dialect.quotechar</code>: A <code>one-character</code> string used to quote fields containing special characters, such as the delimiter or quotechar, or which contain <code>new-line</code> characters. It defaults to <code>&quot;</code>.</li>
<li><code>Dialect.quoting</code>: Controls when quotes should be generated by the writer and recognised by the reader. It can take on any of the <code>QUOTE_*</code> constants and defaults to <code>QUOTE_MINIMAL</code>.</li>
<li><code>Dialect.skipinitialspace</code>: When <code>True</code>, whitespace immediately following the delimiter is ignored. The default is <code>False</code>.</li>
<li><code>Dialect.strict</code>: When <code>True</code>, raise exception Error on bad <code>CSV</code> input. The default is <code>False</code>.</li>
</ul>
<h3 id="Reader-Objects"><a href="#Reader-Objects" class="headerlink" title="Reader Objects"></a>Reader Objects</h3><p>&emsp;&emsp;<code>Reader</code> objects (<code>DictReader</code> instances and objects returned by the <code>reader()</code> function) have the following public methods:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csvreader.__next__()</span><br></pre></td></tr></table></figure>
<p>Return the next row of the reader’s iterable object as a list (if the object was returned from <code>reader()</code>) or a dict (if it is a <code>DictReader</code> instance), parsed according to the current dialect. Usually you should call this as <code>next(reader)</code>.<br>&emsp;&emsp;<code>Reader</code> objects have the following public attributes:</p>
<ul>
<li><code>csvreader.dialect</code>: A <code>read-only</code> description of the dialect in use by the parser.</li>
<li><code>csvreader.line_num</code>: The number of lines read from the source iterator. This is not the same as the number of records returned, as records can span multiple lines.</li>
</ul>
<p>&emsp;&emsp;<code>DictReader</code> objects have the following public attribute:</p>
<ul>
<li><code>csvreader.fieldnames</code>: If not passed as a parameter when creating the object, this attribute is initialized upon first access or when the first record is read from the file.</li>
</ul>
<h3 id="Writer-Objects"><a href="#Writer-Objects" class="headerlink" title="Writer Objects"></a>Writer Objects</h3><p>&emsp;&emsp;<code>Writer</code> objects (<code>DictWriter</code> instances and objects returned by the <code>writer()</code> function) have the following public methods. A row must be an iterable of strings or numbers for <code>Writer</code> objects and a dictionary mapping fieldnames to strings or numbers (by passing them through <code>str()</code> first) for <code>DictWriter</code> objects. Note that complex numbers are written out surrounded by parens. This may cause some problems for other programs which read <code>CSV</code> files (assuming they support complex numbers at all).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csvwriter.writerow(row):</span><br></pre></td></tr></table></figure>
<p>Write the row parameter to the writer’s file object, formatted according to the current dialect.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">csvwriter.writerows(rows):</span><br></pre></td></tr></table></figure>
<p>Write all the rows parameters (a list of row objects as described above) to the writer’s file object, formatted according to the current dialect.<br>&emsp;&emsp;<code>Writer</code> objects have the following public attribute:</p>
<ul>
<li><code>csvwriter.dialect</code>: A <code>read-only</code> description of the dialect in use by the writer.</li>
</ul>
<p>&emsp;&emsp;<code>DictWriter</code> objects have the following public method:</p>
<ul>
<li><code>DictWriter.writeheader()</code>: Write a row with the field names (as specified in the constructor).</li>
</ul>
<h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><p>&emsp;&emsp;The simplest example of reading a <code>CSV</code> file:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'some.csv'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        print(row)</span><br></pre></td></tr></table></figure>
<p>Reading a file with an alternate format:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'passwd'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f, delimiter=<span class="string">':'</span>, quoting=csv.QUOTE_NONE)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        print(row)</span><br></pre></td></tr></table></figure>
<p>The corresponding simplest possible writing example is:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'some.csv'</span>, <span class="string">'w'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">    writer = csv.writer(f)</span><br><span class="line">    writer.writerows(someiterable)</span><br></pre></td></tr></table></figure>
<p>Since <code>open()</code> is used to open a <code>CSV</code> file for reading, the file will by default be decoded into unicode using the system default encoding. To decode a file using a different encoding, use the encoding argument of open:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'some.csv'</span>, newline=<span class="string">''</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        print(row)</span><br></pre></td></tr></table></figure>
<p>The same applies to writing in something other than the system default encoding: specify the encoding argument when opening the output file.<br>&emsp;&emsp;Registering a new dialect:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line">csv.register_dialect(<span class="string">'unixpwd'</span>, delimiter=<span class="string">':'</span>, quoting=csv.QUOTE_NONE)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'passwd'</span>, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f, <span class="string">'unixpwd'</span>)</span><br></pre></td></tr></table></figure>
<p>A slightly more advanced use of the reader — catching and reporting errors:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv, sys</span><br><span class="line">​</span><br><span class="line">filename = <span class="string">'some.csv'</span></span><br><span class="line"><span class="keyword">with</span> open(filename, newline=<span class="string">''</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">            print(row)</span><br><span class="line">    <span class="keyword">except</span> csv.Error <span class="keyword">as</span> e:</span><br><span class="line">        sys.exit(<span class="string">'file &#123;&#125;, line &#123;&#125;: &#123;&#125;'</span>.format(filename, reader.line_num, e))</span><br></pre></td></tr></table></figure>
<p>And while the module doesn’t directly support parsing strings, it can easily be done:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line">​</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> csv.reader([<span class="string">'one,two,three'</span>]):</span><br><span class="line">    print(row)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<strong>Footnotes</strong>: If <code>newline=&#39;&#39;</code> is not specified, newlines embedded inside quoted fields will not be interpreted correctly, and on platforms that use <code>\r\n</code> linendings on write an extra <code>\r</code> will be added. It should always be safe to specify <code>newline=&#39;&#39;</code>, since the csv module does its own (universal) newline handling.</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/02/24/Python语法/数据类型和循环/" rel="next" title="数据类型和循环">
                <i class="fa fa-chevron-left"></i> 数据类型和循环
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/02/24/Node_JS/事件循环/" rel="prev" title="事件循环">
                事件循环 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">付康为</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">939</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Module-Contents"><span class="nav-number">1.</span> <span class="nav-text">Module Contents</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dialects-and-Formatting-Parameters"><span class="nav-number">2.</span> <span class="nav-text">Dialects and Formatting Parameters</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reader-Objects"><span class="nav-number">3.</span> <span class="nav-text">Reader Objects</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Writer-Objects"><span class="nav-number">4.</span> <span class="nav-text">Writer Objects</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Examples"><span class="nav-number">5.</span> <span class="nav-text">Examples</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">付康为</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  


  

  

</body>
</html>
