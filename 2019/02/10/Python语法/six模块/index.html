<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Six: Python 2 and 3 Compatibility Library&amp;emsp;&amp;emsp;six provides simple utilities for wrapping over differences between Python 2 and Python 3. It is intended to support codebases that work on both Py">
<meta property="og:type" content="article">
<meta property="og:title" content="six模块">
<meta property="og:url" content="http://fukangwei.gitee.io/2019/02/10/Python语法/six模块/index.html">
<meta property="og:site_name" content="泥腿子出身">
<meta property="og:description" content="Six: Python 2 and 3 Compatibility Library&amp;emsp;&amp;emsp;six provides simple utilities for wrapping over differences between Python 2 and Python 3. It is intended to support codebases that work on both Py">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-03-30T00:46:51.580Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="six模块">
<meta name="twitter:description" content="Six: Python 2 and 3 Compatibility Library&amp;emsp;&amp;emsp;six provides simple utilities for wrapping over differences between Python 2 and Python 3. It is intended to support codebases that work on both Py">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '561O3H1PZB',
      apiKey: '7631d3cf19ac49bd39ada7163ec937a7',
      indexName: 'fuxinzi',
      hits: "",
      labels: ""
    }
  };
</script>



  <link rel="canonical" href="http://fukangwei.gitee.io/2019/02/10/Python语法/six模块/">





  <title>six模块 | 泥腿子出身</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">泥腿子出身</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://fukangwei.gitee.io/2019/02/10/Python语法/six模块/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="付康为">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="泥腿子出身">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">six模块</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-10T17:38:51+08:00">
                2019-02-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Python语法/" itemprop="url" rel="index">
                    <span itemprop="name">Python语法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="Six-Python-2-and-3-Compatibility-Library"><a href="#Six-Python-2-and-3-Compatibility-Library" class="headerlink" title="Six: Python 2 and 3 Compatibility Library"></a>Six: Python 2 and 3 Compatibility Library</h3><p>&emsp;&emsp;<code>six</code> provides simple utilities for wrapping over differences between <code>Python 2</code> and <code>Python 3</code>. It is intended to support codebases that work on both <code>Python 2</code> and <code>Python 3</code> without modification. <code>six</code> consists of only one <code>Python</code> file, so it is painless to copy into a project.<br>&emsp;&emsp;The name <code>six</code>, comes from the fact that <code>2 * 3</code> equals <code>6</code>. Why not addition? Multiplication is more powerful, and, anyway, <code>five</code> has already been snatched away by the (admittedly now moribund) <code>Zope Five project</code>.</p>
<h3 id="Package-contents"><a href="#Package-contents" class="headerlink" title="Package contents"></a>Package contents</h3><ul>
<li><code>six.PY2</code>: A boolean indicating if the code is running on <code>Python 2</code>.</li>
<li><code>six.PY3</code>: A boolean indicating if the code is running on <code>Python 3</code>.</li>
</ul>
<h3 id="Constants"><a href="#Constants" class="headerlink" title="Constants"></a>Constants</h3><p>&emsp;&emsp;<code>six</code> provides constants that may differ between <code>Python</code> versions. Ones ending <code>_types</code> are mostly useful as the second argument to <code>isinstance</code> or <code>issubclass</code>.</p>
<ul>
<li><code>six.class_types</code>: Possible class types. In <code>Python 2</code>, this encompasses <code>old-style</code> and <code>new-style</code> classes. In <code>Python 3</code>, this is just <code>new-styles</code>.</li>
<li><code>six.integer_types</code>: Possible integer types. In <code>Python 2</code>, this is <code>long</code> and <code>int</code>, and in <code>Python 3</code>, just <code>int</code>.</li>
<li><code>six.string_types</code>: Possible types for text data. This is <code>basestring()</code> in <code>Python 2</code> and <code>str</code> in <code>Python 3</code>.</li>
<li><code>six.text_type</code>: Type for representing (<code>Unicode</code>) textual data. This is <code>unicode()</code> in <code>Python 2</code> and <code>str</code> in <code>Python 3</code>.</li>
<li><code>six.binary_type</code>: Type for representing binary data. This is <code>str</code> in <code>Python 2</code> and <code>bytes</code> in <code>Python 3</code>.</li>
<li><code>six.MAXSIZE</code>: The maximum size of a container like <code>list</code> or <code>dict</code>. This is equivalent to <code>sys.maxsize</code> in <code>Python 2.6</code> and later (including <code>3.x</code>). <strong>Note</strong>: this is temptingly similar to, but not the same as <code>sys.maxint</code> in <code>Python 2</code>. There is no direct equivalent to <code>sys.maxint</code> in <code>Python 3</code> because its integer type has no limits aside from memory.</li>
</ul>
<p>&emsp;&emsp;Here’s example usage of the module:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> six</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dispatch_types</span><span class="params">(value)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> isinstance(value, six.integer_types):</span><br><span class="line">        handle_integer(value)</span><br><span class="line">    <span class="keyword">elif</span> isinstance(value, six.class_types):</span><br><span class="line">        handle_class(value)</span><br><span class="line">    <span class="keyword">elif</span> isinstance(value, six.string_types):</span><br><span class="line">        handle_string(value)</span><br></pre></td></tr></table></figure>
<h3 id="Object-model-compatibility"><a href="#Object-model-compatibility" class="headerlink" title="Object model compatibility"></a>Object model compatibility</h3><p>&emsp;&emsp;<code>Python 3</code> renamed the attributes of several interpreter data structures. The following accessors are available. Note that the recommended way to inspect functions and methods is the stdlib inspect module.<br>&emsp;&emsp;<code>six.get_unbound_function(meth)</code>: Get the function out of unbound method <code>meth</code>. In <code>Python 3</code>, unbound methods don’t exist, so this function just returns <code>meth</code> unchanged. Example usage:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> six <span class="keyword">import</span> get_unbound_function</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">method</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">​</span><br><span class="line">method_function = get_unbound_function(X.method)</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>six.get_method_function(meth)</code>: Get the function out of method object <code>meth</code>.<br>&emsp;&emsp;<code>six.get_method_self(meth)</code>: Get the self of bound method <code>meth</code>.<br>&emsp;&emsp;<code>six.get_function_closure(func)</code>: Get the closure (list of cells) associated with <code>func</code>. This is equivalent to <code>func.__closure__</code> on <code>Python 2.6+</code> and <code>func.func_closure</code> on <code>Python 2.5</code>.<br>&emsp;&emsp;<code>six.get_function_code(func)</code>: Get the code object associated with <code>func</code>. This is equivalent to <code>func.__code__</code> on <code>Python 2.6+</code> and <code>func.func_code</code> on <code>Python 2.5</code>.<br>&emsp;&emsp;<code>six.get_function_defaults(func)</code>: Get the defaults <code>tuple</code> associated with <code>func</code>. This is equivalent to <code>func.__defaults__</code> on <code>Python 2.6+</code> and <code>func.func_defaults</code> on <code>Python 2.5</code>.<br>&emsp;&emsp;<code>six.get_function_globals(func)</code>: Get the globals of <code>func</code>. This is equivalent to <code>func.__globals__</code> on <code>Python 2.6+</code> and <code>func.func_globals</code> on <code>Python 2.5</code>.<br>&emsp;&emsp;<code>six.next(it)</code> or <code>six.advance_iterator(it)</code>: Get the next item of iterator <code>it</code>. <code>StopIteration</code> is raised if the iterator is exhausted. This is a replacement for calling <code>it.next()</code> in <code>Python 2</code> and <code>next(it)</code> in <code>Python 3</code>. <code>Python 2.6</code> and above have a builtin next function, so <code>six&#39;s</code> version is only necessary for <code>Python 2.5</code> compatibility.<br>&emsp;&emsp;<code>six.callable(obj)</code>: Check if <code>obj</code> can be called. Note callable has returned in <code>Python 3.2</code>, so using <code>six&#39;s</code> version is only necessary when supporting <code>Python 3.0</code> or <code>3.1</code>.<br>&emsp;&emsp;<code>six.iterkeys(dictionary, **kwargs)</code>: Returns an iterator over <code>dictionary&#39;s</code> keys. This replaces <code>dictionary.iterkeys()</code> on <code>Python 2</code> and <code>dictionary.keys()</code> on <code>Python 3</code>. <code>kwargs</code> are passed through to the underlying method.<br>&emsp;&emsp;<code>six.itervalues(dictionary, **kwargs)</code>: Returns an iterator over <code>dictionary&#39;s</code> values. This replaces <code>dictionary.itervalues()</code> on <code>Python 2</code> and <code>dictionary.values()</code> on <code>Python 3</code>. <code>kwargs</code> are passed through to the underlying method.<br>&emsp;&emsp;<code>six.iteritems(dictionary, **kwargs)</code>: Returns an iterator over <code>dictionary&#39;s</code> items. This replaces <code>dictionary.iteritems()</code> on <code>Python 2</code> and <code>dictionary.items()</code> on <code>Python 3</code>. <code>kwargs</code> are passed through to the underlying method.<br>&emsp;&emsp;<code>six.iterlists(dictionary, **kwargs)</code>: Calls <code>dictionary.iterlists()</code> on <code>Python 2</code> and <code>dictionary.lists()</code> on <code>Python 3</code>. No builtin Python mapping type has such a method; this method is intended for use with <code>multi-valued</code> dictionaries like Werkzeug’s. <code>kwargs</code> are passed through to the underlying method.<br>&emsp;&emsp;<code>six.viewkeys(dictionary)</code>: Return a view over <code>dictionary&#39;s</code> keys. This replaces <code>dict.viewkeys()</code> on <code>Python 2.7</code> and <code>dict.keys()</code> on <code>Python 3</code>.<br>&emsp;&emsp;<code>six.viewvalues(dictionary)</code>: Return a view over <code>dictionary&#39;s</code> values. This replaces <code>dict.viewvalues()</code> on <code>Python 2.7</code> and <code>dict.values()</code> on <code>Python 3</code>.<br>&emsp;&emsp;<code>six.viewitems(dictionary)</code>: Return a view over <code>dictionary&#39;s</code> items. This replaces <code>dict.viewitems()</code> on <code>Python 2.7</code> and <code>dict.items()</code> on <code>Python 3</code>.<br>&emsp;&emsp;<code>six.create_bound_method(func, obj)</code>: Return a method object wrapping <code>func</code> and bound to <code>obj</code>. On both <code>Python 2</code> and <code>3</code>, this will return a <code>types.MethodType</code> object. The reason this wrapper exists is that on <code>Python 2</code>, the <code>MethodType</code> constructor requires the obj’s class to be passed.<br>&emsp;&emsp;<code>six.create_unbound_method(func, cls)</code>: Return an unbound method object wrapping <code>func</code>. In <code>Python 2</code>, this will return a <code>types.MethodType</code> object. In <code>Python 3</code>, unbound methods do not exist and this wrapper will simply return <code>func</code>.<br>&emsp;&emsp;<code>class six.Iterator</code>: A class for making portable iterators. The intention is that it be subclassed and subclasses provide a <code>__next__</code> method. In <code>Python 2</code>, Iterator has one method: <code>next</code>. It simply delegates to <code>__next__</code>. An alternate way to do this would be to simply alias <code>next</code> to <code>__next__</code>. However, this interacts badly with subclasses that override <code>__next__</code>. Iterator is empty on <code>Python 3</code> (In fact, it is just aliased to object).<br>&emsp;&emsp;<code>six.wraps(wrapped, assigned=functools.WRAPPER_ASSIGNMENTS, updated=functools.WRAPPER_UPDATES)</code>: This is exactly the <code>functools.wraps()</code> decorator, but it sets the <code>__wrapped__</code> attribute on what it decorates as <code>functools.wraps()</code> does on <code>Python</code> versions after <code>3.2</code>.</p>
<h3 id="Syntax-compatibility"><a href="#Syntax-compatibility" class="headerlink" title="Syntax compatibility"></a>Syntax compatibility</h3><p>&emsp;&emsp;These functions smooth over operations which have different syntaxes between <code>Python 2</code> and <code>3</code>.<br>&emsp;&emsp;<code>six.exec_(code, globals=None, locals=None)</code>: Execute <code>code</code> in the scope of <code>globals</code> and <code>locals</code>. <code>code</code> can be a string or a code object. If <code>globals</code> or <code>locals</code> are not given, they will default to the scope of the caller. If just <code>globals</code> is given, it will also be used as <code>locals</code>.<br>&emsp;&emsp;<strong>Note</strong>: <code>Python 3&#39;s</code> <code>exec()</code> doesn’t take keyword arguments, so calling <code>exec()</code> with them should be avoided.<br>&emsp;&emsp;<code>six.print_(*args, *, file=sys.stdout, end=&quot;\n&quot;, sep=&quot; &quot;, flush=False)</code>: Print <code>args</code> into <code>file</code>. Each argument will be separated with <code>sep</code> and <code>end</code> will be written to the file after the last argument is printed. If <code>flush</code> is <code>true</code>, <code>file.flush()</code> will be called after all data is written.<br>&emsp;&emsp;<strong>Note</strong>: In <code>Python 2</code>, this function imitates <code>Python 3&#39;s</code> <code>print()</code> by not having softspace support. If you don’t know what that is, you’re probably ok.<br>&emsp;&emsp;<code>six.raise_from(exc_value, exc_value_from)</code>: Raise an exception from a context. On <code>Python 3</code>, this is equivalent to raise <code>exc_value</code> from <code>exc_value_from</code>. On <code>Python 2</code>, which does not support exception chaining, it is equivalent to raise <code>exc_value</code>.<br>&emsp;&emsp;<code>six.reraise(exc_type, exc_value, exc_traceback=None)</code>: Reraise an exception, possibly with a different traceback. In the simple case, <code>reraise(*sys.exc_info())</code> with an active exception (in an except block) reraises the current exception with the last traceback. A different traceback can be specified with the <code>exc_traceback</code> parameter. Note that since the exception reraising is done within the <code>reraise()</code> function, <code>Python</code> will attach the call frame of <code>reraise()</code> to whatever traceback is raised.<br>&emsp;&emsp;<code>six.with_metaclass(metaclass, *bases)</code>: Create a new class with base classes <code>bases</code> and <code>metaclass</code>. This is designed to be used in class declarations like this:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> six <span class="keyword">import</span> with_metaclass</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Meta</span><span class="params">(type)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(with_metaclass<span class="params">(Meta, Base)</span>)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>Another way to set a <code>metaclass</code> on a class is with the <code>add_metaclass()</code> decorator.<br>&emsp;&emsp;<code>six.add_metaclass(metaclass)</code>: Class decorator that replaces a <code>normally-constructed</code> class with a <code>metaclass-constructed</code> one. Example usage:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@add_metaclass(Meta)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>That code produces a class equivalent to</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(object, metaclass=Meta)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>on <code>Python 3</code> or</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(object)</span>:</span></span><br><span class="line">    __metaclass__ = Meta</span><br></pre></td></tr></table></figure>
<p>on <code>Python 2</code>.<br>&emsp;&emsp;Note that class decorators require <code>Python 2.6</code>. However, the effect of the decorator can be emulated on <code>Python 2.5</code> like so:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">​</span><br><span class="line">MyClass = add_metaclass(Meta)(MyClass)</span><br></pre></td></tr></table></figure>
<h3 id="Binary-and-text-data"><a href="#Binary-and-text-data" class="headerlink" title="Binary and text data"></a>Binary and text data</h3><p>&emsp;&emsp;<code>Python 3</code> enforces the distinction between byte strings and text strings far more rigorously than <code>Python 2</code> does; binary data cannot be automatically coerced to or from text data. <code>six</code> provides several functions to assist in classifying string data in all <code>Python</code> versions.<br>&emsp;&emsp;<code>six.b(data)</code>: A <code>fake</code> bytes literal. <code>data</code> should always be a normal string literal. In <code>Python 2</code>, <code>b()</code> returns a <code>8-bit</code> string. In <code>Python 3</code>, <code>data</code> is encoded with the <code>latin-1</code> encoding to bytes.<br>&emsp;&emsp;<strong>Note</strong>: Since all <code>Python versions 2.6</code> and after support the <code>b</code> prefix, code without <code>2.5</code> support doesn’t need <code>b()</code>.<br>&emsp;&emsp;<code>six.u(text)</code>: A <code>fake</code> unicode literal. <code>text</code> should always be a normal string literal. In <code>Python 2</code>, <code>u()</code> returns unicode, and in <code>Python 3</code>, a string. Also, in <code>Python 2</code>, the string is decoded with the <code>unicode-escape</code> codec, which allows unicode escapes to be used in it.<br>&emsp;&emsp;<strong>Note</strong>: In <code>Python 3.3</code>, the <code>u</code> prefix has been reintroduced. Code that only supports <code>Python 3</code> versions of <code>3.3</code> and higher thus does not need <code>u()</code>.<br>&emsp;&emsp;<strong>Note</strong>: On <code>Python 2</code>, <code>u()</code> doesn’t know what the encoding of the literal is. Each byte is converted directly to the unicode codepoint of the same value. Because of this, it’s only safe to use <code>u()</code> with strings of <code>ASCII</code> data.<br>&emsp;&emsp;<code>six.unichr(c)</code>: Return the Unicode string representing the codepoint <code>c</code>. This is equivalent to <code>unichr()</code> on <code>Python 2</code> and <code>chr()</code> on <code>Python 3</code>.<br>&emsp;&emsp;<code>six.int2byte(i)</code>: Converts <code>i</code> to a byte. <code>i</code> must be in <code>range(0, 256)</code>. This is equivalent to <code>chr()</code> in <code>Python 2</code> and <code>bytes((i,))</code> in <code>Python 3</code>.<br>&emsp;&emsp;<code>six.byte2int(bs)</code>: Converts the first byte of <code>bs</code> to an integer. This is equivalent to <code>ord(bs[0])</code> on <code>Python 2</code> and <code>bs[0]</code> on <code>Python 3</code>.<br>&emsp;&emsp;<code>six.indexbytes(buf, i)</code>: Return the byte at index <code>i</code> of <code>buf</code> as an integer. This is equivalent to indexing a bytes object in <code>Python 3</code>.<br>&emsp;&emsp;<code>six.iterbytes(buf)</code>: Return an iterator over bytes in <code>buf</code> as integers. This is equivalent to a bytes object iterator in <code>Python 3</code>.<br>&emsp;&emsp;<code>six.StringIO</code>: This is a fake file object for textual data. It’s an alias for <code>StringIO.StringIO</code> in <code>Python 2</code> and <code>io.StringIO</code> in <code>Python 3</code>.<br>&emsp;&emsp;<code>six.BytesIO</code>: This is a fake file object for binary data. In <code>Python 2</code>, it’s an alias for <code>StringIO.StringIO</code>, but in <code>Python 3</code>, it’s an alias for <code>io.BytesIO</code>.<br>&emsp;&emsp;<code>six.python_2_unicode_compatible</code>: A class decorator that takes a class defining a <code>__str__</code> method. On <code>Python 3</code>, the decorator does nothing. On <code>Python 2</code>, it aliases the <code>__str__</code> method to <code>__unicode__</code> and creates a new <code>__str__</code> method that returns the result of <code>__unicode__()</code> encoded with <code>UTF-8</code>.</p>
<h3 id="unittest-assertions"><a href="#unittest-assertions" class="headerlink" title="unittest assertions"></a>unittest assertions</h3><p>&emsp;&emsp;<code>six</code> contains compatibility shims for unittest assertions that have been renamed. The parameters are the same as their aliases, but you must pass the test method as the first argument. For example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> six</span><br><span class="line"><span class="keyword">import</span> unittest</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestAssertCountEqual</span><span class="params">(unittest.TestCase)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(self)</span>:</span></span><br><span class="line">        six.assertCountEqual(self, (<span class="number">1</span>, <span class="number">2</span>), [<span class="number">2</span>, <span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>Note these functions are only available on <code>Python 2.7</code> or later.<br>&emsp;&emsp;<code>six.assertCountEqual()</code>: Alias for <code>assertCountEqual()</code> on <code>Python 3</code> and <code>assertItemsEqual()</code> on <code>Python 2</code>.<br>&emsp;&emsp;<code>six.assertRaisesRegex()</code>: Alias for <code>assertRaisesRegex()</code> on <code>Python 3</code> and <code>assertRaisesRegexp()</code> on <code>Python 2</code>.<br>&emsp;&emsp;<code>six.assertRegex()</code>: Alias for <code>assertRegex()</code> on <code>Python 3</code> and <code>assertRegexpMatches()</code> on <code>Python 2</code>.</p>
<h3 id="Renamed-modules-and-attributes-compatibility"><a href="#Renamed-modules-and-attributes-compatibility" class="headerlink" title="Renamed modules and attributes compatibility"></a>Renamed modules and attributes compatibility</h3><p>&emsp;&emsp;<code>Python 3</code> reorganized the standard library and moved several functions to different modules. <code>six</code> provides a consistent interface to them through the fake <code>six.moves</code> module. For example, to load the module for parsing <code>HTML</code> on <code>Python 2</code> or <code>3</code>, write:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> six.moves <span class="keyword">import</span> html_parser</span><br></pre></td></tr></table></figure>
<p>Similarly, to get the function to reload modules, which was moved from the builtin module to the imp module, use:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> six.moves <span class="keyword">import</span> reload_module</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;For the most part, <code>six.moves</code> aliases are the names of the modules in <code>Python 3</code>. When the new <code>Python 3</code> name is a package, the components of the name are separated by underscores. For example, <code>html.parser</code> becomes <code>html_parser</code>. In some cases where several modules have been combined, the <code>Python 2</code> name is retained. This is so the appropriate modules can be found when running on <code>Python 2</code>. For example, <code>BaseHTTPServer</code> which is in <code>http.server</code> in <code>Python 3</code> is aliased as <code>BaseHTTPServer</code>.<br>&emsp;&emsp;Some modules which had two implementations have been merged in <code>Python 3</code>. For example, <code>cPickle</code> no longer exists in <code>Python 3</code>; it was merged with <code>pickle</code>. In these cases, fetching the fast version will load the fast one on <code>Python 2</code> and the merged module in <code>Python 3</code>.<br>&emsp;&emsp;The <code>urllib</code>, <code>urllib2</code>, and <code>urlparse</code> modules have been combined in the <code>urllib</code> package in <code>Python 3</code>. The <code>six.moves.urllib</code> package is a <code>version-independent</code> location for this functionality; its structure mimics the structure of the <code>Python 3</code> <code>urllib</code> package.<br>&emsp;&emsp;<strong>Note</strong>: In order to make imports of the form:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> six.moves.cPickle <span class="keyword">import</span> loads</span><br></pre></td></tr></table></figure>
<p>work, <code>six</code> places special proxy objects in <code>sys.modules</code>. These proxies lazily load the underlying module when an attribute is fetched. This will fail if the underlying module is not available in the <code>Python</code> interpreter. For example, <code>sys.modules[&quot;six.moves.winreg&quot;].LoadKey</code> would fail on any <code>non-Windows</code> platform. Unfortunately, some applications try to load attributes on every module in <code>sys.modules</code>. <code>six</code> mitigates this problem for some applications by pretending attributes on unimportable modules do not exist. This hack does not work in every case, though. If you are encountering problems with the lazy modules and don’t use any from imports directly from <code>six.moves</code> modules, you can workaround the issue by removing the <code>six</code> proxy modules:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d = [name <span class="keyword">for</span> name <span class="keyword">in</span> sys.modules <span class="keyword">if</span> name.startswith(<span class="string">"six.moves."</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> d:</span><br><span class="line">    <span class="keyword">del</span> sys.modules[name]</span><br></pre></td></tr></table></figure>
<h3 id="Advanced-Customizing-renames"><a href="#Advanced-Customizing-renames" class="headerlink" title="Advanced - Customizing renames"></a>Advanced - Customizing renames</h3><p>&emsp;&emsp;It is possible to add additional names to the <code>six.moves</code> namespace.<br>&emsp;&emsp;<code>six.add_move(item)</code>: Add <code>item</code> to the <code>six.moves</code> mapping. <code>item</code> should be a <code>MovedAttribute</code> or <code>MovedModule</code> instance.<br>&emsp;&emsp;<code>six.remove_move(name)</code>: Remove the <code>six.moves</code> mapping called <code>name</code>. <code>name</code> should be a string. Instances of the following classes can be passed to <code>add_move()</code>. Neither have any public members.<br>&emsp;&emsp;<code>class six.MovedModule(name, old_mod, new_mod)</code>: Create a mapping for <code>six.moves</code> called <code>name</code> that references different modules in <code>Python 2</code> and <code>3</code>. <code>old_mod</code> is the name of the <code>Python 2</code> module. <code>new_mod</code> is the name of the <code>Python 3</code> module.<br>&emsp;&emsp;<code>class six.MovedAttribute(name, old_mod, new_mod, old_attr=None, new_attr=None)</code>: Create a mapping for <code>six.moves</code> called <code>name</code> that references different attributes in <code>Python 2</code> and <code>3</code>. <code>old_mod</code> is the name of the <code>Python 2</code> module. <code>new_mod</code> is the name of the <code>Python 3</code> module. If <code>new_attr</code> is not given, it defaults to <code>old_attr</code>. If neither is given, they both default to name.</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/02/10/Python语法/psutil模块/" rel="next" title="psutil模块">
                <i class="fa fa-chevron-left"></i> psutil模块
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/02/10/Python语法/错误和异常/" rel="prev" title="错误和异常">
                错误和异常 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">付康为</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">939</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Six-Python-2-and-3-Compatibility-Library"><span class="nav-number">1.</span> <span class="nav-text">Six: Python 2 and 3 Compatibility Library</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Package-contents"><span class="nav-number">2.</span> <span class="nav-text">Package contents</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Constants"><span class="nav-number">3.</span> <span class="nav-text">Constants</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Object-model-compatibility"><span class="nav-number">4.</span> <span class="nav-text">Object model compatibility</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Syntax-compatibility"><span class="nav-number">5.</span> <span class="nav-text">Syntax compatibility</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Binary-and-text-data"><span class="nav-number">6.</span> <span class="nav-text">Binary and text data</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#unittest-assertions"><span class="nav-number">7.</span> <span class="nav-text">unittest assertions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Renamed-modules-and-attributes-compatibility"><span class="nav-number">8.</span> <span class="nav-text">Renamed modules and attributes compatibility</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Advanced-Customizing-renames"><span class="nav-number">9.</span> <span class="nav-text">Advanced - Customizing renames</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">付康为</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  


  

  

</body>
</html>
